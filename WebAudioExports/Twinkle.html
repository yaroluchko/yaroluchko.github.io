
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Creativitas Exported Code</title>
                
                <!-- External Dependencies -->
                <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/15.0.4/Tone.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.0/p5.js"></script>
                <script src="https://cdn.socket.io/4.8.1/socket.io.min.js" integrity="sha384-mkQ3/7FUtcGyoppY6bz/PORYoGqOl7/aSUMn2ymDOJcapfS6PHqxhRTMh1RR0Q6+" crossorigin="anonymous"></script>               
                <script>
                (()=>{var e={69:(e,t,n)=>{n.r(t),n.d(t,{TimingProvider:()=>Tt});var r=n(822),i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+t+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function s(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=u(0),s.throw=u(1),s.return=u(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(6===u[0]&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(e){u=[6,e],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function l(e){return this instanceof l?(this.v=e,this):new l(e)}function h(e){return"function"==typeof e}function f(e){var t=e((function(e){Error.call(e),e.stack=Error().stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}"function"==typeof SuppressedError&&SuppressedError;var d=f((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function p(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var v=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=u(o),l=s.next();!l.done;l=s.next())l.value.remove(this)}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var f=this.initialTeardown;if(h(f))try{f()}catch(e){i=e instanceof d?e.errors:[e]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var v=u(p),y=v.next();!y.done;y=v.next()){var b=y.value;try{_(b)}catch(e){i=null!=i?i:[],e instanceof d?i=a(a([],c(i)),c(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(r=v.return)&&r.call(v)}finally{if(n)throw n.error}}}if(i)throw new d(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)_(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&p(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&p(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),y=v.EMPTY;function b(e){return e instanceof v||e&&"closed"in e&&h(e.remove)&&h(e.add)&&h(e.unsubscribe)}function _(e){h(e)?e():e.unsubscribe()}var m={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=m.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,a([e,t],c(n))):setTimeout.apply(void 0,a([e,t],c(n)))},clearTimeout:function(e){var t=m.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function g(e){m.setTimeout((function(){throw e}))}function w(){}var E=x("C",void 0,void 0);function x(e,t,n){return{kind:e,value:t,error:n}}function S(e){e()}var P=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,b(t)&&t.add(n)):n.destination=C,n}return o(t,e),t.create=function(e,t,n){return new I(e,t,n)},t.prototype.next=function(e){this.isStopped?j(function(e){return x("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?j(x("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?j(E,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(v);var T=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){O(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){O(e)}else O(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){O(e)}},e}(),I=function(e){function t(t,n,r){var i,o=e.call(this)||this;return i=h(t)||!t?{next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:t,o.destination=new T(i),o}return o(t,e),t}(P);function O(e){g(e)}function j(e,t){var n=null;n&&m.setTimeout((function(){return n(e,t)}))}var C={closed:!0,next:w,error:function(e){throw e},complete:w},k="function"==typeof Symbol&&Symbol.observable||"@@observable";function A(e){return e}var L=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof P||function(e){return e&&h(e.next)&&h(e.error)&&h(e.complete)}(r)&&b(r)?e:new I(e,t,n);return S((function(){var e=i.operator,t=i.source;o.add(e?e.call(o,t):t?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=N(t))((function(t,r){var i=new I({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[k]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?A:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=N(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function N(e){var t;return null!==(t=null!=e?e:undefined)&&void 0!==t?t:Promise}var R=f((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),V=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o(t,e),t.prototype.lift=function(e){var t=new z(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new R},t.prototype.next=function(e){var t=this;S((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=u(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;S((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;S((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.observers;return n.hasError||n.isStopped?y:(this.currentObservers=null,r.push(e),new v((function(){t.currentObservers=null,p(r,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.isStopped;t.hasError?e.error(t.thrownError):n&&e.complete()},t.prototype.asObservable=function(){var e=new L;return e.source=this,e},t.create=function(e,t){return new z(e,t)},t}(L),z=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return o(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:y},t}(V);function D(e){return function(t){if(function(e){return h(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function M(e,t,n,r,i){return new q(e,t,n,r,i)}var q=function(e){function t(t,n,r,i,o,s){var u=e.call(this,t)||this;return u.onFinalize=o,u.shouldUnsubscribe=s,u._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,u._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,u}return o(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(P);function U(e,t){return D((function(n,r){var i=0;n.subscribe(M(r,(function(n){r.next(e.call(t,n,i++))})))}))}var W=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function J(e){return h(null==e?void 0:e.then)}function F(e){return h(e[k])}function G(e){return Symbol.asyncIterator&&h(null==e?void 0:e[Symbol.asyncIterator])}function $(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Y="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function B(e){return h(null==e?void 0:e[Y])}function X(e){return function(t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=function(){var t,n,r;return s(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,l(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,l(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,l(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}.apply(t,n||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",(function(e){return function(t){return Promise.resolve(t).then(e,h)}})),r[Symbol.asyncIterator]=function(){return this},r;function u(e,t){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||c(e,t)}))},t&&(r[e]=t(r[e])))}function c(e,t){try{(n=i[e](t)).value instanceof l?Promise.resolve(n.value.v).then(a,h):f(o[0][2],n)}catch(e){f(o[0][3],e)}var n}function a(e){c("next",e)}function h(e){c("throw",e)}function f(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments)}function Z(e){return h(null==e?void 0:e.getReader)}function H(e){if(e instanceof L)return e;if(null!=e){if(F(e))return i=e,new L((function(e){var t=i[k]();if(h(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(W(e))return r=e,new L((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(J(e))return n=e,new L((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,g)}));if(G(e))return K(e);if(B(e))return t=e,new L((function(e){var n,r;try{for(var i=u(t),o=i.next();!o.done;o=i.next())if(e.next(o.value),e.closed)return}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(Z(e))return K(X(e))}var t,n,r,i;throw $(e)}function K(e){return new L((function(t){(function(e,t){var n,r,i,o,c,a,l;return c=this,l=function(){var c;return s(this,(function(s){switch(s.label){case 0:s.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=u(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}(e),s.label=1;case 1:return[4,n.next()];case 2:if((r=s.sent()).done)return[3,4];if(t.next(r.value),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=s.sent(),i={error:c},[3,11];case 6:return s.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function r(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(n,r)}i((l=l.call(c)).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function Q(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function ee(e,t,n){return void 0===n&&(n=1/0),h(t)?ee((function(n,r){return U((function(e,i){return t(n,e,r,i)}))(H(e(n,r)))}),n):("number"==typeof t&&(n=t),D((function(t,r){return function(e,t,n,r){var i=[],o=0,s=0,u=!1,c=function(){!u||i.length||o||t.complete()},a=function(e){o++;var u=!1;H(n(e,s++)).subscribe(M(t,(function(e){t.next(e)}),(function(){u=!0}),void 0,(function(){if(u)try{for(o--;i.length&&o<r;)void 0,e=i.shift(),a(e);c()}catch(e){t.error(e)}var e})))};return e.subscribe(M(t,(function(e){return o<r?a(e):i.push(e)}),(function(){u=!0,c()}))),function(){}}(t,r,e,n)})))}function te(e){return void 0===e&&(e=1/0),ee(A,e)}var ne=new L((function(e){return e.complete()}));function re(e){return e&&h(e.schedule)}function ie(e){return e[e.length-1]}function oe(e){return h(ie(e))?e.pop():void 0}function se(e){return re(ie(e))?e.pop():void 0}function ue(e,t){return void 0===t&&(t=0),D((function(n,r){n.subscribe(M(r,(function(n){return Q(r,e,(function(){return r.next(n)}),t)}),(function(){return Q(r,e,(function(){return r.complete()}),t)}),(function(n){return Q(r,e,(function(){return r.error(n)}),t)})))}))}function ce(e,t){return void 0===t&&(t=0),D((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function ae(e,t){if(!e)throw Error("Iterable cannot be null");return new L((function(n){Q(n,t,(function(){var r=e[Symbol.asyncIterator]();Q(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function le(e,t){return t?function(e,t){if(null!=e){if(F(e))return function(e,t){return H(e).pipe(ce(t),ue(t))}(e,t);if(W(e))return function(e,t){return new L((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(J(e))return function(e,t){return H(e).pipe(ce(t),ue(t))}(e,t);if(G(e))return ae(e,t);if(B(e))return function(e,t){return new L((function(n){var r;return Q(n,t,(function(){r=e[Y](),Q(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return h(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(Z(e))return function(e,t){return ae(X(e),t)}(e,t)}throw $(e)}(e,t):H(e)}function he(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=se(e),r=function(e){return"number"==typeof ie(e)?e.pop():1/0}(e),i=e;return i.length?1===i.length?H(i[0]):te(r)(le(i,n)):ne}function fe(e,t){var n=h(e)?e:function(){return e},r=function(e){return e.error(n())};return new L(t?function(e){return t.schedule(r,0,e)}:r)}function de(e){return D((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}const pe=Symbol.observable||"@@observable",ve=()=>{},ye=e=>{throw e},be=e=>(e.error(Error("The required browser API seems to be not supported.")),()=>{}),_e="undefined"==typeof window?null:window,me=((e,t)=>{const n=()=>{};return e=>{const r=(...r)=>{const i=e((e=>"function"==typeof e[0])(r)?t({next:r[0]}):t(...r));return void 0!==i?i:n};return r[Symbol.observable]=()=>({subscribe:(...e)=>({unsubscribe:r(...e)})}),i=r,Symbol.observable||("function"==typeof i&&i.prototype&&i.prototype[Symbol.observable]?(i.prototype[pe]=i.prototype[Symbol.observable],delete i.prototype[Symbol.observable]):(i[pe]=i[Symbol.observable],delete i[Symbol.observable])),i;var i}})(0,(function(e){return e?e.next&&e.error&&e.complete?e:{complete:(e.complete??ve).bind(e),error:(e.error??ye).bind(e),next:(e.next??ve).bind(e)}:{complete:ve,error:ye,next:ve}})),ge=(e=>(t,n,r)=>e((e=>{const i=t=>e.next(t);return t.addEventListener(n,i,r),()=>t.removeEventListener(n,i,r)})))(me),we=((e,t,n)=>()=>n((n=>{if(null===t||void 0===t.navigator||void 0===t.navigator.onLine)return e(n);const r=()=>n.next(!1),i=()=>n.next(!0);return t.addEventListener("offline",r),t.addEventListener("online",i),n.next(t.navigator.onLine),()=>{t.removeEventListener("offline",r),t.removeEventListener("online",i)}})))(be,_e,me);function Ee(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return te(1)(le(e,se(e)))}var xe=f((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function Se(e,t){return D((function(n,r){var i=0;n.subscribe(M(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function Pe(e){return e<=0?function(){return ne}:D((function(t,n){var r=0;t.subscribe(M(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function Te(){return new xe}function Ie(){return D((function(e,t){e.subscribe(M(t,w))}))}function Oe(e){return new L((function(t){H(e()).subscribe(t)}))}function je(e,t){return h(t)?ee(e,t,1):ee(e,1)}function Ce(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return le(e,se(e))}var ke=function(e){function t(t,n){return e.call(this)||this}return o(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(v),Ae={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Ae.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,a([e,t],c(n))):setInterval.apply(void 0,a([e,t],c(n)))},clearInterval:function(e){var t=Ae.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Le=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return o(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),Ae.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Ae.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,p(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(ke),Ne={now:function(){return(Ne.delegate||Date).now()},delegate:void 0},Re=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Ne.now,e}(),Ve=new(function(e){function t(t,n){void 0===n&&(n=Re.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return o(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Re))(Le),ze=Ve;function De(e,t,n){void 0===e&&(e=0),void 0===n&&(n=ze);var r=-1;return null!=t&&(re(t)?n=t:r=t),new L((function(t){var i,o=(i=e)instanceof Date&&!isNaN(i)?+e-n.now():e;o<0&&(o=0);var s=0;return n.schedule((function(){t.closed||(t.next(s++),0<=r?this.schedule(void 0,r):t.complete())}),o)}))}function Me(e){return D((function(t,n){var r,i=null,o=!1;i=t.subscribe(M(n,void 0,void 0,(function(s){r=H(e(s,Me(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):o=!0}))),o&&(i.unsubscribe(),i=null,r.subscribe(n))}))}function qe(e,t,n){var r=h(e)||t||n?{next:e,error:t,complete:n}:e;return r?D((function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(M(t,(function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)}),(function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()}),(function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)}),(function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)})))})):A}function Ue(e,t,n,r,i){return function(o,s){var u=n,c=t,a=0;o.subscribe(M(s,(function(t){var n=a++;c=u?e(c,t,n):(u=!0,t),r&&s.next(c)}),i&&function(){u&&s.next(c),s.complete()}))}}function We(e,t){return D(Ue(e,t,arguments.length>=2,!0))}var Je={connector:function(){return new V}};function Fe(e,t){void 0===t&&(t=Je);var n=t.connector;return D((function(t,r){var i,o=n();H(e((i=o,new L((function(e){return i.subscribe(e)}))))).subscribe(r),r.add(t.subscribe(o))}))}var Ge=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=Ne);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return o(t,e),t.prototype.next=function(t){var n=this,r=n._buffer,i=n._infiniteTimeWindow,o=n._timestampProvider,s=n._windowTime;n.isStopped||(r.push(t),!i&&r.push(o.now()+s)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var s=n.now(),u=0,c=1;c<r.length&&r[c]<=s;c+=2)u=c;u&&r.splice(0,u+1)}},t}(V);function $e(e,t,n,r){return D((function(i,o){var s;t&&"function"!=typeof t?(n=t.duration,s=t.element,r=t.connector):s=t;var u=new Map,c=function(e){u.forEach(e),e(o)},a=function(e){return c((function(t){return t.error(e)}))},l=0,h=!1,f=new q(o,(function(t){try{var i=e(t),c=u.get(i);if(!c){u.set(i,c=r?r():new V);var d=(v=i,y=c,(b=new L((function(e){l++;var t=y.subscribe(e);return function(){t.unsubscribe(),0==--l&&h&&f.unsubscribe()}}))).key=v,b);if(o.next(d),n){var p=M(c,(function(){c.complete(),null==p||p.unsubscribe()}),void 0,void 0,(function(){return u.delete(i)}));f.add(H(n(d)).subscribe(p))}}c.next(s?s(t):t)}catch(e){a(e)}var v,y,b}),(function(){return c((function(e){return e.complete()}))}),a,(function(){return u.clear()}),(function(){return h=!0,0===l}));i.subscribe(f)}))}var Ye=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return o(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e._value;if(e.hasError)throw e.thrownError;return this._throwIfClosed(),t},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(V);function Be(e,t){return void 0===t&&(t=A),e=null!=e?e:Xe,D((function(n,r){var i,o=!0;n.subscribe(M(r,(function(n){var s=t(n);!o&&e(i,s)||(o=!1,i=s,r.next(n))})))}))}function Xe(e,t){return e===t}function Ze(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return Ee(t,Ce.apply(void 0,a([],c(e))))}}const He=(e,t)=>{const n=t.find((t=>{let[n]=t;return n===e}));if(void 0===n)throw Error("There is no tuple with the given key.");return n[1]},Ke=e=>"boolean"==typeof e[1],Qe=e=>"boolean"!=typeof e[1],et=e=>null!==e[1]&&"object"==typeof e[1],tt=e=>"function"==typeof e[1],nt=e=>!0===e[1],rt=Symbol();function it(e){return Se((function(t,n){return e<=n}))}function ot(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=oe(e);return D((function(t,r){for(var i=e.length,o=Array(i),s=e.map((function(){return!1})),u=!1,l=function(t){H(e[t]).subscribe(M(r,(function(e){o[t]=e,u||s[t]||(s[t]=!0,(u=s.every(A))&&(s=null))}),w))},h=0;h<i;h++)l(h);t.subscribe(M(r,(function(e){if(u){var t=a([e],c(o));r.next(n?n.apply(void 0,a([],c(t))):t)}})))}))}const st=function(e){return null!=e};var ut,ct=Array.isArray;function at(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=oe(e),r=function(e){return 1===e.length&&ct(e[0])?e[0]:e}(e);return r.length?new L((function(e){var t=r.map((function(){return[]})),i=r.map((function(){return!1}));e.add((function(){t=i=null}));for(var o=function(o){H(r[o]).subscribe(M(e,(function(r){if(t[o].push(r),t.every((function(e){return e.length}))){var s=t.map((function(e){return e.shift()}));e.next(n?n.apply(void 0,a([],c(s))):s),t.some((function(e,t){return!e.length&&i[t]}))&&e.complete()}}),(function(){i[o]=!0,!t[o].length&&e.complete()})))},s=0;!e.closed&&s<r.length;s++)o(s);return function(){t=i=null}})):ne}function lt(e,t){return D((function(n,r){var i=null,o=0,s=!1,u=function(){return s&&!i&&r.complete()};n.subscribe(M(r,(function(n){null==i||i.unsubscribe();var s=0,c=o++;H(e(n,c)).subscribe(i=M(r,(function(e){return r.next(t?t(n,e,c,s++):e)}),(function(){i=null,u()})))}),(function(){s=!0,u()})))}))}function ht(e,t,n){return Oe((function(){return e()?t:n}))}function ft(e){return function(e,t){return D(Ue(e,t,arguments.length>=2,!1,!0))}((function(t,n,r){return!e||e(n,r)?t+1:t}),0)}function dt(e,t){return void 0===e&&(e=0),void 0===t&&(t=Ve),e<0&&(e=0),De(e,e,t)}function pt(e){return D((function(t,n){H(e).subscribe(M(n,(function(){return n.complete()}),w)),!n.closed&&t.subscribe(n)}))}function vt(e){var t;void 0===e&&(e=1/0);var n=(t=e&&"object"==typeof e?e:{count:e}).count,r=void 0===n?1/0:n,i=t.delay,o=t.resetOnSuccess,s=void 0!==o&&o;return r<=0?A:D((function(e,t){var n,o=0,u=function(){var c=!1;n=e.subscribe(M(t,(function(e){s&&(o=0),t.next(e)}),void 0,(function(e){if(o++<r){var s=function(){n?(n.unsubscribe(),n=null,u()):c=!0};if(null!=i){var a="number"==typeof i?De(i):H(i(e,o)),l=M(t,(function(){l.unsubscribe(),s()}),(function(){t.complete()}));a.subscribe(l)}else s()}else t.error(e)}))),c&&(n.unsubscribe(),n=null,u())};u()}))}!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(ut||(ut={}));var yt=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){return bt(this,e)},e.prototype.do=function(e,t,n){var r=this,i=r.kind,o=r.error;return"N"===i?null==e?void 0:e(r.value):"E"===i?null==t?void 0:t(o):null==n?void 0:n()},e.prototype.accept=function(e,t,n){var r;return h(null===(r=e)||void 0===r?void 0:r.next)?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){var e=this,t=e.kind,n=e.error,r="N"===t?Ce(e.value):"E"===t?fe((function(){return n})):"C"===t?ne:0;if(!r)throw new TypeError("Unexpected notification kind "+t);return r},e.createNext=function(t){return new e("N",t)},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e}();function bt(e,t){var n,r,i,o=e.kind,s=e.value,u=e.error;if("string"!=typeof o)throw new TypeError('Invalid notification, missing "kind"');"N"===o?null===(n=t.next)||void 0===n||n.call(t,s):"E"===o?null===(r=t.error)||void 0===r||r.call(t,u):null===(i=t.complete)||void 0===i||i.call(t)}class _t{constructor(e){this.callback=e}call(e,t){return t.subscribe(new mt(e,this.callback))}}class mt extends P{constructor(e,t){super(e),this.add(new v((()=>t(this.notification))))}complete(){this.notification=new yt("C"),super.complete()}error(e){this.notification=new yt("E",void 0,e),super.error(e)}}function gt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=se(e);return D((function(t,r){(n?Ee(e,t,n):Ee(e,t)).subscribe(r)}))}const wt=e=>new L((t=>{let n=!0;return e.then((e=>{n&&(t.next(e),t.complete())}),(e=>{n&&t.error(e)})),()=>n=!1})),Et=(e,t)=>n=>n.pipe(ee((n=>{let[r,i,o]=n;return new L((n=>{const s=[],u=new V,c=[],a=new V,l=()=>(_=!1,wt(E.setLocalDescription()).pipe(qe((()=>{const{localDescription:e}=E;if(null===e)throw Error("The local description is not set.");t({...A(e),client:{id:r},version:C})})))),h=()=>ge(E,"icecandidate")((e=>{let{candidate:n}=e;null===n?t({client:{id:r},numberOfGatheredCandidates:w,type:"summary",version:C}):9!==n.port&&"tcp"!==n.protocol&&(t({...n.toJSON(),client:{id:r},type:"candidate",version:C}),w+=1)})),f=()=>{const e=[at([ge(x,"open"),ge(T,"open")]).pipe(Pe(1)).subscribe((()=>{S=e=>{const t="update"===e.type?x:T;try{t.send(JSON.stringify(e))}catch(e){return u.next(e),!1}return!0},n.next([r,S])})),he(...[x,T].map((e=>["close","closing","error"].map((t=>ge(e,t))))).flat()).subscribe((e=>{let{type:t}=e;return u.next(Error(`RTCDataChannel fired unexpected event of type "${t}".`))}))],t=[()=>e.forEach((e=>e.unsubscribe())),ge(x,"message")((e=>{let{data:t}=e;const i=JSON.parse(t);n.next([r,i])})),ge(T,"message")((e=>{let{data:t,timeStamp:i}=e;const o={...JSON.parse(t),timestamp:null!=i?i:performance.now()};n.next([r,o])}))];return()=>t.forEach((e=>e()))},[d,p]=(v=1,[()=>v**2,()=>{v+=1}]);var v;const y=()=>{const e=he(ge(E,"icecandidate"),ge(E,"icegatheringstatechange")).pipe(lt((()=>ht((()=>"gathering"===E.iceGatheringState),Oe((()=>De(1e4*d()))),ne)))).subscribe((()=>{p(),u.next(Error('RTCPeerConnection seems to be stuck at iceGatheringState "gathering".'))})),t=[()=>e.unsubscribe(),ge(E,"connectionstatechange")((()=>{const e=E.connectionState;["closed","disconnected","failed"].includes(e)&&u.next(Error(`RTCPeerConnection transitioned to unexpected connectionState "${e}".`))})),ge(E,"icecandidateerror")((()=>u.next(Error('RTCPeerConnection fired unexpected event of type "icecandidateerror".')))),ge(E,"iceconnectionstatechange")((()=>{const e=E.iceConnectionState;["closed","disconnected","failed"].includes(e)&&u.next(Error(`RTCPeerConnection transitioned to unexpected iceConnectionState "${e}".`))})),ge(E,"signalingstatechange")((()=>{"closed"===E.signalingState&&u.next(Error('RTCPeerConnection transitioned to unexpected signalingState "closed".'))}))];return()=>t.forEach((e=>e()))},b=t=>{a.next(null),I(),O(),j(),x.close(),T.close(),E.close(),null!==S&&n.next([r,!0]),_=!0,m=0,g=C===t?g:1/0,w=0,E=e(),c.length=C===t?c.length:0,x=E.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),S=null,T=E.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),I=h(),O=f(),j=y(),C=t};let _=!0,m=0,g=1/0,w=0,E=e(),x=E.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),S=null,P=null,T=E.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),I=h(),O=f(),j=y(),C=0;const k=async e=>{m+=e,m===g&&await E.addIceCandidate()},A=e=>e instanceof RTCSessionDescription?e.toJSON():e;return n.next([r,!0]),he(Oe((()=>le(s))),u.pipe(ee((e=>fe((()=>e))))),o.pipe(((e,t,n)=>r=>r.pipe(D((function(e,t){e.subscribe(M(t,(function(e){t.next(yt.createNext(e))}),(function(){t.next(yt.createComplete()),t.complete()}),(function(e){t.next(yt.createError(e)),t.complete()})))})),gt(null),lt((r=>Ee(Ce(r),null===r||"N"===r.kind?n.pipe(function(e,t){return void 0===t&&(t=!1),D((function(n,r){var i=0;n.subscribe(M(r,(function(n){var o=e(n,i++);(o||t)&&r.next(n),!o&&r.complete()})))}))}(t),qe(e),Ie()):ne))),Se(st),D((function(e,t){e.subscribe(M(t,(function(e){return bt(e,t)})))}))))((()=>t({client:{id:r},type:"check"})),(()=>"open"!==x.readyState||"open"!==T.readyState),dt(5e3)),(L=e=>{void 0!==e&&u.complete()},e=>e.lift(new _t(L))))).pipe(ee((e=>(e=>{const{type:n}=e;if("answer"===n&&i){if(C>e.version)return ne;if(C===e.version&&!_)return wt(E.setRemoteDescription(e)).pipe(ee((()=>le(c))),ee((e=>wt(E.addIceCandidate(e)))),ft(),ee((e=>wt(k(e)))))}if("candidate"===n){if(C>e.version)return ne;if(C<e.version&&!i&&b(e.version),C===e.version)return null===E.remoteDescription?(c.push(e),ne):wt(E.addIceCandidate(e)).pipe(ee((()=>wt(k(1)))))}if("error"===n&&i)return C>e.version?ne:(b(e.version+1),l());if("notice"===n&&!i)return ne;if("offer"===n&&!i)return C>e.version?ne:(C<e.version&&b(e.version),_=!1,wt(E.setRemoteDescription(e)).pipe(ee((()=>he(wt(E.setLocalDescription()).pipe(qe((()=>{const{localDescription:e}=E;if(null===e)throw Error("The local description is not set.");t({...A(e),client:{id:r},version:C})}))),le(c).pipe(ee((e=>wt(E.addIceCandidate(e)))),ft(),ee((e=>wt(k(e))))))))));if("request"===n&&i)return 0===C&&_?l():ne;if("summary"===n){if(C>e.version)return ne;if(C<e.version&&!i&&b(e.version),C===e.version)return g=e.numberOfGatheredCandidates,wt(k(0))}return P=Error(`The current event of type "${n}" can't be processed.`),fe((()=>P))})(e).pipe(pt(a)))),vt({delay:e=>{if(e===P)return fe((()=>e));if(s.length=0,_)b(C);else{const e={client:{id:r},type:"error",version:C};i?s.push(e):(b(C+1),t(e))}return Ce(null)}}),pt(Ee(o.pipe(Ie()),Ce(null))),de((()=>{I(),O(),j(),x.close(),T.close(),E.close()}))).subscribe({complete:()=>{n.next([r,!1]),n.complete()},error:e=>n.error(e)});var L}))})));function xt(e,t){return function(n,r){return!e.call(t,n,r)}}const St=/^[\dA-Za-z]{20}$/,Pt="undefined"==typeof window?null:window,Tt=((e,t,n,r,i,o,s)=>class extends n{constructor(e){super();const t=r.now()/1e3;this._clientId="",this._endPosition=1/0,this._error=null,this._hops=[],this._onadjust=null,this._onchange=null,this._onreadystatechange=null,this._origin=Number.MAX_SAFE_INTEGER,this._providerIdOrUrl=e,this._readyState="connecting",this._skew=0,this._startPosition=-1/0,this._subscription=null,this._updateRequestsSubject=new V,this._vector={acceleration:0,position:0,timestamp:t,velocity:0},this._version=0,this._createClient()}get endPosition(){return this._endPosition}get error(){return this._error}get onadjust(){return null===this._onadjust?this._onadjust:this._onadjust[0]}set onadjust(e){if(null!==this._onadjust&&this.removeEventListener("adjust",this._onadjust[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("adjust",t),this._onadjust=[e,t]}else this._onadjust=null}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get skew(){return this._skew}get startPosition(){return this._startPosition}get vector(){return this._vector}destroy(){if(null===this._subscription)throw Error("The timingProvider is already destroyed.");this._readyState="closed",this._subscription.unsubscribe(),this._subscription=null,this._updateRequestsSubject.complete(),i((()=>this.dispatchEvent(new Event("readystatechange"))))}update(e){if(null===this._subscription)return Promise.reject(Error("The timingProvider is destroyed and can't be updated."));const t=s(this._vector,e);return null!==t&&this._updateRequestsSubject.next([{...t,hops:[],version:this._version+1},null]),Promise.resolve()}_createClient(){var n=this;const i=St.test(this._providerIdOrUrl)?"wss://matchmaker.suenc.io?providerId="+this._providerIdOrUrl:this._providerIdOrUrl;this._subscription=he(Ee(le(we()).pipe((e=>e.pipe(Se((e=>!0===e)))),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Se((function(t,n){return e(t,n,r)})):A,Pe(1),n?function(e){return D((function(t,n){var r=!1;t.subscribe(M(n,(function(e){r=!0,n.next(e)}),(function(){r||n.next(e),n.complete()})))}))}(t):(void 0===(i=function(){return new xe})&&(i=Te),D((function(e,t){var n=!1;e.subscribe(M(t,(function(e){n=!0,t.next(e)}),(function(){return n?t.complete():t.error(i())})))}))));var i}}(),Ie()),Oe((()=>{const[n,r]=t(i);return n.pipe((o=e=>"closure"===e.type,s=()=>{this._error=Error("Your plan has exceeded its quota."),this._readyState="closed",this.dispatchEvent(new Event("readystatechange"))},Fe((e=>{const[t,n]=(r=e,[Se(i=o,u)(H(r)),Se(xt(i,u))(H(r))]);var r,i,u;return n.pipe(pt(t.pipe(qe(s))))}))),(u=e=>"init"===e.type,e=>e.pipe(We(((e,t)=>{let[n,r]=e;if(u(t)){if(null===r)throw Error("Another value has been identified as the first value already.");return[[t,...r],null]}return null===r?[[t],r]:[n,[...r,t]]}),[[],[]]),je((e=>{let[t]=e;return le(t)})))),je((e=>{if("array"===e.type)return le(e.events);if("init"===e.type){const{client:{id:t},events:n,origin:r}=e;return this._clientId=t,this._origin=r,0===n.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange"))),le(n)}return Ce(e)})),((e,t)=>n=>new L((r=>{const i=new Map,o=t=>e()<t;return n.pipe((s=()=>{i.forEach((e=>{let[t,n]=e;null===t?n.unsubscribe():t.complete()}))},e=>new L((t=>{const n=e.subscribe({complete:()=>{s(),t.complete()},error:e=>{s(),t.error(e)},next:e=>t.next(e)});return()=>{s(),n.unsubscribe()}})))).subscribe({complete(){r.complete()},error(e){r.error(e)},next(e){var n;const s=e.client.id,[u,c]=null!==(n=i.get(s))&&void 0!==n?n:[null,null];if("termination"===e.type)null!==c&&c.unsubscribe(),null!==u&&u.complete(),i.set(s,[null,t.pipe(it(o(s)?1:0),Pe(1)).subscribe((()=>i.delete(s)))]);else if(null===u&&null===c){const t=new V;i.set(s,[t,null]),r.next([s,o(s),t.asObservable()]),t.next(e)}else null===c&&u.next(e)}});var s})))((()=>this._clientId),De(1e4)),Et(e,r));var o,s,u}))).pipe((e=>Oe((()=>{let t=0;return e.pipe(vt({delay:e=>(t+=1,ht((()=>t<4),De(1e3*t**2),fe((()=>e))))}),qe((()=>t=0)))}))),Me((e=>(this._error=e,this._readyState="closed",this.dispatchEvent(new Event("readystatechange")),ne))),qe((e=>{tt(e)&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),We(((e,t)=>{let[,n]=e;const r=n.findIndex((e=>{let[n]=e;return n===t[0]}));return-1===r?(nt(t)||tt(t))&&n.push(t):!1===t[1]?n.splice(r,1):(nt(t)||tt(t))&&(n[r]=t),[t,n]}),[,[]]),qe((e=>{let[,t]=e;0===t.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),Se((e=>{let[t]=e;return!(tt(t)&&!t[1]({message:this._createExtendedVector([...this._hops,this._origin]),type:"update"}))})),Fe((e=>{const t=new Ge(1);return e.pipe(qe((e=>{let[,n]=e;return t.next(n)})),U((e=>{let[t,n]=e;if(et(t)){const[e,r]=t;if("ping"===r.type)return[e,{...r,reply:He(e,n.filter(tt))}]}return t})),Se(Qe),$e((e=>{let[t]=e;return t}),{duration:t=>e.pipe(U((e=>{let[t]=e;return t})),Se(Ke),Se((e=>{let[n]=e;return n===t.key})))}),ee((e=>{const t=new Ye([0,[]]);return e.pipe(Fe((n=>he(n.pipe(Se(tt),(e=>t=>t.pipe(U((t=>{let[,n]=t;return dt(1e3).pipe(gt(0),U(((e,t)=>(n({index:t,type:"ping"}),r.now()))),ot(e),qe((t=>{let[n,[r,i]]=t;return e.next([r,[...i,n]])})),Ie())})),Ze(ne),lt(A)))(t)),n.pipe(Se(et),U((e=>{let[,t]=e;return t})),$e((e=>e.type)),ee((e=>"ping"===e.key?e.pipe(qe((e=>{let{index:t,timestamp:n,reply:i}=e;return i({index:t,remoteReceivedTime:n,remoteSentTime:r.now(),type:"pong"})})),Ie()):"pong"===e.key?e.pipe((e=>t=>t.pipe(ot(e),U((t=>{let[{index:n,remoteReceivedTime:r,remoteSentTime:i,timestamp:o},[s,u]]=t;if(n<s)return null;const c=n-s,[a,...l]=u.slice(c);return e.next([s+c+1,l]),[a,r,i,o]})),Se(st)))(t),U((e=>{let[t,n,r,i]=e;return[(n+r-t-i)/2,i-t+n-r]})),(e=>e.pipe(We(((e,t)=>[...e.slice(-59),t]),[]),U((e=>e.slice(1).reduce(((e,t)=>e[1]<t[1]?e:t),e[0]))))),U((e=>[1,e]))):e.pipe(U((e=>{let{message:t}=e;return t})),U((e=>this._version>e.version||this._version===e.version&&((0===this._hops.length?this._origin:this._hops[0])<e.hops[0]||e.hops.includes(this._origin))?null:e)),U((e=>[0,e]))))),(e=>e.pipe(We(((e,t)=>{let[n,r]=t;return 0===n?[r,e[1]]:[e[0],r]}),[rt,rt]),Se((e=>e.every((e=>e!==rt)))))),Be(((e,t)=>{let[n,[r,i]]=e,[o,[s,u]]=t;return n===o&&r===s&&i===u})),U((t=>{let[n,[r,i]]=t;return[e.key,null===n?null:{...n,timestamp:n.timestamp-r/1e3},i]})),Ze([e.key,null,null]))))))})),We(((e,t)=>{let[,n]=e;const r=n.findIndex((e=>{let[n]=e;return t[0]===n}));return null===t[2]?r>-1&&n.splice(r,1):r>-1?n[r]=t:(n.push(t),n.sort(((e,t)=>{let[n]=e,[r]=t;return n<r?-1:n>r?1:0}))),[t,n]}),[,[]]),ee((e=>t.pipe(Pe(1),U((t=>[e,t]))))),U((e=>{let[[t],n]=e;return[...t,n]})))}))),this._updateRequestsSubject.pipe(U((e=>{let[t]=e;return[null,t,0,null]})))).pipe(We((function(e,t){let[r,i]=void 0===e?[[[null,n._createExtendedVector(n._hops),0]],[]]:e,[s,u,c,a]=t;const l=null!=a?a:i,h=r.findIndex((e=>e[0]===s));if(null!==u){if(n._version<u.version)return r.length=0,r.push([s,u,c]),[r,l];if(n._version===u.version){const e=0===n._hops.length?n._origin:n._hops[0];if(e>u.hops[0]&&!u.hops.includes(n._origin))return r.length=0,r.push([s,u,c]),[r,l];if(e===u.hops[0]&&!u.hops.includes(n._origin)&&n._hops.length>0)return h>-1?r[h]=[s,u,c]:r.push([s,u,c]),o(r),[r,l]}}return h>-1&&(1===r.length?r[0]=[null,{...r[0][1],hops:[r[0][1].hops[0],...r[0][1].hops.map((()=>n._origin))]},0]:r.splice(h,1)),[r,l]}),void 0),Be(((e,t)=>e===t),(e=>{let[[[,t]]]=e;return t}))).subscribe((e=>{let[[[t,n]],r]=e;const i={...n,hops:[...n.hops,this._origin]};for(const[e,n]of r.filter(tt))if(!n({message:i,type:"update"})&&t===e)return;this._setInternalVector(n)}))}_createExtendedVector(e){return{...this._vector,hops:e,version:this._version}}_setInternalVector(e){let{hops:t,version:n,...r}=e;this._hops=t,this._vector=r,this._version=n,this.dispatchEvent(new CustomEvent("change",{detail:r}))}})((e=>()=>{if(null===e)throw Error("A native EventTarget could not be created.");return new e.RTCPeerConnection({iceCandidatePoolSize:1,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}]})})(Pt),(Ct=e=>new WebSocket(e),e=>{const t=new V,n=Ct(e);return[he(ge(n,"message"),he(he(...["close","error"].map((e=>ge(n,e)))).pipe(U((e=>{let{type:t}=e;return Error(`WebSocket fired unexpected event of type "${t}".`)}))),t).pipe(ee((e=>fe((()=>e)))))).pipe(de((()=>n.close())),U((e=>JSON.parse(e.data)))),e=>{try{n.send(JSON.stringify(e))}catch(e){t.next(e)}}]}),(jt=(e=>()=>{if(null===e)throw Error("A native EventTarget could not be created.");return e.document.createElement("p")})(Pt),class{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=jt()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(r=this,i=t,o=e=>{const t={value:r};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof i?i.call(r,e):i.handleEvent.call(r,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var r,i}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}),performance,setTimeout,(It=e=>{let[,{hops:t}]=e;return t},Ot=e=>{let[,,t]=e;return t},e=>{e.sort(((e,t)=>{const n=((e,t)=>{let[n,...r]=e,[i,...o]=t;if(void 0===n||void 0===i)throw Error("Every vector should have an origin.");if(n===i){const e=r.filter((e=>e===r[0])).length,t=o.filter((e=>e===o[0])).length;if(e===t){if(0===e)throw Error("At least one vector should have a hop if they have the same origin.");if(1===e||r[0]===o[0]){if(r.length===o.length){if(r.every(((e,t)=>e===o[t])))throw Error("Every vector should be unique.");return 0}return r.length-o.length}return r[0]-o[0]}return e-t}return n-i})(It(e),It(t));return 0===n?Ot(e)-Ot(t):n}))}),((e,t,n)=>(r,i)=>{const o=e(i),s=n(r,t.now()/1e3-r.timestamp);for(const[e,t]of Object.entries(o))if(t!==s[e])return{...s,...o};return null})(r.filterTimingStateVectorUpdate,performance,r.translateTimingStateVector));var It,Ot,jt,Ct},822:(e,t,n)=>{n.r(t),n.d(t,{TimingObject:()=>o,filterTimingStateVectorUpdate:()=>r,translateTimingStateVector:()=>i});const r=e=>{if(void 0===e)return{};let t=null!=e.acceleration?{acceleration:e.acceleration}:{};return null!=e.position&&(t={...t,position:e.position}),null!=e.velocity?{...t,velocity:e.velocity}:t},i=(e,t)=>{const{acceleration:n,position:r,timestamp:i,velocity:o}=e;return{acceleration:n,position:r+o*t+.5*n*t**2,timestamp:i+t,velocity:o+n*t}},o=((e,t,n,r,i,o,s,u)=>class extends r{constructor(e,t,n){void 0===e&&(e={}),void 0===t&&(t=-1/0),void 0===n&&(n=1/0),super();const{timingProviderSource:r,vector:u}=void 0===e.update?{timingProviderSource:null,vector:e}:{timingProviderSource:e,vector:{}};if(this._endPosition=null===r?n:r.endPosition,this._onchange=null,this._onerror=null,this._onreadystatechange=null,this._readyState=null===r?"open":r.readyState,this._skew=null===r?0:r.skew,this._startPosition=null===r?t:r.startPosition,this._timingProviderSource=r,this._timeoutId=null,this._vector=null===r?{acceleration:0,position:0,velocity:0,...i(u),timestamp:o.now()/1e3}:r.vector,n<this._vector.position&&(this._vector={...this._vector,acceleration:0,position:n,velocity:0}),t>this._vector.position&&(this._vector={...this._vector,acceleration:0,position:t,velocity:0}),this._setInternalTimeout(),null===r)s((()=>this.dispatchEvent(new Event("readystatechange"))));else{const e=()=>{this._skew=r.skew},t=()=>this._setInternalVector(r.vector),n=()=>{this._isAllowedTransition(r.readyState)?this._readyState=r.readyState:(this._readyState="closed",r.removeEventListener("adjust",e),r.removeEventListener("change",t),r.removeEventListener("readystatechange",n)),null!==r.error&&s((()=>this.dispatchEvent(new ErrorEvent("error",{error:r.error})))),s((()=>this.dispatchEvent(new Event("readystatechange"))))};r.addEventListener("adjust",e),r.addEventListener("change",t),r.addEventListener("readystatechange",n)}}get endPosition(){return this._endPosition}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onerror(){return null===this._onerror?this._onerror:this._onerror[0]}set onerror(e){if(null!==this._onerror&&this.removeEventListener("error",this._onerror[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("error",t),this._onerror=[e,t]}else this._onerror=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get startPosition(){return this._startPosition}get timingProviderSource(){return this._timingProviderSource}query(){if("open"!==this._readyState)throw n();const e=o.now()/1e3,t=u(this._vector,null===this._timingProviderSource?e-this._vector.timestamp:e+this._skew-this._vector.timestamp);return this._endPosition<t.position||this._startPosition>t.position?(this._setInternalVector({...t,acceleration:0,position:this._endPosition<t.position?this._endPosition:this._startPosition,velocity:0}),this.query()):t}update(e){if("open"!==this._readyState)return Promise.reject(n());if(null!==this._timingProviderSource){const t=this._timingProviderSource.update(e);return t instanceof Promise?t:Promise.reject(new TypeError("The timingProviderSource failed to return a promise."))}const t=i(e);if(0===Object.keys(t).length)return Promise.resolve();const r={...this.query(),...t},{position:o,velocity:s,acceleration:u}=r;return o<this._startPosition||o>this._endPosition||o===this._startPosition&&(s<0||0===s&&u<0)||o===this._endPosition&&(s>0||0===s&&u>0)?Promise.reject((()=>{try{return new DOMException("","IllegalValueError")}catch(e){return e.name="IllegalValueError",e}})()):(this._setInternalVector(r),Promise.resolve())}_isAllowedTransition(e){return"closing"===this._readyState&&"closed"===e||"connecting"===this._readyState||"open"===this._readyState&&("closed"===e||"closing"===e)}_setInternalTimeout(){if(null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this._endPosition===1/0&&this._startPosition===-1/0||0===this._vector.acceleration&&0===this._vector.velocity)return;const t=e(this._vector,this._startPosition,this._endPosition);null!==t&&(this._timeoutId=s((()=>this.query()),t))}_setInternalVector(e){this._vector=e,this._setInternalTimeout(),s((()=>this.dispatchEvent(new Event("change"))))}})((c=(e,t)=>{let{acceleration:n,position:r,velocity:i}=e;const o=((e,t,n,r)=>{if(0===n&&0===t)return e!==r?[]:[0];if(0===n)return[(r-e)/t];const i=t/n,o=Math.sqrt(i**2-2/n*(e-r));return[o-i,-(o+i)].filter((e=>!isNaN(e))).sort()})(r,i,n,t);if(0===o.length)return null;if(1===o.length)return o[0]>0?o[0]:null;if(2===o.length){if(o[1]<0)return null;if(o[0]>0)return o[0];if(o[1]>0)return o[1]}return null},u=(e,t,n)=>{const r=c(e,t),i=c(e,n);return null!==r&&null!==i?r<i?r:i:null!==r?r:null!==i?i:null},(e,t,n)=>{const r=u(e,t,n);return null===r||r===1/0?null:r}),0,(()=>{try{return new DOMException("","InvalidStateError")}catch(e){return e.code=11,e.name="InvalidStateError",e}}),(s=(e=>()=>{if(null===e)throw Error("A native EventTarget could not be created.");return e.document.createElement("p")})("undefined"==typeof window?null:window),class{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=s()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(r=this,i=t,o=e=>{const t={value:r};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof i?i.call(r,e):i.handleEvent.call(r,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var r,i}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}),r,performance,setTimeout,i);var s,u,c}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{TimingObject:()=>TimingObject,TimingProvider:()=>TimingProvider});const TimingObject=n(822),TimingProvider=n(69);var i=window;for(var o in r)i[o]=r[o];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();
                </script>
                <style>
                
            body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
            canvas { display: block; margin-bottom: 10px; }
            #controls { margin-bottom: 20px; }
            .canvas-container { margin-bottom: 20px; }
            .span-container {
                display: flex;
                align-items: center;
                gap: 10px;
            }
            .invisible-button {
                background: none;
                border: none;
                cursor: pointer;
                padding: 4px;
            }
            .icon {
                height: 24px;
                transition: opacity 0.1s ease;
            }
            .active {
                opacity: 1;
            }
            .inactive {
                opacity: 0.5;
            }
            #notes-display {
                display: flex;
                flex-direction: row;
                flex-wrap: nowrap;
                gap: 8px;
                overflow-x: auto;
                white-space: nowrap;
                max-width: 70vw;
            }
            .note-pill {
                background-color: #f0f0f0;
                border-radius: 12px;
                padding: 4px 8px;
                font-size: 12px;
            }

                </style>
            </head>
            <body>
                <div id="controls">
                    <button onclick="stopCode()">Restart</button>
                    <p>BPM: <span id="bpmValue">120</span></p>
                    
                    <input 
                        type="range" 
                        id="bpmSlider" 
                        min="10" 
                        max="300" 
                        value="120"
                        oninput="updateBPM(this.value)"
                    >
                    
                    <input 
                        type="number" 
                        id="bpmInput" 
                        min="10" 
                        max="300" 
                        value="120"
                        oninput="updateBPM(this.value)"
                    >

                    <div class="span-container" id="keyboard-container">
                        <button class="invisible-button" id="keyboard-button">
                            <img class="icon inactive" id="keyboard-icon" src="https://n54omxuiol.ufs.sh/f/K0nF6SKQt5rdQI0fYSZ76iwjnab1uNgOfU42I3KsEv8Yh9Cr" alt="Keyboard" />
                        </button>
                        <div id="notes-display"></div>
                    </div>
                    <input type="checkbox" id="timing-object-toggle">
                    <label for="timing-object-toggle" id="timing-toggle-label">Use Timing Object</label>
                </div>

                <!-- Canvas container -->
                <div class="canvas-container" id="Canvas"></div>

                <div id="volumeWarning" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 1000;">
                    <div style="background: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h2>⚠️ Volume Warning</h2>
                        <p>This page contains audio content. Please ensure your volume is at a comfortable level.</p>
                        <button onclick="acknowledgeWarning()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">I understand</button>
                    </div>
                </div>

                <script>
                    // Synth class definitions and dependencies
                    (()=>{var __webpack_modules__={138:t=>{"use strict";t.exports=JSON.parse('{"default":{"type":"square","cutoff":275.48799999999994,"Q":0,"keyTrack":0,"envDepth":1457.5999999999976,"level":0,"adsr":[0.02506944444444445,0.39062500000000155,0.08027777777777759,0.2669444444444446]},"chirp":{"type":"saw","cutoff":380.278,"Q":10.44300000000001,"keyTrack":0,"envDepth":2557.399999999998,"level":0,"adsr":[0.01000000000000004,0.3500694444444451,0.08999999999999969,0.21777777777777863]},"pluck":{"type":"square","cutoff":343.35200000000003,"Q":11.532000000000012,"keyTrack":0,"envDepth":1306.3999999999974,"level":0,"adsr":[0.01,0.4,0.5,0.8]},"flute":{"type":"tri","cutoff":20,"Q":0,"keyTrack":0,"envDepth":2197.4000000000037,"level":0,"adsr":[0.8402777777777787,1,1,1]},"drone":{"type":"saw","cutoff":435.3276799999999,"Q":14.700000000000012,"keyTrack":0,"envDepth":8.600000000001046,"level":0.5041000000000002,"adsr":[0.8402777777777787,1,1,1]}}')},182:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.DatoDuo=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(9710),c=r(s(640)),l=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class DatoDuo extends l.MonophonicTemplate{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.gui=t,this.presets=c.default,this.isGlide=!1,this.name="DatoDuo",this.frequency=new o.Signal,this.tonePitchShift=new o.Multiply,this.sawPitchShift=new o.Multiply,this.pulseWav=(new o.PulseOscillator).start(),this.sawWav=new o.Oscillator({type:"sawtooth"}).start(),this.toneMixer=new o.Multiply,this.sawMixer=new o.Multiply,this.cutoff=new o.Signal,this.vcf_env=new o.Envelope,this.filterDepth=new o.Multiply,this.filterMultiplier=new o.Multiply,this.filter=new o.Filter,this.velocity=new o.Signal(1),this.velocityMult=new o.Multiply(1),this.env=new o.Envelope,this.amp=new o.Multiply,this.output=new o.Multiply(.05).toDestination(),this.frequency.connect(this.tonePitchShift),this.tonePitchShift.connect(this.pulseWav.frequency),this.frequency.connect(this.sawPitchShift),this.sawPitchShift.connect(this.sawWav.frequency),this.rampTime=.004,this.frequency.value=500,this.tonePitchShift.factor.value=1,this.sawPitchShift.factor.value=1,this.pulseWav.connect(this.toneMixer),this.toneMixer.connect(this.filter),this.sawWav.connect(this.sawMixer),this.sawMixer.connect(this.filter),this.toneMixer.factor.value=.25,this.sawMixer.factor.value=.25,this.vcf_env.connect(this.filterDepth),this.cutoff.connect(this.filter.frequency),this.filterDepth.connect(this.filter.frequency),this.cutoff.value=1500,this.filterDepth.factor.value=5e3,this.vcf_env.attack=.02,this.vcf_env.decay=.01,this.vcf_env.sustain=0,this.vcf_env.release=.2,this.filter.rolloff=-24,this.filter.Q.value=1,this.filter.connect(this.amp),this.velocity.connect(this.velocityMult.factor),this.env.connect(this.velocityMult),this.velocityMult.connect(this.amp.factor),this.env.attack=.01,this.env.delay=.1,this.env.sustain=0,this.env.release=.9,this.env.releaseCurve="cosine",this.dist=new o.Distortion(.9),this.crusher=new o.BitCrusher(2),this.delay=new o.FeedbackDelay,this.distgain=new o.Multiply(1),this.crushgain=new o.Multiply(1),this.delaygain=new o.Multiply(1),this.delayFilter=new o.Filter,this.lfo=new o.LFO("8n",400,2e3),this.amp.connect(this.dist),this.dist.connect(this.distgain),this.distgain.connect(this.crusher),this.crusher.connect(this.output),this.crusher.connect(this.delaygain),this.delaygain.connect(this.delay),this.delay.connect(this.delayFilter),this.lfo.connect(this.delayFilter.frequency),this.delayFilter.connect(this.output),this.kick="audio/drums-003.mp3",this.snare="audio/snare.mp3",this.kickPlayer=new o.Sampler({urls:{C4:"drums-003.mp3"},baseUrl:"/m080/audio/"}).toDestination(),this.snarePlayer=new o.Sampler({urls:{C4:"snare.mp3"},baseUrl:"/m080/audio/"}).toDestination(),this.kickPlayer.volume.value=-12,this.snarePlayer.volume.value=-18}triggerAttack(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n=Math.pow(n/127,2),t=o.Midi(t).toFrequency(),s?(this.env.triggerAttack(s),this.vcf_env.triggerAttack(s),this.isGlide?this.frequency.linearRampToValueAtTime(t,this.rampTime+s):this.frequency.setValueAtTime(t,s),this.velocity.rampTo(n,.03)):(this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.frequency.value=t,this.velocity.rampTo(n,.03))}triggerRelease(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?(this.env.triggerRelease(t),this.vcf_env.triggerRelease(t)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())}triggerAttackRelease(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;n=Math.pow(n/127,2),t=o.Midi(t).toFrequency(),r?(this.env.triggerAttackRelease(s,r),this.vcf_env.triggerAttackRelease(s,r),this.velocity.setValueAtTime(n,r),this.isGlide?this.frequency.linearRampToValueAtTime(t,this.rampTime+r):this.frequency.setValueAtTime(t,r)):(this.env.triggerAttackRelease(s),this.vcf_env.triggerAttackRelease(s),this.isGlide?this.frequency.exponentialRamp(t,this.rampTime):this.frequency.value=t,this.velocity.rampTo(n,.03))}setADSR(t,n,s,r){this.env.attack=t>.001?t:.001,this.env.decay=n>.01?n:.01,this.env.sustain=Math.abs(s)<1?s:1,this.env.release=r>.01?r:.01}setFilterADSR(t,n,s,r){this.vcf_env.attack=t>.001?t:.001,this.vcf_env.decay=n>.01?n:.01,this.vcf_env.sustain=Math.abs(s)<1?s:1,this.vcf_env.release=r>.01?r:.01}setDetune(t){this.sawPitchShift.factor.value=t}setPulsewidth(t){this.pulseWav.width=t}setOutputGain(t){this.output.factor.value=t}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;this.gui=t,this.distortion_toggle=this.gui.Knob({label:"Distortion",callback:t=>{this.dist.distortion=t,this.distgain.factor.value=1-.4*t},x:85,y:20,size:.8,min:0,max:.9,link:"dist"}),this.distortion_toggle.accentColor=[51,145,219],this.dist.wet.value=1,this.crusher_toggle=this.gui.Knob({label:"bitcrusher",callback:t=>{this.crusher.bits.value=Math.floor(t)},x:90,y:50,size:.8,min:2,max:16,link:"crusher"}),this.crusher_toggle.accentColor=[46,152,99],this.crusher.wet.value=1,this.glide_toggle=this.gui.Momentary({label:"Glide",callback:t=>{this.isGlide=t},x:15,y:20,size:.8,link:"glide"}),this.glide_toggle.accentColor=[51,145,219],this.delayControl=function(t){this.delay.feedback.value=(0,a.stepper)(t,0,1,[[0,0],[.02,0],[.8,.6],[1,1]]),this.delay.wet.value=(0,a.stepper)(t,0,1,[[0,0],[.02,0],[.04,1],[1,1]]),this.delaygain.factor.value=(0,a.stepper)(t,0,1,[[0,0],[.02,0],[.04,.3],[.4,.5],[1,1]]),this.lfo.amplitude.value=(0,a.stepper)(t,0,1,[[0,0],[.5,0],[.7,.5],[1,1]])},this.delay_knob=this.gui.Knob({label:"Delay Control",callback:t=>{this.delayControl(t)},x:10,y:50,size:.8,min:.001,max:1,curve:1,showValue:!1,link:"delayknob"}),this.delay_knob.accentColor=[49,48,55],this.delay_knob.set(1e-4),this.wave_fader=this.gui.Slider({label:"wave",x:39,y:10,size:2,min:0,max:1,callback:t=>{this.pulseWav.width.value=(0,a.stepper)(t,0,1,[[0,0],[.4,.6],[1,1]])},orientation:"vertical",showValue:!1,link:"wave",border:12}),this.wave_fader.accentColor=[247,5,5],this.wave_fader.borderColor=[20,20,20],this.wave_fader.set(.5),this.freq_fader=this.gui.Slider({label:"freq",callback:t=>{this.filterDepth.factor.value=t,this.cutoff.value=t},x:49,y:10,size:2,min:50,max:2500,curve:2,orientation:"vertical",showValue:!1,link:"freq",border:12}),this.freq_fader.accentColor=[247,5,5],this.freq_fader.borderColor=[20,20,20],this.freq_fader.set(700),this.release_fader=this.gui.Slider({label:"release",callback:t=>{this.env.decay=(0,a.stepper)(t,.1,5,[[0,0],[.8,.5],[1,5]]),this.env.release=(0,a.stepper)(t,.1,30,[[0,0],[.8,.5],[1,5]]),this.vcf_env.decay=(0,a.stepper)(t,.1,5,[[0,0],[.8,.5],[1,5]]),this.vcf_env.release=(0,a.stepper)(t,.1,30,[[0,0],[.8,.5],[1,5]])},x:59,y:10,size:2,min:.1,max:1.5,orientation:"vertical",showValue:!1,link:"release",border:12}),this.release_fader.accentColor=[247,5,5],this.release_fader.borderColor=[20,20,20],this.release_fader.set(.8),this.resonance_knob=this.gui.Knob({label:"res",callback:t=>{this.filter.Q.value=t},x:49.5,y:86,size:.5,min:.99999,max:30,curve:2,showValue:!1,link:"res"}),this.resonance_knob.accentColor=[49,48,55],this.resonance_knob.set(1),this.detune_knob=this.gui.Knob({label:"detune",callback:t=>{this.sawPitchShift.factor.value=(0,a.stepper)(t,.99999,2,[[0,0],[.25,.02],[.45,.49],[.55,.51],[.75,.98],[1,1]])/2},x:22,y:50,size:.5,min:.99999,max:2,curve:1,showValue:!1,link:"detune"}),this.detune_knob.accentColor=[49,48,55],this.detune_knob.set(1),this.speaker_knob=this.gui.Knob({label:"gain",callback:t=>{this.output.factor.value=t},x:78,y:50,size:.5,min:0,max:.1,curve:2,showValue:!1,link:"gain"}),this.speaker_knob.accentColor=[49,48,55],this.speaker_knob.set(.05),this.kick_trigger=this.gui.Button({label:"kick",callback:()=>{this.kickPlayer.triggerAttack("C4")},size:1,border:20,x:30,y:80,size:1,link:"kick"}),this.kick_trigger.accentColor=[20,20,20],this.snare_trigger=this.gui.Button({label:"snare",callback:()=>{this.snarePlayer.triggerAttack("C4")},size:1,border:20,x:70,y:80,size:1,link:"snare"}),this.snare_trigger.accentColor=[20,20,20],this.gui_elements=[this.distortion_toggle,this.crusher_toggle,this.glide_toggle,this.delay_knob,this.wave_fader,this.freq_fader,this.release_fader,this.resonance_knob,this.detune_knob,this.speaker_knob,this.kick_trigger,this.snare_trigger]}initPolyGui(t,n){this.gui=n,this.super=t,this.distortion_toggle=this.gui.Toggle({label:"Accent",callback:t=>{this.super.set("dist.wet",t)},x:85,y:20,size:.8,link:"dist"}),this.distortion_toggle.accentColor=[51,145,219],this.super.set("dist.wet.value",0),this.crusher_toggle=this.gui.Toggle({label:"bitcrusher",callback:t=>{this.super.set("crusher.wet",t)},x:90,y:50,size:.8,link:"crusher"}),this.crusher_toggle.accentColor=[46,152,99],this.super.set("crusher.wet.value",0),this.glide_toggle=this.gui.Toggle({label:"Glide",callback:t=>{this.super.set("isGlide",t)},x:15,y:20,size:.8,link:"glide"}),this.glide_toggle.accentColor=[51,145,219],this.delayControl=function(t){this.super.set("delay.feedback.value",(0,a.stepper)(t,0,1,[[0,0],[.02,0],[.8,.6],[1,1]])),this.super.set("delay.wet.value",(0,a.stepper)(t,0,1,[[0,0],[.02,0],[.04,1],[1,1]])),this.super.set("delaygain.factor.value",(0,a.stepper)(t,0,1,[[0,0],[.02,0],[.04,.3],[.4,.5],[1,1]])),this.super.set("lfo.amplitude.value",(0,a.stepper)(t,0,1,[[0,0],[.5,0],[.7,.5],[1,1]]))},this.delay_knob=this.gui.Knob({label:"Delay Control",callback:t=>{this.delayControl(t)},x:10,y:50,size:.8,min:.001,max:1,curve:1,showValue:!1,link:"delayknob"}),this.delay_knob.accentColor=[49,48,55],this.delay_knob.set(1e-4),this.wave_fader=this.gui.Slider({label:"wave",x:39,y:10,size:2,min:0,max:1,callback:t=>{this.super.set("pulseWav.width.value",(0,a.stepper)(t,0,1,[[0,0],[.4,.6],[1,1]]))},orientation:"vertical",showValue:!1,link:"wave",border:12}),this.wave_fader.accentColor=[247,5,5],this.wave_fader.borderColor=[20,20,20],this.wave_fader.set(.5),this.freq_fader=this.gui.Slider({label:"freq",callback:t=>{this.super.set("filterDepth.factor.value",t),this.super.set("cutoff.value",t)},mapto:this.cutoff,x:49,y:10,size:2,min:50,max:2500,curve:2,orientation:"vertical",showValue:!1,link:"freq",border:12}),this.freq_fader.accentColor=[247,5,5],this.freq_fader.borderColor=[20,20,20],this.freq_fader.set(700),this.release_fader=this.gui.Slider({label:"release",callback:t=>{this.super.set("env.decay",(0,a.stepper)(t,.01,1,[[0,0],[.8,.5],[1,5]])),this.super.set("env.release",(0,a.stepper)(t,.1,25,[[0,0],[.8,.5],[1,5]])),this.super.set("vcf_env.decay",(0,a.stepper)(t,.01,1,[[0,0],[.8,.5],[1,5]])),this.super.set("vcf_env.release",(0,a.stepper)(t,.1,25,[[0,0],[.8,.5],[1,5]]))},x:59,y:10,size:2,min:.1,max:25,orientation:"vertical",showValue:!1,link:"release",border:12}),this.release_fader.accentColor=[247,5,5],this.release_fader.borderColor=[20,20,20],this.release_fader.set(.8),this.resonance_knob=this.gui.Knob({label:"res",callback:t=>{this.super.set("filter.Q.value",t)},x:49.5,y:86,size:.25,min:.99999,max:30,curve:2,showValue:!1,link:"res"}),this.resonance_knob.accentColor=[49,48,55],this.resonance_knob.set(1),this.detune_knob=this.gui.Knob({label:"detune",callback:t=>{this.super.set("tonePitchShift.factor",(0,a.stepper)(t,.99999,2,[[0,0],[.25,.02],[.45,.49],[.55,.51],[.75,.98],[1,1]])),console.log((0,a.stepper)(t,.99999,2,[[0,0],[.25,.02],[.45,.49],[.55,.51],[.75,.98],[1,1]]))},x:22,y:50,size:.25,min:.99999,max:2,curve:1,showValue:!1,link:"detune"}),this.detune_knob.accentColor=[49,48,55],this.detune_knob.set(1),this.speaker_knob=this.gui.Knob({label:"gain",callback:t=>{this.super.set("output.factor",t)},x:78,y:50,size:.25,min:0,max:.1,curve:2,showValue:!1,link:"gain"}),this.speaker_knob.accentColor=[49,48,55],this.speaker_knob.set(.05),this.kick_trigger=this.gui.Button({label:"kick",callback:()=>{this.kickPlayer.triggerAttack("C4")},size:1,border:20,x:30,y:80,size:1,link:"kick"}),this.kick_trigger.accentColor=[20,20,20],this.snare_trigger=this.gui.Button({label:"snare",callback:()=>{this.snarePlayer.triggerAttack("C4")},size:1,border:20,x:70,y:80,size:1,link:"snare"}),this.snare_trigger.accentColor=[20,20,20]}}n.DatoDuo=DatoDuo},375:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.MultiVCO=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.MultiVCO=class MultiVCO{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(this.numInputs=t.length,this.frequency=new o.Signal(1),this.output=0===this.numInputs?new o.Multiply(1):new o.Multiply(1/this.numInputs),this.freqScalars=[],this.gainStages=[],this.vco=[],this.i=0;this.i<this.numInputs;this.i++)this.freqScalars.push(new o.Multiply(n[this.i])),"noise"===t[this.i]?this.vco.push(new o.Noise("white").start()):this.vco.push(new o.Oscillator({type:t[this.i]}).start()),this.gainStages.push(new o.Multiply(1)),this.frequency.connect(this.freqScalars[this.i]),"noise"!==t[this.i]&&this.freqScalars[this.i].connect(this.vco[this.i].frequency),this.vco[this.i].connect(this.gainStages[this.i]),this.gainStages[this.i].connect(this.output)}addVoice=t=>{this.freqScalars.push(new o.Multiply(1)),"noise"===t?this.vco.push(new o.Noise("white").start()):this.vco.push(new o.Oscillator({type:t}).start()),this.gainStages.push(new o.Multiply(1)),this.frequency.connect(this.freqScalars[this.numInputs]),"noise"!==t&&this.freqScalars[this.numInputs].connect(this.vco[this.numInputs].frequency),this.vco[this.numInputs].connect(this.gainStages[this.numInputs]),this.gainStages[this.numInputs].connect(this.output),this.numInputs++,this.output.factor.value=1/this.numInputs};removeVoice=(()=>{var t=this;return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t.vco[n].stop(),t.frequency.disconnect(t.freqScalars[n]),"noise"!==t.vco[n].type&&t.freqScalars[n].disconnect(t.vco[n].frequency),t.vco[n].disconnect(t.gainStages[n]),t.gainStages[n].disconnect(t.output),n<t.numInputs-1)for(let s=n;s<t.numInputs;s++)t.freqScalars[s]=t.freqScalars[s+1],t.gainStages[s]=t.gainStages[s+1],t.vco[s]=t.vco[s+1];t.freqScalars.pop(),t.gainStages.pop(),t.vco.pop(),t.numInputs--,t.output.factor.value=0===t.numInputs?1:1/t.numInputs}})();setPitchshift=(t,n)=>{t>=this.numInputs||t<0?console.log("Index out of range"):this.freqScalars[t].factor.value=n};setGain=(t,n)=>{t>=this.numInputs||t<0?console.log("Index out of range"):this.gainStages[t].factor.value=n};connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}disconnect(t){t.input?this.output.disconnect(t.input):this.output.disconnect(t)}}},394:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.DrumSynth=void 0;var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=(s(3447),r(s(2589))),c=s(9672);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class DrumSynth extends c.DrumTemplate{constructor(){var t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),t=this,this.params={toneFrequency:50,pitchEnv:100,amRatio:1,toneGain:.5,noiseShape:"bandpass",noiseLevel:.5,toneLevel:.5,toneDecay:.2,noiseDecay:.3,cutoff:2e3,resonance:1,volume:.5,...n},this.frequency=new o.Signal(this.params.toneFrequency),this.harmonicity=new o.Multiply(1),this.frequency.connect(this.harmonicity),this.vco=new o.Oscillator(this.params.toneFrequency,"sine").start(),this.frequency.connect(this.vco.frequency),this.modVco=new o.Oscillator(this.params.toneFrequency*this.params.amRatio,"sine").start(),this.harmonicity.connect(this.modVco.frequency),this.amDepth=new o.Gain(0),this.fmDepth=new o.Gain(0),this.modVco.connect(this.amDepth),this.modVco.connect(this.fmDepth),this.modIndex=new o.Signal,this.indexMult=new o.Multiply,this.modIndex.connect(this.indexMult.factor),this.harmonicity.connect(this.indexMult),this.vcoCarrier=new o.Signal(1),this.vcoCarrier.connect(this.vco.volume),this.amDepth.connect(this.vco.volume),this.indexMult.connect(this.fmDepth.gain),this.fmDepth.connect(this.vco.frequency),this.drive=new o.Gain(this.params.toneGain),this.waveshaper=new o.WaveShaper((t=>Math.sin(t*Math.PI))),this.vco.connect(this.drive),this.drive.connect(this.waveshaper),this.noise=new o.Noise("white").start(),this.noiseFilter=new o.Filter(this.params.cutoff,this.params.noiseShape),this.noiseFilter.type="bandpass",this.noiseGain=new o.Gain(this.params.noiseLevel),this.noise.connect(this.noiseFilter),this.noiseFilter.connect(this.noiseGain),this.noiseVcfEnvDepth=new o.Multiply,this.noiseVcfEnvDepth.connect(this.noiseFilter.frequency),this.env=new o.Envelope({attack:0,decay:this.params.toneDecay,sustain:0,release:this.params.toneDecay}),this.noiseEnv=new o.Envelope({attack:0,decay:this.params.noiseDecay,sustain:0,release:this.params.noiseDecay}),this.pitchEnvelope=new o.Envelope({attack:0,decay:this.params.toneDecay,sustain:0,release:this.params.toneDecay}),this.pitchEnvDepth=new o.Multiply(this.params.pitchEnv),this.pitchEnvelope.connect(this.pitchEnvDepth),this.pitchEnvDepth.connect(this.vco.frequency),this.pitchEnvDepth.connect(this.harmonicity),this.pitchEnvelope.releaseCurve="linear",this.pitchEnvelope.decayCurve="linear",this.toneVca=new o.Multiply,this.env.connect(this.toneVca.factor),this.waveshaper.connect(this.toneVca),this.noiseVca=new o.Multiply,this.noiseEnv.connect(this.noiseVca.factor),this.noiseGain.connect(this.noiseVca),this.noiseCutoff=new o.Signal(2e3),this.noiseCutoff.connect(this.noiseFilter.frequency),this.noiseEnv.connect(this.noiseVcfEnvDepth),this.finalFilter=new o.Filter,this.cutoffSig=new o.Signal(this.params.cutoff),this.cutoffSig.connect(this.finalFilter.frequency),this.finalFilter.type="lowpass",this.finalFilter.Q.value=this.params.resonance,this.output=new o.Multiply(this.params.volume),this.toneVca.connect(this.finalFilter),this.noiseVca.connect(this.finalFilter),this.finalFilter.connect(this.output),this.vcfEnvDepth=new o.Multiply,this.vcfEnvDepth.connect(this.finalFilter.frequency),this.env.connect(this.vcfEnvDepth);let s=[{name:"type",type:"vco",value:"square",radioOptions:["square","saw","tri","sine"],callback:function(n){switch(n){case"square":t.vco.type="square";break;case"saw":t.vco.type="sawtooth";break;case"tri":t.vco.type="triangle";break;case"sine":t.vco.type="sine"}}},{name:"drive2",type:"vco",min:0,max:2,curve:2,callback:function(n){return t.drive.gain.value=n}},{name:"fm",type:"vcf",min:0,max:10,curve:2,callback:function(n){return t.modIndex.value=n}},{name:"am",type:"vcf",min:0,max:2,curve:2,callback:function(n){return t.amDepth.gain.value=n}},{name:"harm",type:"vcf",min:1,max:20,curve:1,callback:function(n){return t.harmonicity.factor.value=n}},{name:"cutoff",type:"vcf",min:50,max:1e4,curve:2,callback:function(n){return t.cutoffSig.value=n}},{name:"Q",type:"vcf",min:0,max:20,curve:.7,callback:function(n){return t.finalFilter.Q.value=n}},{name:"noiseG",type:"vca",min:0,max:1.5,curve:2,callback:function(n){return t.noiseGain.gain.value=n}},{name:"toneG",type:"vca",min:0,max:1.5,curve:2,callback:function(n){return t.drive.gain.value=n}},{name:"vol",type:"vca",min:0,max:2,curve:2,callback:function(n){return t.output.factor.value=n}},{name:"drop",type:"vco",min:0,max:5e3,curve:2,callback:function(n){return t.pitchEnvDepth.factor.value=n}},{name:"decay",type:"env",min:0,max:5,curve:2,callback:function(n){t.env.decay=n,t.env.release=n}},{name:"pDecay",type:"env",min:0,max:1,curve:2,callback:function(n){t.pitchEnvelope.decay=n,t.pitchEnvelope.release=n}},{name:"nDecay",type:"env",min:0,max:5,curve:2,callback:function(n){t.noiseEnv.decay=n,t.noiseEnv.release=n}},{name:"nFreq",type:"vcf",min:100,max:1e4,curve:2,callback:function(n){t.noiseCutoff.value=n}},{name:"nEnv",type:"env",min:0,max:5e3,curve:3,callback:function(n){return t.noiseVcfEnvDepth.factor.value=n}},{name:"vcfEnv",type:"vcf",min:0,max:5e3,curve:3,callback:function(n){return t.vcfEnvDepth.factor.value=n}}];this.param=this.generateParameters(s),this.createAccessors(this,this.param),this.autocompleteList=s.map((t=>t.name)),setTimeout((()=>{this.loadPreset("default")}),500)}setADSR(t,n,s){let r=this.env;"tone"==t?r=this.env:"noise"==t?r=this.noiseEnv:"pitch"==t?r=this.pitchEnvelope:null==n&&(r=this.env,n=t),Array.isArray(n)&&null==s?n.length<=4&&(r.attack=n[0],r.decay=n[1],r.sustain=n[2],r.release=n[3]):null!=s&&(0==s&&(r.attack=n),1==s&&(r.decay=n),2==s&&(r.sustain=n),3==s&&(r.release=n))}trigger(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.now();this.env.triggerAttackRelease(.05,t),this.noiseEnv.triggerAttackRelease(.05,t),this.pitchEnvelope.triggerAttackRelease(.05,t)}triggerAttackRelease(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:48,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;n/=127,s&&(this.frequency.setValueAtTime(o.Midi(t).toFrequency(),s),this.env.triggerAttackRelease(.01,s),this.noiseEnv.triggerAttackRelease(.01,s),this.pitchEnvelope.triggerAttackRelease(.01,s))}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=t;const n=a.default.layout,s={};Object.values(this.param).forEach((t=>{s[t.type]||(s[t.type]=[]),s[t.type].push(t)})),Object.keys(s).forEach((t=>{const r=n[t];if(!r)return;if("hidden"===t)return;let o=0;s[t].forEach(((t,n)=>{const s=r.groupA.includes(t.name),a=s?r.controlTypeA:r.controlTypeB,c=s?r.sizeA:r.sizeB;let l=0,h=0;if(Array.isArray(t._value))t._value.forEach(((s,u)=>{l=r.offsets.x*((n+o)%Math.floor(r.boundingBox.width/r.offsets.x)),h=r.offsets.y*Math.floor((n+o)/Math.floor(r.boundingBox.width/r.offsets.x));const d=r.boundingBox.x+l,f=r.boundingBox.y+h;this.createGuiElement(t,{x:d,y:f,size:c,controlType:a,color:r.color,i:u}),o++}));else{l=r.offsets.x*((n+o)%Math.floor(r.boundingBox.width/r.offsets.x)),h=r.offsets.y*Math.floor((n+o)/Math.floor(r.boundingBox.width/r.offsets.x));const s=r.boundingBox.x+l,u=r.boundingBox.y+h;this.createGuiElement(t,{x:s,y:u,size:c,controlType:a,color:r.color})}}))}))}createGuiElement(t,n){let{x:s,y:r,size:o,controlType:a,color:c,i:l=null}=n;if("knob"===a)t.guiElements.push(this.gui.Knob({label:l?t.labels[l]:t.name,min:t.min,max:t.max,value:t._value,size:o,curve:t.curve,x:s,y:r,accentColor:c,callback:n=>t.set(n,l,!0)}));else if("fader"===a)t.guiElements.push(this.gui.Fader({label:l?t.labels[l]:t.name,min:t.min,max:t.max,curve:t.curve,size:t.size,x:s,y:r,accentColor:c,callback:n=>t.set(n,l,!0)}));else if("radioButton"===a)return Array.isArray(t.radioOptions)&&0!==t.radioOptions.length?this.gui.RadioButton({label:l?t.labels[l]:t.name,radioOptions:t.radioOptions,x:s,y:r+10,size:.5,accentColor:c,callback:n=>t.set(n)}):(console.warn(`Parameter "${t.name}" has no options defined for radioBox.`),null)}}n.DrumSynth=DrumSynth},506:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__(4994);Object.defineProperty(exports,"__esModule",{value:!0}),exports.Polyphony=void 0;var _p=_interopRequireDefault(__webpack_require__(5897)),Tone=_interopRequireWildcard(__webpack_require__(5726)),_MonophonicTemplate=__webpack_require__(1174),_Utilities=__webpack_require__(9710);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}class Polyphony extends _MonophonicTemplate.MonophonicTemplate{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.gui=s,this.name=t.name,this.numVoices=n,this.slop=.05,this.voice=[];for(let n=0;n<this.numVoices;n++)this.voice.push(new t);this.output=new Tone.Multiply(1/this.numVoices),this.hpf=new Tone.Filter({type:"highpass",rolloff:-12,Q:0,cutoff:50});for(let t=0;t<this.numVoices;t++)this.voice[t].output.connect(this.hpf);this.hpf.connect(this.output),this.prevNote=0,this.v=0,this.voiceCounter=0,this.activeNotes=[],this.noteOrder=[],this.noteOrderIndex=0,this.voiceOrder=[];for(let t=0;t<this.numVoices;t++)this.activeNotes.push(-1),this.noteOrder.push(t)}triggerAttack=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.v=this.getNewVoice(t),s?this.voice[this.v].triggerAttack(t,n,s):this.voice[this.v].triggerAttack(t,n)};triggerRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.v=this.getActiveNote(t),this.v>=0&&null!=this.v?(n?this.voice[this.v].triggerRelease(n):this.voice[this.v].triggerRelease(),this.freeActiveNote(t)):console.log("tr null",t,n,this.activeNotes[t],this.v,this.voice[this.v])};triggerAttackRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.v=this.getNewVoice(t),r?this.voice[this.v].triggerAttackRelease(t,n,s,r):this.voice[this.v].triggerAttackRelease(t,n,s)};getNewVoice(t){this.voiceCounter=(this.voiceCounter+1)%this.numVoices;const n=this.getActiveNote(t);n>=0&&this.freeActiveNote(n);let s=Infinity,r=this.getLeastRecentNotes(),o=r[0];for(let n=0;n<this.numVoices/2;n++){const a=this.noteOrder[n],c=this.voice[a].env.value;if(c<s&&r.includes(a)&&(s=c,o=a),c<=.01)return this.setActiveNote(a,t),a}return this.voice[o].env.cancel(),this.setActiveNote(o,t),o}getActiveNote(t){return this.activeNotes.includes(t)?this.activeNotes.indexOf(t):-1}setActiveNote(t,n){this.activeNotes.includes(n)||(this.activeNotes[t]=n);const s=this.noteOrder.indexOf(t);-1!==s&&this.noteOrder.splice(s,1),this.noteOrder.push(t)}getLeastRecentNotes(){return this.noteOrder.slice(0,this.numVoices/2)}freeActiveNote(t){void 0!==this.voice[t]&&t>=0&&(this.voice[t].triggerRelease(),this.activeNotes[t]=-1)}setADSR(t,n,s,r){for(let o=0;o<this.numVoices;o++)this.voice[o].env&&(this.voice[o].env.attack=t>.001?t:.001,this.voice[o].env.decay=n>.01?n:.01,this.voice[o].env.sustain=Math.abs(s)<1?s:1,this.voice[o].env.release=r>.01?r:.01)}setFilterADSR(t,n,s,r){for(let o=0;o<this.numVoices;o++)this.voice[o].vcf_env&&(this.voice[o].vcf_env.attack=t>.001?t:.001,this.voice[o].vcf_env.decay=n>.01?n:.01,this.voice[o].vcf_env.sustain=Math.abs(s)<1?s:1,this.voice[o].vcf_env.release=r>.01?r:.01)}initGui(selfRef,gui){this.voice[0].super=selfRef,this.voice[0].initGui(gui);const elements=this.voice[0].gui_elements,modifyValueExpression=t=>t?t.replace(/\bx\b/g,"e"):null;function stringIsFunction(t){return arguments.length>1&&void 0!==arguments[1]||window,/\(.*\)/.test(t)}function getFunctionDetails(t){(t=t.trim().replace(/^.*=>\s*/,"")).startsWith("{")&&t.endsWith("}")&&(t=t.slice(1,-1).trim());const n=t.match(/([a-zA-Z_$][0-9a-zA-Z_$]*)\s*\((.*)\)/);return n?{functionName:n[1],argsString:n[2]}:null}const createCallback=(param,val,element)=>{const modifiedVal=modifyValueExpression(val);let voiceTarget=this.voice[0],keys=param.split(".");const lastKey=keys[keys.length-1];if(val){for(let t=0;t<keys.length-1;t++){if(void 0===voiceTarget[keys[t]])return void console.log("Voice target undefined");voiceTarget=voiceTarget[keys[t]]}if(stringIsFunction(modifiedVal,this)){const t=modifiedVal.replace(/^this\./,"").replace(/\(.*\)$/,"");let n=this.voice[0][t];return console.log("value is function",n,param,t),n=>{for(let s=0;s<this.numVoices;s++){let r=this.voice[s][t];voiceTarget=this.voice[s];for(let t=0;t<keys.length-1;t++)voiceTarget=voiceTarget[keys[t]];voiceTarget[lastKey]=r(n)}}}return e=>{this.set(param,eval(e))}}{const t=modifyValueExpression(param),n=getFunctionDetails(t);if(!n)return console.error("Invalid function string"),null;const{functionName:s,argsString:r}=n;return s?t=>{for(let n=0;n<this.numVoices;n++){this.voice[n][s];let o=this.voice[n];for(let t=0;t<keys.length-1;t++)o=o[keys[t]];const a=r.replace(/\bx\b/g,t);let c;try{c=new Function("e",`return [${a}]`)(t)}catch(t){}try{this.voice[n][s](...c)}catch(t){}}}:(console.error("Invalid function string"),null)}};elements.forEach((t=>{try{if(!t.callback)return;if(t.callback.toString().includes("this.super"))return;let n=this.generateParamString(t.callback);const s=this.retrieveValueExpression(t.callback);n||(n=this.applyFunctionToAllVoices(t.callback));const r=createCallback(n,s,t);t.callback=r}catch(n){console.log("Invalid GUI element:",t,n)}}))}hideGui(){for(let t=0;t<this.voice[0].gui_elements.length;t++)this.voice[0].gui_elements[t].hide=!0}showGui(){for(let t=0;t<this.voice[0].gui_elements.length;t++)this.voice[0].gui_elements[t].hide=!1}applyFunctionToAllVoices(t){let n=t.toString();return n=n.replace(/\bthis\./g,""),n}stringToFunction(t){const n=t.split("=>"),s=n[0].replace(/\(|\)/g,"").trim();let r=n[1].trim();return r=r.replace(/\bthis\./g,"this.voice[i]."),r=r.replace(/(?<!this\.|this\.super\.)\b(\w+)\(/g,"this.$1("),new Function("i",s,r)}generateParamString(t){const n=t.toString().match(/this\.([\w\d_\.]+)\s*=\s*([\w\d_\.]+)\s*;?/);return n?n[1]:null}retrieveValueExpression(t){const n=t.toString().match(/this\.([\w\d_\.]+)\s*=\s*(.+);?/);return n?n[2].trim():null}set(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tone.now(),r=t.split(".");for(let t=0;t<this.numVoices;t++){let o=this.voice[t];for(let n=0;n<r.length-1;n++){if(void 0===o[r[n]])return void console.error(`Parameter ${r[n]} does not exist on voice ${t}`);o=o[r[n]]}const a=r[r.length-1],c="function"==typeof n?n():n;void 0!==o[a]?void 0!==o[a]?.value?(console.log(`Current value: ${o[a].value}, Setting new value: ${c}`),null===s?o[a].value=c:o[a].linearRampToValueAtTime(c,s+.1)):o[a]=c:console.error(`Parameter ${a} does not exist on voice ${t}`)}}loadPreset(t){this.voice[0].loadPreset(t)}listPresets(){this.voice[0].listPresets()}savePreset(t){this.voice[0].savePreset(t)}downloadPresets(){this.voice[0].downloadPresets()}panic=function(){for(let t=0;t<this.numVoices;t++)this.voice[t].triggerRelease(),this.activeNotes[t]=-1};pan=function(t){for(let n=0;n<this.numVoices;n++)this.voice[n].panner.pan.value=Math.sin(n/8*Math.PI*2)*t}}exports.Polyphony=Polyphony},582:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__(4994);Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toggle=exports.Text=exports.RadioButton=exports.Pad=exports.Momentary=exports.Line=exports.Knob=exports.GuiFonts=exports.Fader=exports.Dropdown=exports.Button=void 0,exports.debug=debug,exports.divResized=divResized,exports.drawBackground=drawBackground,exports.drawElements=drawElements,exports.exportTheme=exportTheme,exports.initialize=initialize,exports.listThemes=listThemes,exports.setFont=exports.setColor=void 0,exports.setTheme=setTheme,exports.setThemeParameters=setThemeParameters;var _p=_interopRequireDefault(__webpack_require__(5897)),_p5Themes=_interopRequireDefault(__webpack_require__(1656));let activeTheme=_p5Themes.default.themes.default;function debug(){console.log("esy"),console.log(activeTheme)}function listThemes(){console.log(Object.keys(_p5Themes.default.themes))}function setTheme(t){_p5Themes.default.themes[t]?activeTheme=_p5Themes.default.themes[t]:console.error(`Theme '${t}' not found.`)}function setThemeParameters(t){activeTheme?activeTheme={...activeTheme,...t}:console.error(`Active theme '${activeTheme}' not found.`)}function exportTheme(){return console.log("exporting "+activeTheme),console.log(JSON.stringify(activeTheme,null,2)),JSON.stringify(activeTheme,null,2)}function initialize(t,n){return t.div=n,t.createCanvas(n.offsetWidth,.4*n.offsetWidth),t.width=n.offsetWidth,t.height=.4*n.offsetWidth,t.elements={},[t.width,t.height]}function resizeP5(t,n,s){var r=t.match(/(\w+)\.(\w+)\((.*?)\)/);if(r){var o=r[1],a=r[2];let c=r[3].split(",").map((t=>t.trim()));for(let t=0;t<("arc"===a?4:c.length);t++)c[t]*="circle"===a&&t>1?(n+s)/2:t%2==0?n:s;return t.replace(r[0],o+"."+a+"("+c.join(", ")+")")}return t}function divResized(t,n,s){let r=t.width,o=t.height;t.resizeCanvas(0,0);let a=document.getElementById("canvases"),c=document.getElementById("controls"),l=document.getElementById("flex");"+h"===n?(t.height=a.offsetHeight-c.offsetHeight,t.width=t.div.offsetWidth):"-h"===n?(t.height=a.offsetHeight/s-c.offsetHeight,t.width=r):"+w"===n?(t.width=l.offsetWidth,t.height=t.div.offsetHeight):"-w"===n?(t.width=l.offsetWidth/2,t.height=o):(t.width=t.div.offsetWidth,t.height=t.div.offsetHeight);let h=t.width/r,u=t.height/o;t.resizeCanvas(t.width,t.height);for(let[n,s]of Object.entries(t.elements))"string"==typeof s?t.elements[n]=resizeP5(s,h,u):s.resize(h,u);t.drawElements()}function drawGrid(t){let n=Math.ceil((t.width-20)/3)-5,s=Math.ceil((t.height-20)/3)-5;t.textSize(12);let r=activeTheme.backgroundColor.reduce(((t,n)=>t+n));t.fill(r<382?255:0),t.noStroke();for(let r=0;r<4;r++){let o=10+r*n,a=10+r*s;t.text(o,o,10),t.text(a,10,a)}}_p.default.prototype.initialize=function(t){return initialize(this,t)},_p.default.prototype.divResized=function(){divResized(this,arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)};let updateCanvas=1;function drawBackground(t){updateCanvas>0&&(updateCanvas=1,t.background(activeTheme.backgroundColor))}function drawElements(p){if(updateCanvas>0){updateCanvas=1;for(let element of Object.values(p.elements))"string"==typeof element?eval(element):element.draw()}}_p.default.prototype.drawBackground=function(){drawBackground(this)},_p.default.prototype.drawElements=function(){drawElements(this)};const scaleOutput=function(t,n,s,r,o,a){void 0===a&&(a=1);let c=1/(s-n)*(t-n);return c=Math.pow(c,a),c*(o-r)+r},unScaleOutput=function(t,n,s,r,o,a){a=void 0===a?1:1/a;let c=1/(o-r)*(t-r);return c=Math.pow(c,a),c*(s-n)+n},getElementByLabel=(t,n)=>{const s=Object.values(t.elements);for(const t of s)if(console.log(t.id),t.id===n)return t;return null};_p.default.prototype.getElementByLabel=function(t){getElementByLabel(this,t)};const setColor=function(t,n){"border"===t?activeTheme.borderColor=n:"accent"===t?activeTheme.accentColor=n:"background"===t?activeTheme.backgroundColor=n:"text"===t?activeTheme.textColor=n:"string"==typeof t&&Array.isArray(n)?(n.length=3)?(activeTheme[t]=n,console.error(`new Color added: ${t}`)):console.error("second argument must be an array of three values in RGB format"):console.error(`incorrect color values: ${t}, ${n} `)};exports.setColor=setColor;const getColor=function(t){return"border"===t?activeTheme.borderColor:"accent"===t?activeTheme.accentColor:"background"===t?activeTheme.backgroundColor:"text"===t?activeTheme.textColor:Array.isArray(t)?t:(console.error(`Invalid color property: ${t}`),[0,0,0])},GuiFonts=exports.GuiFonts={label:"Helvetica",value:"Courier",text:"Times New Roman",title:"Verdana"},setFont=function(t,n){"label"===t?activeTheme.labelFont=n:"value"===t?activeTheme.valueFont=n:"text"===t?activeTheme.textFont=n:"title"===t?activeTheme.titleFont=n:"string"==typeof t&&"string"==typeof n?(activeTheme[t]=n,console.error(`new Font added: ${t}`)):console.error(`incorrect font values: ${t}, ${n} `)};exports.setFont=setFont;const getFont=function(t){return"label"===t?activeTheme.labelFont:"value"===t?activeTheme.valueFont:"text"===t?activeTheme.textFont:"title"===t?activeTheme.titleFont:"string"==typeof t?t:(console.error(`Invalid font property: ${t}`),"Geneva")};let elementXPosition=0,elementYPosition=25,prevElementSize=0,prevYElementSize=0;class Element{constructor(p,options){this.p=p,this.ch=window.chClient,this.theme=activeTheme,this.label=options.label||"myElement",this.id=this.label,this.hide=!1;let i=1;for(;this.id in p.elements;)this.id+=i,i++;this.style=options.style||1,this.size=options.size||1,this.textSize=options.textSize||1,this.border=options.border||"theme",this.borderColor=options.borderColor||"border",this.accentColor=options.accentColor||"accent",this.borderRadius=options.borderRadius||activeTheme.borderRadius||0,this.textColor=options.textColor||"text",this.showLabel=void 0===options.showLabel||options.showLabel,this.showValue=void 0===options.showValue||options.showValue,this.labelFont=options.labelFont||"label",this.valueFont=options.valueFont||"value",this.textFont=options.textFont||"text",this.labelX=options.labelX||0,this.labelY=options.labelY||0,this.valueX=options.valueX||0,this.valueY=options.valueY||0,this.textX=options.textX||0,this.textY=options.textY||0;let currentGap=(prevElementSize+this.size)/2;elementXPosition+=8*currentGap+5,elementXPosition>100-8*this.size&&(elementXPosition=this.size/2*8+5,elementYPosition+=20*prevYElementSize+10,prevYElementSize=this.size),this.x=options.x||elementXPosition,this.y=options.y||elementYPosition,prevElementSize=this.size,prevYElementSize=this.size>prevYElementSize?this.size:prevYElementSize,this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width,this.x_box=this.cur_size,this.y_box=this.cur_size,this.active=0,this.min=options.min||0,this.max=options.max||1,this.curve=options.curve||1,"string"==typeof options.mapto?this.mapto=eval(options.mapto):this.mapto=options.mapto||null,this.callback=options.callback||null,this.mapto||this.callback?this.maptoDefined="true":this.maptoDefined="false",this.rawValue=unScaleOutput(options.value,0,1,this.min,this.max,this.curve)||.5,this.value=null!=options.value?options.value:scaleOutput(.5,0,1,this.min,this.max,this.curve),p.elements[this.id]=this,this.linkName="string"==typeof options.link?options.link:null,this.linkFunc="function"==typeof options.link?options.link:null,this.linkName&&this.ch.on(this.linkName,(t=>{this.forceSet(this.ch.getControl(this.linkName))})),this.mapValue(this.value,this.mapto),this.runCallBack()}getParam(t,n){return"theme"===n?activeTheme[t]:n}isPressed(){!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2&&(this.active=1)}isReleased(){!0!==this.hide&&1===this.active&&(this.active=0)}resize(t,n){this.x*=t,this.y*=n}drawLabel(t,n){this.p.textSize(10*this.textSize),this.p.stroke(this.setColor(this.textColor)),this.p.strokeWeight(1e-5*this.textSize*20),this.p.textAlign(this.p.CENTER,this.p.CENTER),this.p.fill(this.setColor(this.textColor)),this.p.textFont(getFont(this.labelFont)),this.p.text(this.label,t+this.labelX/100*this.p.width,n+this.labelY/100*this.p.height)}drawValue(t,n){let s=this.value;this.p.stroke(this.setColor(this.textColor)),this.p.textSize(10*this.textSize),this.p.strokeWeight(1e-5*this.textSize*20),this.p.textAlign(this.p.CENTER,this.p.CENTER),this.p.fill(this.setColor(this.textColor)),this.p.textFont(getFont(this.valueFont)),s=Math.abs(s)<1?s.toFixed(4):Math.abs(s)<5?s.toFixed(3):Math.abs(s)<100?s.toFixed(2):s.toFixed(1),this.p.text(s,t+this.valueX/100*this.p.width,n+this.valueY/100*this.p.height)}drawText(t,n,s){this.p.textSize(10*this.textSize),this.p.stroke(this.setColor(this.textColor)),this.p.strokeWeight(1e-5*this.textSize*20),this.p.textAlign(this.p.CENTER,this.p.CENTER),this.p.fill(getColor(this.textColor)),this.p.textFont(getFont(this.textFont)),this.p.text(t,n+this.textX/100*this.p.width,s+this.textY/100*this.p.height)}setPosition(t,n){this.x=t,this.y=n}setColor(t){return"string"==typeof t?getColor(t):Array.isArray(t)&&3===t.length?t:(console.log(this.label,typeof t,"invalid color"),[0,0,0])}mapValue(t,n){if(n)try{n.value.rampto(t,.1)}catch{try{n.value=t}catch{try{n=t}catch(t){console.log("Error setting Mapto to value: ",t)}}}else"false"===this.maptoDefined&&console.log(this.label,"no destination defined")}runCallBack(){if(this.callback){let t=this.value;try{this.callback(t)}catch{try{this.callback()}catch(t){console.log("Error with Callback Function: ",t)}}}else"false"===this.maptoDefined&&console.log(this.label,"no destination defined");this.sendName&&this.ch.control(this.sendName,this.value)}set(t){"string"==typeof t?this.value=t:(this.value=t,this.rawValue=unScaleOutput(t,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto)),this.runCallBack(),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}forceSet(t){"string"==typeof t?this.value=t:(this.value=t,this.rawValue=unScaleOutput(t,0,1,this.min,this.max,this.curve)||.5,this.mapValue(this.value,this.mapto)),this.runCallBack()}}class Knob extends Element{constructor(t,n){super(t,n),this.incr=n.incr||.01,this.degrees=n.degrees||320,this.startAngle=this.p.PI*(.5+(360-this.degrees)/360),this.endAngle=this.p.PI*(.5-(360-this.degrees)/360)+2*this.p.PI,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(t,n){super.resize(t,n),Math.max(Math.abs(1-t))>Math.max(Math.abs(1-n))?this.size*=t:this.size*=n}draw(){if(!0===this.hide)return;this.startAngle=this.p.PI*(.5+(360-this.degrees)/360),this.endAngle=this.p.PI*(.5-(360-this.degrees)/360)+2*this.p.PI;let t=this.p.map(this.rawValue,0,1,0,this.endAngle-this.startAngle);this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width/2,this.x_box=this.cur_size,this.y_box=this.cur_size;let n=this.getParam("border",this.border);this.p.textSize(10*this.textSize),this.p.textWidth(this.label);let s=this.p.textAscent()+this.p.textDescent();this.showLabel&&this.drawLabel(this.cur_x,this.cur_y+this.cur_size/2+.5*s),this.showValue&&this.drawValue(this.cur_x,this.cur_y+this.cur_size/2+s*(this.showLabel?1.5:.5)),this.p.noFill(),this.p.strokeWeight(n),this.p.stroke(this.setColor(this.borderColor)),this.p.arc(this.cur_x,this.cur_y,this.cur_size,this.cur_size,this.p.constrain(this.startAngle+t+n/30/this.size/2,this.startAngle,this.endAngle),this.endAngle),this.p.stroke(this.setColor(this.accentColor)),this.p.arc(this.cur_x,this.cur_y,this.cur_size,this.cur_size,this.startAngle,this.p.constrain(this.startAngle+t-n/30/this.size/2,this.startAngle,this.endAngle));let r=this.cur_size/2,o=this.cur_x+this.p.cos(this.startAngle+t)*r,a=this.cur_y+this.p.sin(this.startAngle+t)*r;this.p.stroke(this.setColor(this.accentColor)),this.p.line(this.cur_x,this.cur_y,o,a)}isDragged(){!0!==this.hide&&this.active&&(0!=this.p.movedY&&(this.p.keyIsDown(this.p.ALT)?this.rawValue-=this.p.movedY*this.incr/10:this.rawValue-=this.p.movedY*this.incr),this.rawValue>1&&(this.rawValue=1),this.rawValue<0&&(this.rawValue=0),this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}}exports.Knob=Knob,_p.default.prototype.Knob=function(){return new Knob(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.Dial=function(){return new Knob(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Fader extends Element{constructor(t,n){super(t,n),this.incr=n.incr||.01,this.orientation="horizontal"===n.orientation?"horizontal":"vertical",this.isHorizontal="horizontal"===this.orientation,this.value=this.value||.5,this.dragging=!1,this.size=n.size||1,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(t,n){super.resize(t,n),this.size*=this.isHorizontal?t:n}draw(){if(!0===this.hide)return;this.isHorizontal="horizontal"===this.orientation,this.cur_size=this.size/6*this.p.width/2;let t=this.getParam("border",this.border),n=this.x/100*this.p.width,s=this.y/100*this.p.height;this.isHorizontal?(this.x_box=this.cur_size,this.y_box=3*t*this.size,this.cur_x=this.x/100*this.p.width+this.cur_size/2,this.cur_y=this.y/100*this.p.height+t):(this.y_box=this.cur_size,this.x_box=3*t*this.size,this.cur_x=this.x/100*this.p.width+t,this.cur_y=this.y/100*this.p.height+this.cur_size/2),this.size,this.thickness=t,this.thickness,this.p.textSize(10*this.textSize),this.p.textWidth(this.label);let r=this.p.textAscent()+this.p.textDescent(),o=this.isHorizontal?this.cur_y+2*t+.5*r:this.cur_y+this.cur_size/2+t+.5*r;this.showLabel&&this.drawLabel(this.cur_x,o),this.showValue&&this.drawValue(this.cur_x,o+(this.showLabel?1:0)*r),this.p.noFill(),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(1.5*t),this.isHorizontal?this.p.rect(n,s,this.cur_size,2*t):this.p.rect(n,s,2*t,this.cur_size),this.p.fill(getColor("background")),this.p.stroke(this.setColor("background")),this.pos=this.p.map(this.rawValue,0,1,this.isHorizontal?n:s+this.cur_size-this.thickness,this.isHorizontal?n+this.cur_size-this.thickness:s);let a=.25*t;this.isHorizontal?this.p.rect(this.pos-a,s,this.thickness+2*a,2*this.thickness):this.p.rect(n,this.pos-a,2*this.thickness,this.thickness+2*a),this.p.fill(this.setColor(this.accentColor)),this.p.stroke(this.setColor(this.accentColor)),this.pos=this.p.map(this.rawValue,0,1,this.isHorizontal?n:s+this.cur_size-this.thickness,this.isHorizontal?n+this.cur_size-this.thickness:s),this.isHorizontal?this.p.rect(this.pos,s,this.thickness,2*this.thickness):this.p.rect(n,this.pos,2*this.thickness,this.thickness)}isDragged(){!0!==this.hide&&this.active&&(this.isHorizontal?0!==this.p.movedX&&(this.p.keyIsDown(this.p.ALT)?this.rawValue+=this.p.movedX*this.incr/10:this.rawValue+=this.p.movedX*this.incr/this.size):0!==this.p.movedY&&(this.p.keyIsDown(this.p.ALT)?this.rawValue-=this.p.movedY*this.incr/10:this.rawValue-=this.p.movedY*this.incr/this.size),this.rawValue>1&&(this.rawValue=1),this.rawValue<0&&(this.rawValue=0),this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}}exports.Fader=Fader,_p.default.prototype.Fader=function(){return new Fader(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.Slider=function(){return new Fader(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Pad extends Element{constructor(p,options){super(p,options),this.incr=options.incr||.01,this.valueX=this.valueX||.5,this.valueY=this.valueY||.5,this.rawValueX=this.valueX,this.rawValueY=this.valueY,this.dragging=!1,this.sizeX=options.sizeX||options.size||5,this.sizeY=options.sizeY||options.size||5,"string"==typeof options.maptoX?this.maptoX=eval(options.maptoX):this.maptoX=options.maptoX||null,"string"==typeof options.maptoY?this.maptoY=eval(options.maptoY):this.maptoY=options.maptoY||null,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(t,n){super.resize(t,n)}draw(){if(!0===this.hide)return;this.cur_size=this.size/6*this.p.width/2,this.cur_sizeX=this.sizeX/6*this.p.width/2,this.cur_sizeY=this.sizeY/6*this.p.width/2;let t=this.getParam("border",this.border),n=this.x/100*this.p.width-this.cur_sizeX/2,s=this.y/100*this.p.height-this.cur_sizeY/2;this.x_box=2*this.cur_sizeX,this.y_box=2*this.cur_sizeY,this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.thickness=t,this.thickness,this.p.fill(this.setColor(this.borderColor)),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(1.5*t),this.p.rect(n,s,this.cur_sizeX,this.cur_sizeY),this.p.fill(this.setColor(this.accentColor)),this.p.stroke(this.setColor(this.accentColor));let r=n+this.rawValueX*(this.cur_sizeX-0*t),o=s+this.rawValueY*(this.cur_sizeY-0*t);this.p.circle(r,o,(this.cur_sizeX+this.cur_sizeY)/30);let a=this.p.textAscent()+this.p.textDescent();this.showLabel&&this.drawLabel(this.cur_x,this.cur_y-this.cur_sizeY/2-a)}isDragged(){!0!==this.hide&&this.active&&(0!==this.p.movedX&&(this.p.keyIsDown(this.p.ALT)?this.rawValueX+=this.p.movedX*this.incr/10:this.rawValueX+=this.p.movedX*this.incr/this.sizeX),0!==this.p.movedY&&(this.p.keyIsDown(this.p.ALT)?this.rawValueY+=this.p.movedY*this.incr/10:this.rawValueY+=this.p.movedY*this.incr/this.sizeY),this.rawValueX>1&&(this.rawValueX=1),this.rawValueX<0&&(this.rawValueX=0),this.valueX=scaleOutput(this.rawValueX,0,1,this.min,this.max,this.curve),this.mapValue(this.valueX,this.maptoX),this.rawValueY>1&&(this.rawValueY=1),this.rawValueY<0&&(this.rawValueY=0),this.valueY=scaleOutput(this.rawValueY,0,1,this.min,this.max,this.curve),this.mapValue(this.valueY,this.maptoY),this.runCallBack())}}exports.Pad=Pad,_p.default.prototype.Pad=function(){return new Pad(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.JoyStick=function(){return new Pad(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Button extends Element{constructor(t,n){super(t,n),this.value=n.value||0,this.rawValue=this.value,this.cornerRadius=n.cornerRadius||1,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(t,n){super.resize(t,n),this.size*=!1!==this.horizontal?t:n}draw(){if(!0===this.hide)return;this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width/2,this.x_box=this.cur_size,this.y_box=this.cur_size;let t=this.getParam("border",this.border);this.rawValue?(this.p.fill(this.setColor(this.accentColor)),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(t/2),this.p.rect(this.cur_x-this.cur_size/2,this.cur_y-this.cur_size/2,this.cur_size,this.cur_size,this.cur_size/2*this.cornerRadius)):(this.p.noFill(),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(t/2),this.p.rect(this.cur_x-this.cur_size/2,this.cur_y-this.cur_size/2,this.cur_size,this.cur_size,this.cur_size/2*this.cornerRadius)),this.showLabel&&this.drawLabel(this.cur_x,this.cur_y)}isPressed(){!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2&&(this.active=1,this.rawValue=1,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),"false"===this.maptoDefined&&postButtonError("Buttons"),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}isReleased(){!0!==this.hide&&1===this.active&&(this.active=0,this.rawValue=0,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}forceSet(t){t?(this.active=1,this.rawValue=1,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),"false"===this.maptoDefined&&postButtonError("Buttons")):(this.active=0,this.rawValue=0,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve))}}function postButtonError(t){"Buttons"===t&&console.log(t+" generally work by defining a callback function. For buttons, the value is 1 on every press."),"Toggle buttons"===t&&console.log(t+" generally work by defining a callback function. The value for toggle buttons alternates between 1 and 0."),"RadioButtons"===t&&console.log(t+" generally work by defining a callback function. The value for radio buttons is the text string of the selected button."),"Buttons"===t&&console.log("An example of defining a callback for a button is: \ncallback: function(val){ env.triggerAttackRelease(0.1) }"),"Toggle buttons"===t&&console.log("An example of defining a callback for a toggle is: \ncallback: function(val){ \n    if(val==1) vco.type = 'square'; \n    else vco.type = 'sawtooth'; \n}"),"RadioButtons"===t&&console.log("An example of defining a callback for a radio button is: \ncallback: function(val){ vco.type = val }")}exports.Button=Button,_p.default.prototype.Button=function(){return new Button(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Momentary extends Button{constructor(t,n){super(t,n),this.value=n.value||0,this.rawValue=this.value}isReleased(){!0!==this.hide&&1===this.active&&(this.active=0,this.rawValue=0,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack())}}exports.Momentary=Momentary,_p.default.prototype.Momentary=function(){return new Momentary(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Toggle extends Button{constructor(t,n){super(t,n),this.state=n.state||!1,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}isPressed(){!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2&&(this.active=1,this.rawValue=this.rawValue?0:1,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),"false"===this.maptoDefined&&postButtonError("Toggle buttons"),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}isReleased(){!0!==this.hide&&1===this.active&&(this.active=0)}forceSet(t){this.rawValue=t,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),"false"===this.maptoDefined&&postButtonError("Toggle buttons")}}exports.Toggle=Toggle,_p.default.prototype.Toggle=function(){return new Toggle(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class RadioButton extends Button{constructor(t,n){super(t,n),this.radioOptions=n.radioOptions||["on","off"],this.orientation=n.orientation||"vertical",this.isHorizontal="horizontal"===this.orientation,this.value=n.value||this.radioOptions[0],this.radioHeight=this.cur_size/2,this.radioWidth=2*this.cur_size,this.border=n.border||activeTheme.radioBorder||2,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}draw(){if(!0===this.hide)return;this.radioClicked={},this.isHorizontal="horizontal"===this.orientation,this.cur_size=this.size/6*this.p.width/2,this.radioHeight=this.cur_size/2,this.radioWidth=2*this.cur_size;let t=this.getParam("border",this.border);this.p.textSize(10*this.textSize);let n=0;for(let t=0;t<this.radioOptions.length;t++){let s=this.p.textWidth(this.radioOptions[t]);s>n&&(n=s)}this.cur_size=n,this.radioWidth=1.5*this.cur_size,this.isHorizontal?(this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.x_corner=this.cur_x-this.radioWidth*this.radioOptions.length/2,this.y_corner=this.cur_y-this.radioHeight/2,this.x_box=this.radioWidth*this.radioOptions.length,this.y_box=this.radioHeight):(this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.x_corner=this.cur_x-this.radioWidth/2,this.y_corner=this.cur_y-this.radioHeight*this.radioOptions.length/2,this.y_box=this.radioHeight*this.radioOptions.length,this.x_box=this.radioWidth),this.showLabel&&this.drawLabel(this.cur_x,this.isHorizontal?this.cur_y+this.radioHeight:this.cur_y+this.radioHeight*(this.radioOptions.length/2+.5));for(let n=0;n<this.radioOptions.length;n++){let s=this.radioOptions[n],r=this.isHorizontal?this.x_corner+n*this.radioWidth:this.x_corner,o=this.isHorizontal?this.y_corner:this.y_corner+this.radioHeight*n;this.p.fill(this.value===s?this.setColor(this.accentColor):this.setColor(this.borderColor)),this.p.stroke(0),this.p.strokeWeight(t),this.p.rect(r,o,this.radioWidth,this.radioHeight),this.drawText(s,r+this.radioWidth/2,o+this.radioHeight/2),this.radioClicked[this.radioOptions[n]]=()=>this.isHorizontal?this.p.mouseX>=r&&this.p.mouseX<=r+this.radioSize:this.p.mouseY>=o&&this.p.mouseY<=o+this.radioSize/2}}isPressed(){if(!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2){if(this.isHorizontal){let t=this.cur_x+this.x_box/2-this.p.mouseX;t=Math.floor(t/this.radioWidth),t=this.radioOptions.length-t-1,this.value=this.radioOptions[t]}else{let t=this.cur_y+this.y_box/2-this.p.mouseY;t=Math.floor(t/this.radioHeight),t=this.radioOptions.length-t-1,this.value=this.radioOptions[t]}this.active=1,this.runCallBack(),this.mapValue(this.value,this.mapto),"false"===this.maptoDefined&&postButtonError("RadioButtons"),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}}isReleased(){}}exports.RadioButton=RadioButton,_p.default.prototype.RadioButton=function(){return new RadioButton(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.Radio=function(){return new RadioButton(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Dropdown extends Button{constructor(t,n){super(t,n),this.dropdownOptions=n.dropdownOptions||["on","off"],this.value=n.value||this.dropdownOptions[0],this.isOpen=!1,this.cur_size=this.size||30,this.border=n.border||activeTheme.radioBorder||2,this.accentColor=n.accentColor||[200,50,0],this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}draw(){if(!0===this.hide)return;this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.p.textSize(.9*this.cur_size);let t=this.p.textWidth(this.value);if(this.boxWidth=Math.max(t+20,100),this.boxHeight=this.cur_size,this.p.fill(255),this.p.stroke(0),this.p.strokeWeight(this.border),this.p.rect(this.cur_x,this.cur_y,this.boxWidth,this.boxHeight),this.drawText(this.value,this.cur_x+this.boxWidth/2,this.cur_y+this.boxHeight/2),this.isOpen)for(let t=0;t<this.dropdownOptions.length;t++){let n=this.dropdownOptions[t],s=this.cur_y+(t+1)*(this.boxHeight+2);this.value===n?this.p.fill(this.accentColor):this.p.fill(200),this.p.stroke(0),this.p.rect(this.cur_x,s,this.boxWidth,this.boxHeight),this.p.fill(0),this.drawText(n,this.cur_x+this.boxWidth/2,s+this.boxHeight/2)}}isPressed(){if(!0!==this.hide)if(this.p.mouseX>=this.cur_x&&this.p.mouseX<=this.cur_x+this.boxWidth&&this.p.mouseY>=this.cur_y&&this.p.mouseY<=this.cur_y+this.boxHeight)this.isOpen=!this.isOpen;else if(this.isOpen){for(let t=0;t<this.dropdownOptions.length;t++){let n=this.cur_y+(t+1)*(this.boxHeight+2);if(this.p.mouseX>=this.cur_x&&this.p.mouseX<=this.cur_x+this.boxWidth&&this.p.mouseY>=n&&this.p.mouseY<=n+this.boxHeight)return this.value=this.dropdownOptions[t],this.isOpen=!1,this.runCallBack(),this.mapValue(this.value,this.mapto),"false"===this.maptoDefined&&postButtonError("Dropdown"),this.linkName&&this.ch.control(this.linkName,this.value),void(this.linkFunc&&this.linkFunc())}this.isOpen=!1}else this.isOpen=!1}isReleased(){}}exports.Dropdown=Dropdown,_p.default.prototype.Dropdown=function(){return new Dropdown(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Line extends Element{constructor(t,n,s,r,o,a){super(t,a),this.x1=n||0,this.x2=r||0,this.y1=s||0,this.y2=o||0,this.showLabel=a.showLabel||"false",this.border=a.border||2,this.color=a.color||activeTheme.lineColor||"border"}resize(t,n){super.resize(t,n),this.size*=!1!==this.horizontal?t:n}draw(){if(!0===this.hide)return;let t=this.x1/100*this.p.width,n=this.x2/100*this.p.width,s=this.y1/100*this.p.height,r=this.y2/100*this.p.height,o=this.getParam("border",this.border);this.p.fill(this.setColor(this.color)),this.p.stroke(this.setColor(this.color)),this.p.strokeWeight(2*o),this.p.line(t,s,n,r)}isPressed(){}pressed(){}isReleased(){}}exports.Line=Line,_p.default.prototype.Line=function(t,n,s,r){return new Line(this,t,n,s,r,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{})};class Text extends Element{constructor(t,n){super(t,n),this.border=n.border||activeTheme.border||0,this.textSize=n.size||activeTheme.textSize||n.textSize||1}resize(t,n){super.resize(t,n),this.size*=!1!==this.horizontal?t:n}draw(){if(!0===this.hide)return;this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width/2;let t=this.getParam("border",this.border),n=this.getParam("borderRadius",this.borderRadius);if(this.drawText(this.label,this.cur_x,this.cur_y),t>0){let s=this.p.textWidth(this.label),r=this.p.textAscent()+this.p.textDescent();this.p.noFill(),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(t),this.p.rect(this.cur_x-s/2-2-n/2,this.cur_y-r/2-1,s+4+n,r+1,n,n)}}isPressed(){}pressed(){}isReleased(){}}exports.Text=Text,_p.default.prototype.Text=function(){return new Text(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},640:t=>{"use strict";t.exports=JSON.parse('{"thickDistortion":{"Accent":0,"bitcrusher":0,"Glide":0,"Delay Control":0.0001,"wave":0.5,"freq":700,"release":0.8,"res":1,"detune":1,"gain":0.05},"default":{"Accent":0,"bitcrusher":0,"Glide":0,"Delay Control":0.05095,"wave":0.6950000000000002,"freq":1791.337256248868,"release":1.2970000000000006,"res":3.448777886795153,"detune":2,"gain":0.05},"shortNoisy":{"Accent":1,"bitcrusher":1,"Glide":0,"Delay Control":0.05088999999999999,"wave":0.45999999999999996,"freq":776.5421160762811,"release":0.604,"res":8.859313268874072,"detune":1.0099901,"gain":0.04450314575050762}}')},727:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Player=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(1174),c=s(1077),l=s(3941);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class CustomPlayer extends o.Player{set playbackRate(t){this._playbackRate=t;const n=this.now();this._activeSources.forEach((s=>{s.playbackRate.setValueAtTime(t,n)}))}}class Player extends a.MonophonicTemplate{constructor(t){super(),this.name="Player",this.player=new CustomPlayer,this.vcf=new o.Filter,this.vca=new o.Multiply(1),this.output=new o.Multiply(1),this.cutoffSig=new o.Signal(1e4),this.cutoffSig.connect(this.vcf.frequency),this.vcf.frequency.value=1e4,this.vcf.rolloff=-12,this.vcf.Q.value=1,this.filterEnv=new o.Envelope,this.vcfEnvDepth=new o.Multiply,this.filterEnv.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcf.frequency),this.player.connect(this.vcf),this.vcf.connect(this.vca),this.vca.connect(this.output),this.sample="",this.sampleDuration=0,this._baseUnit=16,this.seqControlsPitch=!1,this._start=0,this._end=100,this._playbackRate=1,this._baseNote=60;let n=[{name:"volume",value:-6,min:-36,max:0,curve:1,callback:t=>this.player.volume.value=t},{name:"cutoff",value:2e4,min:100,max:1e4,curve:2,callback:t=>this.cutoffSig.value=t},{name:"Q",min:0,value:0,max:20,curve:2,callback:t=>this.vcf.Q.value=t},{name:"filterType",value:"lowpass",min:0,max:20,curve:2,callback:t=>this.vcf.type=t},{name:"filterEnvDepth",value:0,min:0,max:5e3,curve:2,callback:t=>this.vcfEnvDepth.factor.value=t},{name:"loopStart",value:0,min:0,max:1e4,curve:1,callback:t=>this.player.loopStart=t},{name:"loopEnd",value:1,min:0,max:1e4,curve:1,callback:t=>this.player.loopEnd=t},{name:"loop",value:!1,min:0,max:1,curve:1,callback:t=>this.player.loop=t>0},{name:"fadeIn",value:.005,min:0,max:10,curve:3,callback:t=>this.player.fadeIn=t},{name:"fadeOut",value:.1,min:0,max:10,curve:3,callback:t=>this.player.fadeOut=t},{name:"baseUnit",value:16,min:0,max:6e4,curve:1,callback:t=>this._baseUnit=t},{name:"playbackRate",value:1,min:0,max:1e3,curve:1,callback:t=>{t<0&&(this.player.reverse=1),this._playbackRate=Math.abs(t),this.player.playbackRate=Math.abs(t)}},{name:"sequenceTime",value:!0,min:0,max:1,curve:1,callback:t=>this.seqControlsPitch=!t},{name:"startTime",value:0,min:0,max:1e4,curve:1,callback:t=>this._start=t},{name:"endTime",value:1,min:0,max:1e4,curve:1,callback:t=>this._end=t},{name:"baseNote",min:0,max:127,curve:1,callback:t=>this._baseNote=t},{name:"reverse",value:!1,min:0,max:1,curve:1,callback:t=>{this.player.reverse=t>0?1:0}}];this.param=this.generateParameters(n),this.createAccessors(this,this.param),this.sampleFiles={bell:["C4","berklee/bell_1.mp3"],bell1:["C4","berklee/bell_1a.mp3"],bell2:["C4","berklee/bell_2a.mp3"],bell3:["C4","berklee/bell_mallet_2.mp3"],horn:["C4","berklee/casiohorn2.mp3"],chotone:["C4","berklee/chotone_c4_!.mp3"],voice:["C4","berklee/femalevoice_aa_Db4.mp3"],kalimba:["C4","berklee/Kalimba_1.mp3"],dreamyPiano:["A5","salamander/A5.mp3"],softPiano:["A4","salamander/A4.mp3"],piano:[45,"salamander/A3.mp3"],casio:["C4","casio/C2.mp3"]},t&&this.loadSample(t)}load(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.loadSample(t)}loadSample(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t)return void this.loadAudioBuffer();if("number"==typeof t){const n=Object.keys(this.sampleFiles);t=Math.floor(t)%n.length,t=n[t]}if(!(t in this.sampleFiles)){try{return this.player.load(t),console.log("file loaded from ",t),void this.getSampleDuration()}catch{}return void console.error(`The sample "${t}" is not available.`)}console.log(`Player loading ${t}`),this.sample=t,this.baseUrl="https://tonejs.github.io/audio/";const n=this.sampleFiles[this.sample][1],s=this.sampleFiles[this.sample][0];console.log(s,n),this.player.load(this.baseUrl.concat(n),(()=>{const t=this.player.buffer.length/o.context.sampleRate;console.log(`Sample duration: ${t.toFixed(2)} seconds`)}))}listSamples(){const t=Object.keys(this.sampleFiles);console.log(t)}trigger(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.triggerAttackRelease(t,n,s,r)}triggerAttack(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=100;n/=127,s?(this.seqControlsPitch?(this.player.playbackRate=this.midiToRate(t),this.player.start(s,this._start,r)):(this._playbackRate!=this.player.playbackRate&&(this.player.playbackRate=this._playbackRate),this.player.start(s,t,r)),this.filterEnv.triggerAttack(s+0),this.vca.factor.setValueAtTime(n,s+0)):(this.seqControlsPitch?(this.player.playbackRate=this.midiToRate(t),this.player.start(o.now(),this._start,r)):(this._playbackRate!=this.player.playbackRate&&(this.player.playbackRate=this._playbackRate),this.player.start(o.now(),t,r)),this.filterEnv.triggerAttack(),this.vca.factor.setValueAtTime(n))}triggerRelease(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?(this.player.stop(n),this.filterEnv.triggerRelease(n+0)):(this.player.stop(),this.filterEnv.triggerRelease())}triggerAttackRelease(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;n/=127,s+=.2,r&&(this.seqControlsPitch?(this.player.playbackRate=this.midiToRate(t),this.player.start(r,this._start)):(this._playbackRate!=this.player.playbackRate&&(this.player.playbackRate=this._playbackRate),this.player.start(r,t)),this.filterEnv.triggerAttackRelease(s,r),this.vca.factor.setValueAtTime(n,r))}midiToRate(t){return Math.pow(2,(t-this._baseNote)/12)}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}loadAudioBuffer(){const t=document.createElement("input");t.type="file",t.accept="audio/*",t.onchange=t=>{const n=t.target.files[0];if(!n)return void console.log("No file selected");const s=new FileReader;s.onload=()=>{this.player=new CustomPlayer(s.result).connect(this.vcf),this.player.autostart=!1,console.log("Audio loaded into player"),this.getSampleDuration()},s.readAsDataURL(n)},t.click()}getSampleDuration(){setTimeout((()=>{const t=this.player._buffer.length/o.context.sampleRate;t>0?(console.log(`Sample duration: ${t.toFixed(2)} seconds`),this.sampleDuration=t):this.getSampleDuration()}),100)}sequence(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite";this.seq[s]?this.seq[s].sequence(t,n,r):this.seq[s]=new l.Seq(this,t,n,r,s,this.parseNoteString.bind(this)),this.start(s)}parseNoteString(t,n,s,r){if(0==this.sampleDuration)return console.log("Sample duration: 0 seconds"),void this.getSampleDuration();if("."===t[0])return void("started"===this.player.state&&this.player.stop(n));const a=/^[a-ac-zA-Z]$/.test(t[0][0]);let l="";if(this.seqControlsPitch)l=a?(0,c.pitchNameToMidi)(t[0]):(0,c.intervalToMidi)(t[0],this.min,this.max);else{if(a)return void console.log("player seq values are time positions in the sample");l=t[0]*this.sampleDuration}const h=t[1];if(l<0)return;let u=this.getSeqParam(this.seq[r].octave,s),d=this.getSeqParam(this.seq[r].velocity,s),f=this.getSeqParam(this.seq[r].sustain,s),v=this.getSeqParam(this.seq[r].subdivision,s);this.seqControlsPitch||(l/=this._baseUnit),l+=u;try{this.triggerAttackRelease(l,d,f,n+h*o.Time(v))}catch(t){console.log("invalid note",l,d,f)}}}n.Player=Player},1077:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Theory=n.Chord=void 0,n.intervalToMidi=function intervalToMidi(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:127;const r=(t=t.trim()).match(/\[.*?\]|-?\d+|@(\d+)|\./g)[0],a=t.match(/[b#]+/g);let c=-1;try{c=o.getChord().interval(r,n,s)}catch(t){console.log("bad interval: ",r)}if(null!==a)if(Array.isArray(a))for(const t of a)"#"===t?c+=1:"b"===t&&(c-=1);else"#"===a?c+=1:"b"===a&&(c-=1);return c},n.parsePitchStringBeat=function parsePitchStringBeat(t,n){try{"number"==typeof t&&(t=t.toString());const n=t.replace(/\[/g,"")[0],s=/^[a-ac-zA-Z]$/.test(n);let r=[];return/^\[.*\]$/.test(t)?(t=t.slice(1,-1).split(",")).forEach((t=>{let n=/\[.*?\]|[A-Ga-g][#b]?\d*|@(\d+)|./g;s||(n=/\[.*?\]|-?\d+[#b]?|@(\d+)|\./g),t=t.match(n);for(let n=0;n<t.length;n++)if(t[n].startsWith("@")){const s=parseInt(t[n].slice(1),10)-1,r=t[n-1],o=new Array(s).fill(r);t.splice(n,1,...o),n+=s-1}const o=t.length;for(let n=0;n<o;n++){const s=t[n];r.push([s,n/o])}})):r.push([t,0]),r}catch(t){return console.log("error with parsePitchStringBeat"),["."]}},n.parsePitchStringSequence=function parsePitchStringSequence(t){const n=t.replace(/\[/g,"")[0],s=/^[a-ac-zA-Z?]$/.test(n);s&&(t=t.replace(/\s/g,""));let r=/\[.*?\]|[A-Ga-g][#b]?\d*|@(\d+)|\.|\?/g;s||(r=/\[.*?\]|-?[b#]?\d+[b#]?|@(\d+)|\.|\?/g);let o=t.match(r);for(let t=0;t<o.length;t++)if(o[t].startsWith("@")){const n=parseInt(o[t].slice(1),10)-1,s=o[t-1],r=new Array(n).fill(s);o.splice(t,1,...r),t+=n-1}return o},n.parseStringBeat=function parseStringBeat(t,n){let s=[];return/^\[.*\]$/.test(t)?(t=t.slice(1,-1).split(",")).forEach((t=>{const n=t.length;for(let r=0;r<n;r++){const o=t[r];s.push([o,r/n])}})):s.push([t,0]),s},n.parseStringSequence=function parseStringSequence(t){const n=/\[.*?\]|./g;return(t=(t=t.replace(/\s/g,"")).replace(/(.)@(\d+)/g,((t,n,s)=>n.repeat(Number(s))))).match(n),t.match(n)},n.pitchNameToMidi=function pitchNameToMidi(t){const n=o.noteToInterval;let s,r=(t=t.trim()).match(/[A-G]?[a-g]?[#b]?/)[0];s=/[A-G]/.test(t[0])?3:4,r=r.charAt(0).toUpperCase()+r.slice(1);let a=t.match(/\d+$/);return a&&(s=parseInt(a[0],10)),n[r]+12*(s+1)};var r=_interopRequireWildcard(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}_interopRequireWildcard(s(6192));const o=n.Theory=new class MusicGenerator{constructor(){this._tonic="C",this.tonicNumber=0,this.keyType="major",this.octave=4,this.voicing="closed",this.previousChord=[],this._scale="major",this._chord="I",this._timeSignature="4/4",this._harmonicTempo=120,this._beat=0,this._bar=0,this._beatsPerBar=4,this._startingBar=0,this._startingBeat=0,this._barOffset=0,this._prevBarOffset=0,this._ticks=0,this.pulsePerChord=16,this.harmonicRhythm=8,this.progressionChords=[],this._progression=[],this.voicings={closed:[0,2,4,6],open:[0,4,6,9],drop2:[-3,0,2,6],drop3:[-1,0,3,4]},this.notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this.noteToInterval={C:0,"B#":12,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11},this.chordIntervals={major:[0,4,7],minor:[0,3,7],dominant7:[0,4,7,10],minor7:[0,3,7,10],major7:[0,4,7,11],minorMaj7:[0,3,7,11],diminished:[0,3,6],diminished7:[0,3,6,9],add9:[0,4,7,14]},this.chordScales={major:[0,2,4,5,7,9,11],minor:[0,2,3,5,7,8,10],lydianDominant:[0,2,4,6,7,9,10],mixolydian:[0,2,4,5,7,9,10],phrygianDominant:[0,1,4,5,7,8,10],minor7:[0,2,3,5,7,9,10],major7:[0,2,4,5,7,9,11],minorMaj7:[0,2,3,5,7,9,11],diminished:[0,2,3,5,6,8,9,11],diminished7:[0,2,3,5,6,8,9,11],add9:[0,2,4,5,7,9,11],dorian:[0,2,3,5,7,9,10],phrygian:[0,1,3,5,7,8,10],lydian:[0,2,4,6,7,9,11],locrian:[0,1,3,5,6,8,10]},this.MajorScaleDegrees={I:0,bII:1,II:2,bIII:3,III:4,IV:5,"#IV":6,bV:6,V:7,"#V":8,bVI:8,VI:9,bVII:10,VII:11,i:0,bii:1,ii:2,biii:3,iii:4,iv:5,"#iv":6,bv:6,v:7,bvi:8,vi:9,bvii:10,vii:11},this.MinorScaleDegrees={I:0,bII:1,II:2,III:3,"#III":4,IV:5,"#IV":6,bV:6,V:7,"#V":8,VI:8,"#VI":9,VII:10,"#VII":11,i:0,bii:1,ii:2,iii:3,"#iii":4,iv:5,"#iv":6,bv:6,v:7,vi:8,"#vi":9,bvii:10,vii:11}}set tonic(t){this.setTonic(t)}get tonic(){return this._tonic}set root(t){this.setTonic(t)}get root(){return this._tonic}set key(t){this.setTonic(t)}get key(){return this._tonic}set progression(t){this.setProgression(t)}get progression(){return this._progression}set tempo(t){r.Transport.bpm.value=t}get tempo(){return r.Transport.bpm.value}set scale(t){this._scale=t}get scale(){return this._scale}set chord(t){this._chord=t}get chord(){return this._chord}set timeSignature(t){this._timeSignature=t}get timeSignature(){return this._timeSignature}set harmonicTempo(t){this._harmonicTempo=t}get harmonicTempo(){return this._harmonicTempo}set beat(t){let n=this.transportToArray(r.Transport.position);n[1]=t,r.Transport.position=this.arrayToTransport(n)}get beat(){return this.transportToArray(r.Transport.position)[1]}set bar(t){let n=this.transportToArray(r.Transport.position);n[0]=t,r.Transport.position=this.arrayToTransport(n)}get bar(){return this.transportToArray(r.Transport.position)[0]}set beatsPerBar(t){this._beatsPerBar=t,r.Transport.timeSignature=t}get beatsPerBar(){return this._beatsPerBar}set ticks(t){this._ticks=t}get ticks(){return this.getTicks()+2}set start(t){void 0===t&&(t=0)}get now(){const t=r.Transport.position.split(":").map(Number);return 4*t[0]+t[1]+(t[2]||0)/4}getIndex(t){return Math.floor(this.ticks/r.Time(t).toTicks())}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;r.Transport.position=this.arrayToTransport([t,0,0]),r.Transport.start()}stop(){r.Transport.stop()}transportToArray(t){return t.split(":").map(Number)}arrayToTransport(t){return t.join(":")}onBar(t,n){r.Transport.schedule(t,this.arrayToTransport([n,0,0]))}setTonic(t){if("string"==typeof t){const n=/[A-Ga-g][#b]?/,s=/\d+/,r=t.match(n),o=t.match(s);r&&(this._tonic=r[0].toUpperCase(),this.keyType=r[0]===r[0].toUpperCase()?"major":"minor"),o&&(this.octave=parseInt(o[0],10))}else if("number"==typeof t){this.octave=Math.floor(t/12)-1;const n=t%12;this._tonic=this.notes[n]}this.tonicNumber=this.noteToInterval[this._tonic],console.log(`Tonic: ${this._tonic}, Number: ${this.tonicNumber}, Key Type: ${this.keyType}, Octave: ${this.octave}`)}setProgression(t){let n=[],s=-1;t.constructor!==Array&&(t=t.replaceAll(","," ").split(" "));for(let r=0;r<t.length;r++){let o=t[r];try{if(""!==t[r]){const t=o.match(/[iIvVb#]+/)[0],a=this.getChordType(o);console.log(o,a),"number"!=typeof this.MajorScaleDegrees[t]&&(s=r),this.chordScales[a].constructor!==Array&&(s=r),s<0&&n.push(o)}}catch{console.log("error with element ",t[r]),s=0}}if(s<0){this._progression=n,this.progressionChords=[];for(let t=0;t<this._progression.length;t++)this.progressionChords.push(new Chord(this._progression[t]))}else console.log("error in progression element",t[s])}setVoicing(t){this.voicings.hasOwnProperty(t)?this.voicing=t:console.log("invalid voicing name ",t),console.log("current voicing: ",this.voicing)}getChord(t){let n=this.getChordIndex();return this.progressionChords.length<1&&this.progressionChords.push(new Chord("I")),this.progressionChords[Math.floor(n%this.progressionChords.length)]}getChordIndex(){return Math.floor((this.ticks+2)/(r.Time("4n").toTicks()*this._beatsPerBar))}getChordType(t){const n=t.replace(/[iIvVb#]+/,"");let s=t.match(/[iIvV]+/)[0];s||(s="I");const r=this.getDefaultMode(s,this.keyType);for(const t of Object.keys(this.chordScales))if(n.toLowerCase().includes(t.toLowerCase()))return console.log("key",t),t;if(n.includes("dim"))return"diminished";if(n.includes("m6"))return"dorian";if(n.includes("min6"))return"dorian";if(n.includes("m13"))return"dorian";if(n.includes("min13"))return"dorian";if(n.includes("m7b9"))return"phrygian";if(n.includes("7b9"))return"phrygianDominant";if(n.includes("Maj7#11"))return"lydian";if(n.includes("m7b5"))return"locrian";if(n.includes("7b5"))return"lydianDominant";if(n.includes("Maj7")){const t=s===s.toUpperCase();return"lydian"===r?r:!0===t?"major7":"minorMaj7"}return n.includes("7")?s===s.toUpperCase()?"mixolydian":"minor7":n.includes("2")?"major9":"none"!==r?r:s===s.toUpperCase()?"major":"minor"}getDefaultMode(t,n){if("major"===n)switch(t){case"I":return"major";case"ii":return"dorian";case"iii":return"phrygian";case"IV":return"lydian";case"V":return"mixolydian";case"vi":return"minor";case"vii":return"locrian"}if("minor"===n)switch(t){case"i":return"minor";case"ii":return"locrian";case"III":return"major";case"iv":return"dorian";case"v":return"phrygian";case"V":return"phrygianDominant";case"VI":return"lydian";case"VII":return"mixolydian"}return"none"}getTicks(){const t=r.Transport.ticks-this._barOffset;return t<0?r.Transport.ticks-this._prevBarOffset:t}resetBar(t){const n=r.Transport.ticks,s=r.Time("4n").toTicks()*this._beatsPerBar,o=Math.ceil(n/s)*s;this._barOffset=o+t*s-t*s}getChordRoot(t){const n=t.match(/[iIvVb#]+/)[0];if(!n)return console.log("incorrect chord name ${name}"),this.tonicNumber;let s=0;return"major"==this.keyType?(s=this.MajorScaleDegrees[n],null==s&&(s=this.MinorScaleDegrees[n]),null==s&&(s=0)):(s=this.MinorScaleDegrees[n],null==s&&(s=this.MajorScaleDegrees[n]),null==s&&(s=0)),null==s&&(s=0),s%12}getChordTones(t,n,s){let r=[],o=3;/\d/.test(n)&&(o=4);for(let n=0;n<o;n++)r[n]=s[2*n]+t}getInterval(t,n){let s=n.length;if("number"==typeof t){let r=Math.floor(t/s);return t<0&&(t=s+t%s),n[t%s]+12*r}if("string"==typeof t){const r=t.match(/^([^\d-]+)?(-?\d+)$/);t=Number(r[2]);let o=Math.floor(t/s);return t<0&&(t=7+t%7),t=n[t%s]+12*o,"#"==r[1]?t+=1:"b"==r[1]&&(t-=1),t+this.tonicNumber}return 0}minimizeMovement(t,n){let s=Math.abs(t[0]%12-n[0]%12),r=0;for(let o=1;o<t.length;o++)Math.abs(t[o]%12-n[0]%12)<s&&(s=Math.abs(t[o]%12-n[0]%12),r=o);for(;t[r]<n[0]-2;)t=t.map((t=>t+12));for(let s=0;s<t.length;s++)t[s]<n[0]&&(t[s]+=12);return t.sort(((t,n)=>t-n))}};class Chord{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.octave,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.voicing;this.name=t,this.octave=n,this.voicing=s,this.rootValue=o.getChordRoot(t),this.quality=o.getChordType(t),this.scale=o.chordScales[this.quality],"V7"==this.name&&(this.scale=o.chordScales.mixolydian),this.chordTones=this.getChordTones(this.rootValue,this.quality,this.scale),this.length=this.chordTones.length}interval(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===s&&(s=n+12),this.getInterval(t,n,s)}getInterval(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:127;if((t=o.getInterval(t,this.scale)+this.rootValue+12*this.octave)<n){const s=Math.floor((n-t)/12)+1;for(let n=0;n<s;n++)t+=12}else if(t>s){const n=Math.floor((t-s)/12)+1;for(let s=0;s<n;s++)t-=12}return t}root(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36;return this.rootValue+t}tones(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:48;return this.getChordTones(t)}getChordTones(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:48,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===n&&(n=t+12),this.getChord(this.name,t,this.voicing)}setChord(t){this.notes=t}applyVoicing(t){const n=o.voicings[this.voicing];return o.chordTones.map(((t,s)=>t+(n[s]||0)))}getChord(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null==s&&(s=o.voicing);let r=[this.scale[0],this.scale[2],this.scale[4]];if(/\d/.test(t)&&this.scale.length>=7){const n=t.match(/\d+/);n&&r.push(this.scale[parseInt(n[0],10)%7])}return r=r.map((t=>t+12*this.octave+this.rootValue)),o.previousChord.length>0&&(n&&(o.previousChord[0]=n),r=o.minimizeMovement(r,o.previousChord)),o.previousChord=r,r.map((t=>t+o.tonicNumber))}}n.Chord=Chord},1160:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Twinkle=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=r(s(138)),c=s(1174),l=(s(3447),r(s(1297)));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class Twinkle extends c.MonophonicTemplate{constructor(){var t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),t=this,this.gui=n,this.presets=a.default,this.isGlide=!1,this.name="Twinkle",console.log(this.name," loaded, available preset: ",this.presets),this.frequency=new o.Signal(200),this.vco=new o.OmniOscillator({type:"pulse"}).start(),this.frequency.connect(this.vco.frequency),this.vcf=new o.Filter({type:"lowpass",rolloff:-24}),this.vco.connect(this.vcf),this.vca=new o.Multiply,this.vcf.connect(this.vca),this.output=new o.Multiply(1),this.vcf.connect(this.vca),this.vca.connect(this.output),this.vca_lvl=new o.Signal,this.vca_lvl.connect(this.vca.factor),this.env=new o.Envelope,this.env.releaseCurve="linear",this.env.decayCurve="exponential",this.env_depth=new o.Multiply,this.env.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.velocitySig=new o.Signal(1),this.velocitySig.connect(this.env_depth.factor),this.cutoffSig=new o.Signal(1e3),this.cutoff_cv=new o.Signal(0),this.vcf_env_depth=new o.Multiply(500),this.keyTracker=new o.Multiply(.1),this.env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.cutoffSig.connect(this.vcf.frequency),this.cutoff_cv.connect(this.vcf.frequency),this.frequency.connect(this.keyTracker),this.keyTracker.connect(this.vcf.frequency);let s=[{name:"type",type:"vco",value:"square",radioOptions:["square","saw","tri","sine"],callback:function(n){switch(n){case"square":t.vco.type="pulse";break;case"saw":t.vco.type="sawtooth";break;case"tri":t.vco.type="triangle";break;case"sine":t.vco.type="sine"}}},{name:"cutoff",type:"vcf",min:20,max:1e4,curve:2,callback:function(n){return t.cutoffSig.value=n}},{name:"Q",type:"vcf",min:0,max:30,curve:2,callback:function(n){return t.vcf.Q.value=n}},{name:"keyTrack",type:"hidden",min:0,max:2,curve:1,callback:function(n){return t.keyTracker.factor.value=n}},{name:"envDepth",type:"vcf",min:-1e3,max:5e3,curve:2,callback:function(n){return t.vcf_env_depth.factor.value=n}},{name:"level",value:0,type:"vca",min:0,max:1,curve:2,callback:function(n){return t.vca_lvl.value=n}},{name:"adsr",type:"env",min:0,max:1,curve:2,value:[.01,.1,.5,.5],labels:["attack","decay","sustain","release"],callback:function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Array.isArray(n)?n.length<=4&&t.setADSR(n[0],n[1],n[2],n[3]):0==s?t.env.attack=n:1==s?t.env.decay=n:2==s?t.env.sustain=n:3==s&&(t.env.release=n)}}];this.param=this.generateParameters(s),this.createAccessors(this,this.param),this.autocompleteList=s.map((t=>t.name)),setTimeout((()=>{this.loadPreset("default")}),500)}triggerAttack(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=o.Midi(t).toFrequency(),n/=127,s?(this.env.triggerAttack(s),this.frequency.setValueAtTime(t,s),this.velocitySig.setValueAtTime(n,s)):(this.env.triggerAttack(),this.frequency.value=t,this.velocitySig.rampTo(n,.03))}triggerRelease(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?this.env.triggerRelease(t):this.env.triggerRelease()}triggerAttackRelease(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=o.Midi(t).toFrequency(),n/=127,r?(this.env.triggerAttackRelease(s,r),this.frequency.setValueAtTime(t,r),this.velocitySig.setValueAtTime(n,r)):(this.env.triggerAttackRelease(s),this.frequency.value=t,this.velocitySig.rampTo(n,.03))}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=t;const n=l.default.basicLayout,s={};Object.values(this.param).forEach((t=>{s[t.type]||(s[t.type]=[]),s[t.type].push(t)})),Object.keys(s).forEach((t=>{const r=n[t];if(!r)return;if("hidden"===t)return;let o=0;s[t].forEach(((t,n)=>{const s=r.groupA.includes(t.name),a=s?r.controlTypeA:r.controlTypeB,c=s?r.sizeA:r.sizeB;let l=0,h=0;if(Array.isArray(t._value))t._value.forEach(((s,u)=>{l=r.offsets.x*((n+o)%Math.floor(r.boundingBox.width/r.offsets.x)),h=r.offsets.y*Math.floor((n+o)/Math.floor(r.boundingBox.width/r.offsets.x));const d=r.boundingBox.x+l,f=r.boundingBox.y+h;this.createGuiElement(t,{x:d,y:f,size:c,controlType:a,color:r.color,i:u}),o++}));else{l=r.offsets.x*((n+o)%Math.floor(r.boundingBox.width/r.offsets.x)),h=r.offsets.y*Math.floor((n+o)/Math.floor(r.boundingBox.width/r.offsets.x));const s=r.boundingBox.x+l,u=r.boundingBox.y+h;this.createGuiElement(t,{x:s,y:u,size:c,controlType:a,color:r.color})}}))}))}createGuiElement(t,n){let{x:s,y:r,size:o,controlType:a,color:c,i:l=null}=n;if("knob"===a)t.guiElements.push(this.gui.Knob({label:l?t.labels[l]:t.name,min:t.min,max:t.max,value:t._value,size:o,curve:t.curve,x:s,y:r,accentColor:c,callback:n=>t.set(n,l,!0)}));else if("fader"===a)t.guiElements.push(this.gui.Fader({label:l?t.labels[l]:t.name,min:t.min,max:t.max,curve:t.curve,size:o,x:s,y:r,accentColor:c,callback:n=>t.set(n,l,!0)}));else if("radioButton"===a)return Array.isArray(t.radioOptions)&&0!==t.radioOptions.length?this.gui.RadioButton({label:l?t.labels[l]:t.name,radioOptions:t.radioOptions,x:s,y:r+10,accentColor:c,callback:n=>t.set(n)}):(console.warn(`Parameter "${t.name}" has no options defined for radioBox.`),null)}createKnob(t,n,s,r,o,a,c,l){return this.gui.Knob({label:t,min:r,max:o,size:a,accentColor:c,x:n+this.x,y:s+this.y,callback:l,showLabel:1,showValue:0,curve:2,border:2})}savePreset(t){const n={};for(let t of Object.values(this.param))n[t.name]=t._value;console.log(this.presets),this.presets[t]||(this.presets[t]={}),this.presets[t]=n,console.log(`Preset saved under ${this.name}/${t}`)}downloadPresets(){this.presetsData=this.presets;const t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.presetsData,null,2)),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",`${this.name}Presets.json`),document.body.appendChild(n),n.click(),n.remove()}loadPreset(t){this.curPreset=t;const n=this.presets[this.curPreset];if(n){console.log("Loading preset ",this.curPreset);for(let t in n)try{for(let s of Object.values(this.param))this.param[t].set(n[t])}catch(t){console.log(t)}}else console.log("No preset of name ",t)}logPreset(){const t=this.presets[this.curPreset];if(t){let n="Parameters:\n";for(let s in t){const r=t[s];Array.isArray(r)?n+=`${s}: [${r.map((t=>"number"==typeof t?Number(t.toFixed(2)):t)).join(", ")}]\n`:n+="number"==typeof r?`${s}: ${r.toFixed(2)}\n`:`${s}: ${r}\n`}console.log(n)}else console.log("No preset of name ",this.curPreset)}listPresets(){console.log("Synth presets",this.presets)}}n.Twinkle=Twinkle},1174:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MonophonicTemplate=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),o=s(1077),a=s(3941),c=(s(6373),s(1313)),l=s(3447);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.MonophonicTemplate=class MonophonicTemplate{constructor(){this.presets={},this.gui_elements=[],this.gui=null,this.poly_ref=null,this.super=null,this.frequency=new r.Signal,this.env=new r.Envelope,this.type="Synth",this.name="",this.presetsData=null,this.curPreset=null,this.seq=[],this.turingMachine=null,this.callback=(t,n)=>{},this.callbackLoop=new r.Loop((t=>{this.index=Math.floor(o.Theory.ticks/r.Time("16n").toTicks()),this.callback(this.index,null)}),"16n").start(),this.seqToDraw=0,this.drawing=new c.ArrayVisualizer(this,[0],"Canvas",.2),this.drawingLoop=new r.Loop((t=>{if(!0===this.drawing.enabled&&(this.drawing.startVisualFrame(),this.seq[this.seqToDraw])){const t=this.seq[this.seqToDraw];if(t.vals.length>0){const n=Math.floor(o.Theory.ticks/r.Time(t.subdivision).toTicks());this.drawing.visualize(t.vals,n)}}}),"16n").start()}savePreset(t){const n={};for(let t of Object.values(this.gui.elements))n[t.id]=t.value;console.log(this.presets,this.gui),this.presets[t]||(this.presets[t]={}),this.presets[t]=n,console.log(`Preset saved under ${this.name}/${t}`)}downloadPresets(){this.presetsData=this.presets;const t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.presetsData,null,2)),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",`${this.name}Presets.json`),document.body.appendChild(n),n.click(),n.remove()}loadPreset(t){setTimeout((()=>{this.curPreset=t;const n=this.presets[this.curPreset];if(n){console.log("Loading preset ",this.curPreset);for(let t in n)try{for(let s of Object.values(this.gui.elements))s.id===t&&"momentary"!==s.type&&s.set(n[t])}catch(t){console.log(t)}}else console.log("No preset of name ",t)}),50)}logPreset(){const t=this.presets[this.curPreset];if(t){console.log("Preset "+this.curPreset);for(let n in t)try{for(let s of Object.values(this.gui.elements))s.id===n&&"momentary"!==s.type&&console.log(n,t[n])}catch(t){console.log(t)}}else console.log("No preset of name ",this.curPreset)}listPresets(){console.log("Synth presets",this.presets)}triggerAttack(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n/=127,s?(this.frequency.setValueAtTime(r.Midi(t).toFrequency(),s),this.env.triggerAttack(s)):(this.frequency.value=r.Midi(t).toFrequency(),this.env.triggerAttack())}triggerRelease(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.env.triggerRelease(n):this.env.triggerRelease()}triggerAttackRelease(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;console.log("AR ",t,n,s,o),n/=127,o?(this.frequency.setValueAtTime(r.Midi(t).toFrequency(),o),this.env.triggerAttackRelease(s,o)):(this.frequency.value=r.Midi(t).toFrequency(),this.env.triggerAttackRelease(s))}generateParameters(t){const n={};return t.forEach((t=>{const s=new l.Parameter(t);n[t.name]=s})),n}createAccessors(t,n){Object.keys(n).forEach((s=>{const r=n[s];if("function"!=typeof r.set)throw new Error(`Parameter '${s}' does not have a set method`);const o={get:(t,n)=>"string"!=typeof n||isNaN(n)?t.get():t.get(parseInt(n)),set:(t,n,s)=>(console.log(t,n,s),"string"!=typeof n||isNaN(n)?(t.set(s),!0):(t.set(s,parseInt(n)),!0))};Object.defineProperty(t,s,{get:()=>new Proxy(r,o),set:t=>r.set(t)})}))}setParameter(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.param[t];if(!r)throw new Error(`Parameter '${t}' does not exist.`);s?r.callback(n,s):r.callback(n),r.guiElement&&r.guiElement.setValue(n)}get(){let t="Parameters:\n";for(let n in this.param){const s=this.param[n];t+=`${s.name}: ${s._value}\n`}console.log(t)}setADSR(t,n,s,r){this.env&&(this.env.attack=t>.001?t:.001,this.env.decay=n>.01?n:.01,this.env.sustain=Math.abs(s)<1?s:1,this.env.release=r>.01?r:.01)}setFilterADSR(t,n,s,r){this.vcf_env&&(this.vcf_env.attack=t>.001?t:.001,this.vcf_env.decay=n>.01?n:.01,this.vcf_env.sustain=Math.abs(s)<1?s:1,this.vcf_env.release=r>.01?r:.01)}initGui(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.gui=t,this.x=n,this.y=s,this.gui_elements=[]}hideGui(){for(let t=0;t<this.gui_elements.length;t++)this.gui_elements[t].hide=!0}showGui(){for(let t=0;t<this.gui_elements.length;t++)this.gui_elements[t].hide=!1}createKnob(t,n,s,r,o,a,c,l){return this.gui.Knob({label:t,min:r,max:o,size:a,accentColor:c,x:n+this.x,y:s+this.y,callback:l,showLabel:1,showValue:1,curve:2,border:2})}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}disconnect(t){t.input?this.output.disconnect(t.input):this.output.disconnect(t)}sequence(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite";this.seq[s]?this.seq[s].sequence(t,n,r):this.seq[s]=new a.Seq(this,t,n,r,s,this.parseNoteString.bind(this)),this.start(s)}setSeq(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.seq[s]?this.seq[s].setSeq(t,n):this.seq[s]=new a.Seq(this,t,n,"infinite",s,this.parseNoteString.bind(this))}play(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.seq[t]&&this.seq[t].play(n)}expr(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"16n",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.seq[r]||(this.seq[r]=new a.Seq(this,[],s,"infinite",r,this.parseNoteString.bind(this))),this.seq[r].expr(t,n,s)}set velocity(t){for(let n=0;n<10;n++)this.seq[n]&&(this.seq[n].velocity=t)}set octave(t){for(let n=0;n<10;n++)this.seq[n]&&(this.seq[n].octave=t)}set sustain(t){for(let n=0;n<10;n++)this.seq[n]&&(this.seq[n].sustain=t)}set subdivision(t){for(let n=0;n<10;n++)this.seq[n]&&(this.seq[n].subdivision=t)}set transform(t){if("function"==typeof t)for(let n=0;n<10;n++)this.seq[n]&&(this.seq[n].transform=t);else console.warn("Transform must be a function. Received: "+typeof t)}set roll(t){for(let n=0;n<10;n++)this.seq[n]&&(this.seq[n].roll=t)}setTransform(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";if("all"===n)for(let n of this.seq)n&&n.setTransform(t);else this.seq[n]&&this.seq[n].setTransform(t)}get sustain(){const t=this;return new Proxy([],{set(n,s,r){const o=parseInt(s);return isNaN(o)||t.seq[o]&&t.seq[o].setSustain(r),!0}})}get velocity(){const t=this;return new Proxy([],{set(n,s,r){const o=parseInt(s);return isNaN(o)||t.seq[o]&&t.seq[o].setVelocity(r),!0}})}get octave(){const t=this;return new Proxy([],{set(n,s,r){const o=parseInt(s);return isNaN(o)||t.seq[o]&&t.seq[o].setOctave(r),!0}})}get subdivision(){const t=this;return new Proxy([],{set(n,s,r){const o=parseInt(s);return isNaN(o)||t.seq[o]&&t.seq[o].setSubdivision(r),!0}})}get roll(){const t=this;return new Proxy([],{set(n,s,r){const o=parseInt(s);return isNaN(o)||t.seq[o]&&t.seq[o].setRoll(r),!0}})}get transform(){const t=this;return new Proxy([],{set(n,s,r){const o=parseInt(s);return isNaN(o)||t.seq[o]&&t.seq[o].setTransform(r),!0}})}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";if("all"===t){for(let t of this.seq)t&&t.start();this.drawingLoop.start()}else this.seq[t]&&this.seq[t].start()}stop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";if("all"===t){for(let t of this.seq)t&&t.stop();this.drawingLoop.stop()}else this.seq[t]&&this.seq[t].stop()}turing(t){}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.drawing.array,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.drawing.target,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.drawing.ratio;this.drawing=new c.ArrayVisualizer(t,n,s)}getSeqParam(t,n){return Array.isArray(t)?t[n%t.length]:t}parseNoteString(t,n,s,a){if("."===t[0])return;let c="";if(c=/^[a-gA-G]/.test(t[0][0])?(0,o.pitchNameToMidi)(t[0]):(0,o.intervalToMidi)(t[0],this.min,this.max),c<0)return;let l=this.getSeqParam(this.seq[a].octave,s),h=this.getSeqParam(this.seq[a].velocity,s),u=this.getSeqParam(this.seq[a].sustain,s),d=this.getSeqParam(this.seq[a].subdivision,s);try{this.triggerAttackRelease(c+12*l,h,u,n+t[1]*r.Time(d))}catch(s){console.log("invalid note",c+12*l,h,u,n+t[1]*r.Time(d))}}}},1297:t=>{"use strict";t.exports=JSON.parse('{"basicLayout":{"vco":{"color":[150,0,0],"boundingBox":{"x":10,"y":20,"width":30,"height":50},"offsets":{"x":12,"y":30},"groupA":["type"],"controlTypeA":"radioButton","controlTypeB":"knob","sizeA":0.8,"sizeB":0.75,"theme":"dark"},"vcf":{"color":[100,0,150],"boundingBox":{"x":30,"y":20,"width":40,"height":50},"offsets":{"x":10,"y":30},"groupA":["cutoff"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6},"vca":{"color":[100,50,100],"boundingBox":{"x":70,"y":20,"width":30,"height":50},"offsets":{"x":12,"y":0},"groupA":["level"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6},"env":{"color":[20,100,100],"boundingBox":{"x":10,"y":60,"width":50,"height":50},"offsets":{"x":8,"y":300},"groupA":[],"controlTypeA":"knob","controlTypeB":"fader","sizeA":0.8,"sizeB":1.2},"lfo":{"color":[20,0,100],"boundingBox":{"x":50,"y":70,"width":50,"height":50},"offsets":{"x":12,"y":30},"groupA":["rate"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6}}}')},1313:(t,n,s)=>{"use strict";function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.ArrayVisualizer=void 0,function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}r.default=t,s&&s.set(t,r)}(s(5726)),n.ArrayVisualizer=class ArrayVisualizer{constructor(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Canvas",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.4;this.parent=t,this._array=n,this._target=document.getElementById(s),this._ratio=r,this._type="horizontal",this._color=["#FF5733","#33A1FF","#FF33B1","#33FF57","#5733FF","#FFBD33","#33FFBD","#FF3380"],this._backgroundColor="#3C3D37",this._activeColor="#ECDFCC",this._rows=1,this._columns=n.length,this._width=this._target.offsetWidth,this._height=this._width*this._ratio,this.elementWidth=this._width/this._columns,this.elementHeight=this._height/this._rows,this._min=0,this._max=1,this._minActive=0,this._maxActive=1,this._seqNum=0,this._displayLength=8,this._activeLength=8,this._subDivision="16n",this._enabled=!1,this._svg=null,this.index=0}createSVG(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("width",this._width),t.setAttribute("height",this._height),t.setAttribute("class","array-visualizer-svg"),t}clearSVG(){if(this._svg)for(;this._svg.firstChild;)this._svg.removeChild(this._svg.firstChild);const t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("x",0),t.setAttribute("y",0),t.setAttribute("width",this._width),t.setAttribute("height",this._height),t.setAttribute("fill",this._backgroundColor),this._svg.appendChild(t)}startVisualFrame(){this.clearSVG(),this._min=this._minActive,this._max=this._maxActive,this._minActive=null,this._maxActive=null,this._seqNum=0,this._displayLength=this._activeLength,this._activeLength=8}visualize(t,n){switch(Array.isArray(t)&&t.every((t=>Array.isArray(t))),t.length>this._activeLength&&(this._activeLength=t.length),t=this.transformArray(t),this.calculateMinMax(t),n%=t.length,this._type){case"horizontal":this.drawHorizontalLines(n,t);break;case"vertical":this.drawVerticalBars(n,t);break;case"numbers":this.drawNumericValues(n,t);break;default:console.error("Unknown visualization type")}this._seqNum+=1}calculateMinMax(t){const n=t.filter((t=>!isNaN(t)&&""!==t&&null!==t)).map((t=>Number(t))),s=Math.min(...n)-.6,r=Math.max(...n)+.6;(null===this._minActive||s<this._minActive)&&(this._minActive=s),(null===this._maxActive||r>this._maxActive)&&(this._maxActive=r)}transformArray(t){const n={O:-1,o:1,X:0,x:0,1:3,2:2,3:1,"*":4,"^":5},s=["*","O","o","x","X","^"];let r=!1;for(let n in s)r=!!t.includes(s[n])||r;return r?t.map((t=>void 0!==n[t]?n[t]:t)):t}enable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==t&&(this.parent.seqToDraw=t),this.parent.drawingLoop.start(),this._enabled||(this._enabled=!0,this._svg=this.createSVG(),this._target.appendChild(this._svg),this.parent.drawingLoop.start())}disable(){this._enabled&&(this._enabled=!1,this._target&&this._svg&&this._target.contains(this._svg)&&this._target.removeChild(this._svg),this._svg=null)}get type(){return this._type}set type(t){this._type=t}get color(){return this._color}set color(t){this._color=t}get ratio(){return this._ratio}set ratio(t){this._ratio=t,this._height=this._width*this._ratio,this._svg.setAttribute("height",this._height)}get rows(){return this._rows}set rows(t){this._rows=t}get columns(){return this._columns}set columns(t){this._columns=t}get enabled(){return this._enabled}set enabled(t){t?this.enable():this.disable()}drawHorizontalLines(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.elementWidth;(n=n.map((t=>(t-this._min)/(this._max-this._min)))).forEach(((n,r)=>{if("number"==typeof n&&!isNaN(n)){const o=document.createElementNS("http://www.w3.org/2000/svg","line"),a=r*s/this._displayLength,c=(r+1)*s/this._displayLength-2,l=this._height*(1-n);let h=this._height/(this._max-this._min)-2;h<2&&(h=2),o.setAttribute("x1",a),o.setAttribute("x2",c),o.setAttribute("y1",l),o.setAttribute("y2",l),t===r?o.setAttribute("stroke",this._activeColor):o.setAttribute("stroke",this._color[this._seqNum]),o.setAttribute("stroke-width",h),this._svg.appendChild(o)}}))}drawVerticalBars(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.elementWidth;n=n.map((t=>(t-this._min)/(this._max-this._min))),this.clearSVG(),n.forEach(((n,r)=>{if("number"==typeof n&&!isNaN(n)){const o=document.createElementNS("http://www.w3.org/2000/svg","rect"),a=r*(s/this._displayLength),c=n*this._height,l=this._height-c;let h=s/this._displayLength*.98;h=h>4?h-2:h,o.setAttribute("x",a),o.setAttribute("y",l),o.setAttribute("width",h),o.setAttribute("height",c),t===r?o.setAttribute("fill",this._activeColor):o.setAttribute("fill",this._color[this._seqNum]),this._svg.appendChild(o)}}))}drawNumericValues(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.elementWidth,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.elementHeight;const o=Math.ceil(this.this._displayLength/this._rows);n.forEach(((n,a)=>{const c=Math.floor(t/o),l=a%o,h=document.createElementNS("http://www.w3.org/2000/svg","text");h.setAttribute("x",l*s+s/2),h.setAttribute("y",c*r+r/2),t==a?h.setAttribute("fill",this._activeColor):h.setAttribute("fill",this._color),h.setAttribute("font-size","16"),h.setAttribute("text-anchor","middle"),h.setAttribute("alignment-baseline","middle"),h.textContent=Math.round(n),this._svg.appendChild(h)}))}destroy(){this._target&&this._svg&&this._target.contains(this._svg)&&this._target.removeChild(this._svg),this._array=null,this._target=null,this._svg=null}}},1439:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Resonator=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Resonator=class Resonator{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=t,this.input=new o.Multiply(1),this.delay_1=new o.LowpassCombFilter({resonance:.95,dampening:1e4}),this.delay_2=new o.LowpassCombFilter({resonance:.95,dampening:1e4}),this.hpf=new o.Filter({frequency:20,type:"highpass",Q:0}),this.lpf=new o.Filter({frequency:1e4,type:"lowpass",Q:0}),this.vca=new o.Multiply,this.output=new o.Multiply(1),this.env=new o.Envelope,this.hpf_cutoff=new o.Signal(20),this.lpf_cutoff=new o.Signal(2e4),this.hpf_env_depth=new o.Multiply,this.lpf_env_depth=new o.Multiply,this.delayTime=new o.Signal(.1),this.delayTimeScalar=new o.Multiply(1),this.detune=new o.Multiply(1),this.env_depth=new o.Multiply(1),this.direct=new o.Signal(1),this.input.connect(this.delay_1),this.input.connect(this.delay_2),this.delay_1.connect(this.hpf),this.delay_2.connect(this.hpf),this.hpf.connect(this.lpf),this.lpf.connect(this.vca),this.vca.connect(this.output),this.delayTime.connect(this.delayTimeScalar),this.delayTimeScalar.connect(this.delay_1.delayTime),this.delayTimeScalar.connect(this.detune),this.detune.connect(this.delay_2.delayTime),this.hpf_cutoff.connect(this.hpf.frequency),this.lpf_cutoff.connect(this.lpf.frequency),this.env.connect(this.hpf_env_depth.factor),this.env.connect(this.hpf_env_depth.factor),this.hpf_env_depth.connect(this.hpf.frequency),this.lpf_env_depth.connect(this.lpf.frequency),this.env.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.direct.connect(this.vca.factor)}setCutoff=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.lpf_cutoff.setValueAtTime(t,n):this.lpf_cutoff.value=t};setFrequency=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.delayTime.setValueAtTime(1/t,n):this.delayTime.value=1/t};setFeedback=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t=t<0?0:t>.9999?.9999:t,n?(this.delay_1.resonance.setValueAtTime(t,n),this.delay_2.resonance.setValueAtTime(t,n)):(this.delay_1.resonance.value=t,this.delay_2.resonance.value=t)};setADSR(t,n,s,r){this.env.attack=t>.001?t:.001,this.env.decay=n>.01?n:.01,this.env.sustain=Math.abs(s)<1?s:1,this.env.release=r>.01?r:.01}connect(t){this.output.connect(t)}}},1656:t=>{"use strict";t.exports=JSON.parse('{"themes":{"default":{"border":6,"backgroundColor":[240,240,240],"borderColor":[100,100,100],"accentColor":[0,128,255],"textColor":[0,0,0],"labelFont":"Arial","valueFont":"Helvetica","textFont":"Verdana","titleFont":"Verdana","borderRadius":5,"showValue":true},"dark":{"border":3,"backgroundColor":[20,20,20],"borderColor":[50,50,50],"accentColor":[255,0,0],"textColor":[255,255,255],"labelFont":"Helvetica","valueFont":"Arial","textFont":"Verdana","titleFont":"Verdana","borderRadius":8},"custom":{"border":2,"backgroundColor":[255,255,200],"borderColor":[0,128,0],"accentColor":[255,165,0],"textColor":[0,0,0],"labelFont":"Georgia","valueFont":"Courier New","textFont":"Palatino","titleFont":"Verdana","borderRadius":10}}}')},1729:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Spectrogram=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Spectrogram=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;this.target=document.getElementById(t),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.target.offsetWidth,this.height=n,this.canvas.width=this.width,this.canvas.height=this.height,this.target.appendChild(this.canvas),this.context.fillStyle="lightgrey",this.context.fillRect(0,0,this.width,this.height),this.audioContext=window.audioContext||new(window.AudioContext||window.webkitAudioContext),this.analyserNode=this.audioContext.createAnalyser(),this.analyserNode.smoothingTimeConstant=0,this.input=new r.Multiply,this._gain=new r.Signal(.1),this.input.connect(this.analyserNode),this._gain.connect(this.input.factor),this.analyserNode.fftSize=4096,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this._maxFrequency=24e3,this._minFrequency=0,this._timeResolution=2,this.currentX=0,this.running=!1;const getColor=t=>{let n=[255*Math.sin((t/255-.25)*Math.PI*3),t<128?0:255*Math.sin((t-128)/255*Math.PI*1),255*Math.sin(t/255*Math.PI*2.5)];return n=n.map((t=>Math.min(255,Math.max(0,t)))),`rgb(${n[0]}, ${n[1]}, ${n[2]})`};Object.defineProperty(this,"gain",{get:()=>this._gain.value,set:t=>{this._gain.value=t}}),Object.defineProperty(this,"minFrequency",{get:()=>this._minFrequency,set:t=>{this._minFrequency=Math.max(0,Math.min(t,this.maxFrequency))}}),Object.defineProperty(this,"maxFrequency",{get:()=>this._maxFrequency,set:t=>{this._maxFrequency=Math.max(this.minFrequency,Math.min(t,this.audioContext.sampleRate/2))}}),Object.defineProperty(this,"timeResolution",{get:()=>this._timeResolution,set:t=>{this._timeResolution=Math.max(1,t)}}),Object.defineProperty(this,"fftSize",{get:()=>this._timeResolution,set:t=>{Math.log2(t)%1!=0&&(t=Math.pow(2,Math.floor(Math.log2(t))),console.log("FFT size must be a power of two.")),console.log("Setting FFT size to ",t),this.analyserNode.fftSize=t,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength)}}),this.drawSpectrogram=function(){this.analyserNode.getByteFrequencyData(this.dataArray),this.context.clearRect(this.currentX,0,this._timeResolution,this.height);const t=this._maxFrequency-this._minFrequency,n=this.audioContext.sampleRate/2/this.bufferLength,s=Math.floor(this._minFrequency/n),r=Math.ceil(this._maxFrequency/n),o=this.height/(r-s);for(let a=s;a<=r;a++){const s=a*n,r=this.height-Math.floor((s-this._minFrequency)*(this.height/t)),c=this.dataArray[a],l=getColor(c);this.context.fillStyle=l,o>=1?this.context.fillRect(this.currentX,r-o,this._timeResolution,Math.ceil(o)):this.context.fillRect(this.currentX,r,this._timeResolution,1)}this.currentX+=this._timeResolution,this.currentX>=this.width&&(this.currentX=0),this.running&&requestAnimationFrame(this.drawSpectrogram)}.bind(this),this.start=function(){this.running=!0,requestAnimationFrame(this.drawSpectrogram)}.bind(this),this.stop=function(){this.running=!1}.bind(this),this.destroy=function(){this.stop(),this.target.removeChild(this.canvas),this.analyserNode.disconnect(),this.audioContext.close()}.bind(this),this.start()}},1768:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.ESPSynth=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(375),c=s(9710),l=r(s(9212)),h=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class ESPSynth extends h.MonophonicTemplate{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["triangle","sawtooth","square","square","square","noise"],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1,.5,.25,1];super(),this.gui=t,this.presets=l.default,this.name="ESPSynth",this.frequency=new o.Signal,this.pitchshift=new o.Multiply,this.vco=new a.MultiVCO(n,s),this.lfo=(new o.LFO).start(),this.vibratoSwitch=new o.Multiply,this.wahSwitch=new o.Multiply,this.vcf=new o.Filter,this.cutoff=new o.Signal,this.env=new o.Envelope,this.vcfVelocityDepth=new o.Signal(1),this.vcaVelocityDepth=new o.Signal(1),this.vcfEnvDepth=new o.Multiply,this.vcfVelocity=new o.Multiply(1),this.vcaEnvDepth=new o.Multiply,this.vcaVelocity=new o.Multiply(1),this.vca=new o.Multiply,this.output=new o.Multiply(1),this.frequency.connect(this.pitchshift),this.pitchshift.connect(this.vco.frequency),this.pitchshift.value=1,this.vco.connect(this.vcf),this.cutoff.connect(this.vcf.frequency),this.vcf.rolloff=-24,this.vcf.Q.value=1,this.lfo.connect(this.vibratoSwitch),this.vibratoSwitch.connect(this.vco.frequency),this.lfo.connect(this.wahSwitch),this.wahSwitch.connect(this.vcf.frequency),this.env.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcfVelocity),this.vcfVelocity.connect(this.vcf.frequency),this.vcfVelocityDepth.connect(this.vcfVelocity.factor),this.vcf.connect(this.vca),this.vcaEnvDepth.factor.value=1,this.env.connect(this.vcaEnvDepth),this.vcaEnvDepth.connect(this.vcaVelocity),this.vcaVelocity.connect(this.vca.factor),this.vcaVelocityDepth.connect(this.vcaVelocity.factor),this.dist=new o.Distortion,this.vca.connect(this.dist),this.chor=new o.Chorus(2.5,5,.9),this.dist.connect(this.chor),this.chor.connect(this.output),this.velo=10,this.amp=this.velo/127,this.vcfDynamicRange=0,this.vcaDynamicRange=0,null!==this.gui&&(this.initGui(),this.hideGui(),setTimeout((()=>{this.loadPreset("default")}),500))}octaveMapping=t=>void 0===t?1:"4"===t?2:"8"===t?1:"16"===t?.5:void 0;lfoControl=t=>{if(void 0!==t){let n=2*Math.abs(t-.5),s=50;t<.47?(this.lfo.min=-s*n,this.lfo.max=s*n,this.vibratoSwitch.value=1,this.wahSwitch.value=0):t>=.47&&t<=.49?(this.vibratoSwitch.value=0,this.wahSwitch.value=0):t>.49&&(this.lfo.min=0,this.lfo.max=s*n,this.vibratoSwitch.value=0,this.wahSwitch.value=100*n)}};triggerAttack(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=o.Midi(t).toFrequency(),n/=127,s?(this.env.triggerAttack(s),this.frequency.setValueAtTime(t,s),this.vcfVelocityDepth.rampTo((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),.03),this.vcaVelocityDepth.rampTo((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),.03)):(this.env.triggerAttack(),this.frequency.value=t,this.vcfVelocityDepth.rampTo((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),.03),this.vcaVelocityDepth.rampTo((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),.03))}triggerRelease(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?this.env.triggerRelease(t):this.env.triggerRelease()}triggerAttackRelease(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=o.Midi(t).toFrequency(),n/=127,r?(this.env.triggerAttackRelease(s,r),this.frequency.setValueAtTime(t,r),this.vcfVelocityDepth.setValueAtTime((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),r),this.vcaVelocityDepth.setValueAtTime((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),r)):(this.env.triggerAttackRelease(s),this.frequency.value=t,this.vcfVelocityDepth.rampTo((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),.01),this.vcaVelocityDepth.rampTo((0,c.stepper)(n,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),.01))}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}setADSR(t,n,s,r){this.env.attack=t>.001?t:.001,this.env.decay=n>.01?n:.01,this.env.sustain=Math.abs(s)<1?s:1,this.env.release=r>.01?r:.01}setOutputGain(t){this.output.factor.value=t}setVcoGain(t,n){this.vco.setGain(t,n)}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;this.gui=t,this.octave_radio=this.gui.RadioButton({label:"octave",radioOptions:["4","8","16"],callback:t=>this.pitchshift.value=this.octaveMapping(t),x:5,y:50,size:1,orientation:"vertical"}),this.octave_radio.set("8"),this.octave_radio.accentColor=[122,132,132],this.octave_radio.borderColor=[178,192,191],this.triangle_fader=this.gui.Slider({label:"tri",callback:t=>{this.setVcoGain(0,t)},x:11,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.triangle_fader.accentColor=[255,162,1],this.triangle_fader.borderColor=[20,20,20],this.triangle_fader.set(1),this.saw_fader=this.gui.Slider({label:"saw",callback:t=>{this.setVcoGain(1,t)},x:17,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.saw_fader.accentColor=[255,162,1],this.saw_fader.borderColor=[20,20,20],this.saw_fader.set(1),this.square_fader=this.gui.Slider({label:"squ",callback:t=>{this.setVcoGain(2,t)},x:23,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.square_fader.accentColor=[255,162,1],this.square_fader.borderColor=[20,20,20],this.square_fader.set(1),this.octave_down_fader=this.gui.Slider({label:"-1",callback:t=>{this.setVcoGain(3,t)},x:29,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.octave_down_fader.accentColor=[255,162,1],this.octave_down_fader.borderColor=[20,20,20],this.octave_down_fader.set(1),this.two_octave_down_fader=this.gui.Slider({label:"-2",callback:t=>{this.setVcoGain(4,t)},x:35,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.two_octave_down_fader.accentColor=[255,162,1],this.two_octave_down_fader.borderColor=[20,20,20],this.two_octave_down_fader.set(1),this.noise_fader=this.gui.Slider({label:"noise",callback:t=>{this.setVcoGain(5,t)},x:41,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.noise_fader.accentColor=[255,162,1],this.noise_fader.borderColor=[20,20,20],this.noise_fader.set(1),this.lfo_intensity_knob=this.gui.Knob({label:"vib/wah",callback:t=>{this.lfoControl(t)},x:20,y:23,size:1.1,showValue:!1,min:1e-4,max:.95}),this.lfo_intensity_knob.set(.48),this.lfo_intensity_knob.borderColor=[178,192,191],this.lfo_intensity_knob.accentColor=[255,162,1],this.lfo_intensity_knob.border=5,this.lfoControl(.48),this.lfo_speed_knob=this.gui.Knob({label:"speed",callback:t=>{this.lfo.frequency.value=t},x:35,y:23,size:1.1,showValue:!1,min:.01,max:20,curve:2.5}),this.lfo_speed_knob.set(10),this.lfo.frequency.value=10,this.lfo_speed_knob.borderColor=[178,192,191],this.lfo_speed_knob.accentColor=[255,162,1],this.lfo_speed_knob.border=5,this.cutoff_frequency_knob=this.gui.Knob({label:"frequency",callback:t=>{this.cutoff.value=t},x:53,y:25,size:1.4,showValue:!1,min:50,max:2500,curve:2}),this.cutoff_frequency_knob.set(1200),this.cutoff.value=1200,this.cutoff_frequency_knob.borderColor=[178,192,191],this.cutoff_frequency_knob.accentColor=[255,162,1],this.cutoff_frequency_knob.border=5,this.resonance_knob=this.gui.Knob({label:"resonance",callback:t=>{this.vcf.Q.value=t},x:53,y:72,size:1.4,min:.99999,max:18,curve:2,showValue:!1}),this.resonance_knob.set(1),this.vcf.Q.value=1,this.resonance_knob.borderColor=[178,192,191],this.resonance_knob.accentColor=[255,162,1],this.resonance_knob.border=5,this.asdr_int_knob=this.gui.Knob({label:"VCF Env Depth",callback:t=>{this.vcfEnvDepth.factor.value=t},x:66,y:34,size:.85,curve:3,min:0,max:5e3,showValue:!1}),this.asdr_int_knob.set(.01),this.asdr_int_knob.borderColor=[178,192,191],this.asdr_int_knob.accentColor=[255,162,1],this.asdr_int_knob.border=5,this.volume_knob=this.gui.Knob({label:"volume",callback:t=>{this.output.factor.value=t},x:66,y:68,size:.85,min:1e-4,max:1.5,showValue:!1}),this.volume_knob.set(1),this.output.factor.value=1,this.volume_knob.borderColor=[178,192,191],this.volume_knob.accentColor=[255,162,1],this.volume_knob.border=5,this.velocity_filter_knob=this.gui.Knob({label:"velo filter",callback:t=>{this.vcfDynamicRange=t},x:77,y:15,size:.85,min:.01,max:.99,showValue:!1}),this.velocity_filter_knob.set(.99),this.velocity_filter_knob.borderColor=[178,192,191],this.velocity_filter_knob.accentColor=[255,162,1],this.velocity_filter_knob.border=5,this.velocity_volume_knob=this.gui.Knob({label:"velo volume",callback:t=>{this.vcaDynamicRange=t},x:77,y:83,size:.85,min:.01,max:.99,showValue:!1}),this.velocity_volume_knob.set(.99),this.velocity_volume_knob.borderColor=[178,192,191],this.velocity_volume_knob.accentColor=[255,162,1],this.velocity_volume_knob.border=5,this.attack_fader=this.gui.Slider({label:"A",callback:t=>{this.env.attack=t},x:76,y:36,size:1,curve:2,min:.01,max:10,orientation:"vertical",showValue:!1}),this.attack_fader.accentColor=[255,162,1],this.attack_fader.borderColor=[20,20,20],this.env.attack=.1,this.attack_fader.set(.1),this.decay_fader=this.gui.Slider({label:"D",callback:t=>{this.env.decay=t},x:82,y:36,size:1,curve:2,min:.01,max:10,orientation:"vertical",showValue:!1}),this.decay_fader.accentColor=[255,162,1],this.decay_fader.borderColor=[20,20,20],this.env.decay=.1,this.decay_fader.set(.1),this.sustain_fader=this.gui.Slider({label:"S",callback:t=>{this.env.sustain=t},x:88,y:36,size:1,min:1e-4,max:1,orientation:"vertical",showValue:!1}),this.sustain_fader.accentColor=[255,162,1],this.sustain_fader.borderColor=[20,20,20],this.sustain_fader.set(1),this.env.sustain=1,this.release_fader=this.gui.Slider({label:"R",callback:t=>{this.env.release=t},x:94,y:36,size:1,min:.1,max:20,curve:2,orientation:"vertical",showValue:!1}),this.release_fader.accentColor=[255,162,1],this.release_fader.borderColor=[20,20,20],this.release_fader.set(1),this.env.release=1,this.chorus_filter_knob=this.gui.Knob({label:"chorus",callback:t=>{this.chor.wet.value=t},x:91,y:15,size:.85,min:1e-4,max:1,showValue:!1}),this.chorus_filter_knob.set(1e-4),this.chorus_filter_knob.borderColor=[178,192,191],this.chorus_filter_knob.accentColor=[255,162,1],this.chorus_filter_knob.border=5,this.dist_volume_knob=this.gui.Knob({label:"Overdrive",callback:t=>{this.dist.distortion=t},x:91,y:83,size:.85,min:1e-4,max:1,showValue:!1}),this.dist_volume_knob.set(1e-4),this.dist_volume_knob.borderColor=[178,192,191],this.dist_volume_knob.accentColor=[255,162,1],this.dist_volume_knob.border=5,this.gui_elements=[this.octave_radio,this.triangle_fader,this.saw_fader,this.square_fader,this.octave_down_fader,this.two_octave_down_fader,this.noise_fader,this.lfo_intensity_knob,this.lfo_speed_knob,this.cutoff_frequency_knob,this.resonance_knob,this.asdr_int_knob,this.volume_knob,this.velocity_filter_knob,this.velocity_volume_knob,this.attack_fader,this.decay_fader,this.sustain_fader,this.release_fader,this.chorus_filter_knob,this.dist_volume_knob]}}n.ESPSynth=ESPSynth},1951:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Oscilloscope=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Oscilloscope=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4;this.target=document.getElementById(t),this.width=this.target.offsetWidth,this.height=this.width*n,this.wave=document.createElementNS("http://www.w3.org/2000/svg","path"),this.wave.setAttribute("class","oscilloscope__wave"),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("width",this.width),this.svg.setAttribute("height",this.height),this.svg.setAttribute("class","oscilloscope__svg"),this.svg.appendChild(this.wave),this.target.appendChild(this.svg),this.audioContext=window.audioContext,this.running=!0,this.hasAudio=!1,this.input=new r.Multiply,this.gain=new r.Signal(1),this.analyserNode=this.audioContext.createAnalyser(),this.input.connect(this.analyserNode),this.gain.connect(this.input.factor),this.analyserNode.fftSize=2048,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.yScaling=1,this.xScaling=2,this.zoom=1.25,this.enableTrigger=1,this.threshold=128,this.constructor=function(){this.start(),console.log("Oscilloscope started")},this.setFftSize=function(t){Math.log2(t)%1!=0&&(t=Math.pow(2,Math.floor(Math.log2(t))),console.log("FFT size must be a power of two.")),console.log("Setting FFT size to",t),this.analyserNode.fftSize=t,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength)}.bind(this),this.drawWave=function(){var t="M";this.analyserNode.getByteTimeDomainData(this.dataArray);var n=0;let s=this.threshold<=1?128*this.threshold+127:this.threshold;for(var r=1;r<this.bufferLength;r++)if(this.dataArray[r]>s&&this.dataArray[r-1]<=s){n=r;break}0===this.enableTrigger&&(n=0);let o=0,a=this.height/2;for(t+=`${o} ${a}, `,this.xScaling=this.zoom<.1?.2:2*this.zoom,r=0;r<this.bufferLength-n;r++){let s=(255-this.dataArray[r+n])*(1/this.yScaling);if(o=this.width/this.bufferLength*r*this.xScaling,a=this.height/2*(s/128),o>this.width-10)break;t+=`${o} ${a}, `}this.wave.setAttribute("d",t),this.wave.setAttribute("stroke","black"),this.wave.setAttribute("stroke-width","2"),this.wave.setAttribute("fill","none"),this.running&&window.requestAnimationFrame(this.drawWave)}.bind(this),this.start=function(){this.running=!0,window.requestAnimationFrame(this.drawWave)}.bind(this),this.stop=function(){this.running=!1}.bind(this),this.disconnect=function(){this.target.removeChild(this.svg)}.bind(this),this.connect=function(t){this.target=document.getElementById(t),this.target.appendChild(this.svg)}.bind(this),this.destroy=function(){this.stop(),setTimeout((()=>{this.target.contains(this.svg)&&this.target.removeChild(this.svg),this.analyserNode.disconnect(),this.input.disconnect(),this.gain.dispose(),this.target=null,this.wave=null,this.svg=null,this.audioContext=null,this.input=null,this.gain=null,this.analyserNode=null,this.dataArray=null,console.log("Oscilloscope destroyed.")}),100)}.bind(this),this.start()}},2049:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Snare=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Snare=class Snare{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.name="Snare",this.gui=n,this.output=new o.Multiply(1),this.vco1=new o.Oscillator(t).start(),this.vco2=new o.Oscillator(t+150).start(),this.vca1=new o.Multiply(.5),this.headsEnvelope=new o.Envelope({attack:.001,decay:.1,sustain:0,release:.1}),this.vco1.connect(this.vca1),this.vco2.connect(this.vca1),this.headsEnvelope.connect(this.vca1.factor),this.vca1.connect(this.output),this.rattle=new o.Noise("white").start(),this.ratFilter=new o.Filter({type:"bandpass",frequency:1500,Q:1}),this.vca2=new o.Multiply(.5),this.ratEnvelope=new o.Envelope({attack:.001,decay:.2,sustain:0,release:.1}),this.rattle.connect(this.ratFilter),this.ratFilter.connect(this.vca2),this.ratEnvelope.connect(this.vca2.factor),this.vca2.connect(this.output)}trigger(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?(this.ratEnvelope.triggerAttackRelease(.01,t),this.headsEnvelope.triggerAttackRelease(.01,t)):(this.ratEnvelope.triggerAttackRelease(.01),this.headsEnvelope.triggerAttackRelease(.01))}}},2075:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.timingManager=n.default=void 0;var r=s(9762),o=s(2271),a=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class TimingManager{constructor(){this.timingObject=null,this.intervalId=null,this.shouldBeUsed=!1}async initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AspCEtTZLHqHgw3KfHav";return this.timingObject?Promise.resolve(this):new Promise((n=>{this.timingObject=new r.TimingObject(new o.TimingProvider(t));const resolveWhenOpen=()=>{this.timingObject.removeEventListener("readystatechange",resolveWhenOpen),"open"===this.timingObject.readyState&&n(this)};this.timingObject.addEventListener("readystatechange",resolveWhenOpen)}))}setShouldUse(){this.shouldBeUsed=!0,this.timingObject&&"open"===this.timingObject.readyState&&this.setupEventListeners()}setupEventListeners(){this.timingObject.addEventListener("change",(()=>{if(!this.shouldBeUsed)return;const{velocity:t}=this.timingObject.query();0===t?this.stopTimer():null===this.intervalId?this.startTimer():this.restartTimer()}))}translateVector(t){let{acceleration:n,position:s,timestamp:r,velocity:o}=t;if(0!==n)throw new Error("Acceleration other than zero is not supported.");return{position:s+o*(performance.now()/1e3-r),velocity:o}}convertBpmToVelocity(t){return t/60}updateTransport(){if(!this.shouldBeUsed)return;const{position:t,velocity:n}=this.translateVector(this.timingObject.query());0!==n&&(a.getTransport().seconds=t/n,a.getTransport().bpm.value=60*n)}startTimer(){this.shouldBeUsed&&("stopped"===a.getTransport().state&&a.getTransport().start(),this.updateTransport(),this.intervalId=setInterval((()=>this.updateTransport()),2e3))}stopTimer(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.shouldBeUsed&&(null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),t&&a.getTransport().stop())}restartTimer(){this.shouldBeUsed&&(this.stopTimer(),this.startTimer())}updateVelocity(t){return this.shouldBeUsed?this.timingObject.update({velocity:this.convertBpmToVelocity(t)}):Promise.resolve()}isMoving(){const{velocity:t}=this.timingObject.query();return 0!==t}}n.timingManager=new TimingManager,n.default=TimingManager},2188:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Simpler=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=r(s(3670)),c=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class Simpler extends c.MonophonicTemplate{constructor(t){super(),this.presets=a.default,this.name="Simpler",this.sampler=new o.Sampler,this.vcf=new o.Filter,this.vca=new o.Multiply(1),this.output=new o.Multiply(1),this.cutoffSig=new o.Signal(1e4),this.cutoffSig.connect(this.vcf.frequency),this.vcf.frequency.value=1e4,this.vcf.rolloff=-12,this.vcf.Q.value=1,this.filterEnv=new o.Envelope,this.vcfEnvDepth=new o.Multiply,this.filterEnv.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcf.frequency),this.vcf.connect(this.vca),this.vca.connect(this.output),this.sample="";let n=[{name:"volume",min:-36,max:0,curve:1,callback:t=>{this.sampler.volume.value=Math.pow(10,t/20)}},{name:"attack",min:.01,max:1,curve:2,callback:t=>{this.sampler.attack=t}},{name:"release",min:.01,max:10,curve:2,callback:t=>{this.sampler.release=t}},{name:"cutoff",min:100,max:1e4,curve:2,callback:t=>this.cutoffSig.value=t},{name:"Q",min:0,max:20,curve:2,callback:t=>this.vcf.Q.value=t},{name:"filterEnvDepth",min:0,max:5e3,curve:2,callback:t=>this.vcfEnvDepth.factor.value=t}];this.param=this.generateParameters(n),this.createAccessors(this,this.param),this.sampleFiles={bell:["C4","berklee/bell_1.mp3"],bell1:["C4","berklee/bell_1a.mp3"],bell2:["C4","berklee/bell_2a.mp3"],bell3:["C4","berklee/bell_mallet_2.mp3"],horn:["C4","berklee/casiohorn2.mp3"],chotone:["C4","berklee/chotone_c4_!.mp3"],voice:["C4","berklee/femalevoice_aa_Db4.mp3"],kalimba:["C4","berklee/Kalimba_1.mp3"],dreamyPiano:["A5","salamander/A5.mp3"],softPiano:["A4","salamander/A4.mp3"],piano:[45,"salamander/A3.mp3"],casio:["C4","casio/C2.mp3"]},t&&this.loadSample(t)}load(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.loadSample(t)}loadSample(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.sampler&&(this.sampler.dispose(),this.sampler.releaseAll()),null===t)return void this.loadSampleToSampler();if("number"==typeof t){const n=Object.keys(this.sampleFiles);t=Math.floor(t)%n.length,t=n[t]}if(!(t in this.sampleFiles))return void console.error(`The sample "${t}" is not available.`);console.log(`Simpler loading ${t}`),this.sample=t,this.baseUrl="https://tonejs.github.io/audio/";const n=this.sampleFiles[this.sample][1],s=this.sampleFiles[this.sample][0];console.log(s,n),this.sampler=new o.Sampler({urls:{60:this.baseUrl.concat(n)}}).connect(this.vcf)}listSamples(){const t=Object.keys(this.sampleFiles);console.log(t)}triggerAttack(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.sampler.release=this.release,t=o.Midi(t).toFrequency(),n/=127,s?(this.sampler.triggerAttack(t,s,n),this.filterEnv.triggerAttack(s),this.vca.factor.setValueAtTime(n,s)):(this.sampler.triggerAttack(t),this.filterEnv.triggerAttack(),this.vca.factor.value=n)}triggerRelease(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t=o.Midi(t).toFrequency(),n?(this.sampler.triggerRelease(t,n),this.filterEnv.triggerRelease(n)):(this.sampler.triggerRelease(t),this.filterEnv.triggerRelease())}triggerAttackRelease(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.param.release=this.release,t=o.Midi(t).toFrequency(),n/=127,console.log(t,n,s),r&&(this.sampler.triggerAttackRelease(t,s,r,n),this.filterEnv.triggerAttackRelease(s,r),this.vca.factor.setValueAtTime(n,r))}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}setADSR(t,n,s,r){this.sampler.attack=t>.001?t:.001,this.sampler.release=r>.01?r:.01}loadSampleToSampler(){const t=document.createElement("input");t.type="file",t.accept="audio/*",t.onchange=t=>{const n=t.target.files[0];if(!n)return void console.log("No file selected");const s=new FileReader;s.onload=()=>{this.sampler=new o.Sampler({urls:{60:s.result}}).connect(this.vcf),console.log("Audio loaded into sampler")},s.readAsDataURL(n)},t.click()}}n.Simpler=Simpler},2271:(t,n,s)=>{"use strict";s.r(n),s.d(n,{TimingProvider:()=>ee});var r=s(9762),extendStatics=function(t,n){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},extendStatics(t,n)};function __extends(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=t}extendStatics(t,n),t.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}function __generator(t,n){var s,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},c=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return c.next=verb(0),c.throw=verb(1),c.return=verb(2),"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function verb(l){return function(h){return function step(l){if(s)throw new TypeError("Generator is already executing.");for(;c&&(c=0,l[0]&&(a=0)),a;)try{if(s=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){a.label=l[1];break}if(6===l[0]&&a.label<o[1]){a.label=o[1],o=l;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(l);break}o[2]&&a.ops.pop(),a.trys.pop();continue}l=n.call(t,a)}catch(t){l=[6,t],r=0}finally{s=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,h])}}}function __values(t){var n="function"==typeof Symbol&&Symbol.iterator,s=n&&t[n],r=0;if(s)return s.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(t,n){var s="function"==typeof Symbol&&t[Symbol.iterator];if(!s)return t;var r,o,a=s.call(t),c=[];try{for(;(void 0===n||n-- >0)&&!(r=a.next()).done;)c.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(s=a.return)&&s.call(a)}finally{if(o)throw o.error}}return c}function __spreadArray(t,n,s){if(s||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))}function __await(t){return this instanceof __await?(this.v=t,this):new __await(t)}function isFunction(t){return"function"==typeof t}function createErrorClass(t){var n=t((function(t){Error.call(t),t.stack=(new Error).stack}));return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var o=createErrorClass((function(t){return function UnsubscriptionErrorImpl(n){t(this),this.message=n?n.length+" errors occurred during unsubscription:\n"+n.map((function(t,n){return n+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=n}}));function arrRemove(t,n){if(t){var s=t.indexOf(n);0<=s&&t.splice(s,1)}}var a=function(){function Subscription(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return Subscription.prototype.unsubscribe=function(){var t,n,s,r,a;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var l=__values(c),h=l.next();!h.done;h=l.next())h.value.remove(this)}catch(n){t={error:n}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}else c.remove(this);var u=this.initialTeardown;if(isFunction(u))try{u()}catch(t){a=t instanceof o?t.errors:[t]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=__values(d),v=f.next();!v.done;v=f.next()){var g=v.value;try{execFinalizer(g)}catch(t){a=null!=a?a:[],t instanceof o?a=__spreadArray(__spreadArray([],__read(a)),__read(t.errors)):a.push(t)}}}catch(t){s={error:t}}finally{try{v&&!v.done&&(r=f.return)&&r.call(f)}finally{if(s)throw s.error}}}if(a)throw new o(a)}},Subscription.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)execFinalizer(t);else{if(t instanceof Subscription){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},Subscription.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},Subscription.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},Subscription.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&arrRemove(n,t)},Subscription.prototype.remove=function(t){var n=this._finalizers;n&&arrRemove(n,t),t instanceof Subscription&&t._removeParent(this)},Subscription.EMPTY=((t=new Subscription).closed=!0,t),Subscription;var t}(),c=a.EMPTY;function isSubscription(t){return t instanceof a||t&&"closed"in t&&isFunction(t.remove)&&isFunction(t.add)&&isFunction(t.unsubscribe)}function execFinalizer(t){isFunction(t)?t():t.unsubscribe()}var l=null,h=null,u=void 0,d=!1,f=!1,v={setTimeout:function(t,n){for(var s=[],r=2;r<arguments.length;r++)s[r-2]=arguments[r];var o=v.delegate;return(null==o?void 0:o.setTimeout)?o.setTimeout.apply(o,__spreadArray([t,n],__read(s))):setTimeout.apply(void 0,__spreadArray([t,n],__read(s)))},clearTimeout:function(t){var n=v.delegate;return((null==n?void 0:n.clearTimeout)||clearTimeout)(t)},delegate:void 0};function reportUnhandledError(t){v.setTimeout((function(){if(!l)throw t;l(t)}))}function noop(){}var g=createNotification("C",void 0,void 0);function createNotification(t,n,s){return{kind:t,value:n,error:s}}var m=null;function errorContext(t){if(d){var n=!m;if(n&&(m={errorThrown:!1,error:null}),t(),n){var s=m,r=s.errorThrown,o=s.error;if(m=null,r)throw o}}else t()}var y=function(t){function Subscriber(n){var s=t.call(this)||this;return s.isStopped=!1,n?(s.destination=n,isSubscription(n)&&n.add(s)):s.destination=k,s}return __extends(Subscriber,t),Subscriber.create=function(t,n,s){return new w(t,n,s)},Subscriber.prototype.next=function(t){this.isStopped?handleStoppedNotification(function nextNotification(t){return createNotification("N",t,void 0)}(t),this):this._next(t)},Subscriber.prototype.error=function(t){this.isStopped?handleStoppedNotification(function errorNotification(t){return createNotification("E",void 0,t)}(t),this):(this.isStopped=!0,this._error(t))},Subscriber.prototype.complete=function(){this.isStopped?handleStoppedNotification(g,this):(this.isStopped=!0,this._complete())},Subscriber.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},Subscriber.prototype._next=function(t){this.destination.next(t)},Subscriber.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},Subscriber.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},Subscriber}(a),b=Function.prototype.bind;function bind(t,n){return b.call(t,n)}var _=function(){function ConsumerObserver(t){this.partialObserver=t}return ConsumerObserver.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(t){handleUnhandledError(t)}},ConsumerObserver.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(t){handleUnhandledError(t)}else handleUnhandledError(t)},ConsumerObserver.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){handleUnhandledError(t)}},ConsumerObserver}(),w=function(t){function SafeSubscriber(n,s,r){var o,a,c=t.call(this)||this;return isFunction(n)||!n?o={next:null!=n?n:void 0,error:null!=s?s:void 0,complete:null!=r?r:void 0}:c&&f?((a=Object.create(n)).unsubscribe=function(){return c.unsubscribe()},o={next:n.next&&bind(n.next,a),error:n.error&&bind(n.error,a),complete:n.complete&&bind(n.complete,a)}):o=n,c.destination=new _(o),c}return __extends(SafeSubscriber,t),SafeSubscriber}(y);function handleUnhandledError(t){d?function captureError(t){d&&m&&(m.errorThrown=!0,m.error=t)}(t):reportUnhandledError(t)}function handleStoppedNotification(t,n){var s=h;s&&v.setTimeout((function(){return s(t,n)}))}var k={closed:!0,next:noop,error:function defaultErrorHandler(t){throw t},complete:noop},x="function"==typeof Symbol&&Symbol.observable||"@@observable";function identity(t){return t}var S=function(){function Observable(t){t&&(this._subscribe=t)}return Observable.prototype.lift=function(t){var n=new Observable;return n.source=this,n.operator=t,n},Observable.prototype.subscribe=function(t,n,s){var r=this,o=function isSubscriber(t){return t&&t instanceof y||function isObserver(t){return t&&isFunction(t.next)&&isFunction(t.error)&&isFunction(t.complete)}(t)&&isSubscription(t)}(t)?t:new w(t,n,s);return errorContext((function(){var t=r,n=t.operator,s=t.source;o.add(n?n.call(o,s):s?r._subscribe(o):r._trySubscribe(o))})),o},Observable.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},Observable.prototype.forEach=function(t,n){var s=this;return new(n=getPromiseCtor(n))((function(n,r){var o=new w({next:function(n){try{t(n)}catch(t){r(t),o.unsubscribe()}},error:r,complete:n});s.subscribe(o)}))},Observable.prototype._subscribe=function(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)},Observable.prototype[x]=function(){return this},Observable.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function pipeFromArray(t){return 0===t.length?identity:1===t.length?t[0]:function piped(n){return t.reduce((function(t,n){return n(t)}),n)}}(t)(this)},Observable.prototype.toPromise=function(t){var n=this;return new(t=getPromiseCtor(t))((function(t,s){var r;n.subscribe((function(t){return r=t}),(function(t){return s(t)}),(function(){return t(r)}))}))},Observable.create=function(t){return new Observable(t)},Observable}();function getPromiseCtor(t){var n;return null!==(n=null!=t?t:u)&&void 0!==n?n:Promise}var C=createErrorClass((function(t){return function ObjectUnsubscribedErrorImpl(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),M=function(t){function Subject(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return __extends(Subject,t),Subject.prototype.lift=function(t){var n=new O(this,this);return n.operator=t,n},Subject.prototype._throwIfClosed=function(){if(this.closed)throw new C},Subject.prototype.next=function(t){var n=this;errorContext((function(){var s,r;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var o=__values(n.currentObservers),a=o.next();!a.done;a=o.next())a.value.next(t)}catch(t){s={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}}}))},Subject.prototype.error=function(t){var n=this;errorContext((function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var s=n.observers;s.length;)s.shift().error(t)}}))},Subject.prototype.complete=function(){var t=this;errorContext((function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}}))},Subject.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(Subject.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),Subject.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},Subject.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},Subject.prototype._innerSubscribe=function(t){var n=this,s=this,r=s.hasError,o=s.isStopped,l=s.observers;return r||o?c:(this.currentObservers=null,l.push(t),new a((function(){n.currentObservers=null,arrRemove(l,t)})))},Subject.prototype._checkFinalizedStatuses=function(t){var n=this,s=n.hasError,r=n.thrownError,o=n.isStopped;s?t.error(r):o&&t.complete()},Subject.prototype.asObservable=function(){var t=new S;return t.source=this,t},Subject.create=function(t,n){return new O(t,n)},Subject}(S),O=function(t){function AnonymousSubject(n,s){var r=t.call(this)||this;return r.destination=n,r.source=s,r}return __extends(AnonymousSubject,t),AnonymousSubject.prototype.next=function(t){var n,s;null===(s=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===s||s.call(n,t)},AnonymousSubject.prototype.error=function(t){var n,s;null===(s=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===s||s.call(n,t)},AnonymousSubject.prototype.complete=function(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)},AnonymousSubject.prototype._subscribe=function(t){var n,s;return null!==(s=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==s?s:c},AnonymousSubject}(M);function operate(t){return function(n){if(function hasLift(t){return isFunction(null==t?void 0:t.lift)}(n))return n.lift((function(n){try{return t(n,this)}catch(t){this.error(t)}}));throw new TypeError("Unable to lift unknown Observable type")}}function createOperatorSubscriber(t,n,s,r,o){return new T(t,n,s,r,o)}var T=function(t){function OperatorSubscriber(n,s,r,o,a,c){var l=t.call(this,n)||this;return l.onFinalize=a,l.shouldUnsubscribe=c,l._next=s?function(t){try{s(t)}catch(t){n.error(t)}}:t.prototype._next,l._error=o?function(t){try{o(t)}catch(t){n.error(t)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=r?function(){try{r()}catch(t){n.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,l}return __extends(OperatorSubscriber,t),OperatorSubscriber.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var s=this.closed;t.prototype.unsubscribe.call(this),!s&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}},OperatorSubscriber}(y);function map(t,n){return operate((function(s,r){var o=0;s.subscribe(createOperatorSubscriber(r,(function(s){r.next(t.call(n,s,o++))})))}))}var isArrayLike=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function isPromise(t){return isFunction(null==t?void 0:t.then)}function isInteropObservable(t){return isFunction(t[x])}function isAsyncIterable(t){return Symbol.asyncIterator&&isFunction(null==t?void 0:t[Symbol.asyncIterator])}function createInvalidObservableTypeError(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var q=function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function isIterable(t){return isFunction(null==t?void 0:t[q])}function readableStreamLikeToAsyncGenerator(t){return function __asyncGenerator(t,n,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=s.apply(t,n||[]),a=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),verb("next"),verb("throw"),verb("return",(function awaitReturn(t){return function(n){return Promise.resolve(n).then(t,reject)}})),r[Symbol.asyncIterator]=function(){return this},r;function verb(t,n){o[t]&&(r[t]=function(n){return new Promise((function(s,r){a.push([t,n,s,r])>1||resume(t,n)}))},n&&(r[t]=n(r[t])))}function resume(t,n){try{!function step(t){t.value instanceof __await?Promise.resolve(t.value.v).then(fulfill,reject):settle(a[0][2],t)}(o[t](n))}catch(t){settle(a[0][3],t)}}function fulfill(t){resume("next",t)}function reject(t){resume("throw",t)}function settle(t,n){t(n),a.shift(),a.length&&resume(a[0][0],a[0][1])}}(this,arguments,(function readableStreamLikeToAsyncGenerator_1(){var n,s,r;return __generator(this,(function(o){switch(o.label){case 0:n=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,__await(n.read())];case 3:return s=o.sent(),r=s.value,s.done?[4,__await(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,__await(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}}))}))}function isReadableStreamLike(t){return isFunction(null==t?void 0:t.getReader)}function innerFrom(t){if(t instanceof S)return t;if(null!=t){if(isInteropObservable(t))return function fromInteropObservable(t){return new S((function(n){var s=t[x]();if(isFunction(s.subscribe))return s.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")}))}(t);if(isArrayLike(t))return function fromArrayLike(t){return new S((function(n){for(var s=0;s<t.length&&!n.closed;s++)n.next(t[s]);n.complete()}))}(t);if(isPromise(t))return function fromPromise(t){return new S((function(n){t.then((function(t){n.closed||(n.next(t),n.complete())}),(function(t){return n.error(t)})).then(null,reportUnhandledError)}))}(t);if(isAsyncIterable(t))return fromAsyncIterable(t);if(isIterable(t))return function fromIterable(t){return new S((function(n){var s,r;try{for(var o=__values(t),a=o.next();!a.done;a=o.next()){var c=a.value;if(n.next(c),n.closed)return}}catch(t){s={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}n.complete()}))}(t);if(isReadableStreamLike(t))return function fromReadableStreamLike(t){return fromAsyncIterable(readableStreamLikeToAsyncGenerator(t))}(t)}throw createInvalidObservableTypeError(t)}function fromAsyncIterable(t){return new S((function(n){(function process(t,n){var s,r,o,a;return function __awaiter(t,n,s,r){return new(s||(s=Promise))((function(o,a){function fulfilled(t){try{step(r.next(t))}catch(t){a(t)}}function rejected(t){try{step(r.throw(t))}catch(t){a(t)}}function step(t){t.done?o(t.value):function adopt(t){return t instanceof s?t:new s((function(n){n(t)}))}(t.value).then(fulfilled,rejected)}step((r=r.apply(t,n||[])).next())}))}(this,void 0,void 0,(function(){var c,l;return __generator(this,(function(h){switch(h.label){case 0:h.trys.push([0,5,6,11]),s=function __asyncValues(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=t[Symbol.asyncIterator];return s?s.call(t):(t=__values(t),n={},verb("next"),verb("throw"),verb("return"),n[Symbol.asyncIterator]=function(){return this},n);function verb(s){n[s]=t[s]&&function(n){return new Promise((function(r,o){!function settle(t,n,s,r){Promise.resolve(r).then((function(n){t({value:n,done:s})}),n)}(r,o,(n=t[s](n)).done,n.value)}))}}}(t),h.label=1;case 1:return[4,s.next()];case 2:if((r=h.sent()).done)return[3,4];if(c=r.value,n.next(c),n.closed)return[2];h.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=h.sent(),o={error:l},[3,11];case 6:return h.trys.push([6,,9,10]),r&&!r.done&&(a=s.return)?[4,a.call(s)]:[3,8];case 7:h.sent(),h.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return n.complete(),[2]}}))}))})(t,n).catch((function(t){return n.error(t)}))}))}function executeSchedule(t,n,s,r,o){void 0===r&&(r=0),void 0===o&&(o=!1);var a=n.schedule((function(){s(),o?t.add(this.schedule(null,r)):this.unsubscribe()}),r);if(t.add(a),!o)return a}function mergeMap(t,n,s){return void 0===s&&(s=Infinity),isFunction(n)?mergeMap((function(s,r){return map((function(t,o){return n(s,t,r,o)}))(innerFrom(t(s,r)))}),s):("number"==typeof n&&(s=n),operate((function(n,r){return function mergeInternals(t,n,s,r,o,a,c,l){var h=[],u=0,d=0,f=!1,checkComplete=function(){!f||h.length||u||n.complete()},outerNext=function(t){return u<r?doInnerSub(t):h.push(t)},doInnerSub=function(t){a&&n.next(t),u++;var l=!1;innerFrom(s(t,d++)).subscribe(createOperatorSubscriber(n,(function(t){null==o||o(t),a?outerNext(t):n.next(t)}),(function(){l=!0}),void 0,(function(){if(l)try{u--;for(var _loop_1=function(){var t=h.shift();c?executeSchedule(n,c,(function(){return doInnerSub(t)})):doInnerSub(t)};h.length&&u<r;)_loop_1();checkComplete()}catch(t){n.error(t)}})))};return t.subscribe(createOperatorSubscriber(n,outerNext,(function(){f=!0,checkComplete()}))),function(){null==l||l()}}(n,r,t,s)})))}function mergeAll(t){return void 0===t&&(t=Infinity),mergeMap(identity,t)}var R=new S((function(t){return t.complete()}));function isScheduler(t){return t&&isFunction(t.schedule)}function last(t){return t[t.length-1]}function popResultSelector(t){return isFunction(last(t))?t.pop():void 0}function popScheduler(t){return isScheduler(last(t))?t.pop():void 0}function observeOn(t,n){return void 0===n&&(n=0),operate((function(s,r){s.subscribe(createOperatorSubscriber(r,(function(s){return executeSchedule(r,t,(function(){return r.next(s)}),n)}),(function(){return executeSchedule(r,t,(function(){return r.complete()}),n)}),(function(s){return executeSchedule(r,t,(function(){return r.error(s)}),n)})))}))}function subscribeOn(t,n){return void 0===n&&(n=0),operate((function(s,r){r.add(t.schedule((function(){return s.subscribe(r)}),n))}))}function scheduleAsyncIterable(t,n){if(!t)throw new Error("Iterable cannot be null");return new S((function(s){executeSchedule(s,n,(function(){var r=t[Symbol.asyncIterator]();executeSchedule(s,n,(function(){r.next().then((function(t){t.done?s.complete():s.next(t.value)}))}),0,!0)}))}))}function from(t,n){return n?function scheduled(t,n){if(null!=t){if(isInteropObservable(t))return function scheduleObservable(t,n){return innerFrom(t).pipe(subscribeOn(n),observeOn(n))}(t,n);if(isArrayLike(t))return function scheduleArray(t,n){return new S((function(s){var r=0;return n.schedule((function(){r===t.length?s.complete():(s.next(t[r++]),s.closed||this.schedule())}))}))}(t,n);if(isPromise(t))return function schedulePromise(t,n){return innerFrom(t).pipe(subscribeOn(n),observeOn(n))}(t,n);if(isAsyncIterable(t))return scheduleAsyncIterable(t,n);if(isIterable(t))return function scheduleIterable(t,n){return new S((function(s){var r;return executeSchedule(s,n,(function(){r=t[q](),executeSchedule(s,n,(function(){var t,n,o;try{n=(t=r.next()).value,o=t.done}catch(t){return void s.error(t)}o?s.complete():s.next(n)}),0,!0)})),function(){return isFunction(null==r?void 0:r.return)&&r.return()}}))}(t,n);if(isReadableStreamLike(t))return function scheduleReadableStreamLike(t,n){return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(t),n)}(t,n)}throw createInvalidObservableTypeError(t)}(t,n):innerFrom(t)}function merge(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=popScheduler(t),r=function popNumber(t,n){return"number"==typeof last(t)?t.pop():n}(t,Infinity),o=t;return o.length?1===o.length?innerFrom(o[0]):mergeAll(r)(from(o,s)):R}function throwError(t,n){var s=isFunction(t)?t:function(){return t},init=function(t){return t.error(s())};return new S(n?function(t){return n.schedule(init,0,t)}:init)}function finalize(t){return operate((function(n,s){try{n.subscribe(s)}finally{s.add(t)}}))}const P=Symbol.observable||"@@observable",to_observer_noop=()=>{},rethrow=t=>{throw t},emitNotSupportedError=t=>(t.error(new Error("The required browser API seems to be not supported.")),()=>{}),A="undefined"==typeof window?null:window,E=((t,n)=>{const emptyFunction=()=>{};return t=>{const subscribe=(...s)=>{const r=t((t=>"function"==typeof t[0])(s)?n({next:s[0]}):n(...s));return void 0!==r?r:emptyFunction};return subscribe[Symbol.observable]=()=>({subscribe:(...t)=>({unsubscribe:subscribe(...t)})}),function patch(t){return Symbol.observable||("function"==typeof t&&t.prototype&&t.prototype[Symbol.observable]?(t.prototype[P]=t.prototype[Symbol.observable],delete t.prototype[Symbol.observable]):(t[P]=t[Symbol.observable],delete t[Symbol.observable])),t}(subscribe)}})(0,(function toObserver(t){return t?t.next&&t.error&&t.complete?t:{complete:(t.complete??to_observer_noop).bind(t),error:(t.error??rethrow).bind(t),next:(t.next??to_observer_noop).bind(t)}:{complete:to_observer_noop,error:rethrow,next:to_observer_noop}})),D=(((t,n,s)=>{})(emitNotSupportedError,A,E),(t=>{})(E),(t=>{})(E),(t=>(n,s,r)=>t((t=>{const listener=n=>t.next(n);return n.addEventListener(s,listener,r),()=>n.removeEventListener(s,listener,r)})))(E)),j=((t,n,s)=>()=>s((s=>{if(null===n||void 0===n.navigator||void 0===n.navigator.onLine)return t(s);const emitFalse=()=>s.next(!1),emitTrue=()=>s.next(!0);return n.addEventListener("offline",emitFalse),n.addEventListener("online",emitTrue),s.next(n.navigator.onLine),()=>{n.removeEventListener("offline",emitFalse),n.removeEventListener("online",emitTrue)}})))(emitNotSupportedError,A,E);function concat(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function concatAll(){return mergeAll(1)}()(from(t,popScheduler(t)))}var V=createErrorClass((function(t){return function EmptyErrorImpl(){t(this),this.name="EmptyError",this.message="no elements in sequence"}}));function filter(t,n){return operate((function(s,r){var o=0;s.subscribe(createOperatorSubscriber(r,(function(s){return t.call(n,s,o++)&&r.next(s)})))}))}function take(t){return t<=0?function(){return R}:operate((function(n,s){var r=0;n.subscribe(createOperatorSubscriber(s,(function(n){++r<=t&&(s.next(n),t<=r&&s.complete())})))}))}function defaultErrorFactory(){return new V}function ignoreElements(){return operate((function(t,n){t.subscribe(createOperatorSubscriber(n,noop))}))}function defer(t){return new S((function(n){innerFrom(t()).subscribe(n)}))}function concatMap(t,n){return isFunction(n)?mergeMap(t,n,1):mergeMap(t,1)}function of(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return from(t,popScheduler(t))}var I=function(t){function Action(n,s){return t.call(this)||this}return __extends(Action,t),Action.prototype.schedule=function(t,n){return void 0===n&&(n=0),this},Action}(a),F={setInterval:function(t,n){for(var s=[],r=2;r<arguments.length;r++)s[r-2]=arguments[r];var o=F.delegate;return(null==o?void 0:o.setInterval)?o.setInterval.apply(o,__spreadArray([t,n],__read(s))):setInterval.apply(void 0,__spreadArray([t,n],__read(s)))},clearInterval:function(t){var n=F.delegate;return((null==n?void 0:n.clearInterval)||clearInterval)(t)},delegate:void 0},W=function(t){function AsyncAction(n,s){var r=t.call(this,n,s)||this;return r.scheduler=n,r.work=s,r.pending=!1,r}return __extends(AsyncAction,t),AsyncAction.prototype.schedule=function(t,n){var s;if(void 0===n&&(n=0),this.closed)return this;this.state=t;var r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,n)),this.pending=!0,this.delay=n,this.id=null!==(s=this.id)&&void 0!==s?s:this.requestAsyncId(o,this.id,n),this},AsyncAction.prototype.requestAsyncId=function(t,n,s){return void 0===s&&(s=0),F.setInterval(t.flush.bind(t,this),s)},AsyncAction.prototype.recycleAsyncId=function(t,n,s){if(void 0===s&&(s=0),null!=s&&this.delay===s&&!1===this.pending)return n;null!=n&&F.clearInterval(n)},AsyncAction.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(t,n);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},AsyncAction.prototype._execute=function(t,n){var s,r=!1;try{this.work(t)}catch(t){r=!0,s=t||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s},AsyncAction.prototype.unsubscribe=function(){if(!this.closed){var n=this.id,s=this.scheduler,r=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,arrRemove(r,this),null!=n&&(this.id=this.recycleAsyncId(s,n,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},AsyncAction}(I),z={now:function(){return(z.delegate||Date).now()},delegate:void 0},N=function(){function Scheduler(t,n){void 0===n&&(n=Scheduler.now),this.schedulerActionCtor=t,this.now=n}return Scheduler.prototype.schedule=function(t,n,s){return void 0===n&&(n=0),new this.schedulerActionCtor(this,t).schedule(s,n)},Scheduler.now=z.now,Scheduler}(),B=new(function(t){function AsyncScheduler(n,s){void 0===s&&(s=N.now);var r=t.call(this,n,s)||this;return r.actions=[],r._active=!1,r}return __extends(AsyncScheduler,t),AsyncScheduler.prototype.flush=function(t){var n=this.actions;if(this._active)n.push(t);else{var s;this._active=!0;do{if(s=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,s){for(;t=n.shift();)t.unsubscribe();throw s}}},AsyncScheduler}(N))(W),K=B;function timer(t,n,s){void 0===t&&(t=0),void 0===s&&(s=K);var r=-1;return null!=n&&(isScheduler(n)?s=n:r=n),new S((function(n){var o=function isValidDate(t){return t instanceof Date&&!isNaN(t)}(t)?+t-s.now():t;o<0&&(o=0);var a=0;return s.schedule((function(){n.closed||(n.next(a++),0<=r?this.schedule(void 0,r):n.complete())}),o)}))}function catchError(t){return operate((function(n,s){var r,o=null,a=!1;o=n.subscribe(createOperatorSubscriber(s,void 0,void 0,(function(c){r=innerFrom(t(c,catchError(t)(n))),o?(o.unsubscribe(),o=null,r.subscribe(s)):a=!0}))),a&&(o.unsubscribe(),o=null,r.subscribe(s))}))}function tap(t,n,s){var r=isFunction(t)||n||s?{next:t,error:n,complete:s}:t;return r?operate((function(t,n){var s;null===(s=r.subscribe)||void 0===s||s.call(r);var o=!0;t.subscribe(createOperatorSubscriber(n,(function(t){var s;null===(s=r.next)||void 0===s||s.call(r,t),n.next(t)}),(function(){var t;o=!1,null===(t=r.complete)||void 0===t||t.call(r),n.complete()}),(function(t){var s;o=!1,null===(s=r.error)||void 0===s||s.call(r,t),n.error(t)}),(function(){var t,n;o&&(null===(t=r.unsubscribe)||void 0===t||t.call(r)),null===(n=r.finalize)||void 0===n||n.call(r)})))})):identity}function scanInternals(t,n,s,r,o){return function(a,c){var l=s,h=n,u=0;a.subscribe(createOperatorSubscriber(c,(function(n){var s=u++;h=l?t(h,n,s):(l=!0,n),r&&c.next(h)}),o&&function(){l&&c.next(h),c.complete()}))}}function scan(t,n){return operate(scanInternals(t,n,arguments.length>=2,!0))}var L={connector:function(){return new M}};function connect(t,n){void 0===n&&(n=L);var s=n.connector;return operate((function(n,r){var o=s();innerFrom(t(function fromSubscribable(t){return new S((function(n){return t.subscribe(n)}))}(o))).subscribe(r),r.add(n.subscribe(o))}))}var H=function(t){function ReplaySubject(n,s,r){void 0===n&&(n=Infinity),void 0===s&&(s=Infinity),void 0===r&&(r=z);var o=t.call(this)||this;return o._bufferSize=n,o._windowTime=s,o._timestampProvider=r,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=Infinity===s,o._bufferSize=Math.max(1,n),o._windowTime=Math.max(1,s),o}return __extends(ReplaySubject,t),ReplaySubject.prototype.next=function(n){var s=this,r=s.isStopped,o=s._buffer,a=s._infiniteTimeWindow,c=s._timestampProvider,l=s._windowTime;r||(o.push(n),!a&&o.push(c.now()+l)),this._trimBuffer(),t.prototype.next.call(this,n)},ReplaySubject.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(t),s=this._infiniteTimeWindow,r=this._buffer.slice(),o=0;o<r.length&&!t.closed;o+=s?1:2)t.next(r[o]);return this._checkFinalizedStatuses(t),n},ReplaySubject.prototype._trimBuffer=function(){var t=this,n=t._bufferSize,s=t._timestampProvider,r=t._buffer,o=t._infiniteTimeWindow,a=(o?1:2)*n;if(n<Infinity&&a<r.length&&r.splice(0,r.length-a),!o){for(var c=s.now(),l=0,h=1;h<r.length&&r[h]<=c;h+=2)l=h;l&&r.splice(0,l+1)}},ReplaySubject}(M);function groupBy(t,n,s,r){return operate((function(o,a){var c;n&&"function"!=typeof n?(s=n.duration,c=n.element,r=n.connector):c=n;var l=new Map,notify=function(t){l.forEach(t),t(a)},handleError=function(t){return notify((function(n){return n.error(t)}))},h=0,u=!1,d=new T(a,(function(n){try{var o=t(n),f=l.get(o);if(!f){l.set(o,f=r?r():new M);var v=function createGroupedObservable(t,n){var s=new S((function(t){h++;var s=n.subscribe(t);return function(){s.unsubscribe(),0==--h&&u&&d.unsubscribe()}}));return s.key=t,s}(o,f);if(a.next(v),s){var g=createOperatorSubscriber(f,(function(){f.complete(),null==g||g.unsubscribe()}),void 0,void 0,(function(){return l.delete(o)}));d.add(innerFrom(s(v)).subscribe(g))}}f.next(c?c(n):n)}catch(t){handleError(t)}}),(function(){return notify((function(t){return t.complete()}))}),handleError,(function(){return l.clear()}),(function(){return u=!0,0===h}));o.subscribe(d)}))}var G=function(t){function BehaviorSubject(n){var s=t.call(this)||this;return s._value=n,s}return __extends(BehaviorSubject,t),Object.defineProperty(BehaviorSubject.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),BehaviorSubject.prototype._subscribe=function(n){var s=t.prototype._subscribe.call(this,n);return!s.closed&&n.next(this._value),s},BehaviorSubject.prototype.getValue=function(){var t=this,n=t.hasError,s=t.thrownError,r=t._value;if(n)throw s;return this._throwIfClosed(),r},BehaviorSubject.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},BehaviorSubject}(M);function distinctUntilChanged(t,n){return void 0===n&&(n=identity),t=null!=t?t:defaultCompare,operate((function(s,r){var o,a=!0;s.subscribe(createOperatorSubscriber(r,(function(s){var c=n(s);!a&&t(o,c)||(a=!1,o=c,r.next(s))})))}))}function defaultCompare(t,n){return t===n}function endWith(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n){return concat(n,of.apply(void 0,__spreadArray([],__read(t))))}}const findSendPeerToPeerMessageFunction=(t,n)=>{const s=n.find((([n])=>n===t));if(void 0===s)throw new Error("There is no tuple with the given key.");return s[1]},isBooleanTuple=t=>"boolean"==typeof t[1],isNotBooleanTuple=t=>"boolean"!=typeof t[1],isPeerToPeerMessageTuple=t=>null!==t[1]&&"object"==typeof t[1],isSendPeerToPeerMessageTuple=t=>"function"==typeof t[1],isTrueTuple=t=>!0===t[1],$=Symbol();function skip(t){return filter((function(n,s){return t<=s}))}function withLatestFrom(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=popResultSelector(t);return operate((function(n,r){for(var o=t.length,a=new Array(o),c=t.map((function(){return!1})),l=!1,_loop_1=function(n){innerFrom(t[n]).subscribe(createOperatorSubscriber(r,(function(t){a[n]=t,l||c[n]||(c[n]=!0,(l=c.every(identity))&&(c=null))}),noop))},h=0;h<o;h++)_loop_1(h);n.subscribe(createOperatorSubscriber(r,(function(t){if(l){var n=__spreadArray([t],__read(a));r.next(s?s.apply(void 0,__spreadArray([],__read(n))):n)}})))}))}const U=function isNonNulled(t){return null!=t};var Q,Y=Array.isArray;function zip(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=popResultSelector(t),r=function argsOrArgArray(t){return 1===t.length&&Y(t[0])?t[0]:t}(t);return r.length?new S((function(t){var n=r.map((function(){return[]})),o=r.map((function(){return!1}));t.add((function(){n=o=null}));for(var _loop_1=function(a){innerFrom(r[a]).subscribe(createOperatorSubscriber(t,(function(r){if(n[a].push(r),n.every((function(t){return t.length}))){var c=n.map((function(t){return t.shift()}));t.next(s?s.apply(void 0,__spreadArray([],__read(c))):c),n.some((function(t,n){return!t.length&&o[n]}))&&t.complete()}}),(function(){o[a]=!0,!n[a].length&&t.complete()})))},a=0;!t.closed&&a<r.length;a++)_loop_1(a);return function(){n=o=null}})):R}function switchMap(t,n){return operate((function(s,r){var o=null,a=0,c=!1,checkComplete=function(){return c&&!o&&r.complete()};s.subscribe(createOperatorSubscriber(r,(function(s){null==o||o.unsubscribe();var c=0,l=a++;innerFrom(t(s,l)).subscribe(o=createOperatorSubscriber(r,(function(t){return r.next(n?n(s,t,l,c++):t)}),(function(){o=null,checkComplete()})))}),(function(){c=!0,checkComplete()})))}))}function iif(t,n,s){return defer((function(){return t()?n:s}))}function count(t){return function reduce(t,n){return operate(scanInternals(t,n,arguments.length>=2,!1,!0))}((function(n,s,r){return!t||t(s,r)?n+1:n}),0)}function interval(t,n){return void 0===t&&(t=0),void 0===n&&(n=B),t<0&&(t=0),timer(t,t,n)}function takeUntil(t){return operate((function(n,s){innerFrom(t).subscribe(createOperatorSubscriber(s,(function(){return s.complete()}),noop)),!s.closed&&n.subscribe(s)}))}function retry(t){var n;void 0===t&&(t=Infinity);var s=(n=t&&"object"==typeof t?t:{count:t}).count,r=void 0===s?Infinity:s,o=n.delay,a=n.resetOnSuccess,c=void 0!==a&&a;return r<=0?identity:operate((function(t,n){var s,a=0,subscribeForRetry=function(){var l=!1;s=t.subscribe(createOperatorSubscriber(n,(function(t){c&&(a=0),n.next(t)}),void 0,(function(t){if(a++<r){var resub_1=function(){s?(s.unsubscribe(),s=null,subscribeForRetry()):l=!0};if(null!=o){var c="number"==typeof o?timer(o):innerFrom(o(t,a)),h=createOperatorSubscriber(n,(function(){h.unsubscribe(),resub_1()}),(function(){n.complete()}));c.subscribe(h)}else resub_1()}else n.error(t)}))),l&&(s.unsubscribe(),s=null,subscribeForRetry())};subscribeForRetry()}))}!function(t){t.NEXT="N",t.ERROR="E",t.COMPLETE="C"}(Q||(Q={}));var X=function(){function Notification(t,n,s){this.kind=t,this.value=n,this.error=s,this.hasValue="N"===t}return Notification.prototype.observe=function(t){return observeNotification(this,t)},Notification.prototype.do=function(t,n,s){var r=this,o=r.kind,a=r.value,c=r.error;return"N"===o?null==t?void 0:t(a):"E"===o?null==n?void 0:n(c):null==s?void 0:s()},Notification.prototype.accept=function(t,n,s){var r;return isFunction(null===(r=t)||void 0===r?void 0:r.next)?this.observe(t):this.do(t,n,s)},Notification.prototype.toObservable=function(){var t=this,n=t.kind,s=t.value,r=t.error,o="N"===n?of(s):"E"===n?throwError((function(){return r})):"C"===n?R:0;if(!o)throw new TypeError("Unexpected notification kind "+n);return o},Notification.createNext=function(t){return new Notification("N",t)},Notification.createError=function(t){return new Notification("E",void 0,t)},Notification.createComplete=function(){return Notification.completeNotification},Notification.completeNotification=new Notification("C"),Notification}();function observeNotification(t,n){var s,r,o,a=t,c=a.kind,l=a.value,h=a.error;if("string"!=typeof c)throw new TypeError('Invalid notification, missing "kind"');"N"===c?null===(s=n.next)||void 0===s||s.call(n,l):"E"===c?null===(r=n.error)||void 0===r||r.call(n,h):null===(o=n.complete)||void 0===o||o.call(n)}class InexorablyOperator{constructor(t){this.callback=t}call(t,n){return n.subscribe(new InexorablySubscriber(t,this.callback))}}class InexorablySubscriber extends y{constructor(t,n){super(t),this.add(new a((()=>n(this.notification))))}complete(){this.notification=new X("C"),super.complete()}error(t){this.notification=new X("E",void 0,t),super.error(t)}}function startWith(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=popScheduler(t);return operate((function(n,r){(s?concat(t,n,s):concat(t,n)).subscribe(r)}))}const ignoreLateResult=t=>new S((n=>{let s=!0;return t.then((t=>{s&&(n.next(t),n.complete())}),(t=>{s&&n.error(t)})),()=>s=!1})),negotiateDataChannels=(t,n)=>s=>s.pipe(mergeMap((([s,r,o])=>new S((a=>{const c=[],l=new M,h=[],u=new M,createAndSendOffer=()=>(g=!1,ignoreLateResult(_.setLocalDescription()).pipe(tap((()=>{const{localDescription:t}=_;if(null===t)throw new Error("The local description is not set.");n({...jsonifyDescription(t),client:{id:s},version:q})})))),subscribeToCandidates=()=>D(_,"icecandidate")((({candidate:t})=>{null===t?n({client:{id:s},numberOfGatheredCandidates:b,type:"summary",version:q}):9!==t.port&&"tcp"!==t.protocol&&(n({...t.toJSON(),client:{id:s},type:"candidate",version:q}),b+=1)})),subscribeToDataChannels=()=>{const t=[zip([D(w,"open"),D(S,"open")]).pipe(take(1)).subscribe((()=>{k=t=>{const n="update"===t.type?w:S;try{n.send(JSON.stringify(t))}catch(t){return l.next(t),!1}return!0},a.next([s,k])})),merge(...[w,S].map((t=>["close","closing","error"].map((n=>D(t,n))))).flat()).subscribe((({type:t})=>l.next(new Error(`RTCDataChannel fired unexpected event of type "${t}".`))))],n=[()=>t.forEach((t=>t.unsubscribe())),D(w,"message")((({data:t})=>{const n=JSON.parse(t);a.next([s,n])})),D(S,"message")((({data:t,timeStamp:n})=>{const r={...JSON.parse(t),timestamp:null!=n?n:performance.now()};a.next([s,r])}))];return()=>n.forEach((t=>t()))},[d,f]=(v=1,[()=>v**2,()=>{v+=1}]);var v;const subscribeToPeerConnection=()=>{const t=merge(D(_,"icecandidate"),D(_,"icegatheringstatechange")).pipe(switchMap((()=>iif((()=>"gathering"===_.iceGatheringState),defer((()=>timer(1e4*d()))),R)))).subscribe((()=>{f(),l.next(new Error('RTCPeerConnection seems to be stuck at iceGatheringState "gathering".'))})),n=[()=>t.unsubscribe(),D(_,"connectionstatechange")((()=>{const t=_.connectionState;["closed","disconnected","failed"].includes(t)&&l.next(new Error(`RTCPeerConnection transitioned to unexpected connectionState "${t}".`))})),D(_,"icecandidateerror")((()=>l.next(new Error('RTCPeerConnection fired unexpected event of type "icecandidateerror".')))),D(_,"iceconnectionstatechange")((()=>{const t=_.iceConnectionState;["closed","disconnected","failed"].includes(t)&&l.next(new Error(`RTCPeerConnection transitioned to unexpected iceConnectionState "${t}".`))})),D(_,"signalingstatechange")((()=>{"closed"===_.signalingState&&l.next(new Error('RTCPeerConnection transitioned to unexpected signalingState "closed".'))}))];return()=>n.forEach((t=>t()))},resetState=n=>{u.next(null),C(),O(),T(),w.close(),S.close(),_.close(),null!==k&&a.next([s,!0]),g=!0,m=0,y=q===n?y:Infinity,b=0,_=t(),h.length=q===n?h.length:0,w=_.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),k=null,S=_.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),C=subscribeToCandidates(),O=subscribeToDataChannels(),T=subscribeToPeerConnection(),q=n};let g=!0,m=0,y=Infinity,b=0,_=t(),w=_.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),k=null,x=null,S=_.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),C=subscribeToCandidates(),O=subscribeToDataChannels(),T=subscribeToPeerConnection(),q=0;const addFinalCandidate=async t=>{m+=t,m===y&&await _.addIceCandidate()},jsonifyDescription=t=>t instanceof RTCSessionDescription?t.toJSON():t;return a.next([s,!0]),merge(defer((()=>from(c))),l.pipe(mergeMap((t=>throwError((()=>t))))),o.pipe(((t,n,s)=>r=>r.pipe(function materialize(){return operate((function(t,n){t.subscribe(createOperatorSubscriber(n,(function(t){n.next(X.createNext(t))}),(function(){n.next(X.createComplete()),n.complete()}),(function(t){n.next(X.createError(t)),n.complete()})))}))}(),startWith(null),switchMap((r=>concat(of(r),null===r||"N"===r.kind?s.pipe(function takeWhile(t,n){return void 0===n&&(n=!1),operate((function(s,r){var o=0;s.subscribe(createOperatorSubscriber(r,(function(s){var a=t(s,o++);(a||n)&&r.next(s),!a&&r.complete()})))}))}(n),tap(t),ignoreElements()):R))),filter(U),function dematerialize(){return operate((function(t,n){t.subscribe(createOperatorSubscriber(n,(function(t){return observeNotification(t,n)})))}))}()))((()=>n({client:{id:s},type:"check"})),(()=>"open"!==w.readyState||"open"!==S.readyState),interval(5e3)),function inexorably(t){return n=>n.lift(new InexorablyOperator(t))}((t=>{void 0!==t&&l.complete()})))).pipe(mergeMap((t=>(t=>{const{type:o}=t;if("answer"===o&&r){if(q>t.version)return R;if(q===t.version&&!g)return ignoreLateResult(_.setRemoteDescription(t)).pipe(mergeMap((()=>from(h))),mergeMap((t=>ignoreLateResult(_.addIceCandidate(t)))),count(),mergeMap((t=>ignoreLateResult(addFinalCandidate(t)))))}if("candidate"===o){if(q>t.version)return R;if(q<t.version&&!r&&resetState(t.version),q===t.version)return null===_.remoteDescription?(h.push(t),R):ignoreLateResult(_.addIceCandidate(t)).pipe(mergeMap((()=>ignoreLateResult(addFinalCandidate(1)))))}if("error"===o&&r)return q>t.version?R:(resetState(t.version+1),createAndSendOffer());if("notice"===o&&!r)return R;if("offer"===o&&!r)return q>t.version?R:(q<t.version&&resetState(t.version),g=!1,ignoreLateResult(_.setRemoteDescription(t)).pipe(mergeMap((()=>merge(ignoreLateResult(_.setLocalDescription()).pipe(tap((()=>{const{localDescription:t}=_;if(null===t)throw new Error("The local description is not set.");n({...jsonifyDescription(t),client:{id:s},version:q})}))),from(h).pipe(mergeMap((t=>ignoreLateResult(_.addIceCandidate(t)))),count(),mergeMap((t=>ignoreLateResult(addFinalCandidate(t))))))))));if("request"===o&&r)return 0===q&&g?createAndSendOffer():R;if("summary"===o){if(q>t.version)return R;if(q<t.version&&!r&&resetState(t.version),q===t.version)return y=t.numberOfGatheredCandidates,ignoreLateResult(addFinalCandidate(0))}return x=new Error(`The current event of type "${o}" can't be processed.`),throwError((()=>x))})(t).pipe(takeUntil(u)))),retry({delay:t=>{if(t===x)return throwError((()=>t));if(c.length=0,g)resetState(q);else{const t={client:{id:s},type:"error",version:q};r?c.push(t):(resetState(q+1),n(t))}return of(null)}}),takeUntil(concat(o.pipe(ignoreElements()),of(null))),finalize((()=>{C(),O(),T(),w.close(),S.close(),_.close()}))).subscribe({complete:()=>{a.next([s,!1]),a.complete()},error:t=>a.error(t)})})))));function not(t,n){return function(s,r){return!t.call(n,s,r)}}const J=/^[\dA-Za-z]{20}$/,Z="undefined"==typeof window?null:window,ee=((t,n,s,r,o,a,c)=>class TimingProvider extends s{constructor(t){super();const n=r.now()/1e3;this._clientId="",this._endPosition=Number.POSITIVE_INFINITY,this._error=null,this._hops=[],this._onadjust=null,this._onchange=null,this._onreadystatechange=null,this._origin=Number.MAX_SAFE_INTEGER,this._providerIdOrUrl=t,this._readyState="connecting",this._skew=0,this._startPosition=Number.NEGATIVE_INFINITY,this._subscription=null,this._updateRequestsSubject=new M,this._vector={acceleration:0,position:0,timestamp:n,velocity:0},this._version=0,this._createClient()}get endPosition(){return this._endPosition}get error(){return this._error}get onadjust(){return null===this._onadjust?this._onadjust:this._onadjust[0]}set onadjust(t){if(null!==this._onadjust&&this.removeEventListener("adjust",this._onadjust[1]),"function"==typeof t){const n=t.bind(this);this.addEventListener("adjust",n),this._onadjust=[t,n]}else this._onadjust=null}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(t){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof t){const n=t.bind(this);this.addEventListener("change",n),this._onchange=[t,n]}else this._onchange=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(t){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof t){const n=t.bind(this);this.addEventListener("readystatechange",n),this._onreadystatechange=[t,n]}else this._onreadystatechange=null}get readyState(){return this._readyState}get skew(){return this._skew}get startPosition(){return this._startPosition}get vector(){return this._vector}destroy(){if(null===this._subscription)throw new Error("The timingProvider is already destroyed.");this._readyState="closed",this._subscription.unsubscribe(),this._subscription=null,this._updateRequestsSubject.complete(),o((()=>this.dispatchEvent(new Event("readystatechange"))))}update(t){if(null===this._subscription)return Promise.reject(new Error("The timingProvider is destroyed and can't be updated."));const n=c(this._vector,t);return null!==n&&this._updateRequestsSubject.next([{...n,hops:[],version:this._version+1},null]),Promise.resolve()}_createClient(){const s=J.test(this._providerIdOrUrl)?`wss://matchmaker.suenc.io?providerId=${this._providerIdOrUrl}`:this._providerIdOrUrl;this._subscription=merge(concat(from(j()).pipe(function equals(t){return n=>n.pipe(filter((n=>t===n)))}(!0),function first(t,n){var s=arguments.length>=2;return function(r){return r.pipe(t?filter((function(n,s){return t(n,s,r)})):identity,take(1),s?function defaultIfEmpty(t){return operate((function(n,s){var r=!1;n.subscribe(createOperatorSubscriber(s,(function(t){r=!0,s.next(t)}),(function(){r||s.next(t),s.complete()})))}))}(n):function throwIfEmpty(t){return void 0===t&&(t=defaultErrorFactory),operate((function(n,s){var r=!1;n.subscribe(createOperatorSubscriber(s,(function(t){r=!0,s.next(t)}),(function(){return r?s.complete():s.error(t())})))}))}((function(){return new V})))}}(),ignoreElements()),defer((()=>{const[r,o]=n(s);return r.pipe((a=t=>"closure"===t.type,c=()=>{const t=new Error("Your plan has exceeded its quota.");this._error=t,this._readyState="closed",this.dispatchEvent(new Event("readystatechange"))},connect((t=>{const[n,s]=function partition(t,n,s){return[filter(n,s)(innerFrom(t)),filter(not(n,s))(innerFrom(t))]}(t,a);return s.pipe(takeUntil(n.pipe(tap(c))))}))),(l=t=>"init"===t.type,t=>t.pipe(scan((([t,n],s)=>{if(l(s)){if(null===n)throw new Error("Another value has been identified as the first value already.");return[[s,...n],null]}return null===n?[[s],n]:[t,[...n,s]]}),[[],[]]),concatMap((([t])=>from(t))))),concatMap((t=>{if("array"===t.type)return from(t.events);if("init"===t.type){const{client:{id:n},events:s,origin:r}=t;return this._clientId=n,this._origin=r,0===s.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange"))),from(s)}return of(t)})),((t,n)=>s=>new S((r=>{const o=new Map,isActive=n=>t()<n;return s.pipe((a=()=>{o.forEach((([t,n])=>{null===t?n.unsubscribe():t.complete()}))},t=>new S((n=>{const s=t.subscribe({complete:()=>{a(),n.complete()},error:t=>{a(),n.error(t)},next:t=>n.next(t)});return()=>{a(),s.unsubscribe()}})))).subscribe({complete(){r.complete()},error(t){r.error(t)},next(t){var s;const a=t.client.id,[c,l]=null!==(s=o.get(a))&&void 0!==s?s:[null,null];if("termination"===t.type)null!==l&&l.unsubscribe(),null!==c&&c.complete(),o.set(a,[null,n.pipe(skip(isActive(a)?1:0),take(1)).subscribe((()=>o.delete(a)))]);else if(null===c&&null===l){const n=new M;o.set(a,[n,null]),r.next([a,isActive(a),n.asObservable()]),n.next(t)}else null===l&&c.next(t)}});var a})))((()=>this._clientId),timer(1e4)),negotiateDataChannels(t,o));var a,c,l}))).pipe((t=>defer((()=>{let n=0;return t.pipe(retry({delay:t=>(n+=1,iif((()=>n<4),timer(1e3*n**2),throwError((()=>t))))}),tap((()=>n=0)))}))),catchError((t=>(this._error=t,this._readyState="closed",this.dispatchEvent(new Event("readystatechange")),R))),tap((t=>{isSendPeerToPeerMessageTuple(t)&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),scan((([,t],n)=>{const s=t.findIndex((([t])=>t===n[0]));return-1===s?(isTrueTuple(n)||isSendPeerToPeerMessageTuple(n))&&t.push(n):!1===n[1]?t.splice(s,1):(isTrueTuple(n)||isSendPeerToPeerMessageTuple(n))&&(t[s]=n),[n,t]}),[,[]]),tap((([,t])=>{0===t.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),filter((([t])=>!(isSendPeerToPeerMessageTuple(t)&&!t[1]({message:this._createExtendedVector([...this._hops,this._origin]),type:"update"})))),connect((t=>{const n=new H(1);return t.pipe(tap((([,t])=>n.next(t))),map((([t,n])=>{if(isPeerToPeerMessageTuple(t)){const[s,r]=t;if("ping"===r.type)return[s,{...r,reply:findSendPeerToPeerMessageFunction(s,n.filter(isSendPeerToPeerMessageTuple))}]}return t})),filter(isNotBooleanTuple),groupBy((([t])=>t),{duration:n=>t.pipe(map((([t])=>t)),filter(isBooleanTuple),filter((([t])=>t===n.key)))}),mergeMap((t=>{const n=new G([0,[]]);return t.pipe(connect((s=>merge(s.pipe(filter(isSendPeerToPeerMessageTuple),((t,n)=>s=>s.pipe(map((([,s])=>interval(1e3).pipe(startWith(0),map(((t,r)=>(s({index:r,type:"ping"}),n()))),withLatestFrom(t),tap((([n,[s,r]])=>t.next([s,[...r,n]]))),ignoreElements()))),endWith(R),function switchAll(){return switchMap(identity)}()))(n,(()=>r.now()))),s.pipe(filter(isPeerToPeerMessageTuple),map((([,t])=>t)),groupBy((t=>t.type)),mergeMap((t=>"ping"===t.key?t.pipe(tap((({index:t,timestamp:n,reply:s})=>s({index:t,remoteReceivedTime:n,remoteSentTime:r.now(),type:"pong"}))),ignoreElements()):"pong"===t.key?t.pipe((t=>n=>n.pipe(withLatestFrom(t),map((([{index:n,remoteReceivedTime:s,remoteSentTime:r,timestamp:o},[a,c]])=>{if(n<a)return null;const l=n-a,[h,...u]=c.slice(l);return t.next([a+l+1,u]),[h,s,r,o]})),filter(U)))(n),map((([t,n,s,r])=>[(n+s-t-r)/2,r-t+n-s])),(t=>t.pipe(scan(((t,n)=>[...t.slice(-59),n]),[]),map((t=>t.slice(1).reduce(((t,n)=>t[1]<n[1]?t:n),t[0]))))),map((t=>[1,t]))):t.pipe(map((({message:t})=>t)),map((t=>this._version>t.version||this._version===t.version&&((0===this._hops.length?this._origin:this._hops[0])<t.hops[0]||t.hops.includes(this._origin))?null:t)),map((t=>[0,t]))))),(t=>t.pipe(scan(((t,[n,s])=>0===n?[s,t[1]]:[t[0],s]),[$,$]),filter((t=>t.every((t=>t!==$)))))),distinctUntilChanged((([t,[n,s]],[r,[o,a]])=>t===r&&n===o&&s===a)),map((([n,[s,r]])=>[t.key,null===n?null:{...n,timestamp:n.timestamp-s/1e3},r])),endWith([t.key,null,null]))))))})),scan((([,t],n)=>{const s=t.findIndex((([t])=>n[0]===t));return null===n[2]?s>-1&&t.splice(s,1):s>-1?t[s]=n:(t.push(n),t.sort((([t],[n])=>t<n?-1:t>n?1:0))),[n,t]}),[,[]]),mergeMap((t=>n.pipe(take(1),map((n=>[t,n]))))),map((([[t],n])=>[...t,n])))}))),this._updateRequestsSubject.pipe(map((([t])=>[null,t,0,null])))).pipe(scan((([t,n]=[[[null,this._createExtendedVector(this._hops),0]],[]],[s,r,o,c])=>{const l=null!=c?c:n,h=t.findIndex((t=>t[0]===s));if(null!==r){if(this._version<r.version)return t.length=0,t.push([s,r,o]),[t,l];if(this._version===r.version){const n=0===this._hops.length?this._origin:this._hops[0];if(n>r.hops[0]&&!r.hops.includes(this._origin))return t.length=0,t.push([s,r,o]),[t,l];if(n===r.hops[0]&&!r.hops.includes(this._origin)&&this._hops.length>0)return h>-1?t[h]=[s,r,o]:t.push([s,r,o]),a(t),[t,l]}}return h>-1&&(1===t.length?t[0]=[null,{...t[0][1],hops:[t[0][1].hops[0],...t[0][1].hops.map((()=>this._origin))]},0]:t.splice(h,1)),[t,l]}),void 0),distinctUntilChanged(((t,n)=>t===n),(([[[,t]]])=>t))).subscribe((([[[t,n]],s])=>{const r={...n,hops:[...n.hops,this._origin]};for(const[n,o]of s.filter(isSendPeerToPeerMessageTuple))if(!o({message:r,type:"update"})&&t===n)return;this._setInternalVector(n)}))}_createExtendedVector(t){return{...this._vector,hops:t,version:this._version}}_setInternalVector({hops:t,version:n,...s}){this._hops=t,this._vector=s,this._version=n,this.dispatchEvent(new CustomEvent("change",{detail:s}))}})((t=>()=>{if(null===t)throw new Error("A native EventTarget could not be created.");return new t.RTCPeerConnection({iceCandidatePoolSize:1,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}]})})(Z),(se=t=>new WebSocket(t),t=>{const n=new M,s=se(t);return[merge(D(s,"message"),merge(merge(...["close","error"].map((t=>D(s,t)))).pipe(map((({type:t})=>new Error(`WebSocket fired unexpected event of type "${t}".`)))),n).pipe(mergeMap((t=>throwError((()=>t)))))).pipe(finalize((()=>s.close())),map((t=>JSON.parse(t.data)))),t=>{try{s.send(JSON.stringify(t))}catch(t){n.next(t)}}]}),(ne=(t=>()=>{if(null===t)throw new Error("A native EventTarget could not be created.");return t.document.createElement("p")})(Z),class EventTarget{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=ne()}addEventListener(t,n,s){if(null!==n){let a=this._listeners.get(n);void 0===a&&(r=this,o=n,a=t=>{const n={value:r};return Object.defineProperties(t,{currentTarget:n,target:n}),"function"==typeof o?o.call(r,t):o.handleEvent.call(r,t)},"function"==typeof n&&this._listeners.set(n,a)),this._nativeEventTarget.addEventListener(t,a,s)}var r,o}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,s){const r=null===n?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,void 0===r?null:r,s)}}),performance,setTimeout,(te=([,{hops:t}])=>t,ie=([,,t])=>t,t=>{t.sort(((t,n)=>{const s=(([t,...n],[s,...r])=>{if(void 0===t||void 0===s)throw new Error("Every vector should have an origin.");if(t===s){const t=n.filter((t=>t===n[0])).length,s=r.filter((t=>t===r[0])).length;if(t===s){if(0===t)throw new Error("At least one vector should have a hop if they have the same origin.");if(1===t||n[0]===r[0]){if(n.length===r.length){if(n.every(((t,n)=>t===r[n])))throw new Error("Every vector should be unique.");return 0}return n.length-r.length}return n[0]-r[0]}return t-s}return t-s})(te(t),te(n));return 0===s?ie(t)-ie(n):s}))}),((t,n,s)=>(r,o)=>{const a=t(o),c=s(r,n.now()/1e3-r.timestamp);for(const[t,n]of Object.entries(a))if(n!==c[t])return{...c,...a};return null})(r.filterTimingStateVectorUpdate,performance,r.translateTimingStateVector));var te,ie,ne,se},2589:t=>{"use strict";t.exports=JSON.parse('{"layout":{"vco":{"color":[150,0,0],"boundingBox":{"x":10,"y":20,"width":30,"height":50},"offsets":{"x":12,"y":30},"groupA":["type"],"controlTypeA":"radioButton","controlTypeB":"knob","sizeA":0.8,"sizeB":0.75,"theme":"dark"},"vcf":{"color":[100,0,150],"boundingBox":{"x":30,"y":20,"width":40,"height":50},"offsets":{"x":10,"y":30},"groupA":["cutoff"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6},"vca":{"color":[100,50,100],"boundingBox":{"x":70,"y":20,"width":30,"height":50},"offsets":{"x":12,"y":30},"groupA":["level"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6},"env":{"color":[20,100,100],"boundingBox":{"x":5,"y":60,"width":100,"height":50},"offsets":{"x":8,"y":30},"groupA":["decay","pDecay","nDecay"],"controlTypeA":"knob","controlTypeB":"fader","sizeA":0.5,"sizeB":1},"lfo":{"color":[20,0,100],"boundingBox":{"x":50,"y":70,"width":50,"height":50},"offsets":{"x":12,"y":30},"groupA":["rate"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6}}}')},2805:t=>{"use strict";t.exports=JSON.parse('{"default":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":0.6399999999999997,"detune":-0.0050000000000004485,"gain":0.49,"octave1":0.3763000000000001,"detune1":0.004100000000000548,"gain1":0.2471151519016499,"octave12":-0.48769999999999936,"detune12":-0.006785841498486267,"gain12":0.4489000000000002,"cutoff":145.9711999999991,"keyTracking":1,"vcf env":1800.0000000000005,"Q":2.5919999999999983,"a":0.003,"d":1.4579999999999995,"s":0,"r":4.049999999999999,"vcf a":0.007199999999999998,"vcf d":1.25,"vcf s":0.02249999999999999,"vcf r":3.8719999999999994,"lfo":0.5,"pwm":0.0225,"distortion":1.6478738086663287e-32,"mix":1},"mono":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":-0.2600000000000011,"detune":-4.440892098500626e-16,"gain":0.99,"octave1":-1.0253000000000012,"detune1":-0.03759999999999947,"gain1":0,"octave12":-0.5299999999999998,"detune12":-0.006785841498486267,"gain12":0,"cutoff":257.94879999999887,"keyTracking":0,"vcf env":220.49999999999946,"Q":9.800000000000006,"a":0.003,"d":5,"s":0.3249000000000002,"r":0.12799999999999884,"vcf a":0.0012500000000000002,"vcf d":0.6124999999999979,"vcf s":0,"vcf r":0.3919999999999978,"distortion":0,"mix":1,"lfo":0.5,"pwm":0.0225},"ringingSub":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":0.4599999999999995,"detune":-4.440892098500626e-16,"gain":0.99,"octave1":-0.8468000000000013,"detune1":-0.03759999999999947,"gain1":0.6399999999999997,"octave12":-0.5299999999999998,"detune12":-0.006785841498486267,"gain12":0,"cutoff":10.998199999999782,"keyTracking":1,"vcf env":199.99999999999923,"Q":2.737999999999998,"a":0.003,"d":1.9844999999999988,"s":1,"r":1.7999999999999972,"vcf a":0.005,"vcf d":1.1044999999999978,"vcf s":0.3480999999999996,"vcf r":1.0579999999999958,"lfo":0.5,"pwm":0.0225,"distortion":0,"mix":1},"fat":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":0.15999999999999925,"detune":-4.440892098500626e-16,"gain":1,"octave1":-0.5717000000000012,"detune1":0.09289999999999965,"gain1":0.8463999999999998,"octave12":-0.7324999999999999,"detune12":-0.08746089048940536,"gain12":0.8463999999999998,"cutoff":226.95499999999856,"keyTracking":0.17639999999999956,"vcf env":647.9999999999991,"Q":0.2419999999999986,"a":0.003,"d":1.9844999999999988,"s":1,"r":1.5679999999999972,"vcf a":0.005,"vcf d":0.9140958877053913,"vcf s":0.3480999999999996,"vcf r":0.031999999999999244,"lfo":0.5,"pwm":0.0225,"distortion":0.14440000000000014,"mix":0.3969000000000003},"blip":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":1,"detune":-4.440892098500626e-16,"gain":0.7499999999999998,"octave1":0.3231999999999995,"detune1":0.032899999999999596,"gain1":1,"octave12":0.27070000000000105,"detune12":-0.006785841498486267,"gain12":0.8463999999999998,"cutoff":170.96619999999902,"keyTracking":0.6399999999999997,"vcf env":647.9999999999991,"Q":0.7219999999999969,"a":0.003,"d":1.1519999999999984,"s":0.1295999999999996,"r":0.24199999999999997,"vcf a":0.005,"vcf d":0.24199999999999763,"vcf s":0.06249999999999967,"vcf r":0.049999999999999066,"lfo":0.5,"pwm":0.1225,"distortion":0.10890000000000019,"mix":0.4356000000000005},"sub":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":-0.20000000000000107,"detune":-4.440892098500626e-16,"gain":0.99,"octave1":1,"detune1":0.001264000000000598,"gain1":0.3480999999999996,"octave12":-0.5299999999999998,"detune12":-0.006785841498486267,"gain12":0,"cutoff":37.992799999999605,"keyTracking":0.9409000000000014,"vcf env":40.49999999999962,"Q":0,"a":0.003,"d":1.9844999999999988,"s":1,"r":0.5119999999999978,"vcf a":0.005,"vcf d":1.1044999999999978,"vcf s":0.3480999999999996,"vcf r":0.5119999999999968,"lfo":0.5,"pwm":0.225,"distortion":0,"mix":1}}')},2946:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PlotTransferFunction=void 0,n.PlotTransferFunction=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Canvas1",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4;const r=document.getElementById(n),o=r.querySelector("svg.transfer-function-svg");if(o&&r.removeChild(o),"stop"===t)return;const a=r.offsetWidth,c=r.offsetWidth*s,l=c-10,h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("width",a),h.setAttribute("height",c),h.setAttribute("class","transfer-function-svg");const u=document.createElementNS("http://www.w3.org/2000/svg","rect");u.setAttribute("x","1"),u.setAttribute("y","1"),u.setAttribute("width",l-1),u.setAttribute("height",l-1),u.setAttribute("stroke","black"),u.setAttribute("fill","none"),h.appendChild(u);const d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("class","transfer-function-path"),h.appendChild(d),r.appendChild(h);var f="M";let v=2/l,g=-1;for(let n=0;n<l;n++)f+=`${n} ${l/2-t(g)*l/2} `,g+=v;function addLabel(t,n,s){const r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("x",n),r.setAttribute("y",s),r.textContent=t,r.setAttribute("font-family","sans-serif"),r.setAttribute("font-size","10px"),r.setAttribute("fill","black"),h.appendChild(r)}function addLabel(t,n,s,r,o,a){const c=document.createElementNS("http://www.w3.org/2000/svg","text");c.setAttribute("x",n),c.setAttribute("y",s),c.textContent=t,c.setAttribute("font-family","sans-serif"),c.setAttribute("font-size","10px"),c.setAttribute("fill","black"),r&&c.setAttribute("transform",`rotate(${r} ${n}, ${s})`),o&&c.setAttribute("text-anchor",o),a&&c.setAttribute("alignment-baseline",a),h.appendChild(c)}d.setAttribute("d",f),d.setAttribute("stroke","black"),d.setAttribute("stroke-width","2"),d.setAttribute("fill","none"),addLabel("-1",5,c-2,0,"start","baseline"),addLabel("input",l/2,c-11,0,"middle","hanging"),addLabel("1",l-5,c-2,0,"end","baseline"),addLabel("-1",l+3,l-5,90,"middle","baseline"),addLabel("1",l+13,10,90,"middle","hanging"),addLabel("output",l+3,l/2,90,"middle","baseline")}},3172:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.asciiCallbackInstance=void 0,n.asciiCallbackInstance=new class AsciiCallback{constructor(){this.asciiOn=!1,this.handler=(t,n)=>{console.log("Ascii",t,n,"\nadd a new handler like: \nsetAsciiHandler((num,state)=>{\nconsole.log(num, state)})")},this.activeKeys={},this.keyDown=this.keyDown.bind(this),this.keyUp=this.keyUp.bind(this)}keyDown(t){if(!this.asciiOn)return;const n=t.keyCode;let s=n;s=32==n?"Space":t.key,this.activeKeys[s]||(this.activeKeys[s]=!0,this.handler(s,"down"))}keyUp(t){if(!this.asciiOn)return;const n=t.keyCode;let s=n;s=32==n?"Space":t.key,this.activeKeys[s]&&(this.activeKeys[s]=!1,this.handler(s,"up"))}enable(){this.asciiOn||(this.asciiOn=!0,document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp))}disable(){this.asciiOn&&(this.asciiOn=!1,document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp))}setHandler(t){this.handler=t}}},3447:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Parameter=void 0;var o=r(s(1297));n.Parameter=class Parameter{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.default;this.name=t.name||"param",this.min=t.min||0,this.max=t.max||1,this.curve=t.curve||1,this.rawValue=this.unScaleValue(t.value||.5,0,1,this.min,this.max,this.curve),this.normalizedValue=0,this.group=t.group||"default",this._value=Array.isArray(t.value)||void 0!==t.value?t.value:this.scaleValue(.5,0,1,this.min,this.max,this.curve),this.callback=t.callback||function(){},this.control=null,this.gui=n,this.layout=s||o.default,this.type=t.type||"vcf",this.radioOptions=t.radioOptions||null,this.guiElements=[],this.labels=t.labels||null,this.set(this._value)}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Array.isArray(this._value)&&null!==t?this._value[t]:this._value}set(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Array.isArray(this._value)?Array.isArray(t)?(this._value=[...t],t.forEach(((t,n)=>this.callback(t,n)))):null!==n?(this._value[n]=t,this.callback(t,n)):(this._value.fill(t),this._value.forEach(((t,n)=>this.callback(t,n)))):(this._value=t,this.callback(t,null)),0==s&&(Array.isArray(this._value)?this.guiElements.forEach(((t,n)=>t.forceSet(this._value[n]))):this.guiElements.length>0&&this.guiElements[0].forceSet(this._value))}attachControl(t){this.control=t,t.onChange=t=>{this.value=t}}createGui(){const{x:t,y:n,width:s,height:r}=this.layout,o=this.getGroupColor(this.group);this.control=this.gui.Knob({label:this.name,min:this.min,max:this.max,size:s,x:t,y:n,accentColor:o,callback:t=>this.set(t)}),this.control.setValue(this.get())}getGroupColor(t){const n={vco:[200,0,0],vcf:[0,200,0],env:[0,0,200],default:[100,100,100]};return n[t]||n.default}setRealValue(t){this.value=t,this.rawValue=this.unScaleValue(t,this.min,this.max,0,1,this.curve)}getRealValue(){return this.value}setNormalizedValue(t){this.rawValue=t,this.value=this.scaleValue(t,0,1,this.min,this.max,this.curve)}getNormalizedValue(){return this.rawValue}scaleValue(t,n,s,r,o,a){return r+Math.pow(t,a)*(o-r)}unScaleValue(t,n,s,r,o,a){return Math.pow((t-n)/(s-n),1/a)}}},3634:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CollabHubTracker=n.CollabHubDisplay=n.CollabHubClient=void 0;var r=s(4658);n.CollabHubClient=class CollabHubClient{constructor(){this.socket=(0,r.io)("https://ch-server.herokuapp.com/hub"),this.controls={},this.handlers={},this.username=void 0,this.roomJoined=void 0,this.controlsCallback=t=>{},this.eventsCallback=t=>{},this.chatCallback=t=>{},this.initializeSocketEvents()}initializeSocketEvents(){this.socket.on("connected",(()=>{console.info("Connected to Collab-Hub server (Join a room w/ ch.joinRoom(x)!)."),this.socket.emit();const t={chat:"Connected with id: "+this.socket.id,target:"all"};this.socket.emit("chat",t)})),this.socket.on("serverMessage",(t=>{})),this.socket.on("chat",(t=>{t.chat==="Connected with id: "+this.socket.id&&(this.username=t.id),this.chatCallback(t)})),this.socket.on("otherUsers",(t=>{let n="",s=t.users.length;for(let r of t.users)n+=--s?`${r}, `:r})),this.socket.on("control",(t=>{if(this.roomJoined){if(t.from!==this.username){let n=t.header,s=t.values;this.controls[n]=s,n in this.handlers&&this.handlers[n](t)}this.controlsCallback(t)}})),this.socket.on("availableControls",(t=>{for(let n of t.controls)delete n.observers,delete n.mode})),this.socket.on("observedControls",(t=>{for(let n of t.controls)delete n.observers,delete n.mode})),this.socket.on("myControls",(t=>{for(let n of t.controls)delete n.observers,delete n.mode})),this.socket.on("event",(t=>{if(this.roomJoined){if(t.from!==this.username){let n=t.header;n in this.handlers&&this.handlers[n](t)}this.eventsCallback(t)}})),this.socket.on("availableEvents",(t=>{for(let n of t.events)delete n.observers,delete n.mode})),this.socket.on("observedEvents",(t=>{for(let n of t.events)delete n.observers,delete n.mode})),this.socket.on("myEvents",(t=>{for(let n of t.events)delete n.observers,delete n.mode})),this.socket.on("availableRoomsList",(t=>{let n="",s=t.rooms.length;for(let r of t.rooms)n+=--s?`${r}, `:r}))}setControlsCallback(t){this.controlsCallback=t}setEventsCallback(t){this.eventsCallback=t}setChatCallback(t){this.chatCallback=t}control(){if(this.roomJoined){let t="publish"===(arguments.length<=0?void 0:arguments[0])||"pub"===(arguments.length<=0?void 0:arguments[0])?"publish":"push";const n={mode:t,header:"publish"===t?arguments.length<=1?void 0:arguments[1]:arguments.length<=0?void 0:arguments[0],values:"publish"===t?arguments.length<=2?void 0:arguments[2]:arguments.length<=1?void 0:arguments[1],target:"publish"===t?(arguments.length<=3?void 0:arguments[3])?arguments.length<=3?void 0:arguments[3]:this.roomJoined:(arguments.length<=2?void 0:arguments[2])?arguments.length<=2?void 0:arguments[2]:this.roomJoined};this.socket.emit("control",n)}else console.info("Join a room to send controls.")}event(){if(this.roomJoined){let t="publish"===(arguments.length<=0?void 0:arguments[0])||"pub"===(arguments.length<=0?void 0:arguments[0])?"publish":"push";const n={mode:t,header:"publish"===t?arguments.length<=1?void 0:arguments[1]:arguments.length<=0?void 0:arguments[0],target:"publish"===t?(arguments.length<=2?void 0:arguments[2])?arguments.length<=2?void 0:arguments[2]:this.roomJoined:(arguments.length<=1?void 0:arguments[1])?arguments.length<=1?void 0:arguments[1]:this.roomJoined};this.socket.emit("event",n)}else console.info("Join a room to send events.")}chat(t,n){if(this.roomJoined){const s={chat:t};s.target=n||this.roomJoined,this.socket.emit("chat",s)}else console.info("Join a room to chat.")}setUsername(t){this.socket.emit("addUsername",{username:t}),this.username=t}getControl(t){return t in this.controls?this.controls[t]:0}on(t,n){this.handlers[t]=n}getUsers(){this.socket.emit("otherUsers")}joinRoom(t){this.roomJoined&&this.leaveRoom(this.roomJoined);let n={room:t};this.socket.emit("joinRoom",n),this.roomJoined=t,console.log("Joined room "+this.roomJoined)}leaveRoom(t){let n={room:t};this.socket.emit("leaveRoom",n)}getRooms(){this.socket.emit("getAvailableRooms")}observeControl(t){let n={header:t};this.socket.emit("observeControl",n)}unobserveControl(t){let n={header:t};this.socket.emit("unobserveControl",n)}observeAllControls(t){let n={observe:t};this.socket.emit("observeAllControl",n),this.socket.emit("getMyControls")}clearControl(t){let n={header:t};this.socket.emit("clearControl",n),this.socket.emit("getMyControls")}observeEvent(t){let n={header:t};this.socket.emit("observeEvent",n)}unobserveEvent(t){let n={header:t};this.socket.emit("unobserveEvent",n)}observeAllEvents(t){let n={observe:t};this.socket.emit("observeAllEvents",n),this.socket.emit("getMyEvents")}clearEvent(t){let n={header:t};this.socket.emit("clearEvent",n),this.socket.emit("getMyEvents")}},n.CollabHubTracker=class CollabHubTracker{constructor(t){this.ch=t,this.recentControls={},this.recentEvents=[],this.recentChat=[],this.controlsTimeOut=3e5,this.eventsTimeOut=4e3,this.chatTimeOut=6e4,this.chatMaxDisplay=20,this.ch.setControlsCallback(this.handleControl.bind(this)),this.ch.setEventsCallback(this.handleEvent.bind(this)),this.ch.setChatCallback(this.handleChat.bind(this)),this.update(),setInterval(this.update.bind(this),1e3)}update(){for(let t in this.recentControls)Date.now()-this.recentControls[t].time>this.controlsTimeOut&&delete this.recentControls[t];this.recentEvents.forEach(((t,n)=>{Date.now()-t.time>this.eventsTimeOut&&this.recentEvents.splice(n,1)})),this.recentChat.forEach(((t,n)=>{Date.now()-t.time>this.chatTimeOut&&this.recentChat.splice(n,1)}))}handleChat(t){this.recentChat.push({message:t.chat,from:t.id}),this.recentChat.length>this.chatMaxDisplay&&this.recentChat.shift()}handleControl(t){this.recentControls[t.header]={value:t.values,from:t.from,time:Date.now()}}handleEvent(t){this.recentEvents.unshift({header:t.header,from:t.from,time:Date.now()})}},n.CollabHubDisplay=class CollabHubDisplay{constructor(t){function updateControls(){const t=document.getElementById("collab-controls");if(!t)return;const n=t.querySelectorAll(".control");Object.keys(window.chTracker.recentControls).forEach((n=>{let{value:s,from:r,time:o}=window.chTracker.recentControls[n];"number"==typeof s&&(s=Math.round(100*s)/100);const a=`controls-${n}`,c=document.getElementById(a);if(c){const t=c.querySelector(".value"),n=c.querySelector(".from");t.innerText==s&&n.innerText==`(${r})`||(t.innerText=s,n.innerText=`(${r})`,c.style.fontWeight="bold",setTimeout((()=>{c.style.fontWeight="normal"}),2e3))}else{const o=document.createElement("div");o.className="property control hidden",o.id=a,o.innerHTML=`\n                <span class="name">${n}:</span>\n                <span class="value">${s}</span>\n                <span class="from">(${r})</span>\n                `,t.appendChild(o),o.classList.remove("hidden"),o.style.fontWeight="bold",setTimeout((()=>{o.style.fontWeight="normal"}),2e3)}})),n.forEach((t=>{const n=t.id.replace("controls-","");window.chTracker.recentControls[n]||(t.classList.add("hidden"),setTimeout((()=>{t.remove()}),300))}))}function updateEvents(){const t=document.getElementById("collab-events");if(!t)return;const n=t.querySelectorAll(".event");window.chTracker.recentEvents.forEach(((n,s)=>{let{header:r,time:o,from:a}=n;const c=`events-${s}`,l=document.getElementById(c);if(l){const t=l.querySelector(".header"),n=l.querySelector(".from");t.innerText==r&&n.innerText==`(${a})`||(t.innerText=r,n.innerText=`(${a})`,l.style.fontWeight="bold",setTimeout((()=>{l.style.fontWeight="normal"}),2e3))}else{const n=document.createElement("div");n.className="property event hidden",n.id=c,n.innerHTML=`\n                <span class="header">${r}</span>\n                <span class="from">(${a})</span>\n                `,t.appendChild(n),n.classList.remove("hidden"),n.style.fontWeight="bold",setTimeout((()=>{n.style.fontWeight="normal"}),2e3)}})),n.forEach((t=>{const n=t.id.replace("events-","");window.chTracker.recentEvents[n]||(t.classList.add("hidden"),setTimeout((()=>{t.remove()}),300))}))}function updateChat(){const t=document.getElementById("collab-chat");if(!t)return;const n=t.querySelectorAll(".chat");window.chTracker.recentChat.forEach(((n,s)=>{let{message:r,from:o}=n;const a=`chat-${s}`;if(!document.getElementById(a)){const n=document.createElement("div");n.className="property chat hidden",n.id=a,n.innerHTML=`\n                <span class="message"><span style="font-weight: bold;">${o}:</span> ${r}</span>\n                `,t.appendChild(n),n.classList.remove("hidden")}})),n.forEach((t=>{const n=t.id.replace("chat-","");window.chTracker.recentChat[n]||(t.classList.add("hidden"),setTimeout((()=>{t.remove()}),300))}))}function sendMessage(){let t=document.getElementById("newChatMessage");window.chClient.chat(t.value),t.placeholder="New message",t.value=""}function joinRoom(){let t=document.getElementById("roomName");window.chClient.joinRoom(t.value),t.placeholder="Joined "+t.value,t.value=""}function changeUserName(){let t=document.getElementById("newUserName");window.chClient.setUsername(t.value),t.placeholder="New user: "+t.value,t.value=""}this.ch=window.chClient,this.target=document.getElementById(t),this.target.offsetWidth,this.target.offsetHeight,this.target.innerHTML='<div><div style="margin-bottom: 5px;"><input type="text" id="roomName" name="roomName" placeholder="Enter room"></input><button id="joinRoomButton">Join Room</button><input type="text" id="newUserName" name="newUserName" placeholder="Enter new username" style="margin-left: 5px;"></input><button id="changeUserName">Change username</button></div><div class="collab-container"><div class="collab-item" id="collab-controls"> </div><div class="collab-item" id="collab-events"> </div><div class="collab-item"> <div class="collab-chat-container"><div id="collab-chat"></div><div class="collab-chat-input"><input type="text" id="newChatMessage" name="newChatMessage" placeholder="New message"></input><button id="sendChatMessage">Send</button></div></div></div></div></div>',updateControls(),updateEvents(),updateChat(),setInterval((()=>{updateControls(),updateEvents(),updateChat()}),100),document.getElementById("sendChatMessage").addEventListener("click",sendMessage),document.getElementById("newChatMessage").addEventListener("keypress",(t=>{13===t.keyCode&&sendMessage()})),document.getElementById("joinRoomButton").addEventListener("click",joinRoom),document.getElementById("roomName").addEventListener("keypress",(t=>{13===t.keyCode&&joinRoom()})),document.getElementById("changeUserName").addEventListener("click",changeUserName),document.getElementById("newUserName").addEventListener("keypress",(t=>{13===t.keyCode&&changeUserName()}))}setControlsCallback(t){this.ch.setControlsCallback(t)}setEventsCallback(t){this.ch.setEventsCallback(t)}setChatCallback(t){this.ch.setChatCallback(t)}control(){this.ch.control(...arguments)}event(){this.ch.event(...arguments)}chat(t,n){this.ch.chat(t,n)}setUsername(t){this.ch.setUsername(t)}getControl(t){return this.ch.getControl(t)}on(t,n){this.ch.on(t,n)}getUsers(){this.ch.getUsers()}joinRoom(t){this.ch.joinRoom(t)}leaveRoom(t){this.ch.leaveRoom(t)}getRooms(){this.ch.getRooms()}observeControl(t){this.ch.observeControl(t)}unobserveControl(t){this.ch.unobserveControl(t)}observeAllControls(t){this.ch.observeAllControls(t)}clearControl(t){this.ch.clearControl(t)}observeEvent(t){this.ch.observeEvent(t)}unobserveEvent(t){this.ch.unobserveEvent(t)}observeAllEvents(t){this.ch.observeAllEvents(t)}clearEvent(t){this.ch.clearEvent(t)}}},3670:t=>{"use strict";t.exports=JSON.parse('{"default":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":1,"Hihat1":1,"Toms1":1,"Output1":3.4800000000000013,"Dry Kick1":0.09999999999999971,"Kick Rate1":1,"Snare Rate1":1,"Hihat Rate1":1,"Tom1 Rate1":1,"Tom2 Rate1":1,"Tom3 Rate1":1,"Threshold1":-13.249999999999986,"Ratio1":2.709999999999994,"Distort1":0,"Hat Decay1":0.2970999999999998,"kit1":"LINN"},"electro":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":1,"Hihat1":0.8999999999999999,"Toms1":0.23000000000000007,"Output1":0.9599999999999991,"Dry Kick1":0.1399999999999997,"Kick Rate1":0.8999999999999999,"Snare Rate1":0.8799999999999999,"Hihat Rate1":1.1,"Tom1 Rate1":1.4000000000000004,"Tom2 Rate1":1.3000000000000003,"Tom3 Rate1":1.12,"Threshold1":-28.649999999999995,"Ratio1":7.459999999999997,"Distort1":0.17,"Hat Decay1":0.11889999999999983,"kit1":"CR78"},"breakbeat":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":1,"Hihat1":0.7199999999999998,"Toms1":0.7900000000000005,"Output1":2.3999999999999995,"Dry Kick1":0,"Kick Rate1":1.06,"Snare Rate1":1.12,"Hihat Rate1":0.8399999999999999,"Tom1 Rate1":1.1600000000000001,"Tom2 Rate1":1.1400000000000001,"Tom3 Rate1":1.1,"Threshold1":-28.649999999999995,"Ratio1":12.210000000000006,"Distort1":0.04,"Hat Decay1":0.19809999999999958,"kit1":"breakbeat8"},"techno":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":0.7299999999999998,"Hihat1":0.5399999999999996,"Toms1":0.6200000000000003,"Output1":3.3199999999999994,"Dry Kick1":0,"Kick Rate1":0.8399999999999999,"Snare Rate1":1.12,"Hihat Rate1":1.1400000000000001,"Tom1 Rate1":1.1600000000000001,"Tom2 Rate1":1.1400000000000001,"Tom3 Rate1":1.1,"Threshold1":-28.649999999999995,"Ratio1":12.020000000000005,"Distort1":0.03,"Hat Decay1":0.2376999999999996,"kit1":"Techno"},"snappy":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":0.7299999999999998,"Hihat1":0.5399999999999996,"Toms1":0.4499999999999995,"Output1":3.3199999999999994,"Dry Kick1":0,"Kick Rate1":1.1400000000000001,"Snare Rate1":1.3800000000000003,"Hihat Rate1":1.1400000000000001,"Tom1 Rate1":1.6800000000000006,"Tom2 Rate1":0.52,"Tom3 Rate1":0.21999999999999936,"Threshold1":-28.649999999999995,"Ratio1":1,"Distort1":0.09999999999999999,"Hat Decay1":0.08919999999999953,"kit1":"KPR77"}}')},3705:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Diffuseur=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Diffuseur=class Diffuseur{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=t,this.input=new o.Multiply(1),this.eq=new o.EQ3,this.convolver=new o.Convolver,this.output=new o.Multiply(1),this.buffer=null,this.input.connect(this.eq),this.eq.connect(this.convolver),this.convolver.connect(this.output),this.sampleFiles={plate:"./audio/plate_reverb.mp3",spring:"./audio/spring_reverb.mp3",hall:"./audio/hall_reverb.mp3",ampeg:"./audio/ampeg_amp.mp3",marshall:"./audio/marshall_amp.mp3",vox:"./audio/voxAC30_amp.mp3",dreadnought:"./audio/dreadnought_guitar.mp3",taylor:"./audio/taylor_guitar.mp3",guitar:"./audio/custom_guitar.mp3",bell3:"berklee/bell_mallet_2.mp3",horn:"berklee/casiohorn2.mp3",chotone:"berklee/chotone_c4_!.mp3",voice:"berklee/femalevoice_aa_Db4.mp3",kalimba:"berklee/Kalimba_1.mp3",dreamyPiano:"salamander/A5.mp3",softPiano:"salamander/A4.mp3",piano:"salamander/A3.mp3",casio:"casio/C2.mp3"}}load(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t){const t=document.createElement("input");t.type="file",t.accept="audio/*",t.onchange=t=>{const n=t.target.files[0];if(!n)return void console.log("No file selected");const s=new FileReader;s.onload=()=>{this.buffer=new o.Buffer(s.result),this.convolver.buffer=this.buffer,console.log("Audio loaded into diffuseur")},s.readAsDataURL(n)},t.click()}if("number"==typeof t){const n=Object.keys(this.sampleFiles);t=Math.floor(t)%n.length,t=n[t]}if(t in this.sampleFiles)return console.log(`Diffuseur loading ${t}`),this.sample=t,new Promise(((n,s)=>{new o.Buffer(this.sampleFiles[t],(t=>{this.buffer=t,this.convolver.buffer=t,n()}),s)}));console.error(`The sample "${t}" is not available.`)}async filterIR(t){if(!this.buffer)return void console.error("Buffer not loaded.");const n=o.getContext().rawContext,s=this.buffer.duration,r=new OfflineAudioContext(2,s*n.sampleRate,n.sampleRate),a=this.buffer.get(),c=r.createBufferSource();c.buffer=a;const l=r.createBiquadFilter();return l.type="lowpass",l.frequency.value=t,c.connect(l),l.connect(r.destination),c.start(0),new Promise(((t,n)=>{r.startRendering().then((n=>{const s=new o.Buffer(n);this.buffer=s,this.convolver.buffer=s,t()})).catch(n)}))}async stretchIR(t){if(!this.buffer)return void console.error("Buffer not loaded.");const n=o.getContext().rawContext,s=this.buffer.duration,r=new OfflineAudioContext(2,s*t*n.sampleRate,n.sampleRate),a=this.buffer.get(),c=r.createBufferSource();return c.buffer=a,c.playbackRate.value=1/t,c.connect(r.destination),c.start(0),new Promise(((t,n)=>{r.startRendering().then((n=>{const s=new o.Buffer(n);this.buffer=s,this.convolver.buffer=s,t()})).catch(n)}))}async highpassIR(t){if(!this.buffer)return void console.error("Buffer not loaded.");const n=o.getContext().rawContext,s=this.buffer.duration,r=new OfflineAudioContext(2,s*n.sampleRate,n.sampleRate),a=this.buffer.get(),c=r.createBufferSource();c.buffer=a;const l=r.createBiquadFilter();return l.type="highpass",l.frequency.value=t,c.connect(l),l.connect(r.destination),c.start(0),new Promise(((t,n)=>{r.startRendering().then((n=>{const s=new o.Buffer(n);this.buffer=s,this.convolver.buffer=s,t()})).catch(n)}))}setEQ(t,n,s){this.eq.high.value=s,this.eq.mid.value=n,this.eq.low.value=t}setEQBand(t,n){t<10||n<10?console.log("EQ bands are in Hz"):(this.eq.highFrequency.value=n,this.eq.lowFrequency.value=t)}listSamples(){const t=Object.keys(this.sampleFiles);console.log(t)}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}disconnect(t){t.input?this.output.disconnect(t.input):this.output.disconnect(t)}}},3820:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.DelayOp=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.DelayOp=class DelayOp{constructor(){this.input=new o.Multiply(1),this.hpf=new o.OnePoleFilter({type:"highpass",frequency:100}),this.delay=new o.FeedbackDelay,this.drive=new o.Multiply(.8),this.waveShaper=new o.WaveShaper((t=>.9*Math.tanh(16*t))),this.lpf=new o.Filter({frequency:2e3}),this.panner=new o.Panner(0),this.output=new o.Multiply(1),this.delayTime=new o.Signal(.1),this.input.connect(this.hpf),this.hpf.connect(this.delay),this.delay.connect(this.drive),this.drive.connect(this.waveShaper),this.waveShaper.connect(this.lpf),this.lpf.connect(this.panner),this.panner.connect(this.output),this.delayTime.connect(this.delay.delayTime)}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}}},3941:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Seq=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),o=s(1077);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Seq=class Seq{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"8n",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.synth=t,this.vals=Array.isArray(n)?n:(0,o.parsePitchStringSequence)(n),this._subdivision=s,this._octave=0,this._sustain=.1,this._roll=.02,this._velocity=100,this._transform=t=>t,this.phraseLength=r,this.enable=1,this.min=24,this.max=127,this.loopInstance=null,this.num=a,this.callback=c,this.parent=null,this.index=0,this.createLoop()}get subdivision(){return this._subdivision}set subdivision(t){this._subdivision=t,this.setSubdivision(t)}get octave(){return this._octave}set octave(t){this._octave=t}get sustain(){return this._sustain}set sustain(t){this._sustain=t}get roll(){return this._roll}set roll(t){this._roll=t}get velocity(){return this._velocity}set velocity(t){this._velocity=t}get transform(){return this._transform}set transform(t){if("function"!=typeof t)throw new TypeError("Transform must be a function");this._transform=t}sequence(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"infinite";this.vals=Array.isArray(t)?t:(0,o.parsePitchStringSequence)(t),this.phraseLength=s,this.subdivision=n,this.loopInstance&&this.loopInstance.dispose(),this.createLoop()}drumSequence(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"infinite";this.vals=Array.isArray(t)?t:(0,o.parseStringSequence)(t),this.phraseLength=s,this.subdivision=n,this.loopInstance&&this.loopInstance.dispose(),this.createLoop()}createLoop(){this.loopInstance=new r.Loop((t=>{if(0===this.enable)return;this.index=Math.floor(o.Theory.ticks/r.Time(this.subdivision).toTicks());let n=this.vals[this.index%this.vals.length];null==n&&(n="."),n=this.perform_transform(n),n=this.checkForRandomElement(n);const s=(0,o.parsePitchStringBeat)(n,t),a=s.map((t=>t[1]));let c=this.getNoteParam(this.roll,this.index);for(let t=1;t<s.length;t++)a[t]===a[t-1]&&(s[t][1]=s[t-1][1]+c);for(const n of s)this.callback(n,t,this.index,this.num);"infinite"!==this.phraseLength&&(this.phraseLength-=1,this.phraseLength<1&&this.stop())}),this.subdivision).start(0),this.setSubdivision(this.subdivision),r.Transport.start()}checkForRandomElement(t){if("number"==typeof t)return t;if("string"==typeof t&&t.includes("?")){let n=[];this.vals.forEach((t=>{if("string"==typeof t){const s=/[#b]?[A-Ga-g]/g,r=/[oOxX\*\^]/g,o=/(-?\d+)/g,a=/([oOxX\*\^])\s*(1|2|3)/g;let c=t.match(s);c&&n.push(...c);let l=t.match(r);if(l){n.push(...l);let s=t.match(a);s&&s.forEach((t=>{const[s,r]=t.split(/\s*/);n.push(r)}))}let h=t.match(o);h&&n.push(...h)}})),t=t.replace(/\?/g,(()=>n[Math.floor(Math.random()*n.length)]))}return t}getNoteParam(t,n){return Array.isArray(t)?t[n%t.length]:t}setNoteParam(t,n){for(let s=0;s<n.length;s++)n[s]=t;return n}start(){this.enable=1,this.loopInstance&&this.loopInstance.start()}stop(){this.enable=0,this.loopInstance&&this.loopInstance.stop()}expr(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"16n";const r=Array.from({length:n},((n,s)=>t(s)));this.vals=r.map((t=>"string"==typeof t?t:Array.isArray(t)?JSON.stringify(t):t)),this.phraseLength="infinite",this.sequence(this.vals,s)}setSubdivision(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"8n";this._subdivision=t,this.loopInstance&&(this.loopInstance.interval=r.Time(this.subdivision))}perform_transform(t){if("[]"===t)return".";if(isNaN(Number(t))){if("["===t[0]){if(t.length<3)return".";for(let n=0;n<t.length;n++)if(!isNaN(Number(t[n]))&&""!==t[n].trim()){let s=t[n],r=n;for(;r<t.length-1&&!isNaN(Number(t[r+1]))&&""!==t[r+1].trim();)s+=t[r+1],r+=1;let o=String(this.transform(Number(s)));t=t.slice(0,n)+o+t.slice(r+1),r+=o.length-s.length,n=r}return t}return t}return String(this.transform(Number(t)))}setTransform(t){this.transform=t}}},4154:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.QuadPanner=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),o=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class QuadPanner extends o.MonophonicTemplate{constructor(){super(),this.context=window.audioContext,this.channelMerger=this.context.createChannelMerger(4);let t=window.audioContext.destination.maxChannelCount;window.audioContext.destination.channelCount=t,window.audioContext.destination.channelCountMode="explicit",window.audioContext.destination.channelInterpretation="discrete",this.channelMerger.channelCountMode="explicit",this.channelMerger.channelInterpretation="discrete",this.channelMerger.connect(window.audioContext.destination),this.input=new r.Multiply(1),this.channel=[];for(let t=0;t<4;t++)this.channel.push(new r.Multiply(.5)),this.input.connect(this.channel[t]),this.channel[t].connect(this.channelMerger,0,t);this._x=0,this._y=0,this.output=this.channelMerger}x(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this._x=t,this.pan(this._x,this._y)}y(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this._y=t,this.pan(this._x,this._y)}pan(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;t=Math.max(-1,Math.min(1,t)),n=Math.max(-1,Math.min(1,n));let s=.7;const r=Math.pow((1-t)*(1-n),s),o=Math.pow((1+t)*(1-n),s),a=Math.pow((1-t)*(1+n),s),c=Math.pow((1+t)*(1+n),s),l=.01;this.channel[0].factor.rampTo(r,l),this.channel[1].factor.rampTo(o,l),this.channel[2].factor.rampTo(c,l),this.channel[3].factor.rampTo(a,l)}circle(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const s=t*Math.PI/180,r=Math.cos(s)*n,o=Math.sin(s)*n;this._x=r,this._y=o,this.pan(this._x,this._y)}dispose(){this.lrPanner.dispose(),this.fbPanner.dispose(),this.splitter.disconnect(),this.channelMerger.disconnect(),console.log("SimpleQuadPanner disposed.")}}n.QuadPanner=QuadPanner},4287:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.MidiOut=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(1174),c=s(6325),l=s(1077);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class MidiOut extends a.MonophonicTemplate{constructor(){super(),this.isGlide=!1,this.name="MidiOut",console.log(this.name," loaded"),this.midiOutput=c.midiHandlerInstance,this.channel=1}triggerAttackRelease(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(console.log("AR",t,n,r),r?(o.now(),o.Time(r).toSeconds()):o.now(),o.Time(s).toSeconds(),this.midiOutput){this.channel;const a=t;o.Draw.schedule((()=>{this.midiOutput.sendNoteOn(a,n)}),r),o.Draw.schedule((()=>{this.midiOutput.sendNoteOff(a,0)}),r+s)}}parseNoteString(t,n,s,r){if("."===t[0])return;let a="";a=/^[a-ac-zA-Z]$/.test(t[0][0])?(0,l.pitchNameToMidi)(t[0]):(0,l.intervalToMidi)(t[0],this.min,this.max);const c=t[1];if(a<0)return;let h=this.getNoteParam(this.octave[s],r),u=this.getNoteParam(this.velocity[s],r),d=this.getNoteParam(this.sustain[s],r);try{this.triggerAttackRelease(a+12*h,u,d,n+c*o.Time(this.subdivision[s]))}catch(t){console.log("invalid note",a+12*h,u,d)}}}n.MidiOut=MidiOut},4426:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Caverns=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(3820);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Caverns=class Caverns{constructor(){this.input=new o.Multiply(1),this.delay=[];for(let t=0;t<8;t++)this.delay.push(new a.DelayOp);this.cross=[];for(let t=0;t<8;t++)this.cross.push(new o.Multiply);this.output=new o.Multiply(.125);for(let t=0;t<8;t++){this.input.connect(this.delay[t].input),this.delay[t].connect(this.output);for(let n=t+1;n<8;n++)this.delay[t].connect(this.cross[n]);this.cross[t].connect(this.delay[t].input)}}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}setDelayTime=function(t){for(let n=0;n<8;n++)this.delay[n].delayTime.value=t*1.25**n};setFeedback=function(t){for(let n=0;n<8;n++)this.delay[n].delay.feedback.value=t};setCross=function(t){for(let n=0;n<8;n++)this.cross[n].factor.value=t};setLowpass=function(t){for(let n=0;n<8;n++)this.delay[n].lpf.frequency.value=t};setHighpass=function(t){for(let n=0;n<8;n++)this.delay[n].hpf.frequency=t};setDrive=function(t){for(let n=0;n<8;n++)this.delay[n].drive.factor.value=t};setPanning=function(t){for(let n=0;n<8;n++)this.delay[n].panner.pan.rampTo(Math.sin(n*t),.1)}}},4658:t=>{"use strict";t.exports=window.io},4994:t=>{t.exports=function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports},5164:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Drummer=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),o=s(9672),a=(s(1077),s(6737));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}s(3447);class Drummer extends o.DrumTemplate{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kick",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"acoustic";super(),this.name="Drummer",this.voice=t,this.kit=n,this.drumkitList=["LINN","Techno","TheCheebacabra1","TheCheebacabra2","acoustic-kit","breakbeat13","breakbeat8","breakbeat9","4OP-FM","Bongos","CR78","KPR77","Kit3","Kit8"],this.output=new r.Multiply(1),this.env=new r.Envelope(.001,1,1,10),this.vca=new r.Multiply,this.gain=new r.Multiply(1),this.drum=new r.Player,this.vcf=new r.Filter({type:"lowpass",rolloff:"-12",Q:0,frequency:1e4}),this.vcfEnvDepth=new r.Multiply,this.cutoffFreq=new r.Signal,this.accentEnv=new r.Envelope({attack:.003,decay:.1,sustain:0,release:.1}),this.accentDepth=new r.Multiply,this.drum.connect(this.vcf),this.vcf.connect(this.vca),this.vca.connect(this.output),this.cutoffFreq.connect(this.vcf.frequency),this.env.connect(this.vcfEnvDepth),this.accentEnv.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcf.frequency),this.env.connect(this.gain),this.gain.connect(this.vca.factor),this.accentEnv.connect(this.accentDepth),this.accentDepth.connect(this.vca.factor),this.velocity=new a.SimpleSeq(1),this.strike=new a.SimpleSeq(0),this.curStrike=0,this.damp=new a.SimpleSeq(0),this.chokeRatio=.5,this.choke=new a.SimpleSeq(0),this.decay=new a.SimpleSeq(1),this.tone=new a.SimpleSeq(1),this.accent=new a.SimpleSeq(0),this.accentLevel=.2,this.tuning=new a.SimpleSeq(1),this.subdivision=new a.SimpleSeq("16n"),this.sampleLength=1,this.loadSamples(this.kit),this.prevTime=0}loadKit(t){this.loadSamples(t)}listKits(){console.log(this.drumkitList)}loadSamples(t){this.kit=t,this.drumFolders={"4OP-FM":"4OP-FM",FM:"4OP-FM",Bongos:"Bongos",Bongo:"Bongos",CR78:"CR78",KPR77:"KPR77",Kit3:"Kit3",kit3:"Kit3",Kit8:"Kit8",kit8:"Kit8",LINN:"LINN",linn:"LINN",R8:"R8",Stark:"Stark",stark:"Stark",Techno:"Techno",techno:"Techno",TheCheebacabra1:"TheCheebacabra1",Cheese1:"TheCheebacabra1",TheCheebacabra2:"TheCheebacabra2",Cheese2:"TheCheebacabra2","acoustic-kit":"acoustic-kit",acoustic:"acoustic-kit",Acoustic:"acoustic-kit",breakbeat13:"breakbeat13",breakbeat8:"breakbeat8",breakbeat9:"breakbeat9"},this.kit in this.drumFolders?(console.log(`Drumsampler loading ${this.kit}`),this.baseUrl="https://tonejs.github.io/audio/drum-samples/".concat(this.drumFolders[this.kit]),this.urls={C3:"/kick.mp3",D3:"/snare.mp3","F#3":"/hihat.mp3",F3:"/tom1.mp3",G3:"/tom2.mp3",A3:"/tom3.mp3"},this.drum=new r.Player({url:this.baseUrl.concat("/"+this.voice+".mp3"),onload:()=>{this.sampleLength=this.drum.buffer.duration,console.log("Sample length:",this.sampleLength," seconds"),this.drum.connect(this.vcf)}})):console.error(`The kit "${this.kit}" is not available.`)}trigger(t,n){console.log("trig",t);try{this.drum.volume.setValueAtTime(r.gainToDb(t),n),this.drum.start(n,this.curStrike),this.env.triggerAttackRelease(.001,n)}catch(t){console.log("time error")}}parseNoteString(t,n,s,o){if("."===t[0])return;let a=t[0],c=t[1];this.loopFunc(o,s,a,n+c*r.Time(this.subdivision[s]))}getNoteParam(t,n){return Array.isArray(t)?t[n%t.length]:t}setNoteParam(t,n){for(let s=0;s<n.length;s++)n[s]=t;return n}toneScalar(t,n){t=Math.pow(t,2),this.vcfEnvDepth.factor.setValueAtTime(4e3*t,n),this.cutoffFreq.setValueAtTime(1e4*(1-t),n)}loopFunc(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:127,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.now(),a=s*this.velocity.get(n,t),c=this.decay.get(n,t);this.env.release=this.sampleLength*c,1!=this.choke.get(n,t)&&(c*=this.chokeRatio),this.toneScalar(this.damp.get(n,t),o),this.accent.get(n,t)&&this.accentEnv.triggerAttackRelease(.05),this.curStrike=this.strike.get(n,t),this.trigger(a,o)}}n.Drummer=Drummer},5213:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Feedback=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(3447);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Feedback=class Feedback{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.input=new o.Multiply(t),this.delay=new o.Delay(n),this._feedback=new o.Multiply(s),this._output=new o.Multiply(1),this.input.connect(this.delay),this.delay.connect(this._feedback),this._feedback.connect(this.delay),this.delay.connect(this._output);let r=[{name:"inputGain",min:0,max:1,curve:2,callback:t=>this.input.factor.value=t},{name:"time",min:.01,max:1,curve:2,callback:t=>this.delay.delayTime.value=t},{name:"feedback",min:0,max:1,curve:1,callback:t=>this._feedback.factor.value=t},{name:"outputGain",min:0,max:1,curve:2,callback:t=>this._output.factor.value=t}];this.param=this.generateParameters(r),this.createAccessors(this,this.param)}generateParameters(t){const n={};return t.forEach((t=>{const s=new a.Parameter(t);n[t.name]=s})),n}createAccessors(t,n){Object.keys(n).forEach((s=>{Object.defineProperty(t,s,{get:()=>n[s].value,set:t=>{n[s].value=t}})}))}get(){let t="Parameters:\n";for(let n in this.param){const s=this.param[n];t+=`${s.name}: ${s.value}\n`}}connect(t){t.input?this._output.connect(t.input):this._output.connect(t)}disconnect(t){t.input?this._output.disconnect(t.input):this._output.disconnect(t)}}},5220:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.DrumSampler=void 0;var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(9672),c=r(s(8642)),l=s(1077),h=s(3447),u=s(3941);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class DrumSampler extends a.DrumTemplate{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.gui=n,this.presets=c.default,this.name="DrumSampler",this.kit=t,this.drumkitList=["LINN","Techno","TheCheebacabra1","TheCheebacabra2","acoustic-kit","breakbeat13","breakbeat8","breakbeat9","4OP-FM","Bongos","CR78","KPR77","Kit3","Kit8"],this.closedEnv=new o.Envelope({attack:0,decay:.5,sustain:0,release:.4}),this.openEnv=new o.Envelope({attack:0,decay:1,sustain:0,release:.4}),this.hatVca=new o.Multiply,this.openHatChoke=new o.Multiply,this.comp=new o.Compressor(-20,4),this.distortion=new o.Distortion(.5),this.output=new o.Multiply(.8),this.dry_kick=new o.Multiply(0),this.kickEnv=new o.Envelope(0,1,1,10),this.kick_vca=new o.Multiply,this.kick_gain=new o.Multiply(1),this.kick=(new o.Player).connect(this.kick_vca),this.snareEnv=new o.Envelope(0,1,1,10),this.snare_vca=new o.Multiply,this.snare_gain=new o.Multiply(1),this.snare=(new o.Player).connect(this.snare_vca),this.hihat_vca=new o.Multiply(.9),this.hihat=(new o.Player).connect(this.hihat_vca),this.tom=[],this.tomEnv=[],this.tom_vca=[],this.tom_gain=[];for(let t=0;t<3;t++)this.tomEnv.push(new o.Envelope(0,1,1,10)),this.tom_vca.push(new o.Multiply),this.tom_gain.push(new o.Multiply(.8)),this.tom.push(new o.Player);for(let t=0;t<3;t++)this.tom[t].connect(this.tom_vca[t]),this.tomEnv[t].connect(this.tom_gain[t]),this.tom_gain[t].connect(this.tom_vca[t].factor),this.tom_vca[t].connect(this.comp);this.kickEnv.connect(this.kick_gain),this.kick_gain.connect(this.kick_vca.factor),this.kick_vca.connect(this.comp),this.snareEnv.connect(this.snare_gain),this.snare_gain.connect(this.snare_vca.factor),this.snare_vca.connect(this.comp),this.hihat_vca.connect(this.hatVca),this.kick_vca.connect(this.dry_kick),this.comp.connect(this.distortion),this.distortion.connect(this.output),this.closedEnv.connect(this.hatVca.factor),this.openEnv.connect(this.openHatChoke),this.openHatChoke.connect(this.hatVca.factor),this.hatVca.connect(this.comp),this.dry_kick.connect(this.output),this.newKick=new DrumVoice,this.newKick.output.connect(this.comp),this.newHat=new DrumVoice,this.newHat.output.connect(this.comp),this.p1=new DrumVoice,this.p1.output.connect(this.comp),setTimeout((()=>this.loadSamples(this.kit)),100),this.hatDecay=.05,this.prevTime=0,this.kickGhostVelocity=new Array(10).fill(.25),this.snareGhostVelocity=new Array(10).fill(1/4),this.kickVelocity=new Array(10).fill(1),this.snareVelocity=new Array(10).fill(1),this.closedVelocity=new Array(10).fill(.75),this.openVelocity=new Array(10).fill(1),this.p1Velocity=new Array(10).fill(1),this.p2Velocity=new Array(10).fill(1),this.p3Velocity=new Array(10).fill(1),null!==this.gui&&(this.initGui(),this.hideGui(),setTimeout(this.loadPreset("default"),1e3));for(let t=0;t<10;t++)this.subdivision[t]="16n"}get kickDecay(){return this.kickEnv.release}set kickDecay(t){this.kickEnv.release=t}get snareDecay(){return this.snareEnv.release}set snareDecay(t){this.snareEnv.release=t}get closedDecay(){return this.closedEnv.release}set closedDecay(t){this.closedEnv.release=t}get openDecay(){return this.openEnv.decay}set openDecay(t){this.openEnv.decay=t}get p1Decay(){return this.tomEnv[0].release}set p1Decay(t){this.tomEnv[0].release=t}get p2Decay(){return this.tomEnv[1].release}set p2Decay(t){this.tomEnv[1].release=t}get p3Decay(){return this.tomEnv[2].release}set p3Decay(t){this.tomEnv[2].release=t}get kickRate(){return this.kick.playbackRate}set kickRate(t){this.kick.playbackRate=t}get snareRate(){return this.snare.playbackRate}set snareRate(t){this.snare.playbackRate=t}get closedRate(){return this.hihat.playbackRate}set closedRate(t){this.hihat.playbackRate=t}get p1Rate(){return this.tom[0].playbackRate}set p1Rate(t){this.tom[0].playbackRate=t}get p2Rate(){return this.tom[1].playbackRate.playbackRate}set p2Rate(t){this.tom[1].playbackRate=t}get p3Rate(){return this.tomEnv[2].playbackRate}set p3Rate(t){this.tom[2].playbackRate=t}get threshold(){return this.comp.threshold.value}set threshold(t){this.comp.threshold.value=t}get ratio(){return this.comp.ratio.value}set ratio(t){this.comp.ratio.value=t}get dist(){return this.distortion.distortion}set dist(t){this.distortion.distortion=t}get volume(){return this.output.factor.value}set volume(t){this.output.factor.value=t}set dryKick(t){this.dry_kick.factor.value=t}get dryKick(){return this.dry_kick.factor.value}setVelocity(t,n,s){if(s>1&&(s/=127),n>=0&&n<10)switch(t){case"kick":case"O":this.kickVelocity[n]=s;break;case"snare":case"X":this.snareVelocity[n]=s;break;case"closed":case"*":this.closedVelocity[n]=s;break;case"open":case"^":this.openVelocity[n]=s;break;case"p1":case"1":case"p2":case"2":case"p3":case"3":this.p1Velocity[n]=s;break;case"o":this.kickGhostVelocity[n]=s;break;case"x":this.snareGhostVelocity[n]=s}else for(let r=0;r<10;r++)switch(t){case"kick":case"O":this.kickVelocity[r]=s;break;case"snare":case"X":this.snareVelocity[r]=s;break;case"closed":case"*":this.closedVelocity[r]=s;break;case"open":case"^":this.openVelocity[r]=s;break;case"p1":case"1":case"p2":case"2":case"p3":case"3":this.p1Velocity[n]=r;break;case"o":this.kickGhostVelocity[n]=s;break;case"x":this.snareGhostVelocity[n]=s}}loadKit(t){this.loadSamples(t)}listKits(){console.log(this.drumkitList)}loadSamples(t){if(this.kit=t,this.drumFolders={"4OP-FM":"4OP-FM",FM:"4OP-FM",Bongos:"Bongos",Bongo:"Bongos",CR78:"CR78",KPR77:"KPR77",Kit3:"Kit3",kit3:"Kit3",Kit8:"Kit8",kit8:"Kit8",LINN:"LINN",linn:"LINN",R8:"R8",Stark:"Stark",stark:"Stark",Techno:"Techno",techno:"Techno",TheCheebacabra1:"TheCheebacabra1",Cheese1:"TheCheebacabra1",TheCheebacabra2:"TheCheebacabra2",Cheese2:"TheCheebacabra2","acoustic-kit":"acoustic-kit",acoustic:"acoustic-kit",Acoustic:"acoustic-kit",breakbeat13:"breakbeat13",breakbeat8:"breakbeat8",breakbeat9:"breakbeat9"},this.kit in this.drumFolders)console.log(`Drumsampler loading ${this.kit}`),this.baseUrl="https://tonejs.github.io/audio/drum-samples/".concat(this.drumFolders[this.kit]);else{if("default"!==this.kit)return void console.error(`The kit "${this.kit}" is not available.`);this.baseUrl="./audio/drumDefault"}this.urls={C3:"/kick.mp3",D3:"/snare.mp3","F#3":"/hihat.mp3",F3:"/tom1.mp3",G3:"/tom2.mp3",A3:"/tom3.mp3"};try{this.kick.load(this.baseUrl.concat("/kick.mp3")),this.snare.load(this.baseUrl.concat("/snare.mp3")),this.hihat.load(this.baseUrl.concat("/hihat.mp3")),this.newHat.voice.load(this.baseUrl.concat("/hihat.mp3")),this.tom[0].load(this.baseUrl.concat("/tom1.mp3")),this.tom[1].load(this.baseUrl.concat("/tom2.mp3")),this.tom[2].load(this.baseUrl.concat("/tom3.mp3")),this.newKick.voice.load(this.baseUrl.concat("/kick.mp3"))}catch(t){console.log("unable to load samples - try calling loadPreset(`default`)")}}trigger(t,n,s){if(t.loaded)switch(t){case"kick":this.triggerVoice(this.kick,n,s);break;case"snare":this.triggerVoice(this.snare,n,s);break;case"hihat":this.triggerVoice(this.hihat,n,s);break;case"tom1":this.triggerVoice(this.tom[0],n,s);break;case"tom2":this.triggerVoice(this.tom[1],n,s);break;case"tom3":this.triggerVoice(this.tom[2],n,s);break;default:console.error(`Unknown voice: ${t}`)}else console.error("Sampler is not loaded yet.")}sequence(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite";console.log(t),this.seq[s]?this.seq[s].drumSequence(t,n,r):(this.seq[s]=new u.Seq(this,"0",n,r,s,this.triggerDrum.bind(this)),this.seq[s].parent=this,this.seq[s].vals=(0,l.parseStringSequence)(t),this.seq[s].loopInstance.stop(),this.seq[s].createLoop=this.newCreateLoop,this.seq[s].createLoop())}setSeq(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.seq[s]=(0,l.parseStringSequence)(t),n&&this.setSubdivision(n,s)}createLoop(t,n){null===this.loopInstance[n]&&(this.loopInstance[n]=new o.Loop((t=>{if(this.index=Math.floor(o.Transport.ticks/o.Time(this.subdivision[n]).toTicks()),0===this.enable[n])return;0==n&&this.callback(this.index);let s=this.seq[n][this.index%this.seq[n].length];s=this.checkForRandomElement(n,s);const r=(0,l.parseStringBeat)(s,t);for(const s of r)this.triggerDrum(s[0],n,t+s[1]*o.Time(this.subdivision[n]));"infinite"!==this.phraseLength[n]&&(this.phraseLength[n]-=1,this.phraseLength[n]<1&&this.stop(n))}),t).start(0),o.Transport.start(),console.log("loop started")),t&&setTimeout(this.setSubdivision(t,n),100),this.start(n)}newCreateLoop(){console.log("loop made"),this.loopInstance=new o.Loop((t=>{if(0===this.enable)return;this.index=Math.floor(o.Transport.ticks/o.Time(this.subdivision).toTicks());let n=this.vals[this.index%this.vals.length];n=this.perform_transform(n),n=this.checkForRandomElement(n);const s=(0,l.parseStringBeat)(n,t);for(const n of s)this.parent.triggerDrum(n[0],0,t+n[1]*o.Time(this.subdivision))}),this.subdivision).start(0),this.setSubdivision(this.subdivision),o.Transport.start(),console.log("loop started"),this.loopInstance.start(),o.Transport.start()}triggerDrum=(t,n,s)=>{switch(t=t[0]){case".":break;case"0":case"O":this.newKick.trigger(1,1,s);break;case"o":this.newKick.trigger(.5,1.5,s);break;case"X":this.triggerVoice(this.snare,1,s);break;case"x":this.triggerVoice(this.snare,.5,s);break;case"*":this.newHat.triggerChoke(.75,.1,s);break;case"^":this.newHat.trigger(.75,1,s);break;case"1":this.triggerVoice(this.tom[0],1,s);break;case"2":this.triggerVoice(this.tom[1],1,s);break;case"3":this.triggerVoice(this.tom[2],1,s);break;default:console.log("triggerDrum(), no matching drum voice ",t,"\n")}};triggerNew(t,n,s){console.log("new"),this.newKick.voice.volume.setValueAtTime(o.gainToDb(n),s),this.newKick.voice.start(s),this.newKick.env1.triggerAttackRelease(.001,s)}triggerVoice(t,n,s){let r=null;t===this.kick?r=this.kickEnv:t===this.snare?r=this.snareEnv:t===this.tom[0]?r=this.tomEnv[0]:t===this.tom[1]?r=this.tomEnv[1]:t===this.tom[2]?r=this.tomEnv[2]:t===this.hihat?(this.closedEnv.triggerAttackRelease(.001,s),this.openHatChoke.factor.setValueAtTime(0,s)):"openHat"===t&&(t=this.hihat,this.openHatChoke.factor.setValueAtTime(1,s),this.openEnv.triggerAttackRelease(10,s));try{t.volume.setValueAtTime(o.gainToDb(n),s),t.start(s),null!==r&&r.triggerAttackRelease(.001,s)}catch(t){}}drawBeat(t){const n=["^","*","1","2","3","x","X","o","O"],s=document.getElementById(t),r=this.seq.original;s.innerHTML="";for(let t=0;t<r.length;t++){const o=r[t],a=n.indexOf(o);if(-1!==a){const n=20*a,r=40*t,c=document.createElement("div");c.className="beat",c.style.transform=`translate(${r}px, ${n}px)`,c.textContent=o,s.appendChild(c)}}}loadPreset(t){setTimeout((()=>{this.curPreset=t;const n=this.presets[this.curPreset];if(n){console.log("Loading preset ",this.curPreset,n);for(let t in n)try{for(let s of Object.values(this.gui_elements))s.id===t&&"momentary"!==s.type&&s.set(n[t])}catch(t){console.log(t)}}else console.log("No preset of name ",t)}),1e3)}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;t&&(this.gui=t),this.x=n,this.y=s,this.enables_array=[],this.values_array=[];const r=this.createKnob("Kick",0,40,0,1,.5,[200,50,0],(t=>this.newKick.output.factor.value=t)),o=this.createKnob("Snare",0,20,0,1,.5,[200,50,0],(t=>this.snare_gain.factor.value=t)),a=this.createKnob("Hihat",0,0,0,1,.5,[200,50,0],(t=>this.newHat.output.factor.value=t)),c=this.createKnob("Toms",0,60,0,1,.5,[200,50,0],(t=>{this.tom_gain[0].factor.value=t,this.tom_gain[1].factor.value=t,this.tom_gain[2].factor.value=t})),l=this.createKnob("decay",10,40,0,1,.5,[200,50,0],(t=>this.newKick.decay=10*t+.01)),h=this.createKnob("decay",10,20,0,1,.5,[200,50,0],(t=>this.snareEnv.release=10*t+.01)),u=this.createKnob("decay",10,60,0,1,.5,[200,50,0],(t=>{this.tomEnv[0].release=10*t+.01,this.tomEnv[1].release=10*t+.01,this.tomEnv[2].release=10*t+.01})),d=this.createKnob("Output",80,60,0,4,1,[200,50,0],(t=>this.output.factor.value=t)),f=this.createKnob("Dry Kick",40,40,0,1,.4,[200,50,0],(t=>this.dry_kick.factor.value=t)),v=this.createKnob("rate",20,40,0,2,.4,[200,50,0],(t=>this.newKick.rate=t)),g=this.createKnob("rate",20,20,0,2,.4,[200,50,0],(t=>this.snare.playbackRate=t)),m=this.createKnob("rate",20,0,0,2,.4,[200,50,0],(t=>this.newHat.rate=t)),y=this.createKnob("1 Rate",20,60,0,2,.4,[200,50,0],(t=>this.tom[0].playbackRate=t)),b=this.createKnob("2 Rate",30,60,0,2,.4,[200,50,0],(t=>this.tom[1].playbackRate=t)),_=this.createKnob("3 Rate",40,60,0,2,.4,[200,50,0],(t=>this.tom[2].playbackRate=t)),w=this.createKnob("Threshold",60,20,-60,-5,.5,[200,50,0],(t=>this.comp.threshold.value=t)),k=this.createKnob("Ratio",60,40,1,20,.5,[200,50,0],(t=>this.comp.ratio.value=t)),x=this.createKnob("Distort",60,60,0,1,.5,[200,50,0],(t=>this.distortion.distortion=t)),S=this.createKnob("Closed Decay",40,0,.01,1,.75,[200,50,0],(t=>this.newHat.choke=t)),C=this.createKnob("Open Decay",50,0,.01,2,.75,[200,50,0],(t=>this.newHat.decay=t)),M=this.gui.Dropdown({label:"kit",dropdownOptions:this.drumkitList,x:80,y:10,size:15,callback:t=>{this.loadSamples(t)}});this.gui_elements=[r,o,a,c,l,h,u,d,f,v,g,m,y,b,_,w,k,x,S,C,M]}createKnob(t,n,s,r,o,a,c,l){return this.gui.Knob({label:t,min:r,max:o,size:a,accentColor:c,x:n+this.x,y:s+this.y,callback:l,curve:1,border:4,showLabel:1,showValue:1})}}n.DrumSampler=DrumSampler;class DrumVoice{constructor(){this.chokeRatio=.1,this.decayTime=1,this.startPoint=0,this.env=new o.Envelope(0,1,1,10),this.vca=new o.Multiply,this.output=new o.Multiply(1),this.dryOut=new o.Multiply(0),this.voice=(new o.Player).connect(this.vca),this.vca.connect(this.output),this.voice.connect(this.dryOut),this.env.connect(this.vca.factor);let t=[{name:"choke",min:0,max:1,curve:2,callback:t=>{this.chokeRatio=t}},{name:"decay",min:0,max:5,curve:3,callback:t=>{this.decayTime=t}},{name:"amp",min:0,max:1,curve:2,callback:t=>this.output.factor.value=t},{name:"dry",min:0,max:1,curve:2,callback:t=>this.dryOut.factor.value=t},{name:"rate",value:1,min:-10,max:10,curve:1,callback:t=>{this.voice.playbackRate=Math.abs(t),t<0&&(this.voice.reverse=!0)}}];this.param=this.generateParameters(t),this.createAccessors(this,this.param)}setDecayTime(t,n){this.decayTime=t,this.chokeRatio=n,this.env.release=t*n}triggerSample(t,n,s){try{this.voice.volume.setValueAtTime(o.gainToDb(t),s),this.voice.start(s,this.startPoint),this.env.triggerAttackRelease(.001,s)}catch(t){console.log("time error",t)}}trigger(t,n,s){this.env.release=this.decayTime,this.env.decay=this.decayTime,this.triggerSample(t,n,s)}triggerChoke(t,n,s){this.env.release=this.decayTime*this.chokeRatio,this.env.decay=this.decayTime*this.chokeRatio,this.triggerSample(t,n,s)}generateParameters(t){const n={};return t.forEach((t=>{const s=new h.Parameter(t);n[t.name]=s})),n}createAccessors(t,n){console.log(n),Object.keys(n).forEach((s=>{const r=n[s];if("function"!=typeof r.set)throw new Error(`Parameter '${s}' does not have a set method`);const o={get:(t,n)=>"string"!=typeof n||isNaN(n)?t.get():t.get(parseInt(n)),set:(t,n,s)=>(console.log(t,n,s),"string"!=typeof n||isNaN(n)?(t.set(s),!0):(t.set(s,parseInt(n)),!0))};Object.defineProperty(t,s,{get:()=>new Proxy(r,o),set:t=>r.set(t)})}))}setParameter(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.param[t];if(!r)throw new Error(`Parameter '${t}' does not exist.`);s?r.callback(n,s):r.callback(n),r.guiElement&&r.guiElement.setValue(n)}get(){let t="Parameters:\n";for(let n in this.param){const s=this.param[n];t+=`${s.name}: ${s._value}\n`}console.log(t)}}},5294:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.NoiseVoice=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.NoiseVoice=class NoiseVoice{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=t,this.source=(new o.Noise).start(),this.gain=new o.Multiply(.5),this.waveshaper=new o.WaveShaper((t=>Math.tanh(8*t))),this.hpf=new o.Filter({frequency:200,type:"highpass",Q:0}),this.lpf=new o.Filter({frequency:1e3,type:"lowpass",Q:0}),this.vca=new o.Multiply(0),this.env=new o.Envelope({attack:.01,decay:.1,sustain:0,release:.1}),this.velocity=new o.Signal(1),this.velocity_depth=new o.Multiply(1),this.env_depth=new o.Multiply(1),this.direct=new o.Signal(1),this.baseCutoff=new o.Signal(0),this.cutoffSignal=new o.Signal(1e3),this.hpf_band=new o.Multiply,this.lpf_band=new o.Multiply,this.hpf_env_depth=new o.Multiply,this.lpf_env_depth=new o.Multiply,this.source.connect(this.gain),this.gain.connect(this.waveshaper),this.waveshaper.connect(this.hpf),this.hpf.connect(this.lpf),this.lpf.connect(this.vca),this.env.connect(this.velocity_depth),this.velocity.connect(this.velocity_depth.factor),this.velocity_depth.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.direct.connect(this.vca.factor),this.baseCutoff.connect(this.hpf.frequency),this.baseCutoff.connect(this.lpf.frequency),this.cutoffSignal.connect(this.hpf.frequency),this.cutoffSignal.connect(this.lpf.frequency),this.cutoffSignal.connect(this.hpf_band),this.cutoffSignal.connect(this.lpf_band),this.hpf_band.connect(this.hpf.frequency),this.lpf_band.connect(this.lpf.frequency),this.env.connect(this.hpf_env_depth),this.env.connect(this.lpf_env_depth),this.hpf_env_depth.connect(this.hpf.frequency),this.lpf_env_depth.connect(this.lpf.frequency)}setCutoff(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.cutoffSignal.setValueAtTime(t,n):this.cutoffSignal.value=t}setResonance(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s?("both"!==n&&"lpf"!==n||this.lpf.Q.setValueAtTime(t,s),"both"!==n&&"hpf"!==n||this.hpf.Q.setValueAtTime(t,s)):("both"!==n&&"lpf"!==n||(this.lpf.Q.value=t),"both"!==n&&"hpf"!==n||(this.hpf.Q.value=t))}setBandwidth(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s?("both"!==n&&"hpf"!==n||this.hpf_band.factor.setValueAtTime(1-Math.pow(2,1/t),s),"both"!==n&&"lpf"!==n||this.lpf_band.factor.setValueAtTime(1-Math.pow(2,t),s)):("both"!==n&&"hpf"!==n||(this.hpf_band.factor.value=1-Math.pow(2,1/t)),"both"!==n&&"lpf"!==n||(this.lpf_band.factor.value=1-Math.pow(2,t)))}triggerAttack(t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n?(this.env.triggerAttack(n),this.setCutoff(t,n)):(this.env.triggerAttack(),this.setCutoff(t),console.log("att",t))}triggerRelease(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?this.env.triggerRelease(t):this.env.triggerRelease()}triggerAttackRelease(t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;s?(this.env.triggerAttackRelease(n,s),this.setCutoff(t,s)):(this.env.triggerAttackRelease(n),this.setCutoff(t))}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[200,200,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r&&(this.gui=r),this.x=t,this.y=n,this.cutoff_knob=this.gui.Knob({label:"cutoff",mapto:this.baseCutoff,min:10,max:15e3,curve:2,x:0+this.x,y:0+this.y,size:.25,accentColor:s}),this.resonance_knob=this.gui.Knob({label:"Q",callback:t=>this.setResonance(t),min:0,max:30,curve:1.5,x:0+this.x,y:15+this.y,size:.25,accentColor:s}),this.bandwidth_knob=this.gui.Knob({label:"width",callback:t=>this.setBandwidth(t),min:-10,max:10,curve:2,x:0+this.x,y:30+this.y,size:.25,accentColor:s}),this.hpf_env_knob=this.gui.Knob({label:"hpf env",mapto:this.hpf_env_depth.factor,min:0,max:5e3,curve:2,x:0+this.x,y:45+this.y,size:.2,accentColor:s}),this.lpf_env_knob=this.gui.Knob({label:"lpf env",mapto:this.lpf_env_depth.factor,min:0,max:5e3,curve:2,x:0+this.x,y:60+this.y,size:.2,accentColor:s})}setADSR(t,n,s,r){this.env.attack=t>.001?t:.001,this.env.decay=n>.01?n:.01,this.env.sustain=Math.abs(s)<1?s:1,this.env.release=r>.01?r:.01}position(t,n){this.cutoff_knob.x=0+t,this.cutoff_knob.y=0+n,this.resonance_knob.x=0+t,this.resonance_knob.y=15+n,this.bandwidth_knob.x=0+t,this.bandwidth_knob.y=30+n,this.hpf_env_knob.x=0+t,this.hpf_env_knob.y=45+n,this.lpf_env_knob.x=0+t,this.lpf_env_knob.y=60+n}connect(t){this.vca.connect(t)}}},5322:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Drone=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=r(s(8272)),c=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class Drone extends c.MonophonicTemplate{constructor(){super(),this.presets=a.default,this.name="Drone",this.frequency=new o.Signal(100),this.frequencyCV=new o.Signal,this.frequency_scalar=new o.Multiply(1),this.detune_scalar=new o.Multiply(1),this.vco_1=(new o.PulseOscillator).start(),this.vco_2=(new o.PulseOscillator).start(),this.frequency.connect(this.frequency_scalar),this.frequencyCV.connect(this.frequency_scalar.factor),this.frequency_scalar.connect(this.vco_1.frequency),this.frequency_scalar.connect(this.detune_scalar),this.detune_scalar.connect(this.vco_2.frequency),this.crossfade=new o.CrossFade,this.crossfade_lfo_depth=new o.Multiply,this.vco_1.connect(this.crossfade.a),this.vco_2.connect(this.crossfade.b),this.vcf=new o.Filter({type:"lowpass",rolloff:-24,Q:0,cutoff:3e3}),this.crossfade.connect(this.vcf),this.crossfade_constant=new o.Signal(0),this.crossfade_lfo_depth.connect(this.crossfade.fade),this.crossfade_constant.connect(this.crossfade.fade),this.vca=new o.Multiply,this.lfo_vca=new o.Multiply(1),this.lfo_vca_constant=new o.Signal(1),this.panner=new o.Panner(0),this.output=new o.Multiply(.25),this.vcf.connect(this.lfo_vca),this.lfo_vca.connect(this.vca),this.lfo_vca_constant.connect(this.lfo_vca.factor),this.vca.connect(this.panner),this.panner.connect(this.output),this.env=new o.Envelope,this.velocity=new o.Signal(1),this.velocity_depth=new o.Multiply(1),this.env.connect(this.velocity_depth),this.velocity_depth.connect(this.vca.factor),this.velocity.connect(this.velocity_depth.factor),this.cutoffSig=new o.Signal(1e3),this.cutoffSig.connect(this.vcf.frequency),this.cutoffCV=new o.Signal,this.cutoffCV.connect(this.vcf.frequency),this.keyTracking=new o.Multiply(.1),this.frequency.connect(this.keyTracking),this.keyTracking.connect(this.vcf.frequency),this.vcf_env=new o.Envelope,this.vcf_env_depth=new o.Multiply,this.vcf_env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.lfo=new o.Oscillator(.5).start(),this.vca_constant=new o.Signal(1),this.amp_lfo_depth=new o.Multiply(0),this.lfo.connect(this.amp_lfo_depth),this.amp_lfo_depth.connect(this.lfo_vca.factor),this.pitch_lfo_depth=new o.Multiply(0),this.lfo.connect(this.pitch_lfo_depth),this.lfo.connect(this.crossfade_lfo_depth),this.frequency_constant=new o.Signal(1),this.pitch_lfo_depth.connect(this.frequency_scalar.factor),this.frequency_constant.connect(this.frequency_scalar.factor),this.pwm_lfo_depth=new o.Multiply,this.lfo.connect(this.pwm_lfo_depth)}triggerAttack=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=o.Midi(t).toFrequency();n/=127,s?(this.frequency.setValueAtTime(r,s),this.env.triggerAttack(s),this.vcf_env.triggerAttack(s),this.velocity.setValueAtTime(Math.pow(n,2),s)):(this.frequency.value=r,this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.velocity.value=Math.pow(n,2))};triggerRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?(this.env.triggerRelease(n),this.vcf_env.triggerRelease(n)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())};triggerAttackRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=o.Midi(t).toFrequency(),n/=127,r?(this.frequency.setValueAtTime(t,r),this.env.triggerAttackRelease(s,r),this.vcf_env.triggerAttackRelease(s,r),this.velocity.setValueAtTime(Math.pow(n,2),r)):(this.frequency.value=t,this.env.triggerAttackRelease(s),this.vcf_env.triggerAttackRelease(s),this.velocity.value=Math.pow(n,2))};shapeVco(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=[];for(let t=0;t<64;t++)a.push(1/Math.pow(t+1,r)*16*(t%2<2-o)*Math.abs(1-Math.sin(t*Math.PI*n+Math.PI/2)*s));0===t?this.vco_1.partials=a:this.vco_2.partials=a}setHighpass(t){null!==this.super&&(this.super.hpf.frequency.value=t)}initGui(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.gui=t,this.x=n,this.y=s,this.vco_mix=this.createKnob("vco_mix",5,5,0,1,.75,[200,50,0],(t=>this.crossfade_constant.value=t)),this.detune=this.createKnob("detune",15,5,1,2,.75,[200,50,0],(t=>this.detune_scalar.factor.value=t)),this.cutoff=this.createKnob("cutoff",25,5,0,1e4,.75,[200,50,0],(t=>this.cutoffSig.value=t)),this.vcf_env_knob=this.createKnob("vcf env",35,5,0,5e3,.75,[200,50,0],(t=>this.vcf_env_depth.factor.value=t)),this.vcf_Q_knob=this.createKnob("Q",45,5,0,20,.75,[200,50,0],(t=>this.vcf.Q.value=t)),this.keyTracking_knob=this.createKnob("key vcf",55,5,0,1,.75,[200,50,0],(t=>this.keyTracking.factor.value=t)),this.highpass_knob=this.createKnob("hpf",65,5,10,3e3,.75,[200,50,0],(t=>this.setHighpass(t))),this.attack_knob=this.createKnob("a",5,45,.005,.5,.5,[200,50,0],(t=>this.env.attack=t)),this.decay_knob=this.createKnob("d",15,45,.01,10,.5,[200,50,0],(t=>this.env.decay=t)),this.sustain_knob=this.createKnob("s",25,45,0,1,.5,[200,50,0],(t=>this.env.sustain=t)),this.release_knob=this.createKnob("r",35,45,0,20,.5,[200,50,0],(t=>this.env.release=t)),this.vcf_attack_knob=this.createKnob("a",5,70,.005,.5,.5,[200,50,0],(t=>this.vcf_env.attack=t)),this.vcf_decay_knob=this.createKnob("d",15,70,.01,10,.5,[200,50,0],(t=>this.vcf_env.decay=t)),this.vcf_sustain_knob=this.createKnob("s",25,70,0,1,.5,[200,50,0],(t=>this.vcf_env.sustain=t)),this.vcf_release_knob=this.createKnob("r",35,70,0,20,.5,[200,50,0],(t=>this.vcf_env.release=t)),this.lfo_freq_knob=this.createKnob("lfo",45,65,0,20,.5,[200,50,0],(t=>this.lfo.frequency.value=t)),this.lfo_vibrato=this.createKnob("vibrato",55,65,0,.1,.5,[200,50,0],(t=>this.pitch_lfo_depth.factor.value=t)),this.lfo_tremolo=this.createKnob("tremolo",65,65,0,1,.5,[200,50,0],(t=>this.amp_lfo_depth.factor.value=t)),this.lfo_blend_knob=this.createKnob("blend",75,65,0,1,.5,[200,50,0],(t=>this.crossfade_lfo_depth.factor.value=t)),this.vco1_shape_knob=this.createKnob("shape1",75,25,0,1,.6,[200,50,0],(t=>this.shapeVco(0,2*t+1))),this.vco2_shape_knob=this.createKnob("shape2",85,25,0,1,.6,[200,50,0],(t=>this.shapeVco(1,2*t+1))),this.pan_knob=this.createKnob("pan",85,65,0,1,.5,[200,50,0],(t=>{this.super.pan(t)})),this.gui_elements=[this.vco_mix,this.detune,this.cutoff,this.vcf_env_knob,this.vcf_Q_knob,this.keyTracking_knob,this.highpass_knob,this.attack_knob,this.decay_knob,this.sustain_knob,this.release_knob,this.vcf_attack_knob,this.vcf_decay_knob,this.vcf_sustain_knob,this.vcf_release_knob,this.lfo_freq_knob,this.lfo_vibrato,this.lfo_tremolo,this.lfo_blend_knob,this.pan_knob,this.vco1_shape_knob,this.vco2_shape_knob]}}n.Drone=Drone},5324:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sketch=void 0;var _p5Elements=__webpack_require__(582);const sketch=p=>{let grey=p.color(220,229,234),div;p.setColor=_p5Elements.setColor,p.setFont=_p5Elements.setFont,p.debug=_p5Elements.debug,p.setTheme=_p5Elements.setTheme,p.listThemes=_p5Elements.listThemes,p.setThemeParameters=_p5Elements.setThemeParameters,p.exportTheme=_p5Elements.exportTheme,p.p5Code="",p.Debug=function(){p.debug()},p.setup=function(){p.canvas.parentElement.id;let t=document.getElementById(p.canvas.parentElement.id),n=p.initialize(t,grey);p.width=n[0],p.height=n[1],p.frame=0,p.x=0,p.y=0,p.capture=null},p.draw=function(){p.drawBackground();try{eval(p.p5Code)}catch(t){console.log("Error in p5Code: ",t)}p.frame+=1,p.drawElements()},p.mousePressed=function(){for(const t of Object.values(p.elements))if("string"!=typeof t)try{t.isPressed()}catch(t){}},p.mouseReleased=function(){for(const t of Object.values(p.elements))if("string"!=typeof t)try{t.isReleased()}catch(t){}},p.mouseClicked=function(){for(const t of Object.values(p.elements))if("string"!=typeof t)try{t.isClicked()}catch(t){}},p.mouseDragged=function(){for(const t of Object.values(p.elements))if("string"!=typeof t)try{t.isDragged()}catch(t){}},p.windowResized=function(){},p.openWebcam=function(t,n){p.capture=p.createCapture(p.VIDEO),p.capture.size(t,n),p.capture.hide(),console.log("Webcam opened with resolution:",t,"x",n)}};exports.sketch=sketch},5493:(t,n,s)=>{"use strict";var r=s(4994);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.Percussion=void 0,r(s(5897)),function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}r.default=t,s&&s.set(t,r)}(s(5726)),n.Percussion=class Percussion{constructor(t){console.log(t)}trigger=function(t){t?(this.env.triggerAttackRelease(.01,t),this.pitch_env.triggerAttackRelease(.01,t)):(this.env.triggerAttackRelease(.01),this.pitch_env.triggerAttackRelease(.01))};connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}disconnect(t){t.input?this.output.disconnect(t.input):this.output.disconnect(t)}}},5726:t=>{"use strict";t.exports=window.Tone},5897:t=>{"use strict";t.exports=window.p5},5923:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.AnalogDelay=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=(s(3820),s(3447));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.AnalogDelay=class AnalogDelay{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.input=new o.Multiply(1),this.highpass=new o.Filter({type:"highpass",frequency:20,Q:0}),this.ws_input=new o.Multiply(.125),this.waveShaper=new o.WaveShaper((t=>Math.tanh(t))),this.vcf=new o.Filter({type:"lowpass",frequency:5e3,Q:0,slope:"-12"}),this.vcfR=new o.Filter({type:"lowpass",frequency:5e3,Q:0,slope:"-12"}),this.delay=new o.Delay(t,t),this.delayR=new o.Delay(t,t),this._delayRatio=.75,this.feedbackMult=new o.Multiply(n),this.feedbackMultR=new o.Multiply(n),this.merge=new o.Merge(2),this.wetSig=new o.Multiply(1),this.drySig=new o.Multiply(0),this.output=new o.Multiply(1),this.input.connect(this.drySig),this.input.connect(this.highpass),this.highpass.connect(this.ws_input),this.ws_input.connect(this.waveShaper),this.waveShaper.connect(this.vcf),this.waveShaper.connect(this.vcfR),this.vcf.connect(this.delay),this.vcfR.connect(this.delayR),this.delay.connect(this.feedbackMult),this.delayR.connect(this.feedbackMultR),this.feedbackMult.connect(this.vcf),this.feedbackMultR.connect(this.vcfR),this.delay.connect(this.merge,0,0),this.delayR.connect(this.merge,0,1),this.merge.connect(this.wetSig),this.wetSig.connect(this.output),this.drySig.connect(this.output),this.lfo=new o.Oscillator(2).start(),this.lfoDepth=new o.Multiply,this.lfo.connect(this.lfoDepth),this.lfoDepth.connect(this.delay.delayTime),this.lfoDepth.connect(this.delayR.delayTime);let s=[{name:"time",min:.01,max:1,curve:2,callback:this.setDelayTime},{name:"feedback",min:0,max:1.2,curve:.7,callback:this.setFeedback},{name:"damping",min:100,max:1e4,curve:2,callback:this.setFilterFrequency},{name:"hpf",min:10,max:2e3,curve:2,callback:t=>this.highpass.frequency.value=t},{name:"dry",value:0,min:0,max:1.2,curve:2,callback:t=>this.drySig.factor.value=t},{name:"wet",min:0,max:1.2,curve:2,callback:t=>this.wetSig.factor.value=t},{name:"gain",min:0,max:1,curve:.2,callback:t=>this.ws_input.factor.value=t},{name:"amp",min:0,max:1.2,curve:2,callback:t=>this.output.factor.value=t},{name:"delayRatio",value:0,min:.5,max:1,curve:1,callback:t=>{this._delayRatio=t,this.setDelayTime(this.delay.delayTime.value)}}];this.param=this.generateParameters(s),this.createAccessors(this,this.param)}generateParameters(t){const n={};return t.forEach((t=>{const s=new a.Parameter(t);n[t.name]=s})),n}createAccessors(t,n){Object.keys(n).forEach((s=>{const r=n[s];if("function"!=typeof r.set)throw new Error(`Parameter '${s}' does not have a set method`);const o={get:(t,n)=>"string"!=typeof n||isNaN(n)?t.get():t.get(parseInt(n)),set:(t,n,s)=>(console.log(t,n,s),"string"!=typeof n||isNaN(n)?(t.set(s),!0):(t.set(s,parseInt(n)),!0))};Object.defineProperty(t,s,{get:()=>new Proxy(r,o),set:t=>r.set(t)})}))}setParameter(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.param[t];if(!r)throw new Error(`Parameter '${t}' does not exist.`);s?r.callback(n,s):r.callback(n),r.guiElement&&r.guiElement.setValue(n)}get(){let t="Parameters:\n";for(let n in this.param){const s=this.param[n];t+=`${s.name}: ${s._value}\n`}console.log(t)}setDelayTime=t=>{this.delay.delayTime.value=t,this.delayR.delayTime.value=t*this._delayRatio};setFeedback=t=>{this.feedbackMult.factor.value=t,this.feedbackMultR.factor.value=t};setFilterFrequency=t=>{this.vcf.frequency.value=t,this.vcf.frequency.value=.9*t};connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}disconnect(t){t.input?this.output.disconnect(t.input):this.output.disconnect(t)}savePreset(t){const n={};for(let t of Object.values(this.param))n[t.name]=t._value;console.log(this.presets),this.presets[t]||(this.presets[t]={}),this.presets[t]=n,console.log(`Preset saved under ${this.name}/${t}`)}downloadPresets(){this.presetsData=this.presets;const t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.presetsData,null,2)),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",`${this.name}Presets.json`),document.body.appendChild(n),n.click(),n.remove()}loadPreset(t){this.curPreset=t;const n=this.presets[this.curPreset];if(n){console.log("Loading preset ",this.curPreset);for(let t in n)try{for(let s of Object.values(this.param))this.param[t].set(n[t])}catch(t){console.log(t)}}else console.log("No preset of name ",t)}logPreset(){const t=this.presets[this.curPreset];if(t){let n="Parameters:\n";for(let s in t){const r=t[s];Array.isArray(r)?n+=`${s}: [${r.map((t=>"number"==typeof t?Number(t.toFixed(2)):t)).join(", ")}]\n`:n+="number"==typeof r?`${s}: ${r.toFixed(2)}\n`:`${s}: ${r}\n`}console.log(n)}else console.log("No preset of name ",this.curPreset)}listPresets(){console.log("Synth presets",this.presets)}}},5953:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hardClip=function hardClip(t){return Math.max(Math.min(4*t,1),-1)},n.hardSync=function hardSync(t){return(t*=8)>0?t%1:t<0?Math.abs(t)%1*-1:0},n.pseudorandom=function pseudorandom(t){return(9187543225*(7*(Math.abs(t)-0))+12345)%4294967296/4294967296*2-1},n.pwm=function pwm(t){return t>.05?1:-1},n.sawToTri=function sawToTri(t){return t*=2.3,Math.abs(t)<=1?t:t>1?2-t:t<-1?-2-t:void 0},n.sineFolder=function sineFolder(t){return Math.sin(t*Math.PI*8)},n.softClip=function softClip(t){return Math.tanh(4*t)},n.triangleFolder=function triangleFolder(t){return t=Math.abs(8*t+.5),0==Math.floor(t%2)?t%1*2-1:2*(1-t%1)-1}},6192:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.orn=function orn(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;const o=[[0,1,2,3],[0,2,1,3],[0,1,-1,0],[1,0,-1,0],[1,".",".",0],[1,0,".","."],[".",0,0,0],[".",0,".",0]];let a=[];n%=o.length;for(let c=0;c<r;c++)a.push(t+o[n][c]*s);return a}},6325:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ccCallbacks=void 0,exports.getMidiIO=getMidiIO,exports.handleMidiInput=handleMidiInput,exports.muted=exports.midi_output_names=exports.midi_output_ids=exports.midi_input_names=exports.midi_input_ids=exports.midiMsgs=exports.midiHandlerInstance=exports.midi=void 0,exports.onMIDIFailure=onMIDIFailure,exports.onMIDISuccess=onMIDISuccess,exports.outputMidiID=void 0,exports.setMidiInput=setMidiInput,exports.setMidiOutput=setMidiOutput;var midi=exports.midi=null,muted=exports.muted=!1,outputMidiID=exports.outputMidiID=null,midiMsgs=exports.midiMsgs={},ccCallbacks=exports.ccCallbacks={};function onMIDISuccess(midiAccess){console.log("MIDI ready!"),exports.midi=midi=midiAccess,console.log(getMidiIO()),eval("globalThis.setMidiInput1 = setMidiInput;")}function onMIDIFailure(t){console.error(`Failed to get MIDI access - ${t}`)}function setMidiInput(t){for(var n of(Array.isArray(t)||(t=[t]),midi.inputs.forEach((function(t,n){t.onmidimessage=null})),t))n in midi_input_ids&null!=midi.inputs.get(midi_input_ids[n])?(midi.inputs.get(midi_input_ids[n]).onmidimessage=handleMidiInput,console.log("MIDI input set to: "+midi_input_names[n])):console.warn("Invalid input ID")}function setMidiOutput(t){Array.isArray(t)&&console.warn("Can only handle one MIDI output. Please enter one ID."),t in midi_output_ids&null!=midi.outputs.get(midi_output_ids[t])?(exports.outputMidiID=outputMidiID=midi_output_ids[t],console.log("MIDI output set to: "+midi_output_names[t]),midiHandlerInstance.setOutput(midi.outputs.get(outputMidiID))):console.warn("Invalid output ID")}navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(onMIDISuccess).catch(onMIDIFailure):console.log("Web MIDI API is not supported in this browser.");class MidiHandler{constructor(){this.noteOnHandler=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127;console.log("Default Note On Handler:",t,n),console.log("Define your own note on handler like this:\nsetNoteOnHandler(( note, vel, (optional:channel) ) => { <your code here> }) ")},this.noteOffHandler=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;console.log("Default Note Off Handler:",t,n),console.log("Define your own note off handler like this:\nsetNoteOffHandler(( note, vel, (optional:channel) ) => { <your code here> }) ")},this.CCHandler=function(t,n){console.log("Default CC Handler:",t,n),console.log("Define your own CC handler like this:\nsetCCHandler(( cc, value, (optionaL:channel) ) => { <your code here> }) ")},this.midiOutput=null}setOutput(t){this.midiOutput=t}sendNoteOn(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(console.log(t,n,s),this.midiOutput){const r=144|s-1;this.midiOutput.send([r,t,n])}else console.warn("No MIDI output is set.")}sendNoteOff(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(console.log(t,n,s),this.midiOutput){const r=128|s-1;this.midiOutput.send([r,t,n])}else console.warn("No MIDI output is set.")}sendCC(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.midiOutput){const r=176|s-1;this.midiOutput.send([r,t,n])}else console.warn("No MIDI output is set.")}handleNoteOn(t,n,s){this.noteOnHandler(t,n,s)}handleNoteOff(t,n,s){this.noteOffHandler(t,n,s)}handleCC(t,n,s){this.CCHandler(t,n,s)}setNoteOnHandler(t){this.noteOnHandler=t}setNoteOffHandler(t){this.noteOffHandler=t}setCCHandler(t){this.CCHandler=t}}const midiHandlerInstance=exports.midiHandlerInstance=new MidiHandler;var midi_input_ids=exports.midi_input_ids={},midi_output_ids=exports.midi_output_ids={},midi_input_names=exports.midi_input_names={},midi_output_names=exports.midi_output_names={};function getMidiIO(){var t="MIDI Inputs:\n",n="MIDI Outputs:\n",s=null,r=null,o=1;for(var a of midi.outputs)n+=o+": "+a[1].name+"\n",r=a[1].id,midi_output_ids[o]=r,midi_output_names[o]=a[1].name,o+=1;for(var c of(o=1,midi.inputs))t+=o+": "+c[1].name+"\n",s=c[1].id,midi_input_ids[o]=s,midi_input_names[o]=c[1].name,o+=1;return t+n}function handleMidiInput(t){let n=1+(15&t.data[0]);if(null!=t.data[1]){let s=t.data[0];if(s>=128&&s<=159){let r=t.data[1],o=t.data[2];s>=128&&s<=143||o<1?midiHandlerInstance.handleNoteOff(r,o,n):midiHandlerInstance.handleNoteOn(r,o,n)}else if(s>=176&&s<=191){let s=t.data[1],r=t.data[2];midiHandlerInstance.handleCC(s,r,n)}}}},6373:(t,n,s)=>{"use strict";function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.TuringMachine=void 0,function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}r.default=t,s&&s.set(t,r)}(s(5726)),s(1077),n.TuringMachine=class TuringMachine{constructor(){this.seq=new Array(32).fill(0),this.bigKnob=0,this.index=0,this.len=16,this.init(),this.val=0,this.pitchScalar=1,this.pitchVal=0,this.scale=[0,2,4,5,7,9,11,12]}init(){for(let t=0;t<32;t++)this.seq[t]=Math.random()>.5}get(){return Math.random()>Math.abs(this.bigKnob)&&(this.seq[this.index%this.len]=Math.random()>.5),this.val=this.seq[this.index%this.len],this.index++,this.val}set knob(t){this.len=this.bigKnob>0?16:8,this.bigKnob=t>1?1:t<-1?-1:t,this.len=this.bigKnob>0?32:16}pitch(){this.pitchVal=0;for(let t=0;t<8;t++)this.pitchVal+=this.seq[(this.index+t)%8]*t;return this.pitchVal=this.pitchVal*this.pitchScalar/32,console.log(this.pitchVal),this.scale[Math.floor(this.pitchVal)]}getStep(t){return Array.isArray(t)&&(t=t.reduce(((t,n)=>t+n))),this.seq[(this.index+t)%this.len]}}},6379:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Stripe=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Stripe=class Stripe{constructor(){this.input=new o.Multiply(1),this.eq=new o.EQ3,this.gain=new o.Multiply(1),this.send=new o.Multiply(0),this.output=new o.Multiply(1),this.input.connect(this.eq),this.eq.connect(this.gain),this.gain.connect(this.send),this.gain.connect(this.output)}setEQ(t,n,s){this.eq.high.value=s,this.eq.mid.value=n,this.eq.low.value=t}setEQBands(t,n){t<10||n<10?console.log("EQ bands are in Hz"):(this.eq.highFrequency.value=n,this.eq.lowFrequency.value=t)}setSendLevel(t){this.send.factor.value=t}setGain(t){this.gain.factor.value=t}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}}},6603:()=>{"use strict";const t={};["Aurora","Bells","Contrabass","Drum","DunDun","Flute","Guitar","HandPan","Harp","Horn","Kalimba","LightGuitar","Lyre","MantaOcarina","Ocarina","Old-Zither","Panflute","Piano","Pipa","SFX_TR-909","ToyUkulele","Trumpet","Vintage-Lyre","WinterPiano","Xylophone","Zither"].forEach(((n,s)=>{const r="https://specy.github.io/genshinMusic/assets/audio/"+n+"/0.mp3";t[n]={url:r,basePitch:60}})),console.log(t)},6737:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SimpleSeq=void 0,n.SimpleSeq=class SimpleSeq{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;this.numSeqs=n,this.seq=new Array(this.numSeqs).fill(t)}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t%=this.numSeqs,Array.isArray(this.seq[t])?this.seq[t][n%this.seq[t].length]:this.seq[t]}set(t,n){this.seq[t]=n}setAll(t){this.seq=new Array(this.numSeqs).fill(t)}set val(t){this.setAll(t)}get val(){return this.seq[0]}set value(t){this.setAll(t)}}},6788:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Cymbal=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=s(9672);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class Cymbal extends a.DrumTemplate{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.gui=t,this.name="Cymbal",this.oscillators=[],this.defaultFrequencies=[893,2079,1546],this.oscWaveforms=["sine","square","triangle","sawtooth"];for(let t=0;t<3;t++){const t=new o.Oscillator({type:"square"}).start();this.oscillators.push(t)}this.noises=[],this.noiseTypes=["white","pink","brown"];for(let t=0;t<3;t++){const t=new o.Noise("white").start();this.noises.push(t)}this.oscMixer=new o.Gain(1),this.oscillators.forEach((t=>t.connect(this.oscMixer))),this.noises.forEach((t=>t.connect(this.oscMixer))),this.lowerBandFilter=new o.Filter({type:"bandpass"}),this.lowerBandEnv=new o.AmplitudeEnvelope({attack:.01,decay:.4,sustain:0,release:.1}),this.lowerBandVCA=new o.Gain(1),this.oscMixer.chain(this.lowerBandFilter,this.lowerBandEnv,this.lowerBandVCA),this.upperBandFilter=new o.Filter({type:"bandpass"}),this.upperBandFilter1=new o.Filter({type:"bandpass"}),this.upperBandFilter2=new o.Filter({type:"bandpass"}),this.upperBandEnv1=new o.AmplitudeEnvelope({attack:.01,decay:.2,sustain:0,release:.1}),this.upperBandEnv2=new o.AmplitudeEnvelope({attack:.01,decay:.3,sustain:0,release:.1}),this.upperBandVCA1=new o.Gain(1),this.upperBandVCA2=new o.Gain(1),this.oscMixer.connect(this.upperBandFilter),this.upperBandFilter.chain(this.upperBandFilter1,this.upperBandEnv1,this.upperBandVCA1),this.upperBandFilter.chain(this.upperBandFilter2,this.upperBandEnv2,this.upperBandVCA2),this.output=new o.Gain(1),this.lowerBandVCA.connect(this.output),this.upperBandVCA1.connect(this.output),this.upperBandVCA2.connect(this.output),this.output.toDestination(),null!==this.gui&&this.initGui()}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;if(null!==t){for(let n=0;n<3;n++){const s=this.oscillators[n];t.Knob({label:"freq "+n,mapto:s.frequency,x:40+8*n,y:12,size:.5,min:20,max:2500,curve:2,value:this.defaultFrequencies[n]}),t.Radio({label:"waveform "+n,radioOptions:this.oscWaveforms,callback:t=>{s.type=t},size:1,x:7,y:12+20*n,horizontal:!0,value:"square"})}for(let n=0;n<3;n++){const s=this.noises[n];t.Radio({label:"noise "+n,radioOptions:this.noiseTypes,callback:t=>{s.type=t},size:1,x:90,y:12+16*n,horizontal:!0,value:"white"})}t.Knob({label:"low band freq",mapto:this.lowerBandFilter.frequency,x:20,y:50,size:.5,min:100,max:5e3,curve:2,value:579}),t.Knob({label:"low band Q",mapto:this.lowerBandFilter.Q,x:30,y:50,size:.5,min:.5,max:5,curve:2,value:1.45}),t.Knob({label:"low decay",mapto:this.lowerBandEnv.decay,x:20,y:70,size:.5,min:.01,max:1,curve:2,value:.4}),t.Knob({label:"low release",mapto:this.lowerBandEnv.release,x:30,y:70,size:.5,min:.01,max:1,curve:2,value:.1}),t.Knob({label:"up band freq",mapto:this.upperBandFilter.frequency,x:57,y:50,size:.5,min:1e3,max:1e4,curve:2,value:5976}),t.Knob({label:"up band Q",mapto:this.upperBandFilter.Q,x:67,y:50,size:.5,min:.5,max:5,curve:2,value:1.4}),t.Knob({label:"up1 band freq",mapto:this.upperBandFilter1.frequency,x:45,y:60,size:.5,min:1e3,max:1e4,curve:2,value:6795}),t.Knob({label:"up2 band freq",mapto:this.upperBandFilter2.frequency,x:70,y:60,size:.5,min:1e3,max:1e4,curve:2,value:8735}),t.Knob({label:"up1 band Q",mapto:this.upperBandFilter1.Q,x:55,y:60,size:.5,min:.5,max:5,curve:2,value:1.39}),t.Knob({label:"up2 band Q",mapto:this.upperBandFilter2.Q,x:80,y:60,size:.5,min:.5,max:5,curve:2,value:.67}),t.Knob({label:"up1 decay",mapto:this.upperBandEnv1.decay,x:45,y:70,size:.5,min:.01,max:1,curve:2,value:.2}),t.Knob({label:"up1 release",mapto:this.upperBandEnv1.release,x:55,y:70,size:.5,min:.01,max:1,curve:2,value:.1}),t.Knob({label:"up2 decay",mapto:this.upperBandEnv2.decay,x:70,y:70,size:.5,min:.01,max:1,curve:2,value:.3}),t.Knob({label:"up2 release",mapto:this.upperBandEnv2.release,x:80,y:70,size:.5,min:.01,max:1,curve:2,value:.1}),t.Button({label:"trig",callback:()=>this.trigger(),size:2,border:20,borderColor:[255,0,0],x:48,y:36})}else console.error("Provide a GUI instance to create GUI elements")}trigger(){this.lowerBandEnv.triggerAttackRelease(.01),this.upperBandEnv1.triggerAttackRelease(.01),this.upperBandEnv2.triggerAttackRelease(.01)}}n.Cymbal=Cymbal},7220:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Kick=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Kick=class Kick{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2;this.vco=(new o.Oscillator).start(),this.shaper_gain=new o.Multiply(s),this.waveShaper=new o.WaveShaper((t=>.9*Math.tanh(16*t))),this.vca=new o.Multiply,this.output=new o.Multiply(.5),this.pitch_env=new o.Envelope,this.pitch_env_depth=new o.Multiply,this.frequency=new o.Signal(t),this.env=new o.Envelope,this.vco.connect(this.vca),this.vca.connect(this.shaper_gain),this.shaper_gain.connect(this.waveShaper),this.waveShaper.connect(this.output),this.pitch_env.connect(this.pitch_env_depth),this.pitch_env_depth.connect(this.vco.frequency),this.frequency.connect(this.vco.frequency),this.env.connect(this.vca.factor),this.env.decay=n,this.env.release=n,this.env.sustain=0,this.env.attack=.03,this.pitch_env.attack=0,this.pitch_env.decay=1,this.pitch_env.sustain=0,this.pitch_env.release=.1}trigger=function(t){t?(this.env.triggerAttackRelease(.01,t),this.pitch_env.triggerAttackRelease(.01,t)):(this.env.triggerAttackRelease(.01),this.pitch_env.triggerAttackRelease(.01))};connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}disconnect(t){t.input?this.output.disconnect(t.input):this.output.disconnect(t)}}},7331:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Rumble=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=r(s(2805)),c=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}s(3447);class Rumble extends c.MonophonicTemplate{constructor(){var t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),t=this,this.gui=n,this.presets=a.default,this.isGlide=!1,this.name="Rumble",console.log(this.name," loaded, available preset: ",a.default),this.frequency=new o.Signal,this.vco_freq_1=new o.Multiply(1),this.vco_freq_2=new o.Multiply(1),this.vco_freq_3=new o.Multiply(1),this.vco_octave_1=new o.Multiply(1),this.vco_octave_2=new o.Multiply(1),this.vco_octave_3=new o.Multiply(1),this.frequency.connect(this.vco_freq_1),this.frequency.connect(this.vco_freq_2),this.frequency.connect(this.vco_freq_3),this.vco_1=new o.OmniOscillator({type:"pulse"}).start(),this.vco_2=new o.OmniOscillator({type:"pulse"}).start(),this.vco_3=new o.OmniOscillator({type:"pulse"}).start(),this.vco_freq_1.connect(this.vco_octave_1),this.vco_freq_2.connect(this.vco_octave_2),this.vco_freq_3.connect(this.vco_octave_3),this.vco_octave_1.connect(this.vco_1.frequency),this.vco_octave_2.connect(this.vco_2.frequency),this.vco_octave_3.connect(this.vco_3.frequency),this.vco_gain_1=new o.Multiply(.25),this.vco_gain_2=new o.Multiply(.25),this.vco_gain_3=new o.Multiply(.25),this.vco_1.connect(this.vco_gain_1),this.vco_2.connect(this.vco_gain_2),this.vco_3.connect(this.vco_gain_3),this.vcf=new o.Filter({type:"lowpass",rolloff:-24}),this.vco_gain_1.connect(this.vcf),this.vco_gain_2.connect(this.vcf),this.vco_gain_3.connect(this.vcf),this.clip=new o.Multiply(.125),this.direct_level=new o.Multiply(.5),this.waveShaper=new o.WaveShaper((t=>Math.sin(t*Math.PI*2))),this.waveShaper.oversample="4x",this.vcf.connect(this.clip),this.vcf.connect(this.direct_level),this.clip.connect(this.waveShaper),this.vca=new o.Multiply,this.direct_level.connect(this.vca),this.output=new o.Multiply(.5),this.waveShaper.connect(this.vca),this.vca.connect(this.output),this.vca_lvl=new o.Signal,this.vca_lvl.connect(this.vca.factor),this.env=new o.Envelope,this.env_depth=new o.Multiply,this.env.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.velocitySig=new o.Signal(1),this.velocitySig.connect(this.env_depth.factor),this.vcf_env=new o.Envelope,this.cutoffSig=new o.Signal(1e3),this.cutoff_cv=new o.Signal(0),this.vcf_env_depth=new o.Multiply(500),this.keyTracking=new o.Multiply(.1),this.vcf_env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.cutoffSig.connect(this.vcf.frequency),this.cutoff_cv.connect(this.vcf.frequency),this.frequency.connect(this.keyTracking),this.keyTracking.connect(this.vcf.frequency),this.lfo=new o.Oscillator(1).start(),this.lfo_pwm_1=new o.Multiply,this.lfo_pwm_2=new o.Multiply,this.lfo_pwm_3=new o.Multiply,this.lfo.connect(this.lfo_pwm_1),this.lfo_pwm_1.connect(this.vco_1.width),this.lfo.connect(this.lfo_pwm_2),this.lfo_pwm_2.connect(this.vco_2.width),this.lfo.connect(this.lfo_pwm_3),this.lfo_pwm_3.connect(this.vco_3.width);let s=[{name:"detune",min:0,max:1,curve:2,value:[1,1,1],callback:function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==s?t.vco_freq_1.factor.value=n:1==s?t.vco_freq_2.factor.value=n:2==s&&(t.vco_freq_3.factor.value=n)}},{name:"octave",min:-3,max:4,curve:1,value:[1,1,1],callback:function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==s?t.vco_octave_1.factor.value=Math.pow(2,n):1==s?t.vco_octave_2.factor.value=Math.pow(2,n):2==s&&(t.vco_octave_3.factor.value=Math.pow(2,n))}},{name:"gain",min:0,max:1,curve:2,value:[.75,.75,.75],callback:function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==s?t.vco_gain_1.factor.value=n:1==s?t.vco_gain_2.factor.value=n:2==s&&(t.vco_gain_3.factor.value=n)}},{name:"cutoff",min:20,max:2e4,curve:2,callback:t=>this.cutoffSig.value=t},{name:"Q",min:0,max:30,curve:2,callback:t=>this.vcf.Q.value=t},{name:"keyTrack",min:0,max:2,curve:1,callback:t=>this.keyTracking.factor.value=t},{name:"vcfEnvDepth",min:0,max:1e3,curve:2,callback:t=>this.vcf_env_depth.factor.value=t},{name:"adsr",min:0,max:100,curve:1,value:[.01,.1,.5,.5],callback:function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==s?t.env.attack=n:1==s?t.env.decay=n:2==s?t.env.sustain=n:3==s&&(t.env.release=n)}},{name:"filterAdsr",min:0,max:100,curve:1,value:[.01,.1,.5,.5],callback:function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==s?t.vcf_env.attack=n:1==s?t.vcf_env.decay=n:2==s?t.vcf_env.sustain=n:3==s&&(t.vcf_env.release=n)}},{name:"pwm",min:0,max:1,curve:1,value:[0,0,0],callback:function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==s?t.lfo_pwm_1.factor.value=n:1==s?t.lfo_pwm_2.factor.value=n:2==s&&(t.lfo_pwm_3.factor.value=n)}},{name:"lfoRate",min:0,max:1e3,curve:1,value:1,callback:function(n){return t.lfo.frequency.value=n}},{name:"distortion",min:0,max:1,curve:.35,value:1,callback:t=>{this.clip.factor.value=t}},{name:"mix",min:0,max:1,curve:1,value:.35,callback:t=>{this.direct_level.factor.value=t}}];this.param=this.generateParameters(s),this.createAccessors(this,this.param),this.autocompleteList=s.map((t=>t.name))}triggerAttack(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=o.Midi(t).toFrequency(),n/=127,s?(this.env.triggerAttack(s),this.vcf_env.triggerAttack(s),this.frequency.setValueAtTime(t,s),this.velocitySig.setValueAtTime(n,s)):(this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.frequency.value=t,this.velocitySig.rampTo(n,.03))}triggerRelease(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?(this.env.triggerRelease(t),this.vcf_env.triggerRelease(t)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())}triggerAttackRelease(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=o.Midi(t).toFrequency(),n/=127,r?(this.env.triggerAttackRelease(s,r),this.vcf_env.triggerAttackRelease(s,r),this.frequency.setValueAtTime(t,r),this.velocitySig.setValueAtTime(n,r)):(this.env.triggerAttackRelease(s),this.vcf_env.triggerAttackRelease(s),this.frequency.value=t,this.velocitySig.rampTo(n,.03))}setDetune(t,n,s){this.vco_freq_1.factor.value=t,this.vco_freq_2.factor.value=n,this.vco_freq_3.factor.value=s}setPwmDepth(t,n,s){this.lfo_pwm_1.factor.value=t,this.lfo_pwm_2.factor.value=n,this.lfo_pwm_3.factor.value=s}setGain(t,n,s){this.vco_gain_1.factor.value=t,this.vco_gain_2.factor.value=n,this.vco_gain_3.factor.value=s}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;this.gui=t,this.x=0,this.y=0;const n=[5,15,25];this.vco1_label=this.createLabel("vco1",n[0],5),this.vco2_label=this.createLabel("vco2",n[1],5),this.vco3_label=this.createLabel("vco3",n[2],5),this.vco1_oct_knob=this.gui.Knob({label:"octave",x:n[0],y:20,min:-2,max:1,size:.75,accentColor:[200,50,0],border:2,callback:t=>{this.vco_freq_1.value=calcFreq(t,this.vco1_detune_knob.value)}}),this.vco1_detune_knob=this.gui.Knob({label:"detune",x:n[0],y:50,min:-.5,max:.5,size:.75,accentColor:[200,50,0],border:2,callback:t=>this.vco_freq_1.value=calcFreq(this.vco1_oct_knob.value,t)}),this.vco1_gain_knob=this.gui.Knob({label:"gain",x:n[0],y:80,min:0,max:1,size:.75,accentColor:[200,50,0],border:2,mapto:this.vco_gain_1.factor});const calcFreq=function(t,n){return Math.pow(2,Math.floor(t))+Math.pow(n,2)*Math.sign(n)};this.vco2_oct_knob=this.createKnob("octave",n[1],20,-2,1,.75,[200,50,0],(t=>{this.vco_freq_2.value=calcFreq(t,this.vco2_detune_knob.value)})),this.vco2_detune_knob=this.createKnob("detune",n[1],50,-.5,.5,.75,[50,150,100],(t=>this.vco_freq_2.value=calcFreq(this.vco2_oct_knob.value,t))),this.vco2_gain_knob=this.createKnob("gain",n[1],80,0,1,.75,[200,50,0],(t=>this.vco_gain_2.factor.value=t)),this.vco3_oct_knob=this.createKnob("octave",n[2],20,-2,1,.75,[200,50,0],(t=>this.vco_freq_3.value=calcFreq(t,this.vco3_detune_knob.value))),this.vco3_detune_knob=this.createKnob("detune",n[2],50,-.5,.5,.75,[50,150,100],(t=>this.vco_freq_3.value=calcFreq(this.vco3_oct_knob.value,t))),this.vco3_gain_knob=this.createKnob("gain",n[2],80,0,1,.75,[200,50,0],(t=>this.vco_gain_3.factor.value=t)),this.vcf_cutoff_knob=this.createKnob("cutoff",45,28,2,1e4,1.75,[200,0,200],(t=>this.cutoffSig.value=t)),this.keytracking_knob=this.createKnob("keyTracking",45,75,0,1,.75,[200,0,200],(t=>this.keyTracking.factor.value=t)),this.vcf_env_depth_knob=this.createKnob("vcf env",55,75,0,5e3,.75,[200,0,200],(t=>this.vcf_env_depth.factor.value=t)),this.vcf_res_knob=this.createKnob("Q",35,75,0,20,.75,[200,0,200],(t=>this.vcf.Q.value=t)),this.attack_knob=this.createKnob("a",68,55,1e-6,.5,.35,[0,0,200],(t=>this.env.attack=t)),this.decay_knob=this.createKnob("d",76,55,0,10,.35,[0,0,200],(t=>this.env.decay=t)),this.sustain_knob=this.createKnob("s",84,55,0,1,.35,[0,0,200],(t=>this.env.sustain=t)),this.release_knob=this.createKnob("r",92,55,0,20,.35,[0,0,200],(t=>this.env.release=t)),this.vcf_attack_knob=this.createKnob("vcf a",68,80,.001,.5,.35,[0,0,200],(t=>this.vcf_env.attack=t)),this.vcf_decay_knob=this.createKnob("vcf d",76,80,0,10,.35,[0,0,200],(t=>this.vcf_env.decay=t)),this.vcf_sustain_knob=this.createKnob("vcf s",84,80,0,1,.35,[0,0,200],(t=>this.vcf_env.sustain=t)),this.vcf_release_knob=this.createKnob("vcf r",92,80,0,20,.35,[0,0,200],(t=>this.vcf_env.release=t)),this.lfo_knob=this.createKnob("lfo",60,25,0,20,.35,[0,0,200],(t=>this.lfo.frequency.value=t)),this.pwm_knob=this.createKnob("pwm",68,25,0,.9,.35,[0,0,200],(t=>{this.setPwmDepth(t,.8*t,.6*t)})),this.clip_knob=this.createKnob("distortion",82,25,0,1,.35,[0,0,200],(t=>{this.clip.factor.value=t})),this.clip_mix=this.createKnob("mix",90,25,0,1,.35,[0,0,200],(t=>{this.direct_level.factor.value=t})),this.gui_elements=[this.vco1_label,this.vco2_label,this.vco3_label,this.vco1_oct_knob,this.vco1_detune_knob,this.vco1_gain_knob,this.vco2_oct_knob,this.vco2_detune_knob,this.vco2_gain_knob,this.vco3_oct_knob,this.vco3_detune_knob,this.vco3_gain_knob,this.vcf_cutoff_knob,this.vcf_res_knob,this.keytracking_knob,this.vcf_env_depth_knob,this.attack_knob,this.decay_knob,this.sustain_knob,this.release_knob,this.vcf_attack_knob,this.vcf_decay_knob,this.vcf_sustain_knob,this.vcf_release_knob,this.lfo_knob,this.pwm_knob,this.clip_knob,this.clip_mix]}createLabel(t,n,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.01;return this.gui.Text({label:t,x:n+this.x,y:s+this.y,size:r,border:o,borderRadius:a})}createKnob(t,n,s,r,o,a,c,l){return this.gui.Knob({label:t,min:r,max:o,size:a,accentColor:c,x:n+this.x,y:s+this.y,callback:l,showLabel:1,showValue:0,curve:2,border:2})}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}}n.Rumble=Rumble},7846:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.Daisy=n.Daisies=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726)),a=r(s(8816)),c=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class Daisy extends c.MonophonicTemplate{constructor(){super(),this.presets=a.default,this.name="Daisy",this.frequency=new o.Signal(100),this.frequencyCV=new o.Signal,this.frequency_scalar=new o.Multiply(1),this.detune_scalar=new o.Multiply(1),this.vco_1=new o.Oscillator({type:"square"}).start(),this.vco_2=new o.Oscillator({type:"square"}).start(),this.frequency.connect(this.frequency_scalar),this.frequencyCV.connect(this.frequency_scalar.factor),this.frequency_scalar.connect(this.vco_1.frequency),this.frequency_scalar.connect(this.detune_scalar),this.detune_scalar.connect(this.vco_2.frequency),this.crossfade=new o.CrossFade,this.crossfade_lfo_depth=new o.Multiply,this.vco_1.connect(this.crossfade.a),this.vco_2.connect(this.crossfade.b),this.vcf=new o.Filter({type:"lowpass",rolloff:-24,Q:0,cutoff:3e3}),this.crossfade.connect(this.vcf),this.crossfade_constant=new o.Signal(0),this.crossfade_lfo_depth.connect(this.crossfade.fade),this.crossfade_constant.connect(this.crossfade.fade),this.vca=new o.Multiply,this.lfo_vca=new o.Multiply(1),this.lfo_vca_constant=new o.Signal(1),this.panner=new o.Panner(0),this.output=new o.Multiply(.25),this.vcf.connect(this.lfo_vca),this.lfo_vca.connect(this.vca),this.lfo_vca_constant.connect(this.lfo_vca.factor),this.vca.connect(this.panner),this.panner.connect(this.output),this.env=new o.Envelope,this.velocitySig=new o.Signal(1),this.velocity_depth=new o.Multiply(1),this.env.connect(this.velocity_depth),this.velocity_depth.connect(this.vca.factor),this.velocitySig.connect(this.velocity_depth.factor),this.cutoffSig=new o.Signal(1e3),this.cutoffSig.connect(this.vcf.frequency),this.cutoffCV=new o.Signal,this.cutoffCV.connect(this.vcf.frequency),this.keyTracking=new o.Multiply(.1),this.frequency.connect(this.keyTracking),this.keyTracking.connect(this.vcf.frequency),this.vcf_env=new o.Envelope,this.vcf_env_depth=new o.Multiply,this.vcf_env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.lfo=new o.Oscillator(.5).start(),this.vca_constant=new o.Signal(1),this.amp_lfo_depth=new o.Multiply(0),this.lfo.connect(this.amp_lfo_depth),this.amp_lfo_depth.connect(this.lfo_vca.factor),this.pitch_lfo_depth=new o.Multiply(0),this.lfo.connect(this.pitch_lfo_depth),this.lfo.connect(this.crossfade_lfo_depth),this.frequency_constant=new o.Signal(1),this.pitch_lfo_depth.connect(this.frequency_scalar.factor),this.frequency_constant.connect(this.frequency_scalar.factor),this.pwm_lfo_depth=new o.Multiply,this.lfo.connect(this.pwm_lfo_depth),this.autocompleteList=["test","triggerAttack"]}triggerAttack=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=o.Midi(t).toFrequency();n/=127,s?(this.frequency.setValueAtTime(r,s),this.env.triggerAttack(s),this.vcf_env.triggerAttack(s),this.velocitySig.setValueAtTime(Math.pow(n,2),s)):(this.frequency.value=r,this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.velocitySig.value=Math.pow(n,2))};triggerRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?(this.env.triggerRelease(n),this.vcf_env.triggerRelease(n)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())};triggerAttackRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=o.Midi(t).toFrequency(),n/=127,r?(this.frequency.setValueAtTime(t,r),this.env.triggerAttackRelease(s,r),this.vcf_env.triggerAttackRelease(s,r),this.velocitySig.setValueAtTime(Math.pow(n,2),r)):(this.frequency.value=t,this.env.triggerAttackRelease(s),this.vcf_env.triggerAttackRelease(s),this.velocitySig.value=Math.pow(n,2))};shapeVco(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=[];for(let t=0;t<64;t++)a.push(1/Math.pow(t+1,r)*16*(t%2<2-o)*Math.abs(1-Math.sin(t*Math.PI*n+Math.PI/2)*s));0===t?this.vco_1.partials=a:this.vco_2.partials=a}setHighpass(t){null!==this.super&&(this.super.hpf.frequency.value=t)}initGui(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.gui=t,this.x=n,this.y=s,this.vco_mix=this.createKnob("vco_mix",0,5,0,1,.75,[200,50,0],(t=>this.crossfade_constant.value=t)),this.detune=this.createKnob("detune",10,5,1,2,.5,[200,50,0],(t=>this.detune_scalar.factor.value=t)),this.vco1_shape_knob=this.createKnob("shape1",18,5,0,1,.5,[200,50,0],(t=>this.shapeVco(0,2*t+1))),this.vco2_shape_knob=this.createKnob("shape2",25,5,0,1,.5,[200,50,0],(t=>this.shapeVco(1,2*t+1))),this.cutoff=this.createKnob("cutoff",40,5,0,1e4,1,[200,50,0],(t=>this.cutoffSig.value=t)),this.vcf_env_knob=this.createKnob("vcf env",50,5,0,5e3,.75,[200,50,0],(t=>this.vcf_env_depth.factor.value=t)),this.vcf_Q_knob=this.createKnob("Q",60,5,0,20,.5,[200,50,0],(t=>this.vcf.Q.value=t)),this.keyTracking_knob=this.createKnob("key vcf",70,5,0,1,.5,[200,50,0],(t=>this.keyTracking.factor.value=t)),this.highpass_knob=this.createKnob("hpf",80,5,10,3e3,.5,[200,50,0],(t=>this.setHighpass(t))),this.attack_knob=this.createKnob("a",5,70,.005,.5,.5,[200,50,0],(t=>this.env.attack=t)),this.decay_knob=this.createKnob("d",13,70,.01,10,.5,[200,50,0],(t=>this.env.decay=t)),this.sustain_knob=this.createKnob("s",21,70,0,1,.5,[200,50,0],(t=>this.env.sustain=t)),this.release_knob=this.createKnob("r",29,70,0,20,.5,[200,50,0],(t=>this.env.release=t)),this.vcf_attack_knob=this.createKnob("a",5,45,.005,.5,.5,[200,50,0],(t=>this.vcf_env.attack=t)),this.vcf_decay_knob=this.createKnob("d",13,45,.01,10,.5,[200,50,0],(t=>this.vcf_env.decay=t)),this.vcf_sustain_knob=this.createKnob("s",21,45,0,1,.5,[200,50,0],(t=>this.vcf_env.sustain=t)),this.vcf_release_knob=this.createKnob("r",29,45,0,20,.5,[200,50,0],(t=>this.vcf_env.release=t)),this.lfo_freq_knob=this.createKnob("lfo",45,65,0,20,1,[200,50,0],(t=>this.lfo.frequency.value=t)),this.lfo_vibrato=this.createKnob("vibrato",55,65,0,.1,.5,[200,50,0],(t=>this.pitch_lfo_depth.factor.value=t)),this.lfo_tremolo=this.createKnob("tremolo",63,65,0,1,.5,[200,50,0],(t=>this.amp_lfo_depth.factor.value=t)),this.lfo_blend_knob=this.createKnob("blend",71,65,0,1,.5,[200,50,0],(t=>this.crossfade_lfo_depth.factor.value=t)),this.vcfEnvText=this.gui.Text({label:"vcf",x:10,y:55,border:.1}),this.vcaEnvText=this.gui.Text({label:"vca",x:10,y:80,border:.1}),this.pan_knob=this.createKnob("pan",80,65,0,1,.5,[200,50,0],(t=>{this.super.pan(t)})),this.gui_elements=[this.vco_mix,this.detune,this.cutoff,this.vcf_env_knob,this.vcf_Q_knob,this.keyTracking_knob,this.highpass_knob,this.attack_knob,this.decay_knob,this.sustain_knob,this.release_knob,this.vcf_attack_knob,this.vcf_decay_knob,this.vcf_sustain_knob,this.vcf_release_knob,this.lfo_freq_knob,this.lfo_vibrato,this.lfo_tremolo,this.lfo_blend_knob,this.pan_knob,this.vco1_shape_knob,this.vco2_shape_knob,this.vcfEnvText,this.vcaEnvText]}}n.Daisy=Daisy;class Daisies extends c.MonophonicTemplate{constructor(){console.log("Daisies is obsolete: use Polyphony(Daisy) instead")}}n.Daisies=Daisies},8011:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Spectroscope=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Spectroscope=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4;this.target=document.getElementById(t),this.width=this.target.offsetWidth,this.height=this.target.offsetWidth*n,this.wave=document.createElementNS("http://www.w3.org/2000/svg","path"),this.wave.setAttribute("class","oscilloscope__wave"),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("width",this.width),this.svg.setAttribute("height",this.height),this.svg.setAttribute("class","oscilloscope__svg"),this.svg.appendChild(this.wave),this.target.appendChild(this.svg),this.audioContext=window.audioContext,this.running=!1,this.hasAudio=!1,this.input=new r.Multiply,this.gain=new r.Signal(.1),this.analyserNode=this.audioContext.createAnalyser(),this.input.connect(this.analyserNode),this.gain.connect(this.input.factor),this.analyserNode.fftSize=4096,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.yScaling=1,this.maxFrequency=24e3,this.minFrequency=0,this.xScaling=2,this.binWidth=24e3/this.analyserNode.frequencyBinCount,this.setFftSize=function(t){Math.log2(t)%1!=0&&(t=Math.pow(2,Math.floor(Math.log2(t))),console.log("FFT size must be a power of two.")),console.log("Setting FFT size to ",t),this.analyserNode.fftSize=t,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.binWidth=24e3/this.bufferLength}.bind(this),this.drawWave=function(){var t="M";this.analyserNode.getByteFrequencyData(this.dataArray);let n=this.width,s=this.height/2;Math.max(...this.dataArray),Math.min(...this.dataArray),n=0,s=this.height,t+=`${n} ${s}, `;for(var r=0;r<this.bufferLength;r++){let o=24e3/(this.maxFrequency-this.minFrequency),a=this.minFrequency/this.binWidth,c=(255-this.dataArray[r+a])*(1/this.yScaling);if(n=(this.width+this.width/this.bufferLength)/this.bufferLength*r,n*=o,s=this.height/2*(c/128),n>this.width)break;t+=`${n} ${s}, `}n+=1,s=this.height,t+=`${n} ${s}, `,this.wave.setAttribute("d",t),this.wave.setAttribute("stroke","black"),this.running&&window.requestAnimationFrame(this.drawWave)}.bind(this),this.start=function(){this.running=!0,window.requestAnimationFrame(this.drawWave)}.bind(this),this.stop=function(){this.running=!1}.bind(this),this.disconnect=function(){this.target.removeChild(this.svg)}.bind(this),this.connect=function(t){this.target=document.getElementById(t),this.target.appendChild(this.svg)},this.start(),this.destroy=function(){this.stop(),setTimeout((()=>{this.target.contains(this.svg)&&this.target.removeChild(this.svg),this.analyserNode.disconnect(),this.input.disconnect(),this.gain.dispose(),this.target=null,this.wave=null,this.svg=null,this.audioContext=null,this.input=null,this.gain=null,this.analyserNode=null,this.dataArray=null,console.log("Spectroscope destroyed.")}),100)}.bind(this)}},8128:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.ModDelay=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.ModDelay=class ModDelay{constructor(){this.input=new o.Multiply(1),this.lfoRate=new o.Signal(.5),this.delay=new o.Delay({delayTime:0}),this.delayTime=new o.Signal(.1),this.delayTimeAdd=new o.Add,this.feedback=new o.Multiply(0),this.lfo=(new o.Oscillator).start(),this.lfoDepthScalar=new o.Multiply(.01),this.lfoDepth=new o.Multiply(.1),this.panner=new o.Panner(0),this.output=new o.Multiply(1),this.input.connect(this.delay),this.delay.connect(this.feedback),this.feedback.connect(this.delay),this.delay.connect(this.panner),this.panner.connect(this.output),this.delayTime.connect(this.delayTimeAdd),this.delayTimeAdd.connect(this.delay.delayTime),this.lfoRate.connect(this.lfo.frequency),this.lfo.connect(this.lfoDepthScalar),this.lfoDepthScalar.connect(this.lfoDepth),this.lfoDepth.connect(this.delayTimeAdd.addend),this.setDelayTime(.01)}setDelayTime(t){this.delayTime.value=t,this.lfoDepthScalar.factor.value=t}}},8272:t=>{"use strict";t.exports=JSON.parse('{"default":{"vco_mix":0.4096000000000002,"detune":1.9940090000000001,"cutoff":120.9999999999993,"vcf env":1057.9999999999998,"Q":2.047999999999998,"key vcf":1,"a":0.005,"d":0.1716759999999987,"s":0.6723999999999998,"r":1.6809999999999994,"a1":0.005,"d1":1.159696,"s1":0.6888999999999997,"r1":0.840999999999999,"lfo":4.801999999999989,"vibrato":0,"tremolo":0},"ether":{"vco_mix":0.6724000000000004,"detune":1.9940090000000001,"cutoff":168.99999999999915,"vcf env":1250,"Q":4.231999999999999,"key vcf":1,"a":0.005,"d":0.1716759999999987,"s":0.4224999999999996,"r":3.8440000000000003,"a1":0.005,"d1":1.159696,"s1":0.2915999999999996,"r1":2.809,"lfo":4.801999999999989,"vibrato":0.007290000000000004,"tremolo":0},"tremPad":{"vco_mix":0.4355999999999999,"detune":1.009409,"cutoff":1023.999999999999,"vcf env":1200.5,"Q":4.802,"key vcf":1,"a":0.5,"d":9.900699,"s":1,"r":20,"a1":0.5,"d1":10,"s1":1,"r1":20,"lfo":1.7999999999999925,"vibrato":0,"tremolo":0.5329000000000006}}')},8331:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Quadrophonic=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Quadrophonic=class Quadrophonic{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this.context=window.audioContext,this.numChannels=t,this.channelMerger=this.context.createChannelMerger(this.numChannels);let n=window.audioContext.destination.maxChannelCount;window.audioContext.destination.channelCount=n,window.audioContext.destination.channelCountMode="explicit",window.audioContext.destination.channelInterpretation="discrete",this.channelMerger=window.audioContext.createChannelMerger(n),this.channelMerger.channelCount=1,this.channelMerger.channelCountMode="explicit",this.channelMerger.channelInterpretation="discrete",this.channelMerger.connect(window.audioContext.destination),this.input=[];for(let t=0;t<this.numChannels;t++)this.input.push(new r.Multiply(1)),this.input[t].connect(this.channelMerger,0,0)}connectSource(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t.connect(this.channelMerger,n,s)}disconnectSource(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.disconnect(this.channelMerger,0,n)}getNode(){return this.channelMerger}dispose(){this.channelMerger.disconnect(),console.log("ChannelMerger disposed.")}}},8375:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=s(3172);Object.keys(r).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===r[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return r[t]}}))}));var o=s(3634);Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===o[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return o[t]}}))}));var a=s(6325);Object.keys(a).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===a[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return a[t]}}))}));var c=s(582);Object.keys(c).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===c[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return c[t]}}))}));var l=s(5324);Object.keys(l).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===l[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return l[t]}}))}));var h=s(1077);Object.keys(h).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===h[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return h[t]}}))}));var u=s(2075);Object.keys(u).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===u[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return u[t]}}))}));var d=s(375);Object.keys(d).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===d[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return d[t]}}))}));var f=s(6192);Object.keys(f).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===f[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return f[t]}}))}));var v=s(3941);Object.keys(v).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===v[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return v[t]}}))}));var g=s(8999);Object.keys(g).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===g[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return g[t]}}))}));var m=s(6373);Object.keys(m).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===m[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return m[t]}}))}));var y=s(9710);Object.keys(y).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===y[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return y[t]}}))}));var b=s(5923);Object.keys(b).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===b[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return b[t]}}))}));var _=s(4426);Object.keys(_).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===_[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return _[t]}}))}));var w=s(8128);Object.keys(w).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===w[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return w[t]}}))}));var k=s(6788);Object.keys(k).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===k[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return k[t]}}))}));var x=s(7846);Object.keys(x).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===x[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return x[t]}}))}));var S=s(182);Object.keys(S).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===S[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return S[t]}}))}));var C=s(3820);Object.keys(C).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===C[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return C[t]}}))}));var M=s(3705);Object.keys(M).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===M[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return M[t]}}))}));var O=s(5322);Object.keys(O).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===O[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return O[t]}}))}));var T=s(5220);Object.keys(T).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===T[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return T[t]}}))}));var q=s(9672);Object.keys(q).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===q[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return q[t]}}))}));var R=s(394);Object.keys(R).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===R[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return R[t]}}))}));var P=s(5164);Object.keys(P).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===P[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return P[t]}}))}));var A=s(1768);Object.keys(A).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===A[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return A[t]}}))}));var E=s(5213);Object.keys(E).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===E[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return E[t]}}))}));var D=s(9313);Object.keys(D).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===D[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return D[t]}}))}));var j=s(7220);Object.keys(j).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===j[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return j[t]}}))}));var V=s(4287);Object.keys(V).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===V[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return V[t]}}))}));var I=s(1174);Object.keys(I).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===I[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return I[t]}}))}));var F=s(5294);Object.keys(F).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===F[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return F[t]}}))}));var W=s(4154);Object.keys(W).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===W[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return W[t]}}))}));var z=s(3447);Object.keys(z).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===z[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return z[t]}}))}));var N=s(5493);Object.keys(N).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===N[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return N[t]}}))}));var B=s(727);Object.keys(B).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===B[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return B[t]}}))}));var K=s(506);Object.keys(K).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===K[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return K[t]}}))}));var L=s(8331);Object.keys(L).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===L[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return L[t]}}))}));var H=s(1439);Object.keys(H).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===H[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return H[t]}}))}));var G=s(7331);Object.keys(G).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===G[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return G[t]}}))}));var $=s(6603);Object.keys($).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===$[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return $[t]}}))}));var U=s(6737);Object.keys(U).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===U[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return U[t]}}))}));var Q=s(2188);Object.keys(Q).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===Q[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return Q[t]}}))}));var Y=s(2049);Object.keys(Y).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===Y[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return Y[t]}}))}));var X=s(6379);Object.keys(X).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===X[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return X[t]}}))}));var J=s(8577);Object.keys(J).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===J[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return J[t]}}))}));var Z=s(9667);Object.keys(Z).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===Z[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return Z[t]}}))}));var ee=s(1160);Object.keys(ee).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===ee[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return ee[t]}}))}));var te=s(5953);Object.keys(te).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===te[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return te[t]}}))}));var ie=s(1951);Object.keys(ie).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===ie[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return ie[t]}}))}));var ne=s(8011);Object.keys(ne).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===ne[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return ne[t]}}))}));var se=s(1729);Object.keys(se).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===se[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return se[t]}}))}));var re=s(2946);Object.keys(re).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===re[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return re[t]}}))}));var oe=s(1313);Object.keys(oe).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in n&&n[t]===oe[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return oe[t]}}))}))},8577:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SympathyString=n.Sympathy=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class SympathyString{constructor(){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.input=new r.Multiply(1),this.delay=new r.LowpassCombFilter({resonance:.95,dampening:1e4}),this.vca=new r.Multiply(t),this.output=new r.Multiply(1),this.delayTime=new r.Signal(.1),this.delayTimeScalar=new r.Multiply(1),this.input.connect(this.delay),this.delay.connect(this.vca),this.vca.connect(this.output),this.delayTime.connect(this.delayTimeScalar),this.delayTimeScalar.connect(this.delay.delayTime)}setFrequency=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.delayTime.setValueAtTime(1/t,n):this.delayTime.value=1/t};setFeedback=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t=t<0?0:t>.9999?.9999:t,n?this.delay.resonance.setValueAtTime(t,n):this.delay.resonance.value=t};connect(t){this.output.connect(t)}}n.SympathyString=SympathyString,n.Sympathy=class Sympathy{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[100,200,300,400,500,600];for(this.numStrings=t,this.frequencies=n,this.input=new r.Multiply(1),this.hpf=new r.Filter({frequency:20,type:"highpass",Q:0}),this.eq=new r.EQ3,this.vca=new r.Multiply(1),this.output=new r.Multiply(1),this.hpf_cutoff=new r.Signal(20),this.hpf.connect(this.eq),this.eq.connect(this.vca),this.vca.connect(this.output),this.strings=[],this.detune=0;this.frequencies.length<this.numStrings;)this.frequencies.push(this.frequencies[0]);for(let t=0;t<this.numStrings;t++)this.strings.push(new SympathyString(n[t],1-n[t]/5e3)),this.input.connect(this.strings[t].input),this.strings[t].output.connect(this.hpf)}setFrequencies=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.length==this.numStrings)if(n)for(let s=0;s<this.numStrings;s++)this.frequencies[s]=t[s]*(1-(Math.random()-.5)*this.detune),this.strings[s].setFrequency(this.frequencies[s],n);else for(let n=0;n<this.numStrings;n++)this.frequencies[n]=t[n]*(1-(Math.random()-.5)*this.detune),this.strings[n].setFrequency(this.frequencies[n]);else console.log("incorrect freq array size, should be ",this.numStrings)};setDetune=function(t){this.detune=t,this.setFrequencies(this.frequencies)};setFeedback=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t=t<0?0:t>.9999?.9999:t,n)for(let s=0;s<this.numStrings;s++)this.strings[s].setFeedback(t,n);else for(let n=0;n<this.numStrings;n++)this.strings[n].setFeedback(t)};setGains=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.length==this.numStrings)if(n)for(let n=0;n<this.numStrings;n++)this.strings[n].vca.factor.exponentialRampToValueAtTime(t[n],.1);else for(let n=0;n<this.numStrings;n++)this.strings[n].vca.factor.value=t[n];else console.log("incorrect gains array size, should be ",this.numStrings)};setHighpass=function(t){this.hpf.frequency.value=t};setEQ(t,n,s){this.eq.high.value=s,this.eq.mid.value=n,this.eq.low.value=t}setEQBands(t,n){t<10||n<10?console.log("EQ bands are in Hz"):(this.eq.highFrequency.value=n,this.eq.lowFrequency.value=t)}connect(t){this.output.connect(t)}}},8642:t=>{"use strict";t.exports=JSON.parse('{"default":{"Kick":0.5,"Snare":0.5,"Hihat":0.4,"Toms":0.5,"decay":1,"decay1":1,"decay12":1,"Output":2,"Dry Kick":0.5,"rate":1,"rate1":1,"rate12":1,"1 Rate":1,"2 Rate":1,"3 Rate":1,"Threshold":-32.5,"Ratio":1,"Distort":0.1,"Closed Decay":0.16839999999999972,"Open Decay":1.9801,"kit":"Acoustic"},"electro":{"Kick":0.7,"Snare":0.5,"Hihat":0.3,"Toms":0.5,"Output":3,"Dry Kick":0.3,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1.4,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":4.5,"Distort":0.3,"Hat Decay":0.505,"kit":"Techno","Kick1":1,"Snare1":1,"Hihat1":0.8999999999999999,"Toms1":0.23000000000000007,"Output1":0.9599999999999991,"Dry Kick1":0.1399999999999997,"Kick Rate1":0.8999999999999999,"Snare Rate1":0.8799999999999999,"Hihat Rate1":1.1,"Tom1 Rate1":1.4000000000000004,"Tom2 Rate1":1.3000000000000003,"Tom3 Rate1":1.12,"Threshold1":-28.649999999999995,"Ratio1":7.459999999999997,"Distort1":0.17,"Hat Decay1":0.11889999999999983,"kit1":"CR78"},"breakbeat":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"Kick1":1,"Snare1":1,"Hihat1":0.7199999999999998,"Toms1":0.7900000000000005,"Output1":2.3999999999999995,"Dry Kick1":0,"Kick Rate1":1.06,"Snare Rate1":1.12,"Hihat Rate1":0.8399999999999999,"Tom1 Rate1":1.1600000000000001,"Tom2 Rate1":1.1400000000000001,"Tom3 Rate1":1.1,"Threshold1":-28.649999999999995,"Ratio1":12.210000000000006,"Distort1":0.04,"Hat Decay1":0.19809999999999958,"kit":"breakbeat8"},"techno":{"Kick":1,"Snare":1,"Hihat":0.6999999999999997,"Toms":0.6099999999999997,"decay":0.2599999999999998,"decay1":0.04999999999999981,"decay12":0.004,"Output":0.9999999999999991,"Dry Kick":0,"rate":0.8599999999999999,"rate1":0.819999999999999,"rate12":1,"1 Rate":2,"2 Rate":2,"3 Rate":2,"Threshold":-29.20000000000002,"Ratio":9.36,"Distort":0.1999999999999997,"Closed Decay":0.07859999999999995,"Open Decay":2,"kit":"Techno"},"snappy":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":0.7299999999999998,"Hihat1":0.5399999999999996,"Toms1":0.4499999999999995,"Output1":3.3199999999999994,"Dry Kick1":0,"Kick Rate1":1.1400000000000001,"Snare Rate1":1.3800000000000003,"Hihat Rate1":1.1400000000000001,"Tom1 Rate1":1.6800000000000006,"Tom2 Rate1":0.52,"Tom3 Rate1":0.21999999999999936,"Threshold1":-28.649999999999995,"Ratio1":1,"Distort1":0.09999999999999999,"Hat Decay1":0.08919999999999953,"kit1":"KPR77"},"linn":{"Kick":1,"Snare":1,"Hihat":0.51,"Toms":1,"decay":0.2599999999999998,"decay1":0.45000000000000007,"decay12":0.5,"Output":1.2799999999999994,"Dry Kick":0,"rate":0.8799999999999999,"rate1":1.2000000000000002,"rate12":0.7999999999999998,"1 Rate":1,"2 Rate":1,"3 Rate":1,"Threshold":-29.20000000000002,"Ratio":6.129999999999996,"Distort":0.09999999999999969,"Closed Decay":0.059,"Open Decay":1.1045000000000003,"kit":"LINN"}}')},8816:t=>{"use strict";t.exports=JSON.parse('{"default":{"vco_mix":0.4096000000000002,"detune":1.9940090000000001,"cutoff":120.9999999999993,"vcf env":1057.9999999999998,"Q":2.047999999999998,"key vcf":1,"hpf":46.178999999999824,"a":0.005,"d":0.1716759999999987,"s":0.6723999999999998,"r":1.6809999999999994,"a1":0.005,"d1":1.159696,"s1":0.6888999999999997,"r1":0.840999999999999,"lfo":4.801999999999989,"vibrato":0,"tremolo":0},"ether":{"vco_mix":0.6724000000000004,"detune":1.9940090000000001,"cutoff":168.99999999999915,"vcf env":1250,"Q":4.231999999999999,"key vcf":1,"hpf":46.178999999999824,"a":0.005,"d":0.1716759999999987,"s":0.4224999999999996,"r":3.8440000000000003,"a1":0.005,"d1":1.159696,"s1":0.2915999999999996,"r1":2.809,"lfo":4.801999999999989,"vibrato":0.007290000000000004,"tremolo":0},"tremPad":{"vco_mix":0.4355999999999999,"detune":1.009409,"cutoff":1023.999999999999,"vcf env":1200.5,"Q":4.802,"key vcf":1,"hpf":46.178999999999824,"a":0.5,"d":9.900699,"s":1,"r":20,"a1":0.5,"d1":10,"s1":1,"r1":20,"lfo":1.7999999999999925,"vibrato":0,"tremolo":0.5329000000000006},"chime":{"vco_mix":0.19359999999999997,"detune":1.9940090000000001,"cutoff":624.9999999999986,"vcf env":1300.5,"Q":2.047999999999998,"key vcf":0.6723999999999998,"hpf":46.178999999999824,"a":0.005,"d":0.28933062867908127,"s":0.5208999999999997,"r":1.457068975770812,"a1":0.005,"d1":0.6305912279255007,"s1":0.04839999999999971,"r1":0.7609756133823595,"lfo":2.047999999999991,"vibrato":0.0032400000000000007,"tremolo":0.24010000000000026,"blend":0.25,"shape1":0.009999999999999943,"shape2":0.3721000000000001,"pan":0.19359999999999955}}')},8999:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Sequencer=void 0;var r=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.Sequencer=class Sequencer{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"8n",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.gui=null,this.subdivision=s,this.control=t,this.callback=this.callback=function(t,n){console.log("To set custom callback: this.callback = (your function here)")},this.setCallback(this.control),this.values=new Array(n).fill(0),this.tempVal=n,this.enables=new Array(o).fill(0),this.tempenables=o,this.beatsPerBar=4,this.subdivisionsPerBeat=4,this.enables_index=0,this.values_index=0,this.timeGrain=this.beatsPerBar*this.subdivisionsPerBeat,this.env=new r.Envelope,this.loop=new r.Loop((t=>{this.time=t,this.position=r.Transport.position.split(":"),this.measure=parseInt(this.position[0]),this.beat=parseInt(this.position[1]),this.sub=parseInt(this.position[2]),this.interval=parseInt(this.subdivision),this.loop.interval=this.subdivision,this.duration_scaler=this.timeGrain/this.interval,this.index=this.measure*this.timeGrain*(1/this.duration_scaler)+this.beat*this.subdivisionsPerBeat*(1/this.duration_scaler)+Math.floor(this.sub/(this.timeGrain/this.interval)),this.temp_enables_index=this.enables_index,this.temp_values_index=this.values_index,this.enables_index=this.index%this.enables.length,this.values_index=this.index%this.values.length,(0==this.enables.length||this.enables[this.enables_index])&&(this.val=this.values[this.values_index],this.callback(this.val,t)),void 0!==this.interface&&this.interface.updateGui(this.values_index,this.enables_index)}),this.subdivision)}setGui(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this.gui=n,"stepSequence"===t?this.interface=new stepSequence(this,n,s,r,o):"circularSequence"===t&&(this.interface=new circularSequence(this,n,s,r,o))}start(){this.loop.start(0),r.Transport.start()}stop(){this.loop.stop()}setCallback(t){null!=t&&("Synth"===t.name?this.callback=function(t,n){this.val&&this.control.triggerAttackRelease(this.val,100,.01,n)}:"Drum"===t.name?this.callback=function(){}:"Filter"===t.name?this.callback=function(){this.control.frequency.value=this.val}:"Multiply"===t.name?this.callback=function(){this.control.factor.value=this.val}:"Envelope"===t.name?this.callback=function(){this.control.decay=this.val,this.control.release=1.2*this.val}:"Oscillator"===t.name?this.callback=function(){this.val&&(this.control.frequency.setValueAtTime(r.Midi(this.val).toFrequency(),this.time),this.env.triggerAttackRelease(this.subdivision,this.time))}:"function"==typeof t&&(this.callback=t))}};class stepSequence{constructor(t,n,s,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;this.gui=n,this.rows=o,this.enColumns=t.enables.length/this.rows,this.valColumns=t.values.length/this.rows,this.target=t,this.initGui(s,r),this.prevVal=0,this.prevEnable=0}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;this.x=t,this.y=n,this.enables_array=[],this.values_array=[];for(let s=0;s<this.rows;s++)for(let r=0;r<this.enColumns;r++)this.enables_array.push(this.createToggle("En"+(r+1+s*this.enColumns).toString(),t*r+10,n+10+25*s,.3,[200,50,0],(t=>this.target.enables[r+s*this.enColumns]=t))),this.enables_array[r+s*this.enColumns].set(1);for(let s=0;s<this.rows;s++)for(let r=0;r<this.valColumns;r++)this.values_array.push(this.createKnob((r+1+s*this.valColumns).toString(),t*r+10,n+25*s,0,127,.75,[200,50,0],(t=>this.target.values[r+s*this.valColumns]=Math.floor(t))));this.playButton=this.createToggle("Pause/Play",t-10,n,1,[200,50,0],(t=>this.togglePlay(t))),this.playButton.set(1),console.log(t,n)}updateGui(t,n){this.values_array.length>0&&(this.values_array[t].accentColor=[0,250,0],this.values_array[this.prevVal].accentColor=[0,0,200],this.prevVal=t),this.enables_array.length>0&&(this.enables_array[n].accentColor=[0,250,0],this.enables_array[this.prevEnable].accentColor=[0,0,200],this.prevEnable=n)}createKnob(t,n,s,r,o,a,c,l){return this.gui.Knob({label:t,min:r,max:o,size:a,accentColor:c,x:n+this.x,y:s+this.y,callback:l,curve:1,border:4,showLabel:0,showValue:0})}createToggle(t,n,s,r,o,a){return this.gui.Toggle({label:t,size:r,accentColor:o,x:n+this.x,y:s+this.y,callback:a,border:5,showLabel:0,showValue:0,cornerRadius:.1})}togglePlay(t){return t?this.target.start():this.target.stop()}}class circularSequence extends stepSequence{constructor(t,n,s,r){super(t,n,s,r)}initGui(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:25,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;this.x=t,this.y=n,this.enables_array=[],this.values_array=[];const s=this.x,r=this.y,o=Math.max(this.target.enables.length,this.target.values.length),a=2*Math.PI/o;for(let t=0;t<this.target.enables.length;t++){const n=t*a,o=s+100*Math.cos(n)/10,c=r+100*Math.sin(n)/5;this.enables_array.push(this.createToggle("En"+(t+1).toString(),o,c,.3,[200,50,0],(n=>this.target.enables[t]=n))),this.enables_array[t].set(1)}for(let t=0;t<this.target.values.length;t++){const n=t*a,o=s+180*Math.cos(n)/10,c=r+180*Math.sin(n)/5;this.values_array.push(this.createKnob(t+1,o,c,24,72,.8,[200,50,0],(n=>this.target.values[t]=Math.floor(n))))}this.playButton=this.createToggle("Pause/Play",s,r,1,[200,50,0],(t=>this.togglePlay(t))),this.playButton.set(1),this.playText=this.gui.Text({label:"play",x:50,y:50,border:1})}}},9212:t=>{"use strict";t.exports=JSON.parse('{"default":{"octave":"8","tri":1,"saw":1,"squ":1,"-1":1,"-2":1,"noise":1,"vib/wah":0.48,"speed":10,"frequency":1200,"resonance":1,"VCF Env Depth":0.01,"volume":1,"velo filter":0.99,"velo volume":0.99,"A":0.1,"D":0.1,"S":1,"R":1,"chorus":0.0001,"Overdrive":0.0001},"Big Sweep":{"octave":"4","tri":0.0001,"saw":1.9866673333333333,"squ":0.0001,"-1":1.7066313333333347,"-2":2,"noise":1,"vib/wah":0.48,"speed":10,"frequency":1079.0000000000005,"resonance":6.142493025000001,"VCF Env Depth":2047.5449932752538,"volume":1,"velo filter":0.49019999999999975,"velo volume":0.3824,"A":7.692400000000003,"D":9.290800000000004,"S":0.37006299999999964,"R":16.721000000000007,"chorus":0.7300270000000002,"Overdrive":0.14008599999999996},"Fat Bass":{"octave":"16","tri":1.826675333333333,"saw":1.960002,"squ":0.0001,"-1":1,"-2":0.7333966666666665,"noise":0.10676133333333335,"vib/wah":0.48,"speed":10,"frequency":685.4999999999993,"resonance":2.641784774360023,"VCF Env Depth":1454.5302125627568,"volume":1.014999,"velo filter":0.99,"velo volume":0.99,"A":0.01,"D":4.195900000000002,"S":0.5900409999999995,"R":4.183999999999998,"chorus":0.090091,"Overdrive":0.33006700000000017},"80s Bass":{"octave":"16","tri":0.0001,"saw":0.0001,"squ":1.7333466666666677,"-1":1.880006,"-2":1.6000200000000002,"noise":0.013432666666666667,"vib/wah":0.48,"speed":10,"frequency":685.4999999999993,"resonance":1.2479293620748477,"VCF Env Depth":1789.554999999998,"volume":1.1550229999999997,"velo filter":0.5293999999999995,"velo volume":0.5293999999999995,"A":0.01,"D":3.596500000000001,"S":0.0001,"R":4.183999999999998,"chorus":0.0001,"Overdrive":0.1700829999999997},"Alien Distress Call":{"octave":"8","tri":1.4666933333333332,"saw":0.0001,"squ":0.8933886666666665,"-1":0.0001,"-2":0.0001,"noise":0.44007800000000036,"vib/wah":0.6460319999999997,"speed":2.203899999999993,"frequency":930.4999999999977,"resonance":13.282497224999993,"VCF Env Depth":69.11999999999912,"volume":0.07509500000000001,"velo filter":0.039399999999999574,"velo volume":0.0884,"A":2.6074000000000006,"D":9.091000000000001,"S":1,"R":10.353,"chorus":0.0001,"Overdrive":0.6200379999999996},"Hazy Pad":{"octave":"8","tri":1.6800160000000013,"saw":0.8667233333333338,"squ":0.10676133333333333,"-1":0.013432666666666667,"-2":0.0001,"noise":0.013432666666666667,"vib/wah":0.7980159999999998,"speed":1.2043999999999933,"frequency":709.999999999997,"resonance":3.082491225000001,"VCF Env Depth":20.479999999999567,"volume":0.8850410000000003,"velo filter":0.40199999999999964,"velo volume":0.4216000000000001,"A":5.404600000000002,"D":0.5095000000000001,"S":1,"R":10.154,"chorus":0.0001,"Overdrive":0.08009200000000001},"Poly Synth":{"octave":"8","tri":0.706731333333335,"saw":1.3200339999999995,"squ":1.7866773333333341,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.47504999999999953,"speed":3.2033999999999927,"frequency":858.5000000000002,"resonance":3.4547914440000014,"VCF Env Depth":787.3199999999944,"volume":0.8850410000000003,"velo filter":0.40199999999999964,"velo volume":0.4216000000000001,"A":0.01,"D":9.100900000000005,"S":0.0001,"R":5.377999999999994,"chorus":0.21007900000000007,"Overdrive":0.2600739999999999},"Lead Synth":{"octave":"4","tri":1.7332966666666678,"saw":0.6267353333333332,"squ":0.6267353333333333,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.461002,"speed":11.399300000000002,"frequency":1030.0000000000005,"resonance":1.4912902890000006,"VCF Env Depth":238.36943484410202,"volume":1,"velo filter":0.99,"velo volume":0.5881999999999996,"A":0.01,"D":0.01,"S":0.8700129999999998,"R":3.786,"chorus":0.0001,"Overdrive":0.090091},"warm keys":{"octave":"4","tri":1.6666333333333343,"saw":0.6267353333333332,"squ":2,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.4705010000000001,"speed":6.001999999999995,"frequency":662.5000000000001,"resonance":1.8992905290000013,"VCF Env Depth":1661.1772730937196,"volume":1.164989,"velo filter":0.7547999999999998,"velo volume":0.8135999999999999,"A":0.01,"D":3.9060999999999946,"S":0.4600539999999994,"R":16.816,"chorus":0.0001,"Overdrive":0.090091},"SynthPop Lead":{"octave":"4","tri":1.1999900000000012,"saw":1.466693333333333,"squ":1.5333566666666671,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.461002,"speed":11.399300000000002,"frequency":1152.5000000000005,"resonance":1.8992905290000013,"VCF Env Depth":238.36943484410202,"volume":1,"velo filter":0.49999999999999944,"velo volume":0.5881999999999996,"A":0.01,"D":0.01,"S":0.8700129999999998,"R":3.786,"chorus":0.0001,"Overdrive":0.17008299999999993},"SynthPop Bass":{"octave":"16","tri":1.4666933333333332,"saw":1.5866873333333347,"squ":1.5733546666666682,"-1":1,"-2":0.6933986666666666,"noise":0.0001,"vib/wah":0.48,"speed":10,"frequency":660.999999999999,"resonance":1.386411747593559,"VCF Env Depth":1454.5302125627568,"volume":1.014999,"velo filter":0.99,"velo volume":0.01,"A":0.01,"D":4.195900000000002,"S":0.5900409999999995,"R":4.183999999999998,"chorus":0.090091,"Overdrive":0.33006700000000017},"Wobbly Pad":{"octave":"8","tri":1.6800160000000013,"saw":0.8667233333333338,"squ":0.10676133333333333,"-1":0.013432666666666667,"-2":0.0001,"noise":0.013432666666666667,"vib/wah":0.8265129999999999,"speed":11.799099999999996,"frequency":1028.4999999999973,"resonance":3.082491225000001,"VCF Env Depth":20.479999999999567,"volume":0.9150390000000003,"velo filter":0.40199999999999964,"velo volume":0.4216000000000001,"A":5.404600000000002,"D":1.7083000000000004,"S":1,"R":0.1,"chorus":0.0001,"Overdrive":0.08009200000000001}}')},9313:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.KP=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}s(5294),s(1439);class Voice{constructor(){this.impulse=(new o.Noise).start(),this.hpf=new o.Filter({frequency:200,type:"highpass",Q:0,rolloff:-24}),this.lpf=new o.Filter({frequency:1e3,type:"lowpass",Q:0,rolloff:-12}),this.dry=new o.Signal(0),this.wet=new o.Multiply(1),this.vca=new o.Multiply(1),this.delay_1=new o.LowpassCombFilter({resonance:.95,dampening:1e4}),this.delay_2=new o.LowpassCombFilter({resonance:.95,dampening:1e4}),this.env=new o.Envelope,this.env_depth=new o.Multiply(1),this.velocity=new o.Multiply(1),this.choke=new o.Signal,this.resonance=new o.Signal(.9),this.velocity_depth=new o.Multiply(1),this.lowpassCutoffSignal=new o.Signal(1e3),this.highpassCutoffSignal=new o.Signal(1e3),this.bandwidthSignal=new o.Signal(500),this.hpfBandWidthNegate=new o.Negate,this.hpf_env_depth=new o.Multiply,this.lpf_env_depth=new o.Multiply,this.delayTime=new o.Signal(.1),this.detune=new o.Multiply(1),this.output=new o.Multiply(1),this.impulse.connect(this.hpf),this.hpf.connect(this.lpf),this.lpf.connect(this.vca),this.dry.connect(this.vca.factor),this.vca.connect(this.wet),this.wet.connect(this.delay_1),this.wet.connect(this.delay_2),this.delay_1.connect(this.output),this.delay_2.connect(this.output),this.resonance.connect(this.delay_1.resonance),this.resonance.connect(this.delay_2.resonance),this.choke.connect(this.delay_1.resonance),this.choke.connect(this.delay_2.resonance),this.env.connect(this.env_depth),this.env_depth.connect(this.velocity_depth),this.velocity_depth.connect(this.vca.factor),this.velocity.connect(this.velocity_depth),this.delayTime.connect(this.delay_1.delayTime),this.delayTime.connect(this.detune),this.detune.connect(this.delay_2.delayTime),this.highpassCutoffSignal.connect(this.hpf.frequency),this.lowpassCutoffSignal.connect(this.lpf.frequency),this.env.connect(this.hpf_env_depth.factor),this.env.connect(this.hpf_env_depth.factor),this.hpf_env_depth.connect(this.hpf.frequency),this.lpf_env_depth.connect(this.lpf.frequency)}cutoff=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.lowpassCutoffSignal.setValueAtTime(t,n):this.lowpassCutoffSignal.value=t};bandwidth=function(t,n){n?this.bandwidthSignal.setValueAtTime(t,n):this.bandwidthSignal.value=t};frequency=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.delayTime.setValueAtTime(1/t,n):this.delayTime.rampTo(1/t,.01)};triggerAttack=function(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s?(this.env.triggerAttack(s),this.frequency(t,s),this.velocity_depth.linearRampToValueAtTime(n,.01,s)):(this.env.triggerAttack(),this.frequency(t),this.velocity_depth.rampTo(n,.002))};triggerRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?this.env.triggerRelease(n):this.env.triggerRelease()};triggerAttackRelease=function(t,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r?(this.env.triggerAttackRelease(s,r),this.frequency(t,r),this.velocity_depth.linearRampToValueAtTime(n,.01,r)):(this.env.triggerAttackRelease(s),this.frequency(t),this.velocity_depth.rampTo(n,.002))}}n.KP=class KP{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;this.numVoices=t,this.voice=[];for(let t=0;t<this.numVoices;t++)this.voice.push(new Voice);this.clip=new o.Multiply(.125),this.waveShaper=new o.WaveShaper((t=>Math.sin(t*Math.PI*2))),this.waveShaper.oversample="4x",this.lpf=new o.Filter({type:"lowpass",rolloff:-12,Q:0,frequency:5e3}),this.output=new o.Multiply(.15),this.clip.connect(this.waveShaper);for(let t=0;t<this.numVoices;t++)this.voice[t].output.connect(this.clip);this.clip.connect(this.waveShaper),this.waveShaper.connect(this.lpf),this.lpf.connect(this.output),this.prevNote=0,this.v=0,this.voiceCounter=0,this.activeNotes=[-1,-1,-1,-1,-1,-1,-1,-1],this.noteOrder=[7,0,1,2,3,4,5,6]}triggerAttack=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.v=this.getNewVoice(t),s?this.voice[this.v].triggerAttack(t,n,s):this.voice[this.v].triggerAttack(t,n)};triggerRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.v=this.getActiveVoice(t),this.v<0||(n?this.voice[this.v].triggerRelease(n):this.voice[this.v].triggerRelease())};triggerAttackRelease=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.v=this.getNewVoice(t),r?this.voice[this.v].triggerAttackRelease(t,n,s,r):this.voice[this.v].triggerAttackRelease(t,n,s)};getNewVoice(t){this.voiceCounter>=this.numVoices&&(this.voiceCounter=0),this.prevNote=this.noteOrder.shift(),this.noteOrder.push(t);for(let n=0;n<this.numVoices;n++)this.activeNotes[n]==t&&this.triggerRelease(t);for(let n=0;n<this.numVoices;n++){const s=(n+this.voiceCounter)%this.numVoices;if(this.activeNotes[s]<0)return this.activeNotes[s]=t,this.voiceCounter=(s+1)%this.numVoices,s}return this.voiceCounter=(this.voiceCounter+1)%this.numVoices,this.voiceCounter}getActiveVoice=function(t){for(let n=0;n<this.numVoices;n++)if(this.activeNotes[n]==t)return this.activeNotes[n]=-1,n;return-1};panic=function(){for(let t=0;t<this.numVoices;t++)this.voice[t].env.triggerRelease(),this.activeNotes[t]=-1};setResonance=function(t){for(let n=0;n<this.numVoices;n++)this.voice[n].resonance.value=t};setDamping=function(t){for(let n=0;n<this.numVoices;n++)this.voice[n].delay_1.dampening=t,this.voice[n].delay_2.dampening=t};setCutoff=function(t){for(let n=0;n<this.numVoices;n++)this.voice[n].lowpassCutoffSignal.value=t;this.lpf.frequency.value=2*t};setQ=function(t){for(let n=0;n<this.numVoices;n++)this.voice[n].lpf.Q.value=t};setHighpass=function(t){for(let n=0;n<this.numVoices;n++)this.voice[n].highpassCutoffSignal.value=t};setADSR=function(t,n,s,r){for(let o=0;o<this.numVoices;o++)this.voice[o].env.attack=t,this.voice[o].env.decay=n,this.voice[o].env.sustain=s,this.voice[o].env.release=r};setDecay(t){t=t<0?.001:t;for(let n=0;n<this.numVoices;n++)this.voice[n].env.release=t,this.voice[n].env.decay=t}setClip(t){this.clip.rampTo(t,.02)}setChoke(t){for(let n=0;n<this.numVoices;n++)this.voice[n].choke.rampTo(-t/2,.2)}setDetune(t){for(let n=0;n<this.numVoices;n++)this.voice[n].detune.value=t}setDry(t){for(let n=0;n<this.numVoices;n++)this.voice[n].dry.value=t}setEnvDepth(t){for(let n=0;n<this.numVoices;n++)this.voice[n].env_depth.factor.value=t}connect(t){t.input?this.output.connect(t.input):this.output.connect(t)}}},9667:(t,n,s)=>{"use strict";var r=s(4994);Object.defineProperty(n,"__esModule",{value:!0}),n.ToneWood=void 0,r(s(5897));var o=function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}return r.default=t,s&&s.set(t,r),r}(s(5726));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}n.ToneWood=class ToneWood{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=t,this.input=new o.Multiply(1),this.gain=new o.Multiply(1),this.waveShaper=new o.WaveShaper((t=>Math.tanh(t))),this.convolver=new o.Convolver,this.output=new o.Multiply(1),this.buffer=null,this.input.connect(this.gain),this.gain.connect(this.convolver),this.waveShaper.connect(this.output),this.convolver.connect(this.waveShaper),this.convolver.normalize=!0}load(t){return new Promise(((n,s)=>{new o.Buffer(t,(t=>{this.buffer=t,this.convolver.buffer=t,n()}),s)}))}async filterIR(t){if(!this.buffer)return void console.error("Buffer not loaded.");const n=o.getContext().rawContext,s=this.buffer.duration,r=new OfflineAudioContext(2,s*n.sampleRate,n.sampleRate),a=this.buffer.get(),c=r.createBufferSource();c.buffer=a;const l=r.createBiquadFilter();return l.type="lowpass",l.frequency.value=t,c.connect(l),l.connect(r.destination),c.start(0),new Promise(((t,n)=>{r.startRendering().then((n=>{const s=new o.Buffer(n);this.buffer=s,this.convolver.buffer=s,t()})).catch(n)}))}async stretchIR(t){if(!this.buffer)return void console.error("Buffer not loaded.");const n=o.getContext().rawContext,s=this.buffer.duration,r=new OfflineAudioContext(2,s*t*n.sampleRate,n.sampleRate),a=this.buffer.get(),c=r.createBufferSource();return c.buffer=a,c.playbackRate.value=1/t,c.connect(r.destination),c.start(0),new Promise(((t,n)=>{r.startRendering().then((n=>{const s=new o.Buffer(n);this.buffer=s,this.convolver.buffer=s,t()})).catch(n)}))}async highpassIR(t){if(!this.buffer)return void console.error("Buffer not loaded.");const n=o.getContext().rawContext,s=this.buffer.duration,r=new OfflineAudioContext(2,s*n.sampleRate,n.sampleRate),a=this.buffer.get(),c=r.createBufferSource();c.buffer=a;const l=r.createBiquadFilter();return l.type="highpass",l.frequency.value=t,c.connect(l),l.connect(r.destination),c.start(0),new Promise(((t,n)=>{r.startRendering().then((n=>{const s=new o.Buffer(n);this.buffer=s,this.convolver.buffer=s,t()})).catch(n)}))}connect(t){this.output.connect(t)}}},9672:(t,n,s)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DrumTemplate=void 0,function _interopRequireWildcard(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=_getRequireWildcardCache(n);if(s&&s.has(t))return s.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&{}.hasOwnProperty.call(t,a)){var c=o?Object.getOwnPropertyDescriptor(t,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=t[a]}r.default=t,s&&s.set(t,r)}(s(5726));var r=s(1174);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var n=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(t){return t?s:n})(t)}class DrumTemplate extends r.MonophonicTemplate{constructor(){super(),this.type="Drum"}trigger(){this.env.triggerAttackRelease(.001)}}n.DrumTemplate=DrumTemplate},9710:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.expr=function expr(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return Array.from({length:n},((n,s)=>t(s)))},n.stepper=function stepper(t,n,s,r){let o=s-n,a=(t-n)/o;const c=[],l=[];for(let t=0;t<r.length;t++)c.push(r[t][0]),l.push(r[t][1]);let h=0;for(;h<c.length;){if(a<c[h]){let t=(l[h]-l[h-1])/(c[h]-c[h-1]);return(l[h-1]+t*(a-c[h-1]))*o+n}h++}return s}},9762:(t,n,s)=>{"use strict";s.r(n),s.d(n,{TimingObject:()=>r,filterTimingStateVectorUpdate:()=>filterTimingStateVectorUpdate,translateTimingStateVector:()=>translateTimingStateVector});const filterTimingStateVectorUpdate=t=>{if(void 0===t)return{};let n=null!==t.acceleration&&void 0!==t.acceleration?{acceleration:t.acceleration}:{};return null!==t.position&&void 0!==t.position&&(n={...n,position:t.position}),null!==t.velocity&&void 0!==t.velocity?{...n,velocity:t.velocity}:n},translateTimingStateVector=(t,n)=>{const{acceleration:s,position:r,timestamp:o,velocity:a}=t;return{acceleration:s,position:r+a*n+.5*s*n**2,timestamp:o+n,velocity:a+s*n}},r=((t,n,s,r,o,a,c,l)=>class extends r{constructor(t={},n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY){super();const{timingProviderSource:r,vector:l}=void 0===t.update?{timingProviderSource:null,vector:t}:{timingProviderSource:t,vector:{}};if(this._endPosition=null===r?s:r.endPosition,this._onchange=null,this._onerror=null,this._onreadystatechange=null,this._readyState=null===r?"open":r.readyState,this._skew=null===r?0:r.skew,this._startPosition=null===r?n:r.startPosition,this._timingProviderSource=r,this._timeoutId=null,this._vector=null===r?{acceleration:0,position:0,velocity:0,...o(l),timestamp:a.now()/1e3}:r.vector,s<this._vector.position&&(this._vector={...this._vector,acceleration:0,position:s,velocity:0}),n>this._vector.position&&(this._vector={...this._vector,acceleration:0,position:n,velocity:0}),this._setInternalTimeout(),null===r)c((()=>this.dispatchEvent(new Event("readystatechange"))));else{const onAdjust=()=>{this._skew=r.skew},onChange=()=>this._setInternalVector(r.vector),onReadyStateChange=()=>{this._isAllowedTransition(r.readyState)?this._readyState=r.readyState:(this._readyState="closed",r.removeEventListener("adjust",onAdjust),r.removeEventListener("change",onChange),r.removeEventListener("readystatechange",onReadyStateChange)),null!==r.error&&c((()=>this.dispatchEvent(new ErrorEvent("error",{error:r.error})))),c((()=>this.dispatchEvent(new Event("readystatechange"))))};r.addEventListener("adjust",onAdjust),r.addEventListener("change",onChange),r.addEventListener("readystatechange",onReadyStateChange)}}get endPosition(){return this._endPosition}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(t){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof t){const n=t.bind(this);this.addEventListener("change",n),this._onchange=[t,n]}else this._onchange=null}get onerror(){return null===this._onerror?this._onerror:this._onerror[0]}set onerror(t){if(null!==this._onerror&&this.removeEventListener("error",this._onerror[1]),"function"==typeof t){const n=t.bind(this);this.addEventListener("error",n),this._onerror=[t,n]}else this._onerror=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(t){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof t){const n=t.bind(this);this.addEventListener("readystatechange",n),this._onreadystatechange=[t,n]}else this._onreadystatechange=null}get readyState(){return this._readyState}get startPosition(){return this._startPosition}get timingProviderSource(){return this._timingProviderSource}query(){if("open"!==this._readyState)throw s();const t=a.now()/1e3,n=null===this._timingProviderSource?t-this._vector.timestamp:t+this._skew-this._vector.timestamp,r=l(this._vector,n);return this._endPosition<r.position||this._startPosition>r.position?(this._setInternalVector({...r,acceleration:0,position:this._endPosition<r.position?this._endPosition:this._startPosition,velocity:0}),this.query()):r}update(t){if("open"!==this._readyState)return Promise.reject(s());if(null!==this._timingProviderSource){const n=this._timingProviderSource.update(t);return n instanceof Promise?n:Promise.reject(new TypeError("The timingProviderSource failed to return a promise."))}const n=o(t);if(0===Object.keys(n).length)return Promise.resolve();const r={...this.query(),...n},{position:a,velocity:c,acceleration:l}=r;return a<this._startPosition||a>this._endPosition||a===this._startPosition&&(c<0||0===c&&l<0)||a===this._endPosition&&(c>0||0===c&&l>0)?Promise.reject((()=>{try{return new DOMException("","IllegalValueError")}catch(t){return t.name="IllegalValueError",t}})()):(this._setInternalVector(r),Promise.resolve())}_isAllowedTransition(t){return"closing"===this._readyState&&"closed"===t||"connecting"===this._readyState||"open"===this._readyState&&("closed"===t||"closing"===t)}_setInternalTimeout(){if(null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this._endPosition===Number.POSITIVE_INFINITY&&this._startPosition===Number.NEGATIVE_INFINITY||0===this._vector.acceleration&&0===this._vector.velocity)return;const n=t(this._vector,this._startPosition,this._endPosition);null!==n&&(this._timeoutId=c((()=>this.query()),n))}_setInternalVector(t){this._vector=t,this._setInternalTimeout(),c((()=>this.dispatchEvent(new Event("change"))))}})((c=({acceleration:t,position:n,velocity:s},r)=>{const o=((t,n,s,r)=>{if(0===s&&0===n)return t!==r?[]:[0];if(0===s)return[(r-t)/n];const o=n/s,a=Math.sqrt(o**2-2/s*(t-r));return[a-o,-(a+o)].filter((t=>!isNaN(t))).sort()})(n,s,t,r);if(0===o.length)return null;if(1===o.length)return o[0]>0?o[0]:null;if(2===o.length){if(o[1]<0)return null;if(o[0]>0)return o[0];if(o[1]>0)return o[1]}return null},a=(t,n,s)=>{const r=c(t,n),o=c(t,s);return null!==r&&null!==o?r<o?r:o:null!==r?r:null!==o?o:null},(t,n,s)=>{const r=a(t,n,s);return null===r||r===Number.POSITIVE_INFINITY?null:r}),0,(()=>{try{return new DOMException("","InvalidStateError")}catch(t){return t.code=11,t.name="InvalidStateError",t}}),(o=(t=>()=>{if(null===t)throw new Error("A native EventTarget could not be created.");return t.document.createElement("p")})("undefined"==typeof window?null:window),class EventTarget{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=o()}addEventListener(t,n,s){if(null!==n){let a=this._listeners.get(n);void 0===a&&(r=this,o=n,a=t=>{const n={value:r};return Object.defineProperties(t,{currentTarget:n,target:n}),"function"==typeof o?o.call(r,t):o.handleEvent.call(r,t)},"function"==typeof n&&this._listeners.set(n,a)),this._nativeEventTarget.addEventListener(t,a,s)}var r,o}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,s){const r=null===n?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,void 0===r?null:r,s)}}),filterTimingStateVectorUpdate,performance,setTimeout,translateTimingStateVector);var o,a,c}},__webpack_module_cache__={};function __webpack_require__(t){var n=__webpack_module_cache__[t];if(void 0!==n)return n.exports;var s=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](s,s.exports,__webpack_require__),s.exports}__webpack_require__.d=(t,n)=>{for(var s in n)__webpack_require__.o(n,s)&&!__webpack_require__.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},__webpack_require__.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(8375),__webpack_export_target__=window;for(var __webpack_i__ in __webpack_exports__)__webpack_export_target__[__webpack_i__]=__webpack_exports__[__webpack_i__];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();


                    // Connect the timing checkbox to its handler
                    document.getElementById('timing-object-toggle').addEventListener('change', handleTimingManager);

                    // Initialize ASCII
                    window.enableAsciiInput = asciiCallbackInstance.enable.bind(asciiCallbackInstance);
                    window.disableAsciiInput = asciiCallbackInstance.disable.bind(asciiCallbackInstance);
                    window.setAsciiHandler = asciiCallbackInstance.setHandler.bind(asciiCallbackInstance);

                    // Initialize MIDI
                    window.midiHandlerInstance = midiHandlerInstance;
                    window.setNoteOnHandler = midiHandlerInstance.setNoteOnHandler.bind(midiHandlerInstance);
                    window.setNoteOffHandler = midiHandlerInstance.setNoteOffHandler.bind(midiHandlerInstance);
                    window.setCCHandler = midiHandlerInstance.setCCHandler.bind(midiHandlerInstance);
                    window.sendCC = midiHandlerInstance.sendCC.bind(midiHandlerInstance);
                    window.sendNote = midiHandlerInstance.sendNoteOn.bind(midiHandlerInstance);
                    window.sendNoteOff = midiHandlerInstance.sendNoteOff.bind(midiHandlerInstance);

                    // Initialize CollabHub
                    // WARNING: Given as function because user will have initCollab() in their code!!!
                    function initCollab (roomName = "web-export-famle") {
                        window.chClient = new CollabHubClient(); // needs to happen once (!)
                        window.chTracker = new CollabHubTracker(window.chClient);
                        // collab-hub join a room
                        window.chClient.joinRoom("web-export-famle");
                    }

                    function acknowledgeWarning() {
                        document.getElementById('volumeWarning').style.display = 'none';
                        runCode();
                    }

                    function handleTimingManager(e) {
                        const {checked} = e.target;
                        if (checked) {
                            // Only initialize timing manager when checkbox is checked
                            if (!window.usableTimingManager) {
                                e.target.disabled = true;
                                document.getElementById('timing-toggle-label').textContent = ' Initializing Timing Object...';
                                
                                // Initialize timing manager
                                window.timingManager.initialize().then((manager) => {
                                    window.usableTimingManager = manager;
                                    window.usableTimingManager.setShouldUse();
                                    window.usableTimingManager.startTimer();
                                    
                                    e.target.disabled = false;
                                    document.getElementById('timing-toggle-label').textContent = ' Use Timing Object';
                                });
                            } else {
                                window.usableTimingManager.setShouldUse();
                                window.usableTimingManager.startTimer();
                            }
                        } else if (window.usableTimingManager) {
                            window.usableTimingManager.shouldBeUsed = false;
                            window.usableTimingManager.stopTimer(false);
                        }
                    }

                    // Function to run user code
                    async function runCode() {
                        try {
                            // Start audio context
                            await Tone.start();
                            window.audioContext = Tone.context.rawContext;
                            
                            // Clear previous state
                            Tone.Transport.stop();
                            Tone.Transport.cancel();
                            
                            // Clear all previous canvases
                            Canvas.innerHTML = "";
                            
                            // Run user code
                            eval(document.getElementById('userCode').textContent);

                            updateBPM(Theory.tempo);
                        } catch (error) {
                            console.error('Error running code:', error);
                            alert('Error running code: ' + error.message);
                        }
                    }

                    // Function to stop all sound (just reloads the page, there is too much to fix otherwise)
                    function stopCode() {
                        location.reload();
                    }

                    function updateBPM(value) {
                        Theory.tempo = parseInt(value);
                        document.getElementById('bpmValue').textContent = value;
                        document.getElementById('bpmSlider').value = value;
                        document.getElementById('bpmInput').value = value;
                        const timingObjectToggle = document.getElementById('timing-object-toggle');
                        if (timingObjectToggle.checked) window.usableTimingManager.updateVelocity(value);
                    }

                    // Sync BPM UI with actual Tone.Transport BPM value
                    function syncBPMFromToneTransport() {
                        const currentBPM = Math.round(Tone.Transport.bpm.value);
                        const displayedBPM = parseInt(document.getElementById('bpmValue').textContent);
                        
                        // Only update if the values differ
                        if (currentBPM !== displayedBPM) {
                            // Update UI without triggering the main updateBPM function
                            document.getElementById('bpmValue').textContent = currentBPM;
                            document.getElementById('bpmSlider').value = currentBPM;
                            document.getElementById('bpmInput').value = currentBPM;
                        }
                    }

                    // Check BPM periodically to keep UI in sync
                    setInterval(syncBPMFromToneTransport, 1000); // Check every 1000ms
                </script>

                <!-- User Code -->
                <script id="userCode" type="text/javascript">
                    let s = new Twinkle()
let output = new Tone.Multiply(.1).toDestination()
s.connect( output )
let gui = new p5(sketch, Canvas)
s.initGui(gui)

s.sequence('0... 0... 1 2 3 4 5 6 7 8', '8n',1)
s.sustain = .05
s.velocity = 100
s.octave = -1

//s.stop()

let scope = new Oscilloscope('Canvas')
s.connect(scope)
//s.env.connect(scope.input)
//scope.setFftSize(1024*32)

let spectrum = new Spectrogram('Canvas',400)
spectrum.maxFrequency = 5000
s.connect(spectrum)

s.listPresets()
s.loadPreset('default')
                </script>
            </body>
            </html>
        