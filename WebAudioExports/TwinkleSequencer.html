
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creativitas Web Export</title>
    
    <!-- External Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/15.0.4/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.0/p5.js"></script>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js" integrity="sha384-mkQ3/7FUtcGyoppY6bz/PORYoGqOl7/aSUMn2ymDOJcapfS6PHqxhRTMh1RR0Q6+" crossorigin="anonymous"></script>               
    
    <!-- Styles -->
    <style>
        
    body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
    canvas { display: block; margin-bottom: 10px; }
    .canvas-container { margin-bottom: 20px; }
    .span-container {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .invisible-button {
        background: none;
        border: none;
        cursor: pointer;
        padding: 4px;
    }
    .icon {
        height: 24px;
        transition: opacity 0.1s ease;
    }
    .active {
        opacity: 1;
    }
    .inactive {
        opacity: 0.5;
    }
    #notes-display {
        display: flex;
        flex-direction: row;
        flex-wrap: nowrap;
        gap: 8px;
        overflow-x: auto;
        white-space: nowrap;
        max-width: 70vw;
    }
    .note-pill {
        background-color: #f0f0f0;
        border-radius: 12px;
        padding: 4px 8px;
        font-size: 12px;
    }
    #volumeWarning {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.8);
        color: black;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        z-index: 1002; /* Above controls */
    }
 // Inject styles directly
    </style>
</head>
    
<body>
    
<div id="controls">
    <div>
        <button id="startButton" style="padding: 5px 10px; margin-right: 5px;">Start</button>
        <button id="stopButton" style="padding: 5px 10px; margin-right: 10px;">Stop</button>
        
        <label for="bpmInput" style="margin-right: 5px;">BPM:</label>
        <span id="bpmValue" style="display: inline-block; min-width: 25px; text-align: right; margin-right: 5px;">120</span>
        <input 
            type="range" 
            id="bpmSlider" 
            min="10" 
            max="300" 
            value="120" 
            oninput="updateBPM(this.value)" 
            style="vertical-align: middle; margin-right: 5px;"
        >
        <input 
            type="number" 
            id="bpmInput" 
            min="10" 
            max="300" 
            value="120" 
            oninput="updateBPM(this.value)"
            style="width: 50px; margin-right: 10px; padding: 2px; vertical-align: middle;"
        >
        
        <label for="timingStrategySelect" style="margin-right: 5px;">Timing:</label>
        <select id="timingStrategySelect" title="Select Timing Strategy" style="padding: 2px; vertical-align: middle;">
            <option value="tone_js">Tone.js</option>
            <option value="midi_clock">Midi Clock</option>
            <option value="timing_object">Timing Object</option>
            <option value="ableton_link">Ableton Link</option>
        </select>
    </div>
    <div style="margin-top: 10px;">
        <label for="midiInputSelect" style="margin-right: 5px;">MIDI Input:</label>
        <select id="midiInputSelect" title="Select MIDI Input Device" style="padding: 2px; vertical-align: middle; margin-right: 10px;">
            <option value="">None</option>
        </select>
        
        <label for="midiOutputSelect" style="margin-right: 5px;">MIDI Output:</label>
        <select id="midiOutputSelect" title="Select MIDI Output Device" style="padding: 2px; vertical-align: middle; margin-right: 10px;">
            <option value="">None</option>
        </select>
        
        <button id="refreshMidiBtn" style="padding: 2px 8px; vertical-align: middle;">Refresh MIDI</button>
    </div>
</div>
    
    <div class="canvas-container" id="Canvas"></div>
    
<div id="volumeWarning">
    <div style="background: white; padding: 20px; border-radius: 8px; text-align: center;">
        <h2>⚠️ Volume Warning</h2>
        <p>This page contains audio content. Please ensure your volume is at a comfortable level.</p>
        <button onclick="acknowledgeWarning()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">I understand</button>
    </div>
</div>
    
    
<script>
    // --- Bundled Core Dependencies ---
    (()=>{var e={69:(e,t,n)=>{n.r(t),n.d(t,{TimingProvider:()=>Tt});var r=n(822),i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+t+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function s(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=u(0),s.throw=u(1),s.return=u(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(6===u[0]&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(e){u=[6,e],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function l(e){return this instanceof l?(this.v=e,this):new l(e)}function h(e){return"function"==typeof e}function f(e){var t=e((function(e){Error.call(e),e.stack=Error().stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}"function"==typeof SuppressedError&&SuppressedError;var d=f((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function p(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var v=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=u(o),l=s.next();!l.done;l=s.next())l.value.remove(this)}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var f=this.initialTeardown;if(h(f))try{f()}catch(e){i=e instanceof d?e.errors:[e]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var v=u(p),y=v.next();!y.done;y=v.next()){var b=y.value;try{_(b)}catch(e){i=null!=i?i:[],e instanceof d?i=a(a([],c(i)),c(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(r=v.return)&&r.call(v)}finally{if(n)throw n.error}}}if(i)throw new d(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)_(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&p(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&p(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),y=v.EMPTY;function b(e){return e instanceof v||e&&"closed"in e&&h(e.remove)&&h(e.add)&&h(e.unsubscribe)}function _(e){h(e)?e():e.unsubscribe()}var m={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=m.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,a([e,t],c(n))):setTimeout.apply(void 0,a([e,t],c(n)))},clearTimeout:function(e){var t=m.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function g(e){m.setTimeout((function(){throw e}))}function w(){}var E=x("C",void 0,void 0);function x(e,t,n){return{kind:e,value:t,error:n}}function S(e){e()}var P=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,b(t)&&t.add(n)):n.destination=C,n}return o(t,e),t.create=function(e,t,n){return new I(e,t,n)},t.prototype.next=function(e){this.isStopped?j(function(e){return x("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?j(x("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?j(E,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(v);var T=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){O(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){O(e)}else O(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){O(e)}},e}(),I=function(e){function t(t,n,r){var i,o=e.call(this)||this;return i=h(t)||!t?{next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:t,o.destination=new T(i),o}return o(t,e),t}(P);function O(e){g(e)}function j(e,t){var n=null;n&&m.setTimeout((function(){return n(e,t)}))}var C={closed:!0,next:w,error:function(e){throw e},complete:w},k="function"==typeof Symbol&&Symbol.observable||"@@observable";function A(e){return e}var L=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof P||function(e){return e&&h(e.next)&&h(e.error)&&h(e.complete)}(r)&&b(r)?e:new I(e,t,n);return S((function(){var e=i.operator,t=i.source;o.add(e?e.call(o,t):t?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=N(t))((function(t,r){var i=new I({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[k]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?A:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=N(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function N(e){var t;return null!==(t=null!=e?e:undefined)&&void 0!==t?t:Promise}var R=f((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),V=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o(t,e),t.prototype.lift=function(e){var t=new z(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new R},t.prototype.next=function(e){var t=this;S((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=u(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;S((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;S((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.observers;return n.hasError||n.isStopped?y:(this.currentObservers=null,r.push(e),new v((function(){t.currentObservers=null,p(r,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.isStopped;t.hasError?e.error(t.thrownError):n&&e.complete()},t.prototype.asObservable=function(){var e=new L;return e.source=this,e},t.create=function(e,t){return new z(e,t)},t}(L),z=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return o(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:y},t}(V);function D(e){return function(t){if(function(e){return h(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function M(e,t,n,r,i){return new q(e,t,n,r,i)}var q=function(e){function t(t,n,r,i,o,s){var u=e.call(this,t)||this;return u.onFinalize=o,u.shouldUnsubscribe=s,u._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,u._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,u}return o(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(P);function U(e,t){return D((function(n,r){var i=0;n.subscribe(M(r,(function(n){r.next(e.call(t,n,i++))})))}))}var W=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function J(e){return h(null==e?void 0:e.then)}function F(e){return h(e[k])}function G(e){return Symbol.asyncIterator&&h(null==e?void 0:e[Symbol.asyncIterator])}function $(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Y="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function B(e){return h(null==e?void 0:e[Y])}function X(e){return function(t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=function(){var t,n,r;return s(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,l(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,l(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,l(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}.apply(t,n||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",(function(e){return function(t){return Promise.resolve(t).then(e,h)}})),r[Symbol.asyncIterator]=function(){return this},r;function u(e,t){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||c(e,t)}))},t&&(r[e]=t(r[e])))}function c(e,t){try{(n=i[e](t)).value instanceof l?Promise.resolve(n.value.v).then(a,h):f(o[0][2],n)}catch(e){f(o[0][3],e)}var n}function a(e){c("next",e)}function h(e){c("throw",e)}function f(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments)}function Z(e){return h(null==e?void 0:e.getReader)}function H(e){if(e instanceof L)return e;if(null!=e){if(F(e))return i=e,new L((function(e){var t=i[k]();if(h(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(W(e))return r=e,new L((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(J(e))return n=e,new L((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,g)}));if(G(e))return K(e);if(B(e))return t=e,new L((function(e){var n,r;try{for(var i=u(t),o=i.next();!o.done;o=i.next())if(e.next(o.value),e.closed)return}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(Z(e))return K(X(e))}var t,n,r,i;throw $(e)}function K(e){return new L((function(t){(function(e,t){var n,r,i,o,c,a,l;return c=this,l=function(){var c;return s(this,(function(s){switch(s.label){case 0:s.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=u(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}(e),s.label=1;case 1:return[4,n.next()];case 2:if((r=s.sent()).done)return[3,4];if(t.next(r.value),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=s.sent(),i={error:c},[3,11];case 6:return s.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function r(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(n,r)}i((l=l.call(c)).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function Q(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function ee(e,t,n){return void 0===n&&(n=1/0),h(t)?ee((function(n,r){return U((function(e,i){return t(n,e,r,i)}))(H(e(n,r)))}),n):("number"==typeof t&&(n=t),D((function(t,r){return function(e,t,n,r){var i=[],o=0,s=0,u=!1,c=function(){!u||i.length||o||t.complete()},a=function(e){o++;var u=!1;H(n(e,s++)).subscribe(M(t,(function(e){t.next(e)}),(function(){u=!0}),void 0,(function(){if(u)try{for(o--;i.length&&o<r;)void 0,e=i.shift(),a(e);c()}catch(e){t.error(e)}var e})))};return e.subscribe(M(t,(function(e){return o<r?a(e):i.push(e)}),(function(){u=!0,c()}))),function(){}}(t,r,e,n)})))}function te(e){return void 0===e&&(e=1/0),ee(A,e)}var ne=new L((function(e){return e.complete()}));function re(e){return e&&h(e.schedule)}function ie(e){return e[e.length-1]}function oe(e){return h(ie(e))?e.pop():void 0}function se(e){return re(ie(e))?e.pop():void 0}function ue(e,t){return void 0===t&&(t=0),D((function(n,r){n.subscribe(M(r,(function(n){return Q(r,e,(function(){return r.next(n)}),t)}),(function(){return Q(r,e,(function(){return r.complete()}),t)}),(function(n){return Q(r,e,(function(){return r.error(n)}),t)})))}))}function ce(e,t){return void 0===t&&(t=0),D((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function ae(e,t){if(!e)throw Error("Iterable cannot be null");return new L((function(n){Q(n,t,(function(){var r=e[Symbol.asyncIterator]();Q(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function le(e,t){return t?function(e,t){if(null!=e){if(F(e))return function(e,t){return H(e).pipe(ce(t),ue(t))}(e,t);if(W(e))return function(e,t){return new L((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(J(e))return function(e,t){return H(e).pipe(ce(t),ue(t))}(e,t);if(G(e))return ae(e,t);if(B(e))return function(e,t){return new L((function(n){var r;return Q(n,t,(function(){r=e[Y](),Q(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return h(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(Z(e))return function(e,t){return ae(X(e),t)}(e,t)}throw $(e)}(e,t):H(e)}function he(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=se(e),r=function(e){return"number"==typeof ie(e)?e.pop():1/0}(e),i=e;return i.length?1===i.length?H(i[0]):te(r)(le(i,n)):ne}function fe(e,t){var n=h(e)?e:function(){return e},r=function(e){return e.error(n())};return new L(t?function(e){return t.schedule(r,0,e)}:r)}function de(e){return D((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}const pe=Symbol.observable||"@@observable",ve=()=>{},ye=e=>{throw e},be=e=>(e.error(Error("The required browser API seems to be not supported.")),()=>{}),_e="undefined"==typeof window?null:window,me=((e,t)=>{const n=()=>{};return e=>{const r=(...r)=>{const i=e((e=>"function"==typeof e[0])(r)?t({next:r[0]}):t(...r));return void 0!==i?i:n};return r[Symbol.observable]=()=>({subscribe:(...e)=>({unsubscribe:r(...e)})}),i=r,Symbol.observable||("function"==typeof i&&i.prototype&&i.prototype[Symbol.observable]?(i.prototype[pe]=i.prototype[Symbol.observable],delete i.prototype[Symbol.observable]):(i[pe]=i[Symbol.observable],delete i[Symbol.observable])),i;var i}})(0,(function(e){return e?e.next&&e.error&&e.complete?e:{complete:(e.complete??ve).bind(e),error:(e.error??ye).bind(e),next:(e.next??ve).bind(e)}:{complete:ve,error:ye,next:ve}})),ge=(e=>(t,n,r)=>e((e=>{const i=t=>e.next(t);return t.addEventListener(n,i,r),()=>t.removeEventListener(n,i,r)})))(me),we=((e,t,n)=>()=>n((n=>{if(null===t||void 0===t.navigator||void 0===t.navigator.onLine)return e(n);const r=()=>n.next(!1),i=()=>n.next(!0);return t.addEventListener("offline",r),t.addEventListener("online",i),n.next(t.navigator.onLine),()=>{t.removeEventListener("offline",r),t.removeEventListener("online",i)}})))(be,_e,me);function Ee(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return te(1)(le(e,se(e)))}var xe=f((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function Se(e,t){return D((function(n,r){var i=0;n.subscribe(M(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function Pe(e){return e<=0?function(){return ne}:D((function(t,n){var r=0;t.subscribe(M(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function Te(){return new xe}function Ie(){return D((function(e,t){e.subscribe(M(t,w))}))}function Oe(e){return new L((function(t){H(e()).subscribe(t)}))}function je(e,t){return h(t)?ee(e,t,1):ee(e,1)}function Ce(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return le(e,se(e))}var ke=function(e){function t(t,n){return e.call(this)||this}return o(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(v),Ae={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Ae.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,a([e,t],c(n))):setInterval.apply(void 0,a([e,t],c(n)))},clearInterval:function(e){var t=Ae.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Le=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return o(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),Ae.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Ae.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,p(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(ke),Ne={now:function(){return(Ne.delegate||Date).now()},delegate:void 0},Re=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Ne.now,e}(),Ve=new(function(e){function t(t,n){void 0===n&&(n=Re.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return o(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Re))(Le),ze=Ve;function De(e,t,n){void 0===e&&(e=0),void 0===n&&(n=ze);var r=-1;return null!=t&&(re(t)?n=t:r=t),new L((function(t){var i,o=(i=e)instanceof Date&&!isNaN(i)?+e-n.now():e;o<0&&(o=0);var s=0;return n.schedule((function(){t.closed||(t.next(s++),0<=r?this.schedule(void 0,r):t.complete())}),o)}))}function Me(e){return D((function(t,n){var r,i=null,o=!1;i=t.subscribe(M(n,void 0,void 0,(function(s){r=H(e(s,Me(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):o=!0}))),o&&(i.unsubscribe(),i=null,r.subscribe(n))}))}function qe(e,t,n){var r=h(e)||t||n?{next:e,error:t,complete:n}:e;return r?D((function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(M(t,(function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)}),(function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()}),(function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)}),(function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)})))})):A}function Ue(e,t,n,r,i){return function(o,s){var u=n,c=t,a=0;o.subscribe(M(s,(function(t){var n=a++;c=u?e(c,t,n):(u=!0,t),r&&s.next(c)}),i&&function(){u&&s.next(c),s.complete()}))}}function We(e,t){return D(Ue(e,t,arguments.length>=2,!0))}var Je={connector:function(){return new V}};function Fe(e,t){void 0===t&&(t=Je);var n=t.connector;return D((function(t,r){var i,o=n();H(e((i=o,new L((function(e){return i.subscribe(e)}))))).subscribe(r),r.add(t.subscribe(o))}))}var Ge=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=Ne);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return o(t,e),t.prototype.next=function(t){var n=this,r=n._buffer,i=n._infiniteTimeWindow,o=n._timestampProvider,s=n._windowTime;n.isStopped||(r.push(t),!i&&r.push(o.now()+s)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var s=n.now(),u=0,c=1;c<r.length&&r[c]<=s;c+=2)u=c;u&&r.splice(0,u+1)}},t}(V);function $e(e,t,n,r){return D((function(i,o){var s;t&&"function"!=typeof t?(n=t.duration,s=t.element,r=t.connector):s=t;var u=new Map,c=function(e){u.forEach(e),e(o)},a=function(e){return c((function(t){return t.error(e)}))},l=0,h=!1,f=new q(o,(function(t){try{var i=e(t),c=u.get(i);if(!c){u.set(i,c=r?r():new V);var d=(v=i,y=c,(b=new L((function(e){l++;var t=y.subscribe(e);return function(){t.unsubscribe(),0==--l&&h&&f.unsubscribe()}}))).key=v,b);if(o.next(d),n){var p=M(c,(function(){c.complete(),null==p||p.unsubscribe()}),void 0,void 0,(function(){return u.delete(i)}));f.add(H(n(d)).subscribe(p))}}c.next(s?s(t):t)}catch(e){a(e)}var v,y,b}),(function(){return c((function(e){return e.complete()}))}),a,(function(){return u.clear()}),(function(){return h=!0,0===l}));i.subscribe(f)}))}var Ye=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return o(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e._value;if(e.hasError)throw e.thrownError;return this._throwIfClosed(),t},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(V);function Be(e,t){return void 0===t&&(t=A),e=null!=e?e:Xe,D((function(n,r){var i,o=!0;n.subscribe(M(r,(function(n){var s=t(n);!o&&e(i,s)||(o=!1,i=s,r.next(n))})))}))}function Xe(e,t){return e===t}function Ze(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return Ee(t,Ce.apply(void 0,a([],c(e))))}}const He=(e,t)=>{const n=t.find((t=>{let[n]=t;return n===e}));if(void 0===n)throw Error("There is no tuple with the given key.");return n[1]},Ke=e=>"boolean"==typeof e[1],Qe=e=>"boolean"!=typeof e[1],et=e=>null!==e[1]&&"object"==typeof e[1],tt=e=>"function"==typeof e[1],nt=e=>!0===e[1],rt=Symbol();function it(e){return Se((function(t,n){return e<=n}))}function ot(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=oe(e);return D((function(t,r){for(var i=e.length,o=Array(i),s=e.map((function(){return!1})),u=!1,l=function(t){H(e[t]).subscribe(M(r,(function(e){o[t]=e,u||s[t]||(s[t]=!0,(u=s.every(A))&&(s=null))}),w))},h=0;h<i;h++)l(h);t.subscribe(M(r,(function(e){if(u){var t=a([e],c(o));r.next(n?n.apply(void 0,a([],c(t))):t)}})))}))}const st=function(e){return null!=e};var ut,ct=Array.isArray;function at(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=oe(e),r=function(e){return 1===e.length&&ct(e[0])?e[0]:e}(e);return r.length?new L((function(e){var t=r.map((function(){return[]})),i=r.map((function(){return!1}));e.add((function(){t=i=null}));for(var o=function(o){H(r[o]).subscribe(M(e,(function(r){if(t[o].push(r),t.every((function(e){return e.length}))){var s=t.map((function(e){return e.shift()}));e.next(n?n.apply(void 0,a([],c(s))):s),t.some((function(e,t){return!e.length&&i[t]}))&&e.complete()}}),(function(){i[o]=!0,!t[o].length&&e.complete()})))},s=0;!e.closed&&s<r.length;s++)o(s);return function(){t=i=null}})):ne}function lt(e,t){return D((function(n,r){var i=null,o=0,s=!1,u=function(){return s&&!i&&r.complete()};n.subscribe(M(r,(function(n){null==i||i.unsubscribe();var s=0,c=o++;H(e(n,c)).subscribe(i=M(r,(function(e){return r.next(t?t(n,e,c,s++):e)}),(function(){i=null,u()})))}),(function(){s=!0,u()})))}))}function ht(e,t,n){return Oe((function(){return e()?t:n}))}function ft(e){return function(e,t){return D(Ue(e,t,arguments.length>=2,!1,!0))}((function(t,n,r){return!e||e(n,r)?t+1:t}),0)}function dt(e,t){return void 0===e&&(e=0),void 0===t&&(t=Ve),e<0&&(e=0),De(e,e,t)}function pt(e){return D((function(t,n){H(e).subscribe(M(n,(function(){return n.complete()}),w)),!n.closed&&t.subscribe(n)}))}function vt(e){var t;void 0===e&&(e=1/0);var n=(t=e&&"object"==typeof e?e:{count:e}).count,r=void 0===n?1/0:n,i=t.delay,o=t.resetOnSuccess,s=void 0!==o&&o;return r<=0?A:D((function(e,t){var n,o=0,u=function(){var c=!1;n=e.subscribe(M(t,(function(e){s&&(o=0),t.next(e)}),void 0,(function(e){if(o++<r){var s=function(){n?(n.unsubscribe(),n=null,u()):c=!0};if(null!=i){var a="number"==typeof i?De(i):H(i(e,o)),l=M(t,(function(){l.unsubscribe(),s()}),(function(){t.complete()}));a.subscribe(l)}else s()}else t.error(e)}))),c&&(n.unsubscribe(),n=null,u())};u()}))}!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(ut||(ut={}));var yt=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){return bt(this,e)},e.prototype.do=function(e,t,n){var r=this,i=r.kind,o=r.error;return"N"===i?null==e?void 0:e(r.value):"E"===i?null==t?void 0:t(o):null==n?void 0:n()},e.prototype.accept=function(e,t,n){var r;return h(null===(r=e)||void 0===r?void 0:r.next)?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){var e=this,t=e.kind,n=e.error,r="N"===t?Ce(e.value):"E"===t?fe((function(){return n})):"C"===t?ne:0;if(!r)throw new TypeError("Unexpected notification kind "+t);return r},e.createNext=function(t){return new e("N",t)},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e}();function bt(e,t){var n,r,i,o=e.kind,s=e.value,u=e.error;if("string"!=typeof o)throw new TypeError('Invalid notification, missing "kind"');"N"===o?null===(n=t.next)||void 0===n||n.call(t,s):"E"===o?null===(r=t.error)||void 0===r||r.call(t,u):null===(i=t.complete)||void 0===i||i.call(t)}class _t{constructor(e){this.callback=e}call(e,t){return t.subscribe(new mt(e,this.callback))}}class mt extends P{constructor(e,t){super(e),this.add(new v((()=>t(this.notification))))}complete(){this.notification=new yt("C"),super.complete()}error(e){this.notification=new yt("E",void 0,e),super.error(e)}}function gt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=se(e);return D((function(t,r){(n?Ee(e,t,n):Ee(e,t)).subscribe(r)}))}const wt=e=>new L((t=>{let n=!0;return e.then((e=>{n&&(t.next(e),t.complete())}),(e=>{n&&t.error(e)})),()=>n=!1})),Et=(e,t)=>n=>n.pipe(ee((n=>{let[r,i,o]=n;return new L((n=>{const s=[],u=new V,c=[],a=new V,l=()=>(_=!1,wt(E.setLocalDescription()).pipe(qe((()=>{const{localDescription:e}=E;if(null===e)throw Error("The local description is not set.");t({...A(e),client:{id:r},version:C})})))),h=()=>ge(E,"icecandidate")((e=>{let{candidate:n}=e;null===n?t({client:{id:r},numberOfGatheredCandidates:w,type:"summary",version:C}):9!==n.port&&"tcp"!==n.protocol&&(t({...n.toJSON(),client:{id:r},type:"candidate",version:C}),w+=1)})),f=()=>{const e=[at([ge(x,"open"),ge(T,"open")]).pipe(Pe(1)).subscribe((()=>{S=e=>{const t="update"===e.type?x:T;try{t.send(JSON.stringify(e))}catch(e){return u.next(e),!1}return!0},n.next([r,S])})),he(...[x,T].map((e=>["close","closing","error"].map((t=>ge(e,t))))).flat()).subscribe((e=>{let{type:t}=e;return u.next(Error(`RTCDataChannel fired unexpected event of type "${t}".`))}))],t=[()=>e.forEach((e=>e.unsubscribe())),ge(x,"message")((e=>{let{data:t}=e;const i=JSON.parse(t);n.next([r,i])})),ge(T,"message")((e=>{let{data:t,timeStamp:i}=e;const o={...JSON.parse(t),timestamp:null!=i?i:performance.now()};n.next([r,o])}))];return()=>t.forEach((e=>e()))},[d,p]=(v=1,[()=>v**2,()=>{v+=1}]);var v;const y=()=>{const e=he(ge(E,"icecandidate"),ge(E,"icegatheringstatechange")).pipe(lt((()=>ht((()=>"gathering"===E.iceGatheringState),Oe((()=>De(1e4*d()))),ne)))).subscribe((()=>{p(),u.next(Error('RTCPeerConnection seems to be stuck at iceGatheringState "gathering".'))})),t=[()=>e.unsubscribe(),ge(E,"connectionstatechange")((()=>{const e=E.connectionState;["closed","disconnected","failed"].includes(e)&&u.next(Error(`RTCPeerConnection transitioned to unexpected connectionState "${e}".`))})),ge(E,"icecandidateerror")((()=>u.next(Error('RTCPeerConnection fired unexpected event of type "icecandidateerror".')))),ge(E,"iceconnectionstatechange")((()=>{const e=E.iceConnectionState;["closed","disconnected","failed"].includes(e)&&u.next(Error(`RTCPeerConnection transitioned to unexpected iceConnectionState "${e}".`))})),ge(E,"signalingstatechange")((()=>{"closed"===E.signalingState&&u.next(Error('RTCPeerConnection transitioned to unexpected signalingState "closed".'))}))];return()=>t.forEach((e=>e()))},b=t=>{a.next(null),I(),O(),j(),x.close(),T.close(),E.close(),null!==S&&n.next([r,!0]),_=!0,m=0,g=C===t?g:1/0,w=0,E=e(),c.length=C===t?c.length:0,x=E.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),S=null,T=E.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),I=h(),O=f(),j=y(),C=t};let _=!0,m=0,g=1/0,w=0,E=e(),x=E.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),S=null,P=null,T=E.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),I=h(),O=f(),j=y(),C=0;const k=async e=>{m+=e,m===g&&await E.addIceCandidate()},A=e=>e instanceof RTCSessionDescription?e.toJSON():e;return n.next([r,!0]),he(Oe((()=>le(s))),u.pipe(ee((e=>fe((()=>e))))),o.pipe(((e,t,n)=>r=>r.pipe(D((function(e,t){e.subscribe(M(t,(function(e){t.next(yt.createNext(e))}),(function(){t.next(yt.createComplete()),t.complete()}),(function(e){t.next(yt.createError(e)),t.complete()})))})),gt(null),lt((r=>Ee(Ce(r),null===r||"N"===r.kind?n.pipe(function(e,t){return void 0===t&&(t=!1),D((function(n,r){var i=0;n.subscribe(M(r,(function(n){var o=e(n,i++);(o||t)&&r.next(n),!o&&r.complete()})))}))}(t),qe(e),Ie()):ne))),Se(st),D((function(e,t){e.subscribe(M(t,(function(e){return bt(e,t)})))}))))((()=>t({client:{id:r},type:"check"})),(()=>"open"!==x.readyState||"open"!==T.readyState),dt(5e3)),(L=e=>{void 0!==e&&u.complete()},e=>e.lift(new _t(L))))).pipe(ee((e=>(e=>{const{type:n}=e;if("answer"===n&&i){if(C>e.version)return ne;if(C===e.version&&!_)return wt(E.setRemoteDescription(e)).pipe(ee((()=>le(c))),ee((e=>wt(E.addIceCandidate(e)))),ft(),ee((e=>wt(k(e)))))}if("candidate"===n){if(C>e.version)return ne;if(C<e.version&&!i&&b(e.version),C===e.version)return null===E.remoteDescription?(c.push(e),ne):wt(E.addIceCandidate(e)).pipe(ee((()=>wt(k(1)))))}if("error"===n&&i)return C>e.version?ne:(b(e.version+1),l());if("notice"===n&&!i)return ne;if("offer"===n&&!i)return C>e.version?ne:(C<e.version&&b(e.version),_=!1,wt(E.setRemoteDescription(e)).pipe(ee((()=>he(wt(E.setLocalDescription()).pipe(qe((()=>{const{localDescription:e}=E;if(null===e)throw Error("The local description is not set.");t({...A(e),client:{id:r},version:C})}))),le(c).pipe(ee((e=>wt(E.addIceCandidate(e)))),ft(),ee((e=>wt(k(e))))))))));if("request"===n&&i)return 0===C&&_?l():ne;if("summary"===n){if(C>e.version)return ne;if(C<e.version&&!i&&b(e.version),C===e.version)return g=e.numberOfGatheredCandidates,wt(k(0))}return P=Error(`The current event of type "${n}" can't be processed.`),fe((()=>P))})(e).pipe(pt(a)))),vt({delay:e=>{if(e===P)return fe((()=>e));if(s.length=0,_)b(C);else{const e={client:{id:r},type:"error",version:C};i?s.push(e):(b(C+1),t(e))}return Ce(null)}}),pt(Ee(o.pipe(Ie()),Ce(null))),de((()=>{I(),O(),j(),x.close(),T.close(),E.close()}))).subscribe({complete:()=>{n.next([r,!1]),n.complete()},error:e=>n.error(e)});var L}))})));function xt(e,t){return function(n,r){return!e.call(t,n,r)}}const St=/^[\dA-Za-z]{20}$/,Pt="undefined"==typeof window?null:window,Tt=((e,t,n,r,i,o,s)=>class extends n{constructor(e){super();const t=r.now()/1e3;this._clientId="",this._endPosition=1/0,this._error=null,this._hops=[],this._onadjust=null,this._onchange=null,this._onreadystatechange=null,this._origin=Number.MAX_SAFE_INTEGER,this._providerIdOrUrl=e,this._readyState="connecting",this._skew=0,this._startPosition=-1/0,this._subscription=null,this._updateRequestsSubject=new V,this._vector={acceleration:0,position:0,timestamp:t,velocity:0},this._version=0,this._createClient()}get endPosition(){return this._endPosition}get error(){return this._error}get onadjust(){return null===this._onadjust?this._onadjust:this._onadjust[0]}set onadjust(e){if(null!==this._onadjust&&this.removeEventListener("adjust",this._onadjust[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("adjust",t),this._onadjust=[e,t]}else this._onadjust=null}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get skew(){return this._skew}get startPosition(){return this._startPosition}get vector(){return this._vector}destroy(){if(null===this._subscription)throw Error("The timingProvider is already destroyed.");this._readyState="closed",this._subscription.unsubscribe(),this._subscription=null,this._updateRequestsSubject.complete(),i((()=>this.dispatchEvent(new Event("readystatechange"))))}update(e){if(null===this._subscription)return Promise.reject(Error("The timingProvider is destroyed and can't be updated."));const t=s(this._vector,e);return null!==t&&this._updateRequestsSubject.next([{...t,hops:[],version:this._version+1},null]),Promise.resolve()}_createClient(){var n=this;const i=St.test(this._providerIdOrUrl)?"wss://matchmaker.suenc.io?providerId="+this._providerIdOrUrl:this._providerIdOrUrl;this._subscription=he(Ee(le(we()).pipe((e=>e.pipe(Se((e=>!0===e)))),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Se((function(t,n){return e(t,n,r)})):A,Pe(1),n?function(e){return D((function(t,n){var r=!1;t.subscribe(M(n,(function(e){r=!0,n.next(e)}),(function(){r||n.next(e),n.complete()})))}))}(t):(void 0===(i=function(){return new xe})&&(i=Te),D((function(e,t){var n=!1;e.subscribe(M(t,(function(e){n=!0,t.next(e)}),(function(){return n?t.complete():t.error(i())})))}))));var i}}(),Ie()),Oe((()=>{const[n,r]=t(i);return n.pipe((o=e=>"closure"===e.type,s=()=>{this._error=Error("Your plan has exceeded its quota."),this._readyState="closed",this.dispatchEvent(new Event("readystatechange"))},Fe((e=>{const[t,n]=(r=e,[Se(i=o,u)(H(r)),Se(xt(i,u))(H(r))]);var r,i,u;return n.pipe(pt(t.pipe(qe(s))))}))),(u=e=>"init"===e.type,e=>e.pipe(We(((e,t)=>{let[n,r]=e;if(u(t)){if(null===r)throw Error("Another value has been identified as the first value already.");return[[t,...r],null]}return null===r?[[t],r]:[n,[...r,t]]}),[[],[]]),je((e=>{let[t]=e;return le(t)})))),je((e=>{if("array"===e.type)return le(e.events);if("init"===e.type){const{client:{id:t},events:n,origin:r}=e;return this._clientId=t,this._origin=r,0===n.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange"))),le(n)}return Ce(e)})),((e,t)=>n=>new L((r=>{const i=new Map,o=t=>e()<t;return n.pipe((s=()=>{i.forEach((e=>{let[t,n]=e;null===t?n.unsubscribe():t.complete()}))},e=>new L((t=>{const n=e.subscribe({complete:()=>{s(),t.complete()},error:e=>{s(),t.error(e)},next:e=>t.next(e)});return()=>{s(),n.unsubscribe()}})))).subscribe({complete(){r.complete()},error(e){r.error(e)},next(e){var n;const s=e.client.id,[u,c]=null!==(n=i.get(s))&&void 0!==n?n:[null,null];if("termination"===e.type)null!==c&&c.unsubscribe(),null!==u&&u.complete(),i.set(s,[null,t.pipe(it(o(s)?1:0),Pe(1)).subscribe((()=>i.delete(s)))]);else if(null===u&&null===c){const t=new V;i.set(s,[t,null]),r.next([s,o(s),t.asObservable()]),t.next(e)}else null===c&&u.next(e)}});var s})))((()=>this._clientId),De(1e4)),Et(e,r));var o,s,u}))).pipe((e=>Oe((()=>{let t=0;return e.pipe(vt({delay:e=>(t+=1,ht((()=>t<4),De(1e3*t**2),fe((()=>e))))}),qe((()=>t=0)))}))),Me((e=>(this._error=e,this._readyState="closed",this.dispatchEvent(new Event("readystatechange")),ne))),qe((e=>{tt(e)&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),We(((e,t)=>{let[,n]=e;const r=n.findIndex((e=>{let[n]=e;return n===t[0]}));return-1===r?(nt(t)||tt(t))&&n.push(t):!1===t[1]?n.splice(r,1):(nt(t)||tt(t))&&(n[r]=t),[t,n]}),[,[]]),qe((e=>{let[,t]=e;0===t.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),Se((e=>{let[t]=e;return!(tt(t)&&!t[1]({message:this._createExtendedVector([...this._hops,this._origin]),type:"update"}))})),Fe((e=>{const t=new Ge(1);return e.pipe(qe((e=>{let[,n]=e;return t.next(n)})),U((e=>{let[t,n]=e;if(et(t)){const[e,r]=t;if("ping"===r.type)return[e,{...r,reply:He(e,n.filter(tt))}]}return t})),Se(Qe),$e((e=>{let[t]=e;return t}),{duration:t=>e.pipe(U((e=>{let[t]=e;return t})),Se(Ke),Se((e=>{let[n]=e;return n===t.key})))}),ee((e=>{const t=new Ye([0,[]]);return e.pipe(Fe((n=>he(n.pipe(Se(tt),(e=>t=>t.pipe(U((t=>{let[,n]=t;return dt(1e3).pipe(gt(0),U(((e,t)=>(n({index:t,type:"ping"}),r.now()))),ot(e),qe((t=>{let[n,[r,i]]=t;return e.next([r,[...i,n]])})),Ie())})),Ze(ne),lt(A)))(t)),n.pipe(Se(et),U((e=>{let[,t]=e;return t})),$e((e=>e.type)),ee((e=>"ping"===e.key?e.pipe(qe((e=>{let{index:t,timestamp:n,reply:i}=e;return i({index:t,remoteReceivedTime:n,remoteSentTime:r.now(),type:"pong"})})),Ie()):"pong"===e.key?e.pipe((e=>t=>t.pipe(ot(e),U((t=>{let[{index:n,remoteReceivedTime:r,remoteSentTime:i,timestamp:o},[s,u]]=t;if(n<s)return null;const c=n-s,[a,...l]=u.slice(c);return e.next([s+c+1,l]),[a,r,i,o]})),Se(st)))(t),U((e=>{let[t,n,r,i]=e;return[(n+r-t-i)/2,i-t+n-r]})),(e=>e.pipe(We(((e,t)=>[...e.slice(-59),t]),[]),U((e=>e.slice(1).reduce(((e,t)=>e[1]<t[1]?e:t),e[0]))))),U((e=>[1,e]))):e.pipe(U((e=>{let{message:t}=e;return t})),U((e=>this._version>e.version||this._version===e.version&&((0===this._hops.length?this._origin:this._hops[0])<e.hops[0]||e.hops.includes(this._origin))?null:e)),U((e=>[0,e]))))),(e=>e.pipe(We(((e,t)=>{let[n,r]=t;return 0===n?[r,e[1]]:[e[0],r]}),[rt,rt]),Se((e=>e.every((e=>e!==rt)))))),Be(((e,t)=>{let[n,[r,i]]=e,[o,[s,u]]=t;return n===o&&r===s&&i===u})),U((t=>{let[n,[r,i]]=t;return[e.key,null===n?null:{...n,timestamp:n.timestamp-r/1e3},i]})),Ze([e.key,null,null]))))))})),We(((e,t)=>{let[,n]=e;const r=n.findIndex((e=>{let[n]=e;return t[0]===n}));return null===t[2]?r>-1&&n.splice(r,1):r>-1?n[r]=t:(n.push(t),n.sort(((e,t)=>{let[n]=e,[r]=t;return n<r?-1:n>r?1:0}))),[t,n]}),[,[]]),ee((e=>t.pipe(Pe(1),U((t=>[e,t]))))),U((e=>{let[[t],n]=e;return[...t,n]})))}))),this._updateRequestsSubject.pipe(U((e=>{let[t]=e;return[null,t,0,null]})))).pipe(We((function(e,t){let[r,i]=void 0===e?[[[null,n._createExtendedVector(n._hops),0]],[]]:e,[s,u,c,a]=t;const l=null!=a?a:i,h=r.findIndex((e=>e[0]===s));if(null!==u){if(n._version<u.version)return r.length=0,r.push([s,u,c]),[r,l];if(n._version===u.version){const e=0===n._hops.length?n._origin:n._hops[0];if(e>u.hops[0]&&!u.hops.includes(n._origin))return r.length=0,r.push([s,u,c]),[r,l];if(e===u.hops[0]&&!u.hops.includes(n._origin)&&n._hops.length>0)return h>-1?r[h]=[s,u,c]:r.push([s,u,c]),o(r),[r,l]}}return h>-1&&(1===r.length?r[0]=[null,{...r[0][1],hops:[r[0][1].hops[0],...r[0][1].hops.map((()=>n._origin))]},0]:r.splice(h,1)),[r,l]}),void 0),Be(((e,t)=>e===t),(e=>{let[[[,t]]]=e;return t}))).subscribe((e=>{let[[[t,n]],r]=e;const i={...n,hops:[...n.hops,this._origin]};for(const[e,n]of r.filter(tt))if(!n({message:i,type:"update"})&&t===e)return;this._setInternalVector(n)}))}_createExtendedVector(e){return{...this._vector,hops:e,version:this._version}}_setInternalVector(e){let{hops:t,version:n,...r}=e;this._hops=t,this._vector=r,this._version=n,this.dispatchEvent(new CustomEvent("change",{detail:r}))}})((e=>()=>{if(null===e)throw Error("A native EventTarget could not be created.");return new e.RTCPeerConnection({iceCandidatePoolSize:1,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}]})})(Pt),(Ct=e=>new WebSocket(e),e=>{const t=new V,n=Ct(e);return[he(ge(n,"message"),he(he(...["close","error"].map((e=>ge(n,e)))).pipe(U((e=>{let{type:t}=e;return Error(`WebSocket fired unexpected event of type "${t}".`)}))),t).pipe(ee((e=>fe((()=>e)))))).pipe(de((()=>n.close())),U((e=>JSON.parse(e.data)))),e=>{try{n.send(JSON.stringify(e))}catch(e){t.next(e)}}]}),(jt=(e=>()=>{if(null===e)throw Error("A native EventTarget could not be created.");return e.document.createElement("p")})(Pt),class{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=jt()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(r=this,i=t,o=e=>{const t={value:r};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof i?i.call(r,e):i.handleEvent.call(r,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var r,i}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}),performance,setTimeout,(It=e=>{let[,{hops:t}]=e;return t},Ot=e=>{let[,,t]=e;return t},e=>{e.sort(((e,t)=>{const n=((e,t)=>{let[n,...r]=e,[i,...o]=t;if(void 0===n||void 0===i)throw Error("Every vector should have an origin.");if(n===i){const e=r.filter((e=>e===r[0])).length,t=o.filter((e=>e===o[0])).length;if(e===t){if(0===e)throw Error("At least one vector should have a hop if they have the same origin.");if(1===e||r[0]===o[0]){if(r.length===o.length){if(r.every(((e,t)=>e===o[t])))throw Error("Every vector should be unique.");return 0}return r.length-o.length}return r[0]-o[0]}return e-t}return n-i})(It(e),It(t));return 0===n?Ot(e)-Ot(t):n}))}),((e,t,n)=>(r,i)=>{const o=e(i),s=n(r,t.now()/1e3-r.timestamp);for(const[e,t]of Object.entries(o))if(t!==s[e])return{...s,...o};return null})(r.filterTimingStateVectorUpdate,performance,r.translateTimingStateVector));var It,Ot,jt,Ct},822:(e,t,n)=>{n.r(t),n.d(t,{TimingObject:()=>o,filterTimingStateVectorUpdate:()=>r,translateTimingStateVector:()=>i});const r=e=>{if(void 0===e)return{};let t=null!=e.acceleration?{acceleration:e.acceleration}:{};return null!=e.position&&(t={...t,position:e.position}),null!=e.velocity?{...t,velocity:e.velocity}:t},i=(e,t)=>{const{acceleration:n,position:r,timestamp:i,velocity:o}=e;return{acceleration:n,position:r+o*t+.5*n*t**2,timestamp:i+t,velocity:o+n*t}},o=((e,t,n,r,i,o,s,u)=>class extends r{constructor(e,t,n){void 0===e&&(e={}),void 0===t&&(t=-1/0),void 0===n&&(n=1/0),super();const{timingProviderSource:r,vector:u}=void 0===e.update?{timingProviderSource:null,vector:e}:{timingProviderSource:e,vector:{}};if(this._endPosition=null===r?n:r.endPosition,this._onchange=null,this._onerror=null,this._onreadystatechange=null,this._readyState=null===r?"open":r.readyState,this._skew=null===r?0:r.skew,this._startPosition=null===r?t:r.startPosition,this._timingProviderSource=r,this._timeoutId=null,this._vector=null===r?{acceleration:0,position:0,velocity:0,...i(u),timestamp:o.now()/1e3}:r.vector,n<this._vector.position&&(this._vector={...this._vector,acceleration:0,position:n,velocity:0}),t>this._vector.position&&(this._vector={...this._vector,acceleration:0,position:t,velocity:0}),this._setInternalTimeout(),null===r)s((()=>this.dispatchEvent(new Event("readystatechange"))));else{const e=()=>{this._skew=r.skew},t=()=>this._setInternalVector(r.vector),n=()=>{this._isAllowedTransition(r.readyState)?this._readyState=r.readyState:(this._readyState="closed",r.removeEventListener("adjust",e),r.removeEventListener("change",t),r.removeEventListener("readystatechange",n)),null!==r.error&&s((()=>this.dispatchEvent(new ErrorEvent("error",{error:r.error})))),s((()=>this.dispatchEvent(new Event("readystatechange"))))};r.addEventListener("adjust",e),r.addEventListener("change",t),r.addEventListener("readystatechange",n)}}get endPosition(){return this._endPosition}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onerror(){return null===this._onerror?this._onerror:this._onerror[0]}set onerror(e){if(null!==this._onerror&&this.removeEventListener("error",this._onerror[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("error",t),this._onerror=[e,t]}else this._onerror=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get startPosition(){return this._startPosition}get timingProviderSource(){return this._timingProviderSource}query(){if("open"!==this._readyState)throw n();const e=o.now()/1e3,t=u(this._vector,null===this._timingProviderSource?e-this._vector.timestamp:e+this._skew-this._vector.timestamp);return this._endPosition<t.position||this._startPosition>t.position?(this._setInternalVector({...t,acceleration:0,position:this._endPosition<t.position?this._endPosition:this._startPosition,velocity:0}),this.query()):t}update(e){if("open"!==this._readyState)return Promise.reject(n());if(null!==this._timingProviderSource){const t=this._timingProviderSource.update(e);return t instanceof Promise?t:Promise.reject(new TypeError("The timingProviderSource failed to return a promise."))}const t=i(e);if(0===Object.keys(t).length)return Promise.resolve();const r={...this.query(),...t},{position:o,velocity:s,acceleration:u}=r;return o<this._startPosition||o>this._endPosition||o===this._startPosition&&(s<0||0===s&&u<0)||o===this._endPosition&&(s>0||0===s&&u>0)?Promise.reject((()=>{try{return new DOMException("","IllegalValueError")}catch(e){return e.name="IllegalValueError",e}})()):(this._setInternalVector(r),Promise.resolve())}_isAllowedTransition(e){return"closing"===this._readyState&&"closed"===e||"connecting"===this._readyState||"open"===this._readyState&&("closed"===e||"closing"===e)}_setInternalTimeout(){if(null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this._endPosition===1/0&&this._startPosition===-1/0||0===this._vector.acceleration&&0===this._vector.velocity)return;const t=e(this._vector,this._startPosition,this._endPosition);null!==t&&(this._timeoutId=s((()=>this.query()),t))}_setInternalVector(e){this._vector=e,this._setInternalTimeout(),s((()=>this.dispatchEvent(new Event("change"))))}})((c=(e,t)=>{let{acceleration:n,position:r,velocity:i}=e;const o=((e,t,n,r)=>{if(0===n&&0===t)return e!==r?[]:[0];if(0===n)return[(r-e)/t];const i=t/n,o=Math.sqrt(i**2-2/n*(e-r));return[o-i,-(o+i)].filter((e=>!isNaN(e))).sort()})(r,i,n,t);if(0===o.length)return null;if(1===o.length)return o[0]>0?o[0]:null;if(2===o.length){if(o[1]<0)return null;if(o[0]>0)return o[0];if(o[1]>0)return o[1]}return null},u=(e,t,n)=>{const r=c(e,t),i=c(e,n);return null!==r&&null!==i?r<i?r:i:null!==r?r:null!==i?i:null},(e,t,n)=>{const r=u(e,t,n);return null===r||r===1/0?null:r}),0,(()=>{try{return new DOMException("","InvalidStateError")}catch(e){return e.code=11,e.name="InvalidStateError",e}}),(s=(e=>()=>{if(null===e)throw Error("A native EventTarget could not be created.");return e.document.createElement("p")})("undefined"==typeof window?null:window),class{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=s()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(r=this,i=t,o=e=>{const t={value:r};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof i?i.call(r,e):i.handleEvent.call(r,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var r,i}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}),r,performance,setTimeout,i);var s,u,c}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{TimingObject:()=>TimingObject,TimingProvider:()=>TimingProvider});const TimingObject=n(822),TimingProvider=n(69);var i=window;for(var o in r)i[o]=r[o];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();
    (()=>{var __webpack_modules__={138:e=>{"use strict";e.exports=JSON.parse('{"default":{"type":"square","cutoff":275.48799999999994,"Q":0,"keyTrack":0,"envDepth":1457.5999999999976,"level":0,"attack":0.02506944444444445,"decay":0.39062500000000155,"sustain":0.08027777777777759,"release":0.2669444444444446},"chirp":{"type":"saw","cutoff":380.278,"Q":10.44300000000001,"keyTrack":0,"envDepth":2557.399999999998,"level":0,"attack":0.01000000000000004,"decay":0.3500694444444451,"sustain":0.08999999999999969,"release":0.21777777777777863},"pluck":{"type":"square","cutoff":343.35200000000003,"Q":11.532000000000012,"keyTrack":0,"envDepth":1306.3999999999974,"level":0,"adsr":[0.01,0.4,0.5,0.8]},"flute":{"type":"tri","cutoff":20,"Q":0,"keyTrack":0,"envDepth":2197.4000000000037,"level":0,"adsr":[0.8402777777777787,1,1,1]},"drone":{"type":"saw","cutoff":435.3276799999999,"Q":14.700000000000012,"keyTrack":0,"envDepth":8.600000000001046,"level":0.5041000000000002,"adsr":[0.8402777777777787,1,1,1]}}')},182:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.DatoDuo=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(9710),a=s(n(640)),c=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class DatoDuo extends c.MonophonicTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.gui=e,this.presets=a.default,this.isGlide=!1,this.name="DatoDuo",this.frequency=new r.Signal,this.tonePitchShift=new r.Multiply,this.sawPitchShift=new r.Multiply,this.pulseWav=(new r.PulseOscillator).start(),this.sawWav=new r.Oscillator({type:"sawtooth"}).start(),this.toneMixer=new r.Multiply,this.sawMixer=new r.Multiply,this.cutoff=new r.Signal,this.vcf_env=new r.Envelope,this.filterDepth=new r.Multiply,this.filterMultiplier=new r.Multiply,this.filter=new r.Filter,this.velocity=new r.Signal(1),this.velocityMult=new r.Multiply(1),this.env=new r.Envelope,this.amp=new r.Multiply,this.output=new r.Multiply(.05).toDestination(),this.frequency.connect(this.tonePitchShift),this.tonePitchShift.connect(this.pulseWav.frequency),this.frequency.connect(this.sawPitchShift),this.sawPitchShift.connect(this.sawWav.frequency),this.rampTime=.004,this.frequency.value=500,this.tonePitchShift.factor.value=1,this.sawPitchShift.factor.value=1,this.pulseWav.connect(this.toneMixer),this.toneMixer.connect(this.filter),this.sawWav.connect(this.sawMixer),this.sawMixer.connect(this.filter),this.toneMixer.factor.value=.25,this.sawMixer.factor.value=.25,this.vcf_env.connect(this.filterDepth),this.cutoff.connect(this.filter.frequency),this.filterDepth.connect(this.filter.frequency),this.cutoff.value=1500,this.filterDepth.factor.value=5e3,this.vcf_env.attack=.02,this.vcf_env.decay=.01,this.vcf_env.sustain=0,this.vcf_env.release=.2,this.filter.rolloff=-24,this.filter.Q.value=1,this.filter.connect(this.amp),this.velocity.connect(this.velocityMult.factor),this.env.connect(this.velocityMult),this.velocityMult.connect(this.amp.factor),this.env.attack=.01,this.env.delay=.1,this.env.sustain=0,this.env.release=.9,this.env.releaseCurve="cosine",this.dist=new r.Distortion(.9),this.crusher=new r.BitCrusher(2),this.delay=new r.FeedbackDelay,this.distgain=new r.Multiply(1),this.crushgain=new r.Multiply(1),this.delaygain=new r.Multiply(1),this.delayFilter=new r.Filter,this.lfo=new r.LFO("8n",400,2e3),this.amp.connect(this.dist),this.dist.connect(this.distgain),this.distgain.connect(this.crusher),this.crusher.connect(this.output),this.crusher.connect(this.delaygain),this.delaygain.connect(this.delay),this.delay.connect(this.delayFilter),this.lfo.connect(this.delayFilter.frequency),this.delayFilter.connect(this.output),this.kick="audio/drums-003.mp3",this.snare="audio/snare.mp3",this.kickPlayer=new r.Sampler({urls:{C4:"drums-003.mp3"},baseUrl:"/m080/audio/"}).toDestination(),this.snarePlayer=new r.Sampler({urls:{C4:"snare.mp3"},baseUrl:"/m080/audio/"}).toDestination(),this.kickPlayer.volume.value=-12,this.snarePlayer.volume.value=-18}triggerAttack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=Math.pow(t/127,2),e=r.Midi(e).toFrequency(),n?(this.env.triggerAttack(n),this.vcf_env.triggerAttack(n),this.isGlide?this.frequency.linearRampToValueAtTime(e,this.rampTime+n):this.frequency.setValueAtTime(e,n),this.velocity.rampTo(t,.03)):(this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.frequency.value=e,this.velocity.rampTo(t,.03))}triggerRelease(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(this.env.triggerRelease(e),this.vcf_env.triggerRelease(e)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())}triggerAttackRelease(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=Math.pow(t/127,2),e=r.Midi(e).toFrequency(),s?(this.env.triggerAttackRelease(n,s),this.vcf_env.triggerAttackRelease(n,s),this.velocity.setValueAtTime(t,s),this.isGlide?this.frequency.linearRampToValueAtTime(e,this.rampTime+s):this.frequency.setValueAtTime(e,s)):(this.env.triggerAttackRelease(n),this.vcf_env.triggerAttackRelease(n),this.isGlide?this.frequency.exponentialRamp(e,this.rampTime):this.frequency.value=e,this.velocity.rampTo(t,.03))}setADSR(e,t,n,s){this.env.attack=e>.001?e:.001,this.env.decay=t>.01?t:.01,this.env.sustain=Math.abs(n)<1?n:1,this.env.release=s>.01?s:.01}setFilterADSR(e,t,n,s){this.vcf_env.attack=e>.001?e:.001,this.vcf_env.decay=t>.01?t:.01,this.vcf_env.sustain=Math.abs(n)<1?n:1,this.vcf_env.release=s>.01?s:.01}setDetune(e){this.sawPitchShift.factor.value=e}setPulsewidth(e){this.pulseWav.width=e}setOutputGain(e){this.output.factor.value=e}initGui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;this.gui=e,this.distortion_toggle=this.gui.Knob({label:"Distortion",callback:e=>{this.dist.distortion=e,this.distgain.factor.value=1-.4*e},x:85,y:20,size:.8,min:0,max:.9,link:"dist"}),this.distortion_toggle.accentColor=[51,145,219],this.dist.wet.value=1,this.crusher_toggle=this.gui.Knob({label:"bitcrusher",callback:e=>{this.crusher.bits.value=Math.floor(e)},x:90,y:50,size:.8,min:2,max:16,link:"crusher"}),this.crusher_toggle.accentColor=[46,152,99],this.crusher.wet.value=1,this.glide_toggle=this.gui.Momentary({label:"Glide",callback:e=>{this.isGlide=e},x:15,y:20,size:.8,link:"glide"}),this.glide_toggle.accentColor=[51,145,219],this.delayControl=function(e){this.delay.feedback.value=(0,o.stepper)(e,0,1,[[0,0],[.02,0],[.8,.6],[1,1]]),this.delay.wet.value=(0,o.stepper)(e,0,1,[[0,0],[.02,0],[.04,1],[1,1]]),this.delaygain.factor.value=(0,o.stepper)(e,0,1,[[0,0],[.02,0],[.04,.3],[.4,.5],[1,1]]),this.lfo.amplitude.value=(0,o.stepper)(e,0,1,[[0,0],[.5,0],[.7,.5],[1,1]])},this.delay_knob=this.gui.Knob({label:"Delay Control",callback:e=>{this.delayControl(e)},x:10,y:50,size:.8,min:.001,max:1,curve:1,showValue:!1,link:"delayknob"}),this.delay_knob.accentColor=[49,48,55],this.delay_knob.set(1e-4),this.wave_fader=this.gui.Slider({label:"wave",x:39,y:10,size:2,min:0,max:1,callback:e=>{this.pulseWav.width.value=(0,o.stepper)(e,0,1,[[0,0],[.4,.6],[1,1]])},orientation:"vertical",showValue:!1,link:"wave",border:12}),this.wave_fader.accentColor=[247,5,5],this.wave_fader.borderColor=[20,20,20],this.wave_fader.set(.5),this.freq_fader=this.gui.Slider({label:"freq",callback:e=>{this.filterDepth.factor.value=e,this.cutoff.value=e},x:49,y:10,size:2,min:50,max:2500,curve:2,orientation:"vertical",showValue:!1,link:"freq",border:12}),this.freq_fader.accentColor=[247,5,5],this.freq_fader.borderColor=[20,20,20],this.freq_fader.set(700),this.release_fader=this.gui.Slider({label:"release",callback:e=>{this.env.decay=(0,o.stepper)(e,.1,5,[[0,0],[.8,.5],[1,5]]),this.env.release=(0,o.stepper)(e,.1,30,[[0,0],[.8,.5],[1,5]]),this.vcf_env.decay=(0,o.stepper)(e,.1,5,[[0,0],[.8,.5],[1,5]]),this.vcf_env.release=(0,o.stepper)(e,.1,30,[[0,0],[.8,.5],[1,5]])},x:59,y:10,size:2,min:.1,max:1.5,orientation:"vertical",showValue:!1,link:"release",border:12}),this.release_fader.accentColor=[247,5,5],this.release_fader.borderColor=[20,20,20],this.release_fader.set(.8),this.resonance_knob=this.gui.Knob({label:"res",callback:e=>{this.filter.Q.value=e},x:49.5,y:86,size:.5,min:.99999,max:30,curve:2,showValue:!1,link:"res"}),this.resonance_knob.accentColor=[49,48,55],this.resonance_knob.set(1),this.detune_knob=this.gui.Knob({label:"detune",callback:e=>{this.sawPitchShift.factor.value=(0,o.stepper)(e,.99999,2,[[0,0],[.25,.02],[.45,.49],[.55,.51],[.75,.98],[1,1]])/2},x:22,y:50,size:.5,min:.99999,max:2,curve:1,showValue:!1,link:"detune"}),this.detune_knob.accentColor=[49,48,55],this.detune_knob.set(1),this.speaker_knob=this.gui.Knob({label:"gain",callback:e=>{this.output.factor.value=e},x:78,y:50,size:.5,min:0,max:.1,curve:2,showValue:!1,link:"gain"}),this.speaker_knob.accentColor=[49,48,55],this.speaker_knob.set(.05),this.kick_trigger=this.gui.Button({label:"kick",callback:()=>{this.kickPlayer.triggerAttack("C4")},size:1,border:20,x:30,y:80,size:1,link:"kick"}),this.kick_trigger.accentColor=[20,20,20],this.snare_trigger=this.gui.Button({label:"snare",callback:()=>{this.snarePlayer.triggerAttack("C4")},size:1,border:20,x:70,y:80,size:1,link:"snare"}),this.snare_trigger.accentColor=[20,20,20],this.gui_elements=[this.distortion_toggle,this.crusher_toggle,this.glide_toggle,this.delay_knob,this.wave_fader,this.freq_fader,this.release_fader,this.resonance_knob,this.detune_knob,this.speaker_knob,this.kick_trigger,this.snare_trigger]}initPolyGui(e,t){this.gui=t,this.super=e,this.distortion_toggle=this.gui.Toggle({label:"Accent",callback:e=>{this.super.set("dist.wet",e)},x:85,y:20,size:.8,link:"dist"}),this.distortion_toggle.accentColor=[51,145,219],this.super.set("dist.wet.value",0),this.crusher_toggle=this.gui.Toggle({label:"bitcrusher",callback:e=>{this.super.set("crusher.wet",e)},x:90,y:50,size:.8,link:"crusher"}),this.crusher_toggle.accentColor=[46,152,99],this.super.set("crusher.wet.value",0),this.glide_toggle=this.gui.Toggle({label:"Glide",callback:e=>{this.super.set("isGlide",e)},x:15,y:20,size:.8,link:"glide"}),this.glide_toggle.accentColor=[51,145,219],this.delayControl=function(e){this.super.set("delay.feedback.value",(0,o.stepper)(e,0,1,[[0,0],[.02,0],[.8,.6],[1,1]])),this.super.set("delay.wet.value",(0,o.stepper)(e,0,1,[[0,0],[.02,0],[.04,1],[1,1]])),this.super.set("delaygain.factor.value",(0,o.stepper)(e,0,1,[[0,0],[.02,0],[.04,.3],[.4,.5],[1,1]])),this.super.set("lfo.amplitude.value",(0,o.stepper)(e,0,1,[[0,0],[.5,0],[.7,.5],[1,1]]))},this.delay_knob=this.gui.Knob({label:"Delay Control",callback:e=>{this.delayControl(e)},x:10,y:50,size:.8,min:.001,max:1,curve:1,showValue:!1,link:"delayknob"}),this.delay_knob.accentColor=[49,48,55],this.delay_knob.set(1e-4),this.wave_fader=this.gui.Slider({label:"wave",x:39,y:10,size:2,min:0,max:1,callback:e=>{this.super.set("pulseWav.width.value",(0,o.stepper)(e,0,1,[[0,0],[.4,.6],[1,1]]))},orientation:"vertical",showValue:!1,link:"wave",border:12}),this.wave_fader.accentColor=[247,5,5],this.wave_fader.borderColor=[20,20,20],this.wave_fader.set(.5),this.freq_fader=this.gui.Slider({label:"freq",callback:e=>{this.super.set("filterDepth.factor.value",e),this.super.set("cutoff.value",e)},mapto:this.cutoff,x:49,y:10,size:2,min:50,max:2500,curve:2,orientation:"vertical",showValue:!1,link:"freq",border:12}),this.freq_fader.accentColor=[247,5,5],this.freq_fader.borderColor=[20,20,20],this.freq_fader.set(700),this.release_fader=this.gui.Slider({label:"release",callback:e=>{this.super.set("env.decay",(0,o.stepper)(e,.01,1,[[0,0],[.8,.5],[1,5]])),this.super.set("env.release",(0,o.stepper)(e,.1,25,[[0,0],[.8,.5],[1,5]])),this.super.set("vcf_env.decay",(0,o.stepper)(e,.01,1,[[0,0],[.8,.5],[1,5]])),this.super.set("vcf_env.release",(0,o.stepper)(e,.1,25,[[0,0],[.8,.5],[1,5]]))},x:59,y:10,size:2,min:.1,max:25,orientation:"vertical",showValue:!1,link:"release",border:12}),this.release_fader.accentColor=[247,5,5],this.release_fader.borderColor=[20,20,20],this.release_fader.set(.8),this.resonance_knob=this.gui.Knob({label:"res",callback:e=>{this.super.set("filter.Q.value",e)},x:49.5,y:86,size:.25,min:.99999,max:30,curve:2,showValue:!1,link:"res"}),this.resonance_knob.accentColor=[49,48,55],this.resonance_knob.set(1),this.detune_knob=this.gui.Knob({label:"detune",callback:e=>{this.super.set("tonePitchShift.factor",(0,o.stepper)(e,.99999,2,[[0,0],[.25,.02],[.45,.49],[.55,.51],[.75,.98],[1,1]])),console.log((0,o.stepper)(e,.99999,2,[[0,0],[.25,.02],[.45,.49],[.55,.51],[.75,.98],[1,1]]))},x:22,y:50,size:.25,min:.99999,max:2,curve:1,showValue:!1,link:"detune"}),this.detune_knob.accentColor=[49,48,55],this.detune_knob.set(1),this.speaker_knob=this.gui.Knob({label:"gain",callback:e=>{this.super.set("output.factor",e)},x:78,y:50,size:.25,min:0,max:.1,curve:2,showValue:!1,link:"gain"}),this.speaker_knob.accentColor=[49,48,55],this.speaker_knob.set(.05),this.kick_trigger=this.gui.Button({label:"kick",callback:()=>{this.kickPlayer.triggerAttack("C4")},size:1,border:20,x:30,y:80,size:1,link:"kick"}),this.kick_trigger.accentColor=[20,20,20],this.snare_trigger=this.gui.Button({label:"snare",callback:()=>{this.snarePlayer.triggerAttack("C4")},size:1,border:20,x:70,y:80,size:1,link:"snare"}),this.snare_trigger.accentColor=[20,20,20]}}t.DatoDuo=DatoDuo},375:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.MultiVCO=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.MultiVCO=class MultiVCO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(this.numInputs=e.length,this.frequency=new r.Signal(1),this.output=0===this.numInputs?new r.Multiply(1):new r.Multiply(1/this.numInputs),this.freqScalars=[],this.gainStages=[],this.vco=[],this.i=0;this.i<this.numInputs;this.i++)this.freqScalars.push(new r.Multiply(t[this.i])),"noise"===e[this.i]?this.vco.push(new r.Noise("white").start()):this.vco.push(new r.Oscillator({type:e[this.i]}).start()),this.gainStages.push(new r.Multiply(1)),this.frequency.connect(this.freqScalars[this.i]),"noise"!==e[this.i]&&this.freqScalars[this.i].connect(this.vco[this.i].frequency),this.vco[this.i].connect(this.gainStages[this.i]),this.gainStages[this.i].connect(this.output)}addVoice=e=>{this.freqScalars.push(new r.Multiply(1)),"noise"===e?this.vco.push(new r.Noise("white").start()):this.vco.push(new r.Oscillator({type:e}).start()),this.gainStages.push(new r.Multiply(1)),this.frequency.connect(this.freqScalars[this.numInputs]),"noise"!==e&&this.freqScalars[this.numInputs].connect(this.vco[this.numInputs].frequency),this.vco[this.numInputs].connect(this.gainStages[this.numInputs]),this.gainStages[this.numInputs].connect(this.output),this.numInputs++,this.output.factor.value=1/this.numInputs};removeVoice=(()=>{var e=this;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e.vco[t].stop(),e.frequency.disconnect(e.freqScalars[t]),"noise"!==e.vco[t].type&&e.freqScalars[t].disconnect(e.vco[t].frequency),e.vco[t].disconnect(e.gainStages[t]),e.gainStages[t].disconnect(e.output),t<e.numInputs-1)for(let n=t;n<e.numInputs;n++)e.freqScalars[n]=e.freqScalars[n+1],e.gainStages[n]=e.gainStages[n+1],e.vco[n]=e.vco[n+1];e.freqScalars.pop(),e.gainStages.pop(),e.vco.pop(),e.numInputs--,e.output.factor.value=0===e.numInputs?1:1/e.numInputs}})();setPitchshift=(e,t)=>{e>=this.numInputs||e<0?console.log("Index out of range"):this.freqScalars[e].factor.value=t};setGain=(e,t)=>{e>=this.numInputs||e<0?console.log("Index out of range"):this.gainStages[e].factor.value=t};connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}disconnect(e){e.input?this.output.disconnect(e.input):this.output.disconnect(e)}}},394:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.DrumSynth=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=(n(3447),s(n(7316))),a=s(n(2589)),c=n(9672),l=s(n(9315));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}n(5324);class DrumSynth extends c.DrumTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.params={toneFrequency:50,pitchEnv:100,amRatio:1,toneGain:.5,noiseShape:"bandpass",noiseLevel:.5,toneLevel:.5,toneDecay:.2,noiseDecay:.3,cutoff:2e3,resonance:1,volume:.5,...e},this.layout=a.default,this.name="DrumSynth",this.presets=o.default,this.frequency=new r.Signal(this.params.toneFrequency),this.tuning=new r.Multiply(1),this.harmonicity=new r.Multiply(1),this.frequency.connect(this.harmonicity),this.vco=new r.Oscillator(this.params.toneFrequency,"sine").start(),this.frequency.connect(this.tuning),this.tuning.connect(this.vco.frequency),this.modVco=new r.Oscillator(this.params.toneFrequency*this.params.amRatio,"sine").start(),this.harmonicity.connect(this.modVco.frequency),this.amDepth=new r.Gain(0),this.fmDepth=new r.Gain(0),this.modVco.connect(this.amDepth),this.modVco.connect(this.fmDepth),this.modIndex=new r.Signal,this.indexMult=new r.Multiply,this.modIndex.connect(this.indexMult.factor),this.harmonicity.connect(this.indexMult),this.vcoCarrier=new r.Signal(1),this.vcoCarrier.connect(this.vco.volume),this.amDepth.connect(this.vco.volume),this.indexMult.connect(this.fmDepth.gain),this.fmDepth.connect(this.vco.frequency),this.drive=new r.Gain(this.params.toneGain),this.waveshaper=new r.WaveShaper((e=>Math.tanh(4*e))),this.vco.connect(this.drive),this.drive.connect(this.waveshaper),this.noise=new r.Noise("white").start(),this.noiseFilter=new r.Filter(this.params.cutoff,this.params.noiseShape),this.noiseFilter.type="bandpass",this.noiseGain=new r.Gain(this.params.noiseLevel),this.noise.connect(this.noiseFilter),this.noiseFilter.connect(this.noiseGain),this.noiseVcfEnvDepth=new r.Multiply,this.noiseVcfEnvDepth.connect(this.noiseFilter.frequency),this.env=new r.Envelope({attack:0,decay:this.params.toneDecay,sustain:0,release:this.params.toneDecay}),this.noiseEnv=new r.Envelope({attack:0,decay:this.params.noiseDecay,sustain:0,release:this.params.noiseDecay}),this.pitchEnvelope=new r.Envelope({attack:0,decay:this.params.toneDecay,sustain:0,release:this.params.toneDecay}),this.pitchEnvDepth=new r.Multiply(this.params.pitchEnv),this.pitchEnvelope.connect(this.pitchEnvDepth),this.pitchEnvDepth.connect(this.vco.frequency),this.pitchEnvDepth.connect(this.harmonicity),this.toneVca=new r.Multiply,this.toneGain=new r.Gain(1),this.env.connect(this.toneVca.factor),this.waveshaper.connect(this.toneVca),this.noiseVca=new r.Multiply,this.noiseEnv.connect(this.noiseVca.factor),this.noiseGain.connect(this.noiseVca),this.noiseCutoff=new r.Signal(2e3),this.noiseCutoff.connect(this.noiseFilter.frequency),this.noiseEnv.connect(this.noiseVcfEnvDepth),this.finalFilter=new r.Filter,this.cutoffSig=new r.Signal(this.params.cutoff),this.cutoffSig.connect(this.finalFilter.frequency),this.finalFilter.type="lowpass",this.finalFilter.Q.value=this.params.resonance,this.output=new r.Multiply(this.params.volume),this.toneVca.connect(this.toneGain),this.toneGain.connect(this.finalFilter),this.noiseVca.connect(this.finalFilter),this.finalFilter.connect(this.output),this.vcfEnvDepth=new r.Multiply,this.vcfEnvDepth.connect(this.finalFilter.frequency),this.env.connect(this.vcfEnvDepth),this.paramDefinitions=(0,l.default)(this),this.param=this.generateParameters(this.paramDefinitions),this.createAccessors(this,this.param),this.autocompleteList=this.paramDefinitions.map((e=>e.name)),setTimeout((()=>{this.loadPreset("default")}),500)}setADSR(e,t,n){let s=this.env;"tone"==e?s=this.env:"noise"==e?s=this.noiseEnv:"pitch"==e?s=this.pitchEnvelope:null==t&&(s=this.env,t=e),Array.isArray(t)&&null==n?t.length<=4&&(s.attack=t[0],s.decay=t[1],s.sustain=t[2],s.release=t[3]):null!=n&&(0==n&&(s.attack=t),1==n&&(s.decay=t),2==n&&(s.sustain=t),3==n&&(s.release=t))}trigger(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.now();this.env.triggerAttackRelease(.01,e),this.noiseEnv.triggerAttackRelease(.01,e),this.pitchEnvelope.triggerAttackRelease(.01,e)}triggerAttackRelease(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:48,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t/=127,n&&(this.frequency.setValueAtTime(r.Midi(e).toFrequency(),n),this.env.triggerAttackRelease(.01,n),this.noiseEnv.triggerAttackRelease(.01,n),this.pitchEnvelope.triggerAttackRelease(.01,n))}}t.DrumSynth=DrumSynth},506:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Polyphony=void 0;var r=s(n(5897)),o=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),a=n(1174),c=(n(9710),n(5324));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class Polyphony extends a.MonophonicTemplate{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;super(),this.name=e.name,this.numVoices=t,this.slop=.05,this.voice=[];for(let t=0;t<this.numVoices;t++)this.voice.push(new e);this.output=new o.Multiply(1/(this.numVoices/2)),this.hpf=new o.Filter({type:"highpass",rolloff:-12,Q:0,cutoff:50});for(let e=0;e<this.numVoices;e++)this.voice[e].output.connect(this.hpf);this.hpf.connect(this.output),this.prevNote=0,this.v=0,this.voiceCounter=0,this.activeNotes=[],this.noteOrder=[],this.noteOrderIndex=0,this.voiceOrder=[];for(let e=0;e<this.numVoices;e++)this.activeNotes.push(-1),this.noteOrder.push(e);this.initParamsFromVoices()}initParamsFromVoices(){var e=this;const t=this.voice[0].param;Object.keys(t).forEach((n=>{const s=t[n].isSignal,r=new Proxy((()=>{}),{get:(t,s)=>"sequence"===s?function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"16n";e.voice.forEach((e=>e.startSequence(n,t,s)))}:"stop"===s?()=>{this.voice.forEach((e=>e.stopSequence(n)))}:"set"===s?function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.voice.forEach((e=>e.param[n].set(t,s,r)))}:"value"===s?this.voice[0].param[n].get():void 0,set:(e,t,s)=>(this.voice.forEach((e=>e.stopSequence(n))),this.voice.forEach((e=>e.param[n].set(s,null,!1))),!0)});Object.defineProperty(this,n,{get:()=>r,set:function(t){e.voice.forEach((e=>{e.stopSequence(n),Array.isArray(t)?e.startSequence(n,t):e.param[n].set(t,null,!1)}))},configurable:!0,enumerable:!0}),this[n+"_param"]={name:n,isSignal:s,get:()=>this.voice[0].param[n].get(),set:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.voice.forEach((e=>e.param[n].set(t,s,r)))},sequence:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n";e.voice.forEach((e=>{e.startSequence(n,t,s)}))},stop:()=>this.voice.forEach((e=>e.stopSequence(n)))},Object.defineProperty(this,n+"_value",{get:()=>this.voice[0].param[n].get(),set:e=>this.voice.forEach((t=>t.param[n].set(e,null,!1))),configurable:!0,enumerable:!0})}))}triggerAttack=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.v=this.getNewVoice(e),n?this.voice[this.v].triggerAttack(e,t,n):this.voice[this.v].triggerAttack(e,t)};triggerRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.v=this.getActiveNote(e),this.v>=0&&null!=this.v?(t?this.voice[this.v].triggerRelease(t):this.voice[this.v].triggerRelease(),this.freeActiveNote(e)):console.log("tr null",e,t,this.activeNotes[e],this.v,this.voice[this.v])};triggerAttackRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.v=this.getNewVoice(e),s?this.voice[this.v].triggerAttackRelease(e,t,n,s):this.voice[this.v].triggerAttackRelease(e,t,n)};getNewVoice(e){this.voiceCounter=(this.voiceCounter+1)%this.numVoices;const t=this.getActiveNote(e);t>=0&&this.freeActiveNote(t);let n=Infinity,s=this.getLeastRecentNotes(),r=s[0];for(let t=0;t<this.numVoices/2;t++){const o=this.noteOrder[t],a=this.voice[o].env.value;if(a<n&&s.includes(o)&&(n=a,r=o),a<=.01)return this.setActiveNote(o,e),o}return this.voice[r].env.cancel(),this.setActiveNote(r,e),r}getActiveNote(e){return this.activeNotes.includes(e)?this.activeNotes.indexOf(e):-1}setActiveNote(e,t){this.activeNotes.includes(t)||(this.activeNotes[e]=t);const n=this.noteOrder.indexOf(e);-1!==n&&this.noteOrder.splice(n,1),this.noteOrder.push(e)}getLeastRecentNotes(){return this.noteOrder.slice(0,this.numVoices/2)}freeActiveNote(e){void 0!==this.voice[e]&&e>=0&&(this.voice[e].triggerRelease(),this.activeNotes[e]=-1)}setADSR(e,t,n,s){for(let r=0;r<this.numVoices;r++)this.voice[r].env&&(this.voice[r].env.attack=e>.001?e:.001,this.voice[r].env.decay=t>.01?t:.01,this.voice[r].env.sustain=Math.abs(n)<1?n:1,this.voice[r].env.release=s>.01?s:.01)}setFilterADSR(e,t,n,s){for(let r=0;r<this.numVoices;r++)this.voice[r].vcf_env&&(this.voice[r].vcf_env.attack=e>.001?e:.001,this.voice[r].vcf_env.decay=t>.01?t:.01,this.voice[r].vcf_env.sustain=Math.abs(n)<1?n:1,this.voice[r].vcf_env.release=s>.01?s:.01)}updateAllVoices=(e,t)=>{for(let n=0;n<this.numVoices;n++)this.voice[n].param[e].set(t,null,!1)};initGui(){this.guiContainer=document.getElementById("Canvas"),this.gui=new r.default(c.sketch,this.guiContainer);const e=this.voice[0].layout,t=this.voice[0].param,n={};Object.values(t).forEach((e=>{n[e.type]||(n[e.type]=[]),n[e.type].push(e)})),Object.keys(n).forEach((t=>{const s=e[t];if(!s||"hidden"===t)return;let r=0;n[t].forEach(((e,t)=>{const n=e.name,o=s.groupA.includes(n),a=o?s.controlTypeA:s.controlTypeB,c=o?s.sizeA:s.sizeB,l=e.get?e.get():e._value;(Array.isArray(l)?l:[l]).forEach(((o,l)=>{let h=s.offsets.x*((t+r)%Math.floor(s.boundingBox.width/s.offsets.x)),u=s.offsets.y*Math.floor((t+r)/Math.floor(s.boundingBox.width/s.offsets.x));const d=s.boundingBox.x+h,f=s.boundingBox.y+u;this.createGuiElement(e,{x:d,y:f,size:c,controlType:a,color:s.color,i:l,value:o,callback:e=>{if(Array.isArray(this[n])){const t=[...this[n]];t[l]=e,this[n+"_param"].set(t,null,"gui")}else this[n+"_param"].set(e,null,"gui")}}),r++}))}))}))}createGuiElement(e,t){let{x:n,y:s,size:r,controlType:o,color:a,i:c=null,value:l,callback:h}=t;if("knob"===o)e.guiElements.push(this.gui.Knob({label:0!==c?e.labels[c]:e.name,min:e.min,max:e.max,value:l,size:r,curve:e.curve,x:n,y:s,accentColor:a,callback:h}));else if("fader"===o)e.guiElements.push(this.gui.Fader({label:0!==c?e.labels[c]:e.name,min:e.min,max:e.max,value:l,curve:e.curve,size:r,x:n,y:s,accentColor:a,callback:h}));else if("radioButton"===o)return Array.isArray(e.radioOptions)&&0!==e.radioOptions.length?this.gui.RadioButton({label:0!==c?e.labels[c]:e.name,radioOptions:e.radioOptions,value:l,x:n,y:s+10,accentColor:a,callback:h}):(console.warn(`Parameter "${e.name}" has no options defined for radioBox.`),null)}hideGui(){for(let e=0;e<this.voice[0].gui_elements.length;e++)this.voice[0].gui_elements[e].hide=!0}showGui(){for(let e=0;e<this.voice[0].gui_elements.length;e++)this.voice[0].gui_elements[e].hide=!1}applyFunctionToAllVoices(e){let t=e.toString();return t=t.replace(/\bthis\./g,""),t}stringToFunction(e){const t=e.split("=>"),n=t[0].replace(/\(|\)/g,"").trim();let s=t[1].trim();return s=s.replace(/\bthis\./g,"this.voice[i]."),s=s.replace(/(?<!this\.|this\.super\.)\b(\w+)\(/g,"this.$1("),new Function("i",n,s)}generateParamString(e){const t=e.toString().match(/this\.([\w\d_\.]+)\s*=\s*([\w\d_\.]+)\s*;?/);return t?t[1]:null}retrieveValueExpression(e){const t=e.toString().match(/this\.([\w\d_\.]+)\s*=\s*(.+);?/);return t?t[2].trim():null}loadPreset(e){this.voice[0].loadPreset(e)}listPresets(){this.voice[0].listPresets()}savePreset(e){this.voice[0].savePreset(e)}downloadPresets(){this.voice[0].downloadPresets()}panic=function(){for(let e=0;e<this.numVoices;e++)this.voice[e].triggerRelease(),this.activeNotes[e]=-1};pan=function(e){for(let t=0;t<this.numVoices;t++)this.voice[t].panner.pan.value=Math.sin(t/8*Math.PI*2)*e};get(){const e={};Object.keys(this.voice[0].param).forEach((t=>{e[t]=this.voice[0].param[t].get()})),console.log(e)}print(){this.get()}}t.Polyphony=Polyphony},540:e=>{"use strict";e.exports=function insertStyleElement(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},582:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__(4994);Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toggle=exports.Text=exports.RadioButton=exports.Pad=exports.Momentary=exports.Line=exports.Knob=exports.GuiFonts=exports.Fader=exports.Dropdown=exports.Button=void 0,exports.debug=debug,exports.divResized=divResized,exports.drawBackground=drawBackground,exports.drawElements=drawElements,exports.exportTheme=exportTheme,exports.initialize=initialize,exports.listThemes=listThemes,exports.setFont=exports.setColor=void 0,exports.setThemeParameters=setThemeParameters,exports.setp5Theme=setp5Theme;var _p=_interopRequireDefault(__webpack_require__(5897)),_p5Themes=_interopRequireDefault(__webpack_require__(1656));let activeTheme=_p5Themes.default.themes.default;function debug(){console.log("esy"),console.log(activeTheme)}function listThemes(){console.log(Object.keys(_p5Themes.default.themes))}function setp5Theme(e){_p5Themes.default.themes[e]?activeTheme=_p5Themes.default.themes[e]:console.error(`Theme '${e}' not found.`)}function setThemeParameters(e){activeTheme?activeTheme={...activeTheme,...e}:console.error(`Active theme '${activeTheme}' not found.`)}function exportTheme(){return console.log("exporting "+activeTheme),console.log(JSON.stringify(activeTheme,null,2)),JSON.stringify(activeTheme,null,2)}function initialize(e,t){return e.div=t,e.createCanvas(t.offsetWidth,.4*t.offsetWidth),e.width=t.offsetWidth,e.height=.4*t.offsetWidth,e.elements={},[e.width,e.height]}function resizeP5(e,t,n){var s=e.match(/(\w+)\.(\w+)\((.*?)\)/);if(s){var r=s[1],o=s[2];let a=s[3].split(",").map((e=>e.trim()));for(let e=0;e<("arc"===o?4:a.length);e++)a[e]*="circle"===o&&e>1?(t+n)/2:e%2==0?t:n;return e.replace(s[0],r+"."+o+"("+a.join(", ")+")")}return e}function divResized(e,t,n){let s=e.width,r=e.height;e.resizeCanvas(0,0);let o=document.getElementById("canvases"),a=document.getElementById("controls"),c=document.getElementById("flex");"+h"===t?(e.height=o.offsetHeight-a.offsetHeight,e.width=e.div.offsetWidth):"-h"===t?(e.height=o.offsetHeight/n-a.offsetHeight,e.width=s):"+w"===t?(e.width=c.offsetWidth,e.height=e.div.offsetHeight):"-w"===t?(e.width=c.offsetWidth/2,e.height=r):(e.width=e.div.offsetWidth,e.height=e.div.offsetHeight);let l=e.width/s,h=e.height/r;e.resizeCanvas(e.width,e.height);for(let[t,n]of Object.entries(e.elements))"string"==typeof n?e.elements[t]=resizeP5(n,l,h):n.resize(l,h);e.drawElements()}function drawGrid(e){let t=Math.ceil((e.width-20)/3)-5,n=Math.ceil((e.height-20)/3)-5;e.textSize(12);let s=activeTheme.backgroundColor.reduce(((e,t)=>e+t));e.fill(s<382?255:0),e.noStroke();for(let s=0;s<4;s++){let r=10+s*t,o=10+s*n;e.text(r,r,10),e.text(o,10,o)}}_p.default.prototype.initialize=function(e){return initialize(this,e)},_p.default.prototype.divResized=function(){divResized(this,arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)};let updateCanvas=1;function drawBackground(e){updateCanvas>0&&(updateCanvas=1,e.background(activeTheme.backgroundColor))}function drawElements(p){if(updateCanvas>0){updateCanvas=1;for(let element of Object.values(p.elements))"string"==typeof element?eval(element):element.draw()}}_p.default.prototype.drawBackground=function(){drawBackground(this)},_p.default.prototype.drawElements=function(){drawElements(this)};const scaleOutput=function(e,t,n,s,r,o){void 0===o&&(o=1);let a=1/(n-t)*(e-t);return a=Math.pow(a,o),a*(r-s)+s},unScaleOutput=function(e,t,n,s,r,o){o=void 0===o?1:1/o;let a=1/(r-s)*(e-s);return a=Math.pow(a,o),a*(n-t)+t},getElementByLabel=(e,t)=>{const n=Object.values(e.elements);for(const e of n)if(console.log(e.id),e.id===t)return e;return null};_p.default.prototype.getElementByLabel=function(e){getElementByLabel(this,e)};const setColor=function(e,t){"border"===e?activeTheme.borderColor=t:"accent"===e?activeTheme.accentColor=t:"background"===e?activeTheme.backgroundColor=t:"text"===e?activeTheme.textColor=t:"string"==typeof e&&Array.isArray(t)?(t.length=3)?(activeTheme[e]=t,console.error(`new Color added: ${e}`)):console.error("second argument must be an array of three values in RGB format"):console.error(`incorrect color values: ${e}, ${t} `)};exports.setColor=setColor;const getColor=function(e){return"border"===e?activeTheme.borderColor:"accent"===e?activeTheme.accentColor:"background"===e?activeTheme.backgroundColor:"text"===e?activeTheme.textColor:Array.isArray(e)?e:(console.error(`Invalid color property: ${e}`),[0,0,0])},GuiFonts=exports.GuiFonts={label:"Helvetica",value:"Courier",text:"Times New Roman",title:"Verdana"},setFont=function(e,t){"label"===e?activeTheme.labelFont=t:"value"===e?activeTheme.valueFont=t:"text"===e?activeTheme.textFont=t:"title"===e?activeTheme.titleFont=t:"string"==typeof e&&"string"==typeof t?(activeTheme[e]=t,console.error(`new Font added: ${e}`)):console.error(`incorrect font values: ${e}, ${t} `)};exports.setFont=setFont;const getFont=function(e){return"label"===e?activeTheme.labelFont:"value"===e?activeTheme.valueFont:"text"===e?activeTheme.textFont:"title"===e?activeTheme.titleFont:"string"==typeof e?e:(console.error(`Invalid font property: ${e}`),"Geneva")};let elementXPosition=0,elementYPosition=25,prevElementSize=0,prevYElementSize=0;class Element{constructor(p,options){this.p=p,this.ch=window.chClient,this.theme=activeTheme,this.label=options.label||"myElement",this.id=this.label,this.hide=!1;let i=1;for(;this.id in p.elements;)this.id+=i,i++;this.style=options.style||1,this.size=options.size||1,this.textSize=options.textSize||1,this.border=options.border||"theme",this.borderColor=options.borderColor||"border",this.accentColor=options.accentColor||"accent",this.borderRadius=options.borderRadius||activeTheme.borderRadius||0,this.textColor=options.textColor||"text",this.showLabel=void 0===options.showLabel||options.showLabel,this.showValue=void 0===options.showValue||options.showValue,this.labelFont=options.labelFont||"label",this.valueFont=options.valueFont||"value",this.textFont=options.textFont||"text",this.labelX=options.labelX||0,this.labelY=options.labelY||0,this.valueX=options.valueX||0,this.valueY=options.valueY||0,this.textX=options.textX||0,this.textY=options.textY||0;let currentGap=(prevElementSize+this.size)/2;elementXPosition+=8*currentGap+5,elementXPosition>100-8*this.size&&(elementXPosition=this.size/2*8+5,elementYPosition+=20*prevYElementSize+10,prevYElementSize=this.size),this.x=options.x||elementXPosition,this.y=options.y||elementYPosition,prevElementSize=this.size,prevYElementSize=this.size>prevYElementSize?this.size:prevYElementSize,this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width,this.x_box=this.cur_size,this.y_box=this.cur_size,this.active=0,this.min=options.min||0,this.max=options.max||1,this.curve=options.curve||1,"string"==typeof options.mapto?this.mapto=eval(options.mapto):this.mapto=options.mapto||null,this.callback=options.callback||null,this.mapto||this.callback?this.maptoDefined="true":this.maptoDefined="false",this.rawValue=unScaleOutput(options.value,0,1,this.min,this.max,this.curve)||.5,this.value=null!=options.value?options.value:scaleOutput(.5,0,1,this.min,this.max,this.curve),p.elements[this.id]=this,this.linkName="string"==typeof options.link?options.link:null,this.linkFunc="function"==typeof options.link?options.link:null,this.linkName&&this.ch.on(this.linkName,(e=>{this.forceSet(e.values)})),this.mapValue(this.value,this.mapto),this.runCallBack()}getParam(e,t){return"theme"===t?activeTheme[e]:t}isPressed(){!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2&&(this.active=1)}isReleased(){!0!==this.hide&&1===this.active&&(this.active=0)}resize(e,t){this.x*=e,this.y*=t}drawLabel(e,t){this.p.textSize(10*this.textSize),this.p.stroke(this.setColor(this.textColor)),this.p.strokeWeight(1e-5*this.textSize*20),this.p.textAlign(this.p.CENTER,this.p.CENTER),this.p.fill(this.setColor(this.textColor)),this.p.textFont(getFont(this.labelFont)),this.p.text(this.label,e+this.labelX/100*this.p.width,t+this.labelY/100*this.p.height)}drawValue(e,t){let n=this.value;this.p.stroke(this.setColor(this.textColor)),this.p.textSize(10*this.textSize),this.p.strokeWeight(1e-5*this.textSize*20),this.p.textAlign(this.p.CENTER,this.p.CENTER),this.p.fill(this.setColor(this.textColor)),this.p.textFont(getFont(this.valueFont)),n=Math.abs(n)<1?n.toFixed(4):Math.abs(n)<5?n.toFixed(3):Math.abs(n)<100?n.toFixed(2):n.toFixed(1),this.p.text(n,e+this.valueX/100*this.p.width,t+this.valueY/100*this.p.height)}drawText(e,t,n){this.p.textSize(10*this.textSize),this.p.stroke(this.setColor(this.textColor)),this.p.strokeWeight(1e-5*this.textSize*20),this.p.textAlign(this.p.CENTER,this.p.CENTER),this.p.fill(getColor(this.textColor)),this.p.textFont(getFont(this.textFont)),this.p.text(e,t+this.textX/100*this.p.width,n+this.textY/100*this.p.height)}setPosition(e,t){this.x=e,this.y=t}setColor(e){return"string"==typeof e?getColor(e):Array.isArray(e)&&3===e.length?e:(console.log(this.label,typeof e,"invalid color"),[0,0,0])}mapValue(e,t){if(t)try{t.value.rampto(e,.1)}catch{try{t.value=e}catch{try{t=e}catch(e){console.log("Error setting Mapto to value: ",e)}}}else"false"===this.maptoDefined&&console.log(this.label,"no destination defined")}runCallBack(){if(this.callback){let e=this.value;try{this.callback(e)}catch{try{this.callback()}catch(e){console.log("Error with Callback Function: ",e)}}}else"false"===this.maptoDefined&&console.log(this.label,"no destination defined");this.sendName&&this.ch.control(this.sendName,this.value)}set(e){"string"==typeof e?this.value=e:(this.value=e,this.rawValue=unScaleOutput(e,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto)),this.runCallBack(),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}forceSet(e){"string"==typeof e?this.value=e:(this.value=e,this.rawValue=unScaleOutput(e,0,1,this.min,this.max,this.curve)||.5,this.mapValue(this.value,this.mapto)),this.runCallBack()}}class Knob extends Element{constructor(e,t){super(e,t),this.incr=t.incr||.01,this.degrees=t.degrees||320,this.startAngle=this.p.PI*(.5+(360-this.degrees)/360),this.endAngle=this.p.PI*(.5-(360-this.degrees)/360)+2*this.p.PI,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(e,t){super.resize(e,t),Math.max(Math.abs(1-e))>Math.max(Math.abs(1-t))?this.size*=e:this.size*=t}draw(){if(!0===this.hide)return;this.startAngle=this.p.PI*(.5+(360-this.degrees)/360),this.endAngle=this.p.PI*(.5-(360-this.degrees)/360)+2*this.p.PI;let e=this.p.map(this.rawValue,0,1,0,this.endAngle-this.startAngle);this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width/2,this.x_box=this.cur_size,this.y_box=this.cur_size;let t=this.getParam("border",this.border);this.p.textSize(10*this.textSize),this.p.textWidth(this.label);let n=this.p.textAscent()+this.p.textDescent();this.showLabel&&this.drawLabel(this.cur_x,this.cur_y+this.cur_size/2+.5*n),this.showValue&&this.drawValue(this.cur_x,this.cur_y+this.cur_size/2+n*(this.showLabel?1.5:.5)),this.p.noFill(),this.p.strokeWeight(t),this.p.stroke(this.setColor(this.borderColor)),this.p.arc(this.cur_x,this.cur_y,this.cur_size,this.cur_size,this.p.constrain(this.startAngle+e+t/30/this.size/2,this.startAngle,this.endAngle),this.endAngle),this.p.stroke(this.setColor(this.accentColor)),this.p.arc(this.cur_x,this.cur_y,this.cur_size,this.cur_size,this.startAngle,this.p.constrain(this.startAngle+e-t/30/this.size/2,this.startAngle,this.endAngle));let s=this.cur_size/2,r=this.cur_x+this.p.cos(this.startAngle+e)*s,o=this.cur_y+this.p.sin(this.startAngle+e)*s;this.p.stroke(this.setColor(this.accentColor)),this.p.line(this.cur_x,this.cur_y,r,o)}isDragged(){!0!==this.hide&&this.active&&(0!=this.p.movedY&&(this.p.keyIsDown(this.p.ALT)?this.rawValue-=this.p.movedY*this.incr/10:this.rawValue-=this.p.movedY*this.incr),this.rawValue>1&&(this.rawValue=1),this.rawValue<0&&(this.rawValue=0),this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}}exports.Knob=Knob,_p.default.prototype.Knob=function(){return new Knob(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.Dial=function(){return new Knob(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Fader extends Element{constructor(e,t){super(e,t),this.incr=t.incr||.01,this.orientation="horizontal"===t.orientation?"horizontal":"vertical",this.isHorizontal="horizontal"===this.orientation,this.value=this.value||.5,this.dragging=!1,this.size=t.size||1,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(e,t){super.resize(e,t),this.size*=this.isHorizontal?e:t}draw(){if(!0===this.hide)return;this.isHorizontal="horizontal"===this.orientation,this.cur_size=this.size/6*this.p.width/2;let e=this.getParam("border",this.border),t=this.x/100*this.p.width,n=this.y/100*this.p.height;this.isHorizontal?(this.x_box=this.cur_size,this.y_box=3*e*this.size,this.cur_x=this.x/100*this.p.width+this.cur_size/2,this.cur_y=this.y/100*this.p.height+e):(this.y_box=this.cur_size,this.x_box=3*e*this.size,this.cur_x=this.x/100*this.p.width+e,this.cur_y=this.y/100*this.p.height+this.cur_size/2),this.size,this.thickness=e,this.thickness,this.p.textSize(10*this.textSize),this.p.textWidth(this.label);let s=this.p.textAscent()+this.p.textDescent(),r=this.isHorizontal?this.cur_y+2*e+.5*s:this.cur_y+this.cur_size/2+e+.5*s;this.showLabel&&this.drawLabel(this.cur_x,r),this.showValue&&this.drawValue(this.cur_x,r+(this.showLabel?1:0)*s),this.p.noFill(),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(1.5*e),this.isHorizontal?this.p.rect(t,n,this.cur_size,2*e):this.p.rect(t,n,2*e,this.cur_size),this.p.fill(getColor("background")),this.p.stroke(this.setColor("background")),this.pos=this.p.map(this.rawValue,0,1,this.isHorizontal?t:n+this.cur_size-this.thickness,this.isHorizontal?t+this.cur_size-this.thickness:n);let o=.25*e;this.isHorizontal?this.p.rect(this.pos-o,n,this.thickness+2*o,2*this.thickness):this.p.rect(t,this.pos-o,2*this.thickness,this.thickness+2*o),this.p.fill(this.setColor(this.accentColor)),this.p.stroke(this.setColor(this.accentColor)),this.pos=this.p.map(this.rawValue,0,1,this.isHorizontal?t:n+this.cur_size-this.thickness,this.isHorizontal?t+this.cur_size-this.thickness:n),this.isHorizontal?this.p.rect(this.pos,n,this.thickness,2*this.thickness):this.p.rect(t,this.pos,2*this.thickness,this.thickness)}isDragged(){!0!==this.hide&&this.active&&(this.isHorizontal?0!==this.p.movedX&&(this.p.keyIsDown(this.p.ALT)?this.rawValue+=this.p.movedX*this.incr/10:this.rawValue+=this.p.movedX*this.incr/this.size):0!==this.p.movedY&&(this.p.keyIsDown(this.p.ALT)?this.rawValue-=this.p.movedY*this.incr/10:this.rawValue-=this.p.movedY*this.incr/this.size),this.rawValue>1&&(this.rawValue=1),this.rawValue<0&&(this.rawValue=0),this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}}exports.Fader=Fader,_p.default.prototype.Fader=function(){return new Fader(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.Slider=function(){return new Fader(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Pad extends Element{constructor(p,options){super(p,options),this.incr=options.incr||.01,this.valueX=this.valueX||.5,this.valueY=this.valueY||.5,this.rawValueX=this.valueX,this.rawValueY=this.valueY,this.dragging=!1,this.sizeX=options.sizeX||options.size||5,this.sizeY=options.sizeY||options.size||5,"string"==typeof options.maptoX?this.maptoX=eval(options.maptoX):this.maptoX=options.maptoX||null,"string"==typeof options.maptoY?this.maptoY=eval(options.maptoY):this.maptoY=options.maptoY||null,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(e,t){super.resize(e,t)}draw(){if(!0===this.hide)return;this.cur_size=this.size/6*this.p.width/2,this.cur_sizeX=this.sizeX/6*this.p.width/2,this.cur_sizeY=this.sizeY/6*this.p.width/2;let e=this.getParam("border",this.border),t=this.x/100*this.p.width-this.cur_sizeX/2,n=this.y/100*this.p.height-this.cur_sizeY/2;this.x_box=2*this.cur_sizeX,this.y_box=2*this.cur_sizeY,this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.thickness=e,this.thickness,this.p.fill(this.setColor(this.borderColor)),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(1.5*e),this.p.rect(t,n,this.cur_sizeX,this.cur_sizeY),this.p.fill(this.setColor(this.accentColor)),this.p.stroke(this.setColor(this.accentColor));let s=t+this.rawValueX*(this.cur_sizeX-0*e),r=n+this.rawValueY*(this.cur_sizeY-0*e);this.p.circle(s,r,(this.cur_sizeX+this.cur_sizeY)/30);let o=this.p.textAscent()+this.p.textDescent();this.showLabel&&this.drawLabel(this.cur_x,this.cur_y-this.cur_sizeY/2-o)}isDragged(){!0!==this.hide&&this.active&&(0!==this.p.movedX&&(this.p.keyIsDown(this.p.ALT)?this.rawValueX+=this.p.movedX*this.incr/10:this.rawValueX+=this.p.movedX*this.incr/this.sizeX),0!==this.p.movedY&&(this.p.keyIsDown(this.p.ALT)?this.rawValueY+=this.p.movedY*this.incr/10:this.rawValueY+=this.p.movedY*this.incr/this.sizeY),this.rawValueX>1&&(this.rawValueX=1),this.rawValueX<0&&(this.rawValueX=0),this.valueX=scaleOutput(this.rawValueX,0,1,this.min,this.max,this.curve),this.mapValue(this.valueX,this.maptoX),this.rawValueY>1&&(this.rawValueY=1),this.rawValueY<0&&(this.rawValueY=0),this.valueY=scaleOutput(this.rawValueY,0,1,this.min,this.max,this.curve),this.mapValue(this.valueY,this.maptoY),this.runCallBack())}}exports.Pad=Pad,_p.default.prototype.Pad=function(){return new Pad(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.JoyStick=function(){return new Pad(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Button extends Element{constructor(e,t){super(e,t),this.value=t.value||0,this.rawValue=this.value,this.cornerRadius=t.cornerRadius||1,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}resize(e,t){super.resize(e,t),this.size*=!1!==this.horizontal?e:t}draw(){if(!0===this.hide)return;this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width/2,this.x_box=this.cur_size,this.y_box=this.cur_size;let e=this.getParam("border",this.border);this.rawValue?(this.p.fill(this.setColor(this.accentColor)),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(e/2),this.p.rect(this.cur_x-this.cur_size/2,this.cur_y-this.cur_size/2,this.cur_size,this.cur_size,this.cur_size/2*this.cornerRadius)):(this.p.noFill(),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(e/2),this.p.rect(this.cur_x-this.cur_size/2,this.cur_y-this.cur_size/2,this.cur_size,this.cur_size,this.cur_size/2*this.cornerRadius)),this.showLabel&&this.drawLabel(this.cur_x,this.cur_y)}isPressed(){if(!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2){this.active=1;let e=scaleOutput(1,0,1,this.min,this.max,this.curve);console.log("Button isPressed - calling set() with value:",e),this.set(e),"false"===this.maptoDefined&&postButtonError("Buttons")}}isReleased(){if(!0!==this.hide&&1===this.active){this.active=0;let e=scaleOutput(0,0,1,this.min,this.max,this.curve);console.log("Button isReleased - calling set() with value:",e),this.set(e)}}forceSet(e){e?(this.active=1,this.rawValue=1,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),"false"===this.maptoDefined&&postButtonError("Buttons")):(this.active=0,this.rawValue=0,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve))}}function postButtonError(e){"Buttons"===e&&console.log(e+" generally work by defining a callback function. For buttons, the value is 1 on every press."),"Toggle buttons"===e&&console.log(e+" generally work by defining a callback function. The value for toggle buttons alternates between 1 and 0."),"RadioButtons"===e&&console.log(e+" generally work by defining a callback function. The value for radio buttons is the text string of the selected button."),"Buttons"===e&&console.log("An example of defining a callback for a button is: \ncallback: function(val){ env.triggerAttackRelease(0.1) }"),"Toggle buttons"===e&&console.log("An example of defining a callback for a toggle is: \ncallback: function(val){ \n    if(val==1) vco.type = 'square'; \n    else vco.type = 'sawtooth'; \n}"),"RadioButtons"===e&&console.log("An example of defining a callback for a radio button is: \ncallback: function(val){ vco.type = val }")}exports.Button=Button,_p.default.prototype.Button=function(){return new Button(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Momentary extends Button{constructor(e,t){super(e,t),this.value=t.value||0,this.rawValue=this.value}isReleased(){!0!==this.hide&&1===this.active&&(this.active=0,this.rawValue=0,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack())}}exports.Momentary=Momentary,_p.default.prototype.Momentary=function(){return new Momentary(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Toggle extends Button{constructor(e,t){super(e,t),this.state=t.state||!1,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}isPressed(){!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2&&(this.active=1,this.rawValue=this.rawValue?0:1,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),"false"===this.maptoDefined&&postButtonError("Toggle buttons"),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc())}isReleased(){!0!==this.hide&&1===this.active&&(this.active=0)}forceSet(e){this.rawValue=e,this.value=scaleOutput(this.rawValue,0,1,this.min,this.max,this.curve),this.mapValue(this.value,this.mapto),this.runCallBack(),"false"===this.maptoDefined&&postButtonError("Toggle buttons")}}exports.Toggle=Toggle,_p.default.prototype.Toggle=function(){return new Toggle(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class RadioButton extends Button{constructor(e,t){super(e,t),this.radioOptions=t.radioOptions||["on","off"],this.orientation=t.orientation||"vertical",this.isHorizontal="horizontal"===this.orientation,this.value=t.value||this.radioOptions[0],this.radioHeight=this.cur_size/2,this.radioWidth=2*this.cur_size,this.border=t.border||activeTheme.radioBorder||2,this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}draw(){if(!0===this.hide)return;this.radioClicked={},this.isHorizontal="horizontal"===this.orientation,this.cur_size=this.size/6*this.p.width/2,this.radioHeight=this.cur_size/2,this.radioWidth=2*this.cur_size;let e=this.getParam("border",this.border);this.p.textSize(10*this.textSize);let t=0;for(let e=0;e<this.radioOptions.length;e++){let n=this.p.textWidth(this.radioOptions[e]);n>t&&(t=n)}this.cur_size=t,this.radioWidth=1.5*this.cur_size,this.isHorizontal?(this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.x_corner=this.cur_x-this.radioWidth*this.radioOptions.length/2,this.y_corner=this.cur_y-this.radioHeight/2,this.x_box=this.radioWidth*this.radioOptions.length,this.y_box=this.radioHeight):(this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.x_corner=this.cur_x-this.radioWidth/2,this.y_corner=this.cur_y-this.radioHeight*this.radioOptions.length/2,this.y_box=this.radioHeight*this.radioOptions.length,this.x_box=this.radioWidth),this.showLabel&&this.drawLabel(this.cur_x,this.isHorizontal?this.cur_y+this.radioHeight:this.cur_y+this.radioHeight*(this.radioOptions.length/2+.5));for(let t=0;t<this.radioOptions.length;t++){let n=this.radioOptions[t],s=this.isHorizontal?this.x_corner+t*this.radioWidth:this.x_corner,r=this.isHorizontal?this.y_corner:this.y_corner+this.radioHeight*t;this.p.fill(this.value===n?this.setColor(this.accentColor):this.setColor(this.borderColor)),this.p.stroke(0),this.p.strokeWeight(e),this.p.rect(s,r,this.radioWidth,this.radioHeight),this.drawText(n,s+this.radioWidth/2,r+this.radioHeight/2),this.radioClicked[this.radioOptions[t]]=()=>this.isHorizontal?this.p.mouseX>=s&&this.p.mouseX<=s+this.radioSize:this.p.mouseY>=r&&this.p.mouseY<=r+this.radioSize/2}}isPressed(){if(!0!==this.hide&&this.p.mouseX<this.cur_x+this.x_box/2&&this.p.mouseX>this.cur_x-this.x_box/2&&this.p.mouseY>this.cur_y-this.y_box/2&&this.p.mouseY<this.cur_y+this.y_box/2){let e;if(this.isHorizontal){let t=this.cur_x+this.x_box/2-this.p.mouseX;t=Math.floor(t/this.radioWidth),t=this.radioOptions.length-t-1,e=this.radioOptions[t]}else{let t=this.cur_y+this.y_box/2-this.p.mouseY;t=Math.floor(t/this.radioHeight),t=this.radioOptions.length-t-1,e=this.radioOptions[t]}this.value=e,this.active=1,this.runCallBack(),this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc(),"false"===this.maptoDefined&&postButtonError("RadioButtons")}}isReleased(){}forceSet(e){this.radioOptions.includes(e)?(this.value=e,this.runCallBack()):"number"==typeof e&&e>=0&&e<this.radioOptions.length&&(this.value=this.radioOptions[e],this.runCallBack())}}exports.RadioButton=RadioButton,_p.default.prototype.RadioButton=function(){return new RadioButton(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},_p.default.prototype.Radio=function(){return new RadioButton(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Dropdown extends Button{constructor(e,t){super(e,t),this.dropdownOptions=t.dropdownOptions||["on","off"],this.value=t.value||this.dropdownOptions[0],this.isOpen=!1,this.cur_size=this.size||30,this.border=t.border||activeTheme.radioBorder||2,this.accentColor=t.accentColor||[200,50,0],this.linkName&&this.ch.control(this.linkName,this.value),this.linkFunc&&this.linkFunc()}draw(){if(!0===this.hide)return;this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.p.textSize(.9*this.cur_size);let e=this.p.textWidth(this.value);if(this.boxWidth=Math.max(e+20,100),this.boxHeight=this.cur_size,this.p.fill(255),this.p.stroke(0),this.p.strokeWeight(this.border),this.p.rect(this.cur_x,this.cur_y,this.boxWidth,this.boxHeight),this.drawText(this.value,this.cur_x+this.boxWidth/2,this.cur_y+this.boxHeight/2),this.isOpen)for(let e=0;e<this.dropdownOptions.length;e++){let t=this.dropdownOptions[e],n=this.cur_y+(e+1)*(this.boxHeight+2);this.value===t?this.p.fill(this.accentColor):this.p.fill(200),this.p.stroke(0),this.p.rect(this.cur_x,n,this.boxWidth,this.boxHeight),this.p.fill(0),this.drawText(t,this.cur_x+this.boxWidth/2,n+this.boxHeight/2)}}isPressed(){if(!0!==this.hide)if(this.p.mouseX>=this.cur_x&&this.p.mouseX<=this.cur_x+this.boxWidth&&this.p.mouseY>=this.cur_y&&this.p.mouseY<=this.cur_y+this.boxHeight)this.isOpen=!this.isOpen;else if(this.isOpen){for(let e=0;e<this.dropdownOptions.length;e++){let t=this.cur_y+(e+1)*(this.boxHeight+2);if(this.p.mouseX>=this.cur_x&&this.p.mouseX<=this.cur_x+this.boxWidth&&this.p.mouseY>=t&&this.p.mouseY<=t+this.boxHeight)return this.value=this.dropdownOptions[e],this.isOpen=!1,this.runCallBack(),this.mapValue(this.value,this.mapto),"false"===this.maptoDefined&&postButtonError("Dropdown"),this.linkName&&this.ch.control(this.linkName,this.value),void(this.linkFunc&&this.linkFunc())}this.isOpen=!1}else this.isOpen=!1}isReleased(){}}exports.Dropdown=Dropdown,_p.default.prototype.Dropdown=function(){return new Dropdown(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};class Line extends Element{constructor(e,t,n,s,r,o){super(e,o),this.x1=t||0,this.x2=s||0,this.y1=n||0,this.y2=r||0,this.showLabel=o.showLabel||"false",this.border=o.border||2,this.color=o.color||activeTheme.lineColor||"border"}resize(e,t){super.resize(e,t),this.size*=!1!==this.horizontal?e:t}draw(){if(!0===this.hide)return;let e=this.x1/100*this.p.width,t=this.x2/100*this.p.width,n=this.y1/100*this.p.height,s=this.y2/100*this.p.height,r=this.getParam("border",this.border);this.p.fill(this.setColor(this.color)),this.p.stroke(this.setColor(this.color)),this.p.strokeWeight(2*r),this.p.line(e,n,t,s)}isPressed(){}pressed(){}isReleased(){}}exports.Line=Line,_p.default.prototype.Line=function(e,t,n,s){return new Line(this,e,t,n,s,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{})};class Text extends Element{constructor(e,t){super(e,t),this.border=t.border||activeTheme.border||0,this.textSize=t.size||activeTheme.textSize||t.textSize||1}resize(e,t){super.resize(e,t),this.size*=!1!==this.horizontal?e:t}draw(){if(!0===this.hide)return;this.cur_x=this.x/100*this.p.width,this.cur_y=this.y/100*this.p.height,this.cur_size=this.size/6*this.p.width/2;let e=this.getParam("border",this.border),t=this.getParam("borderRadius",this.borderRadius);if(this.drawText(this.label,this.cur_x,this.cur_y),e>0){let n=this.p.textWidth(this.label),s=this.p.textAscent()+this.p.textDescent();this.p.noFill(),this.p.stroke(this.setColor(this.borderColor)),this.p.strokeWeight(e),this.p.rect(this.cur_x-n/2-2-t/2,this.cur_y-s/2-1,n+4+t,s+1,t,t)}}isPressed(){}pressed(){}isReleased(){}}exports.Text=Text,_p.default.prototype.Text=function(){return new Text(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},640:e=>{"use strict";e.exports=JSON.parse('{"thickDistortion":{"Accent":0,"bitcrusher":0,"Glide":0,"Delay Control":0.0001,"wave":0.5,"freq":700,"release":0.8,"res":1,"detune":1,"gain":0.05},"default":{"Accent":0,"bitcrusher":0,"Glide":0,"Delay Control":0.05095,"wave":0.6950000000000002,"freq":1791.337256248868,"release":1.2970000000000006,"res":3.448777886795153,"detune":2,"gain":0.05},"shortNoisy":{"Accent":1,"bitcrusher":1,"Glide":0,"Delay Control":0.05088999999999999,"wave":0.45999999999999996,"freq":776.5421160762811,"release":0.604,"res":8.859313268874072,"detune":1.0099901,"gain":0.04450314575050762}}')},727:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(1174),a=n(1077),c=n(3941);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class CustomPlayer extends r.Player{set playbackRate(e){this._playbackRate=e;const t=this.now();this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(e,t)}))}}class Player extends o.MonophonicTemplate{constructor(e){super(),this.name="Player",this.player=new CustomPlayer,this.vcf=new r.Filter,this.vca=new r.Multiply(1),this.output=new r.Multiply(1),this.cutoffSig=new r.Signal(1e4),this.cutoffSig.connect(this.vcf.frequency),this.vcf.frequency.value=1e4,this.vcf.rolloff=-12,this.vcf.Q.value=1,this.filterEnv=new r.Envelope,this.vcfEnvDepth=new r.Multiply,this.filterEnv.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcf.frequency),this.player.connect(this.vcf),this.vcf.connect(this.vca),this.vca.connect(this.output),this.sample="",this.sampleDuration=0,this._baseUnit=16,this.seqControlsPitch=!1,this._start=0,this._end=100,this._playbackRate=1,this._baseNote=60;let t=[{name:"volume",value:-6,min:-36,max:0,curve:1,callback:e=>this.player.volume.value=e},{name:"cutoff",value:2e4,min:100,max:1e4,curve:2,callback:e=>this.cutoffSig.value=e},{name:"Q",min:0,value:0,max:20,curve:2,callback:e=>this.vcf.Q.value=e},{name:"filterType",value:"lowpass",min:0,max:20,curve:2,callback:e=>this.vcf.type=e},{name:"filterEnvDepth",value:0,min:0,max:5e3,curve:2,callback:e=>this.vcfEnvDepth.factor.value=e},{name:"loopStart",value:0,min:0,max:1e4,curve:1,callback:e=>this.player.loopStart=e},{name:"loopEnd",value:1,min:0,max:1e4,curve:1,callback:e=>this.player.loopEnd=e},{name:"loop",value:!1,min:0,max:1,curve:1,callback:e=>this.player.loop=e>0},{name:"fadeIn",value:.005,min:0,max:10,curve:3,callback:e=>this.player.fadeIn=e},{name:"fadeOut",value:.1,min:0,max:10,curve:3,callback:e=>this.player.fadeOut=e},{name:"baseUnit",value:16,min:0,max:6e4,curve:1,callback:e=>this._baseUnit=e},{name:"playbackRate",value:1,min:0,max:1e3,curve:1,callback:e=>{e<0&&(this.player.reverse=1),this._playbackRate=Math.abs(e),this.player.playbackRate=Math.abs(e)}},{name:"sequenceTime",value:!0,min:0,max:1,curve:1,callback:e=>this.seqControlsPitch=!e},{name:"startTime",value:0,min:0,max:1e4,curve:1,callback:e=>this._start=e},{name:"endTime",value:1,min:0,max:1e4,curve:1,callback:e=>this._end=e},{name:"baseNote",min:0,max:127,curve:1,callback:e=>this._baseNote=e},{name:"reverse",value:!1,min:0,max:1,curve:1,callback:e=>{this.player.reverse=e>0?1:0}}];this.param=this.generateParameters(t),this.createAccessors(this,this.param),this.sampleFiles={bell:["C4","berklee/bell_1.mp3"],bell1:["C4","berklee/bell_1a.mp3"],bell2:["C4","berklee/bell_2a.mp3"],bell3:["C4","berklee/bell_mallet_2.mp3"],horn:["C4","berklee/casiohorn2.mp3"],chotone:["C4","berklee/chotone_c4_!.mp3"],voice:["C4","berklee/femalevoice_aa_Db4.mp3"],kalimba:["C4","berklee/Kalimba_1.mp3"],dreamyPiano:["A5","salamander/A5.mp3"],softPiano:["A4","salamander/A4.mp3"],piano:[45,"salamander/A3.mp3"],casio:["C4","casio/C2.mp3"]},e&&this.loadSample(e)}load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.loadSample(e)}loadSample(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e)return void this.loadAudioBuffer();if("number"==typeof e){const t=Object.keys(this.sampleFiles);e=Math.floor(e)%t.length,e=t[e]}if(!(e in this.sampleFiles)){try{return this.player.load(e),console.log("file loaded from ",e),void this.getSampleDuration()}catch{}return void console.error(`The sample "${e}" is not available.`)}console.log(`Player loading ${e}`),this.sample=e,this.baseUrl="https://tonejs.github.io/audio/";const t=this.sampleFiles[this.sample][1],n=this.sampleFiles[this.sample][0];console.log(n,t),this.player.load(this.baseUrl.concat(t),(()=>{const e=this.player.buffer.length/r.context.sampleRate;console.log(`Sample duration: ${e.toFixed(2)} seconds`)}))}listSamples(){const e=Object.keys(this.sampleFiles);console.log(e)}trigger(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.triggerAttackRelease(e,t,n,s)}triggerAttack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=100;t/=127,n?(this.seqControlsPitch?(this.player.playbackRate=this.midiToRate(e),this.player.start(n,this._start,s)):(this._playbackRate!=this.player.playbackRate&&(this.player.playbackRate=this._playbackRate),this.player.start(n,e,s)),this.filterEnv.triggerAttack(n+0),this.vca.factor.setValueAtTime(t,n+0)):(this.seqControlsPitch?(this.player.playbackRate=this.midiToRate(e),this.player.start(r.now(),this._start,s)):(this._playbackRate!=this.player.playbackRate&&(this.player.playbackRate=this._playbackRate),this.player.start(r.now(),e,s)),this.filterEnv.triggerAttack(),this.vca.factor.setValueAtTime(t))}triggerRelease(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?(this.player.stop(t),this.filterEnv.triggerRelease(t+0)):(this.player.stop(),this.filterEnv.triggerRelease())}triggerAttackRelease(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t/=127,n+=.2,s&&(this.seqControlsPitch?(this.player.playbackRate=this.midiToRate(e),this.player.start(s,this._start)):(this._playbackRate!=this.player.playbackRate&&(this.player.playbackRate=this._playbackRate),this.player.start(s,e)),this.filterEnv.triggerAttackRelease(n,s),this.vca.factor.setValueAtTime(t,s))}midiToRate(e){return Math.pow(2,(e-this._baseNote)/12)}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}loadAudioBuffer(){const e=document.createElement("input");e.type="file",e.accept="audio/*",e.onchange=e=>{const t=e.target.files[0];if(!t)return void console.log("No file selected");const n=new FileReader;n.onload=()=>{this.player=new CustomPlayer(n.result).connect(this.vcf),this.player.autostart=!1,console.log("Audio loaded into player"),this.getSampleDuration()},n.readAsDataURL(t)},e.click()}getSampleDuration(){setTimeout((()=>{const e=this.player._buffer.length/r.context.sampleRate;e>0?(console.log(`Sample duration: ${e.toFixed(2)} seconds`),this.sampleDuration=e):this.getSampleDuration()}),100)}sequence(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite";this.seq[n]?this.seq[n].sequence(e,t,s):this.seq[n]=new c.Seq(this,e,t,s,n,this.parseNoteString.bind(this)),this.start(n)}parseNoteString(e,t,n,s){if(0==this.sampleDuration)return console.log("Sample duration: 0 seconds"),void this.getSampleDuration();if("."===e[0])return void("started"===this.player.state&&this.player.stop(t));const o=/^[a-ac-zA-Z]$/.test(e[0][0]);let c="";if(this.seqControlsPitch)c=o?(0,a.pitchNameToMidi)(e[0]):(0,a.intervalToMidi)(e[0],this.min,this.max);else{if(o)return void console.log("player seq values are time positions in the sample");c=e[0]*this.sampleDuration}const l=e[1];if(c<0)return;let h=this.getSeqParam(this.seq[s].octave,n),u=this.getSeqParam(this.seq[s].velocity,n),d=this.getSeqParam(this.seq[s].sustain,n),f=this.getSeqParam(this.seq[s].subdivision,n);this.seqControlsPitch||(c/=this._baseUnit),c+=h;try{this.triggerAttackRelease(c,u,d,t+l*r.Time(f))}catch(e){console.log("invalid note",c,u,d)}}}t.Player=Player},807:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paramDefinitions=void 0,t.paramDefinitions=e=>[{name:"vco_mix",type:"vco",min:0,max:1,curve:.75,callback:function(t){e.crossfade_constant.value=t}},{name:"detune",type:"vco",min:1,max:2,curve:.5,callback:function(t){e.detune_scalar.factor.value=t}},{name:"shape1",type:"vco",min:.1,max:.5,callback:function(t){e.shapeVco(0,2*t+1)}},{name:"shape2",type:"vco",min:.1,max:.5,callback:function(t){e.shapeVco(1,2*t+1)}},{name:"cutoff",type:"vcf",min:0,max:1e4,curve:1,callback:function(t){e.cutoffSig.value=t}},{name:"envDepth",type:"vcf",min:0,max:5e3,curve:.75,callback:function(t){e.vcf_env_depth.factor.value=t}},{name:"Q",type:"vcf",min:0,max:20,curve:.5,callback:function(t){e.vcf.Q.value=t}},{name:"keyTracking",type:"vcf",min:0,max:1,curve:.5,callback:function(t){e.keyTracking.factor.value=t}},{name:"highPass",type:"vcf",min:10,max:3e3,curve:.5,callback:function(t){e.setHighpass(t)}},{name:"attack",type:"env",min:.005,max:.5,curve:.5,callback:function(t){e.env.attack=t}},{name:"decay",type:"env",min:.01,max:10,curve:.5,callback:function(t){e.env.decay=t}},{name:"sustain",type:"env",min:0,max:1,curve:.5,callback:function(t){e.env.sustain=t}},{name:"release",type:"env",min:0,max:20,curve:.5,callback:function(t){e.env.release=t}},{name:"vcf_attack",type:"env",min:.005,max:.5,curve:.5,callback:function(t){e.vcf_env.attack=t}},{name:"vcf_decay",type:"env",min:.01,max:10,curve:.5,callback:function(t){e.vcf_env.decay=t}},{name:"vcf_sustain",type:"env",min:0,max:1,curve:.5,callback:function(t){e.vcf_env.sustain=t}},{name:"vcf_release",type:"env",min:0,max:20,curve:.5,callback:function(t){e.vcf_env.release=t}},{name:"lfo",type:"lfo",min:0,max:20,curve:1,callback:function(t){e.lfo.frequency.value=t}},{name:"vibrato",type:"lfo",min:0,max:.1,curve:.5,callback:function(t){e.pitch_lfo_depth.factor.value=t}},{name:"tremolo",type:"lfo",min:0,max:1,curve:.5,callback:function(t){e.amp_lfo_depth.factor.value=t}},{name:"blend",type:"lfo",min:0,max:1,curve:.5,callback:function(t){e.crossfade_lfo_depth.factor.value=t}}]},1077:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Theory=t.Chord=void 0,t.intervalToMidi=function intervalToMidi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:127,s=0,o=null,a=-1;"string"==typeof e?(s=(e=e.trim()).match(/\[.*?\]|-?\d+|@(\d+)|\./g)[0],o=e.match(/[b#]+/g)):s=e;try{a=r.getChord().interval(s,t,n)}catch(e){console.log("bad interval: ",s)}if(null!==o)if(Array.isArray(o))for(const e of o)"#"===e?a+=1:"b"===e&&(a-=1);else"#"===o?a+=1:"b"===o&&(a-=1);return a},t.parsePitchStringBeat=function parsePitchStringBeat(e,t){try{"number"==typeof e&&(e=e.toString());const t=e.replace(/\[/g,"")[0],n=/^[a-ac-zA-Z]$/.test(t);let s=[];return/^\[.*\]$/.test(e)?(e=e.slice(1,-1).split(",")).forEach((e=>{let t=/\[.*?\]|[A-Ga-g][#b]?\d*|@(\d+)|./g;n||(t=/\[.*?\]|-?\d+[#b]?|@(\d+)|\./g),e=e.match(t);for(let t=0;t<e.length;t++)if(e[t].startsWith("@")){const n=parseInt(e[t].slice(1),10)-1,s=e[t-1],r=new Array(n).fill(s);e.splice(t,1,...r),t+=n-1}const r=e.length;for(let t=0;t<r;t++){const n=e[t];s.push([n,t/r])}})):s.push([e,0]),s}catch(e){return console.log("error with parsePitchStringBeat"),["."]}},t.parsePitchStringSequence=function parsePitchStringSequence(e){const t=e.replace(/\[/g,"")[0],n=/^[a-ac-zA-Z?]$/.test(t);n&&(e=e.replace(/\s/g,""));let s=/\[.*?\]|[A-Ga-g][#b]?\d*|@(\d+)|\.|\?/g;n||(s=/\[.*?\]|-?[b#]?\d+[b#]?|@(\d+)|\.|\?/g);let r=e.match(s);for(let e=0;e<r.length;e++)if(r[e].startsWith("@")){const t=parseInt(r[e].slice(1),10)-1,n=r[e-1],s=new Array(t).fill(n);r.splice(e,1,...s),e+=t-1}return r},t.parseStringBeat=function parseStringBeat(e,t){let n=[];return/^\[.*\]$/.test(e)?(e=e.slice(1,-1).split(",")).forEach((e=>{const t=e.length;for(let s=0;s<t;s++){const r=e[s];n.push([r,s/t])}})):n.push([e,0]),n},t.parseStringSequence=function parseStringSequence(e){const t=/\[.*?\]|./g;return(e=(e=e.replace(/\s/g,"")).replace(/(.)@(\d+)/g,((e,t,n)=>t.repeat(Number(n))))).match(t),e.match(t)},t.pitchNameToMidi=function pitchNameToMidi(e){const t=r.noteToInterval;let n,s=(e=e.trim()).match(/[A-G]?[a-g]?[#b]?/)[0];n=/[A-G]/.test(e[0])?3:4,s=s.charAt(0).toUpperCase()+s.slice(1);let o=e.match(/\d+$/);return o&&(n=parseInt(o[0],10)),t[s]+12*(n+1)};var s=_interopRequireWildcard(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}_interopRequireWildcard(n(6192));const r=t.Theory=new class MusicGenerator{constructor(){this._tonic="C",this.tonicNumber=0,this.keyType="major",this.octave=4,this.voicing="closed",this.previousChord=[],this._scale="major",this._chord="I",this._timeSignature="4/4",this._harmonicTempo=120,this._beat=0,this._bar=0,this._beatsPerBar=4,this._startingBar=0,this._startingBeat=0,this._barOffset=0,this._prevBarOffset=0,this._ticks=0,this.pulsePerChord=16,this.harmonicRhythm=8,this.progressionChords=[],this._progression=[],this.voicings={closed:[0,2,4,6],open:[0,4,6,9],drop2:[-3,0,2,6],drop3:[-1,0,3,4]},this.notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this.noteToInterval={C:0,"B#":12,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11},this.chordIntervals={major:[0,4,7],minor:[0,3,7],dominant7:[0,4,7,10],minor7:[0,3,7,10],major7:[0,4,7,11],minorMaj7:[0,3,7,11],diminished:[0,3,6],diminished7:[0,3,6,9],add9:[0,4,7,14]},this.chordScales={major:[0,2,4,5,7,9,11],minor:[0,2,3,5,7,8,10],lydianDominant:[0,2,4,6,7,9,10],mixolydian:[0,2,4,5,7,9,10],phrygianDominant:[0,1,4,5,7,8,10],minor7:[0,2,3,5,7,9,10],major7:[0,2,4,5,7,9,11],minorMaj7:[0,2,3,5,7,9,11],diminished:[0,2,3,5,6,8,9,11],diminished7:[0,2,3,5,6,8,9,11],add9:[0,2,4,5,7,9,11],dorian:[0,2,3,5,7,9,10],phrygian:[0,1,3,5,7,8,10],lydian:[0,2,4,6,7,9,11],locrian:[0,1,3,5,6,8,10]},this.MajorScaleDegrees={I:0,bII:1,II:2,bIII:3,III:4,IV:5,"#IV":6,bV:6,V:7,"#V":8,bVI:8,VI:9,bVII:10,VII:11,i:0,bii:1,ii:2,biii:3,iii:4,iv:5,"#iv":6,bv:6,v:7,bvi:8,vi:9,bvii:10,vii:11},this.MinorScaleDegrees={I:0,bII:1,II:2,III:3,"#III":4,IV:5,"#IV":6,bV:6,V:7,"#V":8,VI:8,"#VI":9,VII:10,"#VII":11,i:0,bii:1,ii:2,iii:3,"#iii":4,iv:5,"#iv":6,bv:6,v:7,vi:8,"#vi":9,bvii:10,vii:11}}set tonic(e){this.setTonic(e)}get tonic(){return this._tonic}set root(e){this.setTonic(e)}get root(){return this._tonic}set key(e){this.setTonic(e)}get key(){return this._tonic}set progression(e){this.setProgression(e)}get progression(){return this._progression}set tempo(e){s.Transport.bpm.value=e}get tempo(){return s.Transport.bpm.value}set scale(e){this._scale=e}get scale(){return this._scale}set chord(e){this._chord=e}get chord(){return this._chord}set timeSignature(e){this._timeSignature=e}get timeSignature(){return this._timeSignature}set harmonicTempo(e){this._harmonicTempo=e}get harmonicTempo(){return this._harmonicTempo}set beat(e){let t=this.transportToArray(s.Transport.position);t[1]=e,s.Transport.position=this.arrayToTransport(t)}get beat(){return this.transportToArray(s.Transport.position)[1]}set bar(e){let t=this.transportToArray(s.Transport.position);t[0]=e,s.Transport.position=this.arrayToTransport(t)}get bar(){return this.transportToArray(s.Transport.position)[0]}set beatsPerBar(e){this._beatsPerBar=e,s.Transport.timeSignature=e}get beatsPerBar(){return this._beatsPerBar}set ticks(e){this._ticks=e}get ticks(){return this.getTicks()+2}set start(e){void 0===e&&(e=0)}get now(){const e=s.Transport.position.split(":").map(Number);return 4*e[0]+e[1]+(e[2]||0)/4}getIndex(e){return Math.floor(this.ticks/s.Time(e).toTicks())}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;s.Transport.position=this.arrayToTransport([e,0,0]),s.Transport.start()}stop(){s.Transport.stop()}transportToArray(e){return e.split(":").map(Number)}arrayToTransport(e){return e.join(":")}onBar(e,t){s.Transport.schedule(e,this.arrayToTransport([t,0,0]))}setTonic(e){if("string"==typeof e){const t=/[A-Ga-g][#b]?/,n=/\d+/,s=e.match(t),r=e.match(n);s&&(this._tonic=s[0].toUpperCase(),this.keyType=s[0]===s[0].toUpperCase()?"major":"minor"),r&&(this.octave=parseInt(r[0],10))}else if("number"==typeof e){this.octave=Math.floor(e/12)-1;const t=e%12;this._tonic=this.notes[t]}this.tonicNumber=this.noteToInterval[this._tonic],console.log(`Tonic: ${this._tonic}, Number: ${this.tonicNumber}, Key Type: ${this.keyType}, Octave: ${this.octave}`)}setProgression(e){let t=[],n=-1;e.constructor!==Array&&(e=e.replaceAll(","," ").split(" "));for(let s=0;s<e.length;s++){let r=e[s];try{if(""!==e[s]){const e=r.match(/[iIvVb#]+/)[0],o=this.getChordType(r);console.log(r,o),"number"!=typeof this.MajorScaleDegrees[e]&&(n=s),this.chordScales[o].constructor!==Array&&(n=s),n<0&&t.push(r)}}catch{console.log("error with element ",e[s]),n=0}}if(n<0){this._progression=t,this.progressionChords=[];for(let e=0;e<this._progression.length;e++)this.progressionChords.push(new Chord(this._progression[e]))}else console.log("error in progression element",e[n])}setVoicing(e){this.voicings.hasOwnProperty(e)?this.voicing=e:console.log("invalid voicing name ",e),console.log("current voicing: ",this.voicing)}getChord(e){let t=this.getChordIndex();return this.progressionChords.length<1&&this.progressionChords.push(new Chord("I")),this.progressionChords[Math.floor(t%this.progressionChords.length)]}getChordIndex(){return Math.floor((this.ticks+2)/(s.Time("4n").toTicks()*this._beatsPerBar))}getChordType(e){const t=e.replace(/[iIvVb#]+/,"");let n=e.match(/[iIvV]+/)[0];n||(n="I");const s=this.getDefaultMode(n,this.keyType);for(const e of Object.keys(this.chordScales))if(t.toLowerCase().includes(e.toLowerCase()))return console.log("key",e),e;if(t.includes("dim"))return"diminished";if(t.includes("m6"))return"dorian";if(t.includes("min6"))return"dorian";if(t.includes("m13"))return"dorian";if(t.includes("min13"))return"dorian";if(t.includes("m7b9"))return"phrygian";if(t.includes("7b9"))return"phrygianDominant";if(t.includes("Maj7#11"))return"lydian";if(t.includes("m7b5"))return"locrian";if(t.includes("7b5"))return"lydianDominant";if(t.includes("Maj7")){const e=n===n.toUpperCase();return"lydian"===s?s:!0===e?"major7":"minorMaj7"}return t.includes("7")?n===n.toUpperCase()?"mixolydian":"minor7":t.includes("2")?"major9":"none"!==s?s:n===n.toUpperCase()?"major":"minor"}getDefaultMode(e,t){if("major"===t)switch(e){case"I":return"major";case"ii":return"dorian";case"iii":return"phrygian";case"IV":return"lydian";case"V":return"mixolydian";case"vi":return"minor";case"vii":return"locrian"}if("minor"===t)switch(e){case"i":return"minor";case"ii":return"locrian";case"III":return"major";case"iv":return"dorian";case"v":return"phrygian";case"V":return"phrygianDominant";case"VI":return"lydian";case"VII":return"mixolydian"}return"none"}getTicks(){const e=s.Transport.ticks-this._barOffset;return e<0?s.Transport.ticks-this._prevBarOffset:e}resetBar(e){const t=s.Transport.ticks,n=s.Time("4n").toTicks()*this._beatsPerBar,r=Math.ceil(t/n)*n;this._barOffset=r+e*n-e*n}getChordRoot(e){const t=e.match(/[iIvVb#]+/)[0];if(!t)return console.log("incorrect chord name ${name}"),this.tonicNumber;let n=0;return"major"==this.keyType?(n=this.MajorScaleDegrees[t],null==n&&(n=this.MinorScaleDegrees[t]),null==n&&(n=0)):(n=this.MinorScaleDegrees[t],null==n&&(n=this.MajorScaleDegrees[t]),null==n&&(n=0)),null==n&&(n=0),n%12}getChordTones(e,t,n){let s=[],r=3;/\d/.test(t)&&(r=4);for(let t=0;t<r;t++)s[t]=n[2*t]+e}getInterval(e,t){let n=t.length;if("number"==typeof e){let s=Math.floor(e/n);return e<0&&(e=n+e%n),t[e%n]+12*s}if("string"==typeof e){const s=e.match(/^([^\d-]+)?(-?\d+)$/);e=Number(s[2]);let r=Math.floor(e/n);return e<0&&(e=7+e%7),e=t[e%n]+12*r,"#"==s[1]?e+=1:"b"==s[1]&&(e-=1),e+this.tonicNumber}return 0}minimizeMovement(e,t){let n=Math.abs(e[0]%12-t[0]%12),s=0;for(let r=1;r<e.length;r++)Math.abs(e[r]%12-t[0]%12)<n&&(n=Math.abs(e[r]%12-t[0]%12),s=r);for(;e[s]<t[0]-2;)e=e.map((e=>e+12));for(let n=0;n<e.length;n++)e[n]<t[0]&&(e[n]+=12);return e.sort(((e,t)=>e-t))}};class Chord{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.octave,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.voicing;this.name=e,this.octave=t,this.voicing=n,this.rootValue=r.getChordRoot(e),this.quality=r.getChordType(e),this.scale=r.chordScales[this.quality],"V7"==this.name&&(this.scale=r.chordScales.mixolydian),this.chordTones=this.getChordTones(this.rootValue,this.quality,this.scale),this.length=this.chordTones.length}interval(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===n&&(n=t+12),this.getInterval(e,t,n)}getInterval(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:127;if((e=r.getInterval(e,this.scale)+this.rootValue+12*this.octave)<t){const n=Math.floor((t-e)/12)+1;for(let t=0;t<n;t++)e+=12}else if(e>n){const t=Math.floor((e-n)/12)+1;for(let n=0;n<t;n++)e-=12}return e}root(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36;return this.rootValue+e}tones(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:48;return this.getChordTones(e)}getChordTones(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:48,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t&&(t=e+12),this.getChord(this.name,e,this.voicing)}setChord(e){this.notes=e}applyVoicing(e){const t=r.voicings[this.voicing];return r.chordTones.map(((e,n)=>e+(t[n]||0)))}getChord(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null==n&&(n=r.voicing);let s=[this.scale[0],this.scale[2],this.scale[4]];if(/\d/.test(e)&&this.scale.length>=7){const t=e.match(/\d+/);t&&s.push(this.scale[parseInt(t[0],10)%7])}return s=s.map((e=>e+12*this.octave+this.rootValue)),r.previousChord.length>0&&(t&&(r.previousChord[0]=t),s=r.minimizeMovement(s,r.previousChord)),r.previousChord=s,s.map((e=>e+r.tonicNumber))}}t.Chord=Chord},1113:e=>{"use strict";e.exports=function styleTagTransform(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1160:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Twinkle=void 0,s(n(5897)),n(5324);var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(138)),a=n(1174),c=(n(3447),s(n(1297)),s(n(5309)));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class Twinkle extends a.MonophonicTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.gui=e,this.presets=o.default,this.isGlide=!1,this.name="Twinkle",this.frequency=new r.Signal(200),this.vco=new r.OmniOscillator({type:"pulse"}).start(),this.frequency.connect(this.vco.frequency),this.vcf=new r.Filter({type:"lowpass",rolloff:-24}),this.vco.connect(this.vcf),this.vca=new r.Multiply,this.vcf.connect(this.vca),this.output=new r.Multiply(1),this.vcf.connect(this.vca),this.vca.connect(this.output),this.vca_lvl=new r.Signal,this.vca_lvl.connect(this.vca.factor),this.env=new r.Envelope,this.env.releaseCurve="linear",this.env.decayCurve="exponential",this.env_depth=new r.Multiply,this.env.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.velocitySig=new r.Signal(1),this.velocitySig.connect(this.env_depth.factor),this.cutoffSig=new r.Signal(1e3),this.cutoff_cv=new r.Signal(0),this.vcf_env_depth=new r.Multiply(500),this.keyTracker=new r.Multiply(.1),this.env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.cutoffSig.connect(this.vcf.frequency),this.cutoff_cv.connect(this.vcf.frequency),this.frequency.connect(this.keyTracker),this.keyTracker.connect(this.vcf.frequency),this.paramDefinitions=(0,c.default)(this),this.param=this.generateParameters(this.paramDefinitions),this.createAccessors(this,this.param),this.autocompleteList=this.paramDefinitions.map((e=>e.name)),setTimeout((()=>{this.loadPreset("default")}),500)}triggerAttack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e=r.Midi(e).toFrequency(),t/=127,n?(this.env.triggerAttack(n),this.frequency.setValueAtTime(e,n),this.velocitySig.linearRampToValueAtTime(t,n+.01)):(this.env.triggerAttack(),this.frequency.value=e,this.velocitySig.rampTo(t,.03))}triggerRelease(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?this.env.triggerRelease(e):this.env.triggerRelease()}triggerAttackRelease(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=r.Midi(e).toFrequency(),t/=127,s?(this.env.triggerAttackRelease(n,s),this.frequency.setValueAtTime(e,s),this.velocitySig.setTargetAtTime(t,s,.005)):(this.env.triggerAttackRelease(n),this.frequency.value=e,this.velocitySig.rampTo(t,.03))}}t.Twinkle=Twinkle},1174:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.MonophonicTemplate=void 0;var r=_interopRequireWildcard(n(5726)),o=_interopRequireWildcard(n(5897)),a=n(1077),c=n(3941),l=(n(6373),n(1313)),h=n(3447),u=n(5324),d=s(n(1297));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}t.MonophonicTemplate=class MonophonicTemplate{constructor(){this.presets={},this.gui_elements=[],this.gui=null,this.guiContainer=null,this.layout=d.default,this.poly_ref=null,this.super=null,this.frequency=new r.Signal,this.env=new r.Envelope,this.type="Synth",this.name="",this.presetsData=null,this.curPreset=null,this.seq=[],this.turingMachine=null,this.callback=(e,t)=>{},this.callbackLoop=new r.Loop((e=>{this.index=Math.floor(a.Theory.ticks/r.Time("16n").toTicks()),this.callback(this.index,null)}),"16n").start(),this.seqToDraw=0,this.drawing=new l.ArrayVisualizer(this,[0],"Canvas",.2),this.drawingLoop=new r.Loop((e=>{if(!0===this.drawing.enabled&&(this.drawing.startVisualFrame(),this.seq[this.seqToDraw])){const e=this.seq[this.seqToDraw];if(e.vals.length>0){const t=Math.floor(a.Theory.ticks/r.Time(e.subdivision).toTicks());this.drawing.visualize(e.vals,t)}}}),"16n").start()}savePreset(e){const t={};for(let e of Object.values(this.param))t[e.name]=e._value;console.log(this.presets),this.presets[e]||(this.presets[e]={}),this.presets[e]=t,console.log(`Preset saved under ${this.name}/${e}`)}downloadPresets(){this.presetsData=this.presets;const e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.presetsData,null,2)),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",`${this.name}Presets.json`),document.body.appendChild(t),t.click(),t.remove()}loadPreset(e){this.curPreset=e;const t=this.presets[this.curPreset];if(t){console.log("Loading preset ",this.curPreset);for(let e in t)try{for(let n of Object.values(this.param))this.param[e].set(t[e])}catch(e){console.log(e)}}else console.log("No preset of name ",e)}logPreset(){const e=this.presets[this.curPreset];if(e){let t="Parameters:\n";for(let n in e){const s=e[n];Array.isArray(s)?t+=`${n}: [${s.map((e=>"number"==typeof e?Number(e.toFixed(2)):e)).join(", ")}]\n`:t+="number"==typeof s?`${n}: ${s.toFixed(2)}\n`:`${n}: ${s}\n`}console.log(t)}else console.log("No preset of name ",this.curPreset)}listPresets(){console.log("Synth presets",this.presets)}triggerAttack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t/=127,n?(this.frequency.setValueAtTime(r.Midi(e).toFrequency(),n),this.env.triggerAttack(n)):(this.frequency.value=r.Midi(e).toFrequency(),this.env.triggerAttack())}triggerRelease(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.env.triggerRelease(t):this.env.triggerRelease()}triggerAttackRelease(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;console.log("AR ",e,t,n,s),t/=127,s?(this.frequency.setValueAtTime(r.Midi(e).toFrequency(),s),this.env.triggerAttackRelease(n,s)):(this.frequency.value=r.Midi(e).toFrequency(),this.env.triggerAttackRelease(n))}generateParameters(e){const t={};return e.forEach((e=>{const n=new h.Parameter(this,e);t[e.name]=n})),t}createAccessors(e,t){Object.keys(t).forEach((n=>{const s=t[n];let r=null;if("function"!=typeof s.set||"function"!=typeof s.get)throw new Error(`Parameter '${n}' does not have valid get/set methods`);const o={get(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"sequence"===t?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"16n";s.sequence(e,t)}:"stop"===t?()=>{s.stop()}:"set"===t?()=>{"function"==typeof n?n():n.value,r&&(r.dispose(),r=null),s.set(n,null,!1)}:e.get()},set:(t,n,o)=>(Array.isArray(o)?(r&&r.dispose(),r=new c.Seq(e,o,s.subdivision||"16n","infinite",0,((e,t)=>s.set(Number(e[0]),null,!1,t)))):(r&&(r.dispose(),r=null),s.set(o)),!0)};Object.defineProperty(e,n,{get:()=>new Proxy(s,o),set:e=>{Array.isArray(e)?s.sequence(e):(s.stop(),s.set(e))}})}))}startSequence(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"16n";const s=this.param[e];s?s.sequence(t,n):console.warn(`Param ${e} has no sequence method or doesn't exist.`)}stopSequence(e){const t=this.param[e];t.seq?t.stop():console.warn(`Param ${e} has no stop method or doesn't exist.`)}get(){let e="Parameters:\n";for(let t in this.param){const n=this.param[t];let s=n._value;console.log(s),"number"==typeof s&&(s=s>100?s.toFixed():s>1?s.toFixed(1):s.toFixed(3)),e+=`${n.name}: ${s}\n`}console.log(e)}print(){this.get()}setADSR(e,t,n,s){this.env&&(this.attack=e>.001?e:.001,this.decay=t>.01?t:.01,this.sustain=Math.abs(n)<1?n:1,this.release=s>.01?s:.01)}setFilterADSR(e,t,n,s){this.vcf_env&&(this.vcf_env.attack=e>.001?e:.001,this.vcf_env.decay=t>.01?t:.01,this.vcf_env.sustain=Math.abs(n)<1?n:1,this.vcf_env.release=s>.01?s:.01)}initGui(){this.guiContainer=document.getElementById("Canvas"),this.gui=new o(u.sketch,this.guiContainer);const e=this.layout,t={};Object.values(this.param).forEach((e=>{t[e.type]||(t[e.type]=[]),t[e.type].push(e)})),Object.keys(t).forEach((n=>{const s=e[n];if(!s)return;if("hidden"===n)return;let r=0;t[n].forEach(((e,t)=>{const n=s.groupA.includes(e.name),o=n?s.controlTypeA:s.controlTypeB,a=n?s.sizeA:s.sizeB,c=e.get?e.get():e._value;if(Array.isArray(c))c.forEach(((n,c)=>{let l=s.offsets.x*((t+r)%Math.floor(s.boundingBox.width/s.offsets.x)),h=s.offsets.y*Math.floor((t+r)/Math.floor(s.boundingBox.width/s.offsets.x));const u=s.boundingBox.x+l,d=s.boundingBox.y+h;this.createGuiElement(e,{x:u,y:d,size:a,controlType:o,color:s.color,i:c,value:n}),r++}));else{let n=s.offsets.x*((t+r)%Math.floor(s.boundingBox.width/s.offsets.x)),l=s.offsets.y*Math.floor((t+r)/Math.floor(s.boundingBox.width/s.offsets.x));const h=s.boundingBox.x+n,u=s.boundingBox.y+l;this.createGuiElement(e,{x:h,y:u,size:a,controlType:o,color:s.color,value:c})}}))}))}hideGui(){this.gui&&(this.gui.remove(),this.gui=null)}showGui(){this.initGui()}createGuiElement(e,t){let{x:n,y:s,size:r,controlType:o,color:a,i:c=null}=t;if("knob"===o)e.guiElements.push(this.gui.Knob({label:c?e.labels[c]:e.name,min:e.min,max:e.max,value:e._value,size:r,curve:e.curve,x:n,y:s,accentColor:a,callback:t=>e.set(t,c,!0)}));else if("fader"===o)e.guiElements.push(this.gui.Fader({label:c?e.labels[c]:e.name,min:e.min,max:e.max,value:e._value,curve:e.curve,size:r,x:n,y:s,accentColor:a,callback:t=>e.set(t,c,!0)}));else if("radioButton"===o)return Array.isArray(e.radioOptions)&&0!==e.radioOptions.length?this.gui.RadioButton({label:c?e.labels[c]:e.name,radioOptions:e.radioOptions,value:e._value,x:n,y:s+10,accentColor:a,callback:t=>e.set(t)}):(console.warn(`Parameter "${e.name}" has no options defined for radioBox.`),null)}createKnob(e,t,n,s,r,o,a,c){return this.gui.Knob({label:e,min:s,max:r,size:o,accentColor:a,x:t+this.x,y:n+this.y,callback:c,showLabel:1,showValue:0,curve:2,border:2})}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}disconnect(e){e.input?this.output.disconnect(e.input):this.output.disconnect(e)}sequence(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite";this.seq[n]?this.seq[n].sequence(e,t,s):this.seq[n]=new c.Seq(this,e,t,s,n,this.parseNoteString.bind(this)),this.start(n)}setSeq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.seq[n]?this.seq[n].setSeq(e,t):this.seq[n]=new c.Seq(this,e,t,"infinite",n,this.parseNoteString.bind(this))}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.seq[e]&&this.seq[e].play(t)}expr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"16n",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.seq[s]||(this.seq[s]=new c.Seq(this,[],n,"infinite",s,this.parseNoteString.bind(this))),this.seq[s].expr(e,t,n)}set velocity(e){for(let t=0;t<10;t++)this.seq[t]&&(this.seq[t].velocity=e)}set orn(e){for(let t=0;t<10;t++)this.seq[t]&&(this.seq[t].orn=e)}set octave(e){for(let t=0;t<10;t++)this.seq[t]&&(this.seq[t].octave=e)}set sustain(e){for(let t=0;t<10;t++)this.seq[t]&&(this.seq[t].sustain=e)}set subdivision(e){for(let t=0;t<10;t++)this.seq[t]&&(this.seq[t].subdivision=e)}set transform(e){if("function"==typeof e)for(let t=0;t<10;t++)this.seq[t]&&(this.seq[t].transform=e);else console.warn("Transform must be a function. Received: "+typeof e)}set roll(e){for(let t=0;t<10;t++)this.seq[t]&&(this.seq[t].roll=e)}setTransform(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";if("all"===t)for(let t of this.seq)t&&t.setTransform(e);else this.seq[t]&&this.seq[t].setTransform(e)}get sustain(){const e=this;return new Proxy([],{set(t,n,s){const r=parseInt(n);return isNaN(r)||e.seq[r]&&e.seq[r].setSustain(s),!0}})}get velocity(){const e=this;return new Proxy([],{set(t,n,s){const r=parseInt(n);return isNaN(r)||e.seq[r]&&e.seq[r].setVelocity(s),!0}})}get octave(){const e=this;return new Proxy([],{set(t,n,s){const r=parseInt(n);return isNaN(r)||e.seq[r]&&e.seq[r].setOctave(s),!0}})}get subdivision(){const e=this;return new Proxy([],{set(t,n,s){const r=parseInt(n);return isNaN(r)||e.seq[r]&&e.seq[r].setSubdivision(s),!0}})}get roll(){const e=this;return new Proxy([],{set(t,n,s){const r=parseInt(n);return isNaN(r)||e.seq[r]&&e.seq[r].setRoll(s),!0}})}get transform(){const e=this;return new Proxy([],{set(t,n,s){const r=parseInt(n);return isNaN(r)||e.seq[r]&&e.seq[r].setTransform(s),!0}})}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";if("all"===e){for(let e of this.seq)e&&e.start();this.drawingLoop.start()}else this.seq[e]&&this.seq[e].start()}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";if("all"===e){for(let e of this.seq)e&&e.stop();this.drawingLoop.stop()}else this.seq[e]&&this.seq[e].stop()}turing(e){}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.drawing.array,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.drawing.target,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.drawing.ratio;this.drawing=new l.ArrayVisualizer(e,t,n)}getSeqParam(e,t){return Array.isArray(e)?e[t%e.length]:e}parseNoteString(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if("."===e[0])return;let o="";if(o=/^[a-gA-G]/.test(e[0][0])?(0,a.pitchNameToMidi)(e[0]):(0,a.intervalToMidi)(e[0],this.min,this.max),o<0)return;let c=this.getSeqParam(this.seq[s].octave,n),l=this.getSeqParam(this.seq[s].velocity,n),h=this.getSeqParam(this.seq[s].sustain,n),u=this.getSeqParam(this.seq[s].subdivision,n),d=this.getSeqParam(this.seq[s].lag,n);try{this.triggerAttackRelease(o+12*c,l,h,t+e[1]*r.Time(u)+d)}catch(n){console.log("invalid note",o+12*c,l,h,t+e[1]*r.Time(u)+d)}}}},1297:e=>{"use strict";e.exports=JSON.parse('{"vco":{"color":[150,0,0],"boundingBox":{"x":10,"y":10,"width":30,"height":50},"offsets":{"x":12,"y":30},"groupA":["type"],"controlTypeA":"radioButton","controlTypeB":"knob","sizeA":0.8,"sizeB":0.75,"theme":"dark"},"vcf":{"color":[100,0,150],"boundingBox":{"x":30,"y":10,"width":40,"height":50},"offsets":{"x":10,"y":30},"groupA":["cutoff"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6},"vca":{"color":[100,50,100],"boundingBox":{"x":70,"y":10,"width":30,"height":50},"offsets":{"x":12,"y":30},"groupA":["level"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6},"env":{"color":[20,100,100],"boundingBox":{"x":10,"y":60,"width":50,"height":50},"offsets":{"x":8,"y":300},"groupA":[],"controlTypeA":"knob","controlTypeB":"fader","sizeA":0.8,"sizeB":1.2},"lfo":{"color":[20,0,100],"boundingBox":{"x":50,"y":70,"width":50,"height":50},"offsets":{"x":12,"y":30},"groupA":["rate"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6}}')},1313:(e,t,n)=>{"use strict";function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayVisualizer=void 0,function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}s.default=e,n&&n.set(e,s)}(n(5726)),t.ArrayVisualizer=class ArrayVisualizer{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Canvas",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.4;this.parent=e,this._array=t,this._target=document.getElementById(n),this._ratio=s,this._type="horizontal",this._color=["#FF5733","#33A1FF","#FF33B1","#33FF57","#5733FF","#FFBD33","#33FFBD","#FF3380"],this._backgroundColor="#3C3D37",this._activeColor="#ECDFCC",this._rows=1,this._columns=t.length,this._width=this._target.offsetWidth,this._height=this._width*this._ratio,this.elementWidth=this._width/this._columns,this.elementHeight=this._height/this._rows,this._min=0,this._max=1,this._minActive=0,this._maxActive=1,this._seqNum=0,this._displayLength=8,this._activeLength=8,this._subDivision="16n",this._enabled=!1,this._svg=null,this.index=0}createSVG(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("width",this._width),e.setAttribute("height",this._height),e.setAttribute("class","array-visualizer-svg"),e}clearSVG(){if(this._svg)for(;this._svg.firstChild;)this._svg.removeChild(this._svg.firstChild);const e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x",0),e.setAttribute("y",0),e.setAttribute("width",this._width),e.setAttribute("height",this._height),e.setAttribute("fill",this._backgroundColor),this._svg.appendChild(e)}startVisualFrame(){this.clearSVG(),this._min=this._minActive,this._max=this._maxActive,this._minActive=null,this._maxActive=null,this._seqNum=0,this._displayLength=this._activeLength,this._activeLength=8}visualize(e,t){switch(Array.isArray(e)&&e.every((e=>Array.isArray(e))),e.length>this._activeLength&&(this._activeLength=e.length),e=this.transformArray(e),this.calculateMinMax(e),t%=e.length,this._type){case"horizontal":this.drawHorizontalLines(t,e);break;case"vertical":this.drawVerticalBars(t,e);break;case"numbers":this.drawNumericValues(t,e);break;default:console.error("Unknown visualization type")}this._seqNum+=1}calculateMinMax(e){const t=e.filter((e=>!isNaN(e)&&""!==e&&null!==e)).map((e=>Number(e))),n=Math.min(...t)-.6,s=Math.max(...t)+.6;(null===this._minActive||n<this._minActive)&&(this._minActive=n),(null===this._maxActive||s>this._maxActive)&&(this._maxActive=s)}transformArray(e){const t={O:-1,o:1,X:0,x:0,1:3,2:2,3:1,"*":4,"^":5},n=["*","O","o","x","X","^"];let s=!1;for(let t in n)s=!!e.includes(n[t])||s;return s?e.map((e=>void 0!==t[e]?t[e]:e)):e}enable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e&&(this.parent.seqToDraw=e),this.parent.drawingLoop.start(),this._enabled||(this._enabled=!0,this._svg=this.createSVG(),this._target.appendChild(this._svg),this.parent.drawingLoop.start())}disable(){this._enabled&&(this._enabled=!1,this._target&&this._svg&&this._target.contains(this._svg)&&this._target.removeChild(this._svg),this._svg=null)}get type(){return this._type}set type(e){this._type=e}get color(){return this._color}set color(e){this._color=e}get ratio(){return this._ratio}set ratio(e){this._ratio=e,this._height=this._width*this._ratio,this._svg.setAttribute("height",this._height)}get rows(){return this._rows}set rows(e){this._rows=e}get columns(){return this._columns}set columns(e){this._columns=e}get enabled(){return this._enabled}set enabled(e){e?this.enable():this.disable()}drawHorizontalLines(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.elementWidth;(t=t.map((e=>(e-this._min)/(this._max-this._min)))).forEach(((t,s)=>{if("number"==typeof t&&!isNaN(t)){const r=document.createElementNS("http://www.w3.org/2000/svg","line"),o=s*n/this._displayLength,a=(s+1)*n/this._displayLength-2,c=this._height*(1-t);let l=this._height/(this._max-this._min)-2;l<2&&(l=2),r.setAttribute("x1",o),r.setAttribute("x2",a),r.setAttribute("y1",c),r.setAttribute("y2",c),e===s?r.setAttribute("stroke",this._activeColor):r.setAttribute("stroke",this._color[this._seqNum]),r.setAttribute("stroke-width",l),this._svg.appendChild(r)}}))}drawVerticalBars(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.elementWidth;t=t.map((e=>(e-this._min)/(this._max-this._min))),this.clearSVG(),t.forEach(((t,s)=>{if("number"==typeof t&&!isNaN(t)){const r=document.createElementNS("http://www.w3.org/2000/svg","rect"),o=s*(n/this._displayLength),a=t*this._height,c=this._height-a;let l=n/this._displayLength*.98;l=l>4?l-2:l,r.setAttribute("x",o),r.setAttribute("y",c),r.setAttribute("width",l),r.setAttribute("height",a),e===s?r.setAttribute("fill",this._activeColor):r.setAttribute("fill",this._color[this._seqNum]),this._svg.appendChild(r)}}))}drawNumericValues(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.elementWidth,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.elementHeight;const r=Math.ceil(this.this._displayLength/this._rows);t.forEach(((t,o)=>{const a=Math.floor(e/r),c=o%r,l=document.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",c*n+n/2),l.setAttribute("y",a*s+s/2),e==o?l.setAttribute("fill",this._activeColor):l.setAttribute("fill",this._color),l.setAttribute("font-size","16"),l.setAttribute("text-anchor","middle"),l.setAttribute("alignment-baseline","middle"),l.textContent=Math.round(t),this._svg.appendChild(l)}))}destroy(){this._target&&this._svg&&this._target.contains(this._svg)&&this._target.removeChild(this._svg),this._array=null,this._target=null,this._svg=null}}},1439:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Resonator=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Resonator=class Resonator{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=e,this.input=new r.Multiply(1),this.delay_1=new r.LowpassCombFilter({resonance:.95,dampening:1e4}),this.delay_2=new r.LowpassCombFilter({resonance:.95,dampening:1e4}),this.hpf=new r.Filter({frequency:20,type:"highpass",Q:0}),this.lpf=new r.Filter({frequency:1e4,type:"lowpass",Q:0}),this.vca=new r.Multiply,this.output=new r.Multiply(1),this.env=new r.Envelope,this.hpf_cutoff=new r.Signal(20),this.lpf_cutoff=new r.Signal(2e4),this.hpf_env_depth=new r.Multiply,this.lpf_env_depth=new r.Multiply,this.delayTime=new r.Signal(.1),this.delayTimeScalar=new r.Multiply(1),this.detune=new r.Multiply(1),this.env_depth=new r.Multiply(1),this.direct=new r.Signal(1),this.input.connect(this.delay_1),this.input.connect(this.delay_2),this.delay_1.connect(this.hpf),this.delay_2.connect(this.hpf),this.hpf.connect(this.lpf),this.lpf.connect(this.vca),this.vca.connect(this.output),this.delayTime.connect(this.delayTimeScalar),this.delayTimeScalar.connect(this.delay_1.delayTime),this.delayTimeScalar.connect(this.detune),this.detune.connect(this.delay_2.delayTime),this.hpf_cutoff.connect(this.hpf.frequency),this.lpf_cutoff.connect(this.lpf.frequency),this.env.connect(this.hpf_env_depth.factor),this.env.connect(this.hpf_env_depth.factor),this.hpf_env_depth.connect(this.hpf.frequency),this.lpf_env_depth.connect(this.lpf.frequency),this.env.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.direct.connect(this.vca.factor)}setCutoff=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.lpf_cutoff.setValueAtTime(e,t):this.lpf_cutoff.value=e};setFrequency=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.delayTime.setValueAtTime(1/e,t):this.delayTime.value=1/e};setFeedback=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=e<0?0:e>.9999?.9999:e,t?(this.delay_1.resonance.setValueAtTime(e,t),this.delay_2.resonance.setValueAtTime(e,t)):(this.delay_1.resonance.value=e,this.delay_2.resonance.value=e)};setADSR(e,t,n,s){this.env.attack=e>.001?e:.001,this.env.decay=t>.01?t:.01,this.env.sustain=Math.abs(n)<1?n:1,this.env.release=s>.01?s:.01}connect(e){this.output.connect(e)}}},1601:e=>{"use strict";e.exports=function(e){return e[1]}},1656:e=>{"use strict";e.exports=JSON.parse('{"themes":{"default":{"border":6,"backgroundColor":[240,240,240],"borderColor":[100,100,100],"accentColor":[0,128,255],"textColor":[0,0,0],"labelFont":"Arial","valueFont":"Helvetica","textFont":"Verdana","titleFont":"Verdana","borderRadius":5,"showValue":true},"dark":{"border":3,"backgroundColor":[20,20,20],"borderColor":[50,50,50],"accentColor":[255,0,0],"textColor":[255,255,255],"labelFont":"Helvetica","valueFont":"Arial","textFont":"Verdana","titleFont":"Verdana","borderRadius":8},"custom":{"border":2,"backgroundColor":[255,255,200],"borderColor":[0,128,0],"accentColor":[255,165,0],"textColor":[0,0,0],"labelFont":"Georgia","valueFont":"Courier New","textFont":"Palatino","titleFont":"Verdana","borderRadius":10}}}')},1729:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Spectrogram=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Spectrogram=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;this.target=document.getElementById(e),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.target.offsetWidth,this.height=t,this.canvas.width=this.width,this.canvas.height=this.height,this.target.appendChild(this.canvas),this.context.fillStyle="lightgrey",this.context.fillRect(0,0,this.width,this.height),this.audioContext=window.audioContext||new(window.AudioContext||window.webkitAudioContext),this.analyserNode=this.audioContext.createAnalyser(),this.analyserNode.smoothingTimeConstant=0,this.input=new s.Multiply,this._gain=new s.Signal(.1),this.input.connect(this.analyserNode),this._gain.connect(this.input.factor),this.analyserNode.fftSize=4096,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this._maxFrequency=24e3,this._minFrequency=0,this._timeResolution=2,this.currentX=0,this.running=!1;const getColor=e=>{let t=[255*Math.sin((e/255-.25)*Math.PI*3),e<128?0:255*Math.sin((e-128)/255*Math.PI*1),255*Math.sin(e/255*Math.PI*2.5)];return t=t.map((e=>Math.min(255,Math.max(0,e)))),`rgb(${t[0]}, ${t[1]}, ${t[2]})`};Object.defineProperty(this,"gain",{get:()=>this._gain.value,set:e=>{this._gain.value=e}}),Object.defineProperty(this,"minFrequency",{get:()=>this._minFrequency,set:e=>{this._minFrequency=Math.max(0,Math.min(e,this.maxFrequency))}}),Object.defineProperty(this,"maxFrequency",{get:()=>this._maxFrequency,set:e=>{this._maxFrequency=Math.max(this.minFrequency,Math.min(e,this.audioContext.sampleRate/2))}}),Object.defineProperty(this,"timeResolution",{get:()=>this._timeResolution,set:e=>{this._timeResolution=Math.max(1,e)}}),Object.defineProperty(this,"fftSize",{get:()=>this._timeResolution,set:e=>{Math.log2(e)%1!=0&&(e=Math.pow(2,Math.floor(Math.log2(e))),console.log("FFT size must be a power of two.")),console.log("Setting FFT size to ",e),this.analyserNode.fftSize=e,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength)}}),this.drawSpectrogram=function(){this.analyserNode.getByteFrequencyData(this.dataArray),this.context.clearRect(this.currentX,0,this._timeResolution,this.height);const e=this._maxFrequency-this._minFrequency,t=this.audioContext.sampleRate/2/this.bufferLength,n=Math.floor(this._minFrequency/t),s=Math.ceil(this._maxFrequency/t),r=this.height/(s-n);for(let o=n;o<=s;o++){const n=o*t,s=this.height-Math.floor((n-this._minFrequency)*(this.height/e)),a=this.dataArray[o],c=getColor(a);this.context.fillStyle=c,r>=1?this.context.fillRect(this.currentX,s-r,this._timeResolution,Math.ceil(r)):this.context.fillRect(this.currentX,s,this._timeResolution,1)}this.currentX+=this._timeResolution,this.currentX>=this.width&&(this.currentX=0),this.running&&requestAnimationFrame(this.drawSpectrogram)}.bind(this),this.start=function(){this.running=!0,requestAnimationFrame(this.drawSpectrogram)}.bind(this),this.stop=function(){this.running=!1}.bind(this),this.destroy=function(){this.stop(),this.target.removeChild(this.canvas),this.analyserNode.disconnect(),this.audioContext.close()}.bind(this),this.start()}},1768:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.ESPSynth=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(375),a=n(9710),c=s(n(9212)),l=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class ESPSynth extends l.MonophonicTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["triangle","sawtooth","square","square","square","noise"],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1,.5,.25,1];super(),this.gui=e,this.presets=c.default,this.name="ESPSynth",this.frequency=new r.Signal,this.pitchshift=new r.Multiply,this.vco=new o.MultiVCO(t,n),this.lfo=(new r.LFO).start(),this.vibratoSwitch=new r.Multiply,this.wahSwitch=new r.Multiply,this.vcf=new r.Filter,this.cutoff=new r.Signal,this.env=new r.Envelope,this.vcfVelocityDepth=new r.Signal(1),this.vcaVelocityDepth=new r.Signal(1),this.vcfEnvDepth=new r.Multiply,this.vcfVelocity=new r.Multiply(1),this.vcaEnvDepth=new r.Multiply,this.vcaVelocity=new r.Multiply(1),this.vca=new r.Multiply,this.output=new r.Multiply(1),this.frequency.connect(this.pitchshift),this.pitchshift.connect(this.vco.frequency),this.pitchshift.value=1,this.vco.connect(this.vcf),this.cutoff.connect(this.vcf.frequency),this.vcf.rolloff=-24,this.vcf.Q.value=1,this.lfo.connect(this.vibratoSwitch),this.vibratoSwitch.connect(this.vco.frequency),this.lfo.connect(this.wahSwitch),this.wahSwitch.connect(this.vcf.frequency),this.env.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcfVelocity),this.vcfVelocity.connect(this.vcf.frequency),this.vcfVelocityDepth.connect(this.vcfVelocity.factor),this.vcf.connect(this.vca),this.vcaEnvDepth.factor.value=1,this.env.connect(this.vcaEnvDepth),this.vcaEnvDepth.connect(this.vcaVelocity),this.vcaVelocity.connect(this.vca.factor),this.vcaVelocityDepth.connect(this.vcaVelocity.factor),this.dist=new r.Distortion,this.vca.connect(this.dist),this.chor=new r.Chorus(2.5,5,.9),this.dist.connect(this.chor),this.chor.connect(this.output),this.velo=10,this.amp=this.velo/127,this.vcfDynamicRange=0,this.vcaDynamicRange=0,null!==this.gui&&(this.initGui(),this.hideGui(),setTimeout((()=>{this.loadPreset("default")}),500))}octaveMapping=e=>void 0===e?1:"4"===e?2:"8"===e?1:"16"===e?.5:void 0;lfoControl=e=>{if(void 0!==e){let t=2*Math.abs(e-.5),n=50;e<.47?(this.lfo.min=-n*t,this.lfo.max=n*t,this.vibratoSwitch.value=1,this.wahSwitch.value=0):e>=.47&&e<=.49?(this.vibratoSwitch.value=0,this.wahSwitch.value=0):e>.49&&(this.lfo.min=0,this.lfo.max=n*t,this.vibratoSwitch.value=0,this.wahSwitch.value=100*t)}};triggerAttack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e=r.Midi(e).toFrequency(),t/=127,n?(this.env.triggerAttack(n),this.frequency.setValueAtTime(e,n),this.vcfVelocityDepth.rampTo((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),.03),this.vcaVelocityDepth.rampTo((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),.03)):(this.env.triggerAttack(),this.frequency.value=e,this.vcfVelocityDepth.rampTo((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),.03),this.vcaVelocityDepth.rampTo((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),.03))}triggerRelease(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?this.env.triggerRelease(e):this.env.triggerRelease()}triggerAttackRelease(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=r.Midi(e).toFrequency(),t/=127,s?(this.env.triggerAttackRelease(n,s),this.frequency.setValueAtTime(e,s),this.vcfVelocityDepth.setValueAtTime((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),s),this.vcaVelocityDepth.setValueAtTime((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),s)):(this.env.triggerAttackRelease(n),this.frequency.value=e,this.vcfVelocityDepth.rampTo((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcfDynamicRange],[1,1]]),.01),this.vcaVelocityDepth.rampTo((0,a.stepper)(t,0,1,[[0,0],[.001,1-this.vcaDynamicRange],[1,1]]),.01))}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}setADSR(e,t,n,s){this.env.attack=e>.001?e:.001,this.env.decay=t>.01?t:.01,this.env.sustain=Math.abs(n)<1?n:1,this.env.release=s>.01?s:.01}setOutputGain(e){this.output.factor.value=e}setVcoGain(e,t){this.vco.setGain(e,t)}initGui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;this.gui=e,this.octave_radio=this.gui.RadioButton({label:"octave",radioOptions:["4","8","16"],callback:e=>this.pitchshift.value=this.octaveMapping(e),x:5,y:50,size:1,orientation:"vertical"}),this.octave_radio.set("8"),this.octave_radio.accentColor=[122,132,132],this.octave_radio.borderColor=[178,192,191],this.triangle_fader=this.gui.Slider({label:"tri",callback:e=>{this.setVcoGain(0,e)},x:11,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.triangle_fader.accentColor=[255,162,1],this.triangle_fader.borderColor=[20,20,20],this.triangle_fader.set(1),this.saw_fader=this.gui.Slider({label:"saw",callback:e=>{this.setVcoGain(1,e)},x:17,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.saw_fader.accentColor=[255,162,1],this.saw_fader.borderColor=[20,20,20],this.saw_fader.set(1),this.square_fader=this.gui.Slider({label:"squ",callback:e=>{this.setVcoGain(2,e)},x:23,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.square_fader.accentColor=[255,162,1],this.square_fader.borderColor=[20,20,20],this.square_fader.set(1),this.octave_down_fader=this.gui.Slider({label:"-1",callback:e=>{this.setVcoGain(3,e)},x:29,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.octave_down_fader.accentColor=[255,162,1],this.octave_down_fader.borderColor=[20,20,20],this.octave_down_fader.set(1),this.two_octave_down_fader=this.gui.Slider({label:"-2",callback:e=>{this.setVcoGain(4,e)},x:35,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.two_octave_down_fader.accentColor=[255,162,1],this.two_octave_down_fader.borderColor=[20,20,20],this.two_octave_down_fader.set(1),this.noise_fader=this.gui.Slider({label:"noise",callback:e=>{this.setVcoGain(5,e)},x:41,y:50,size:1.5,min:1e-4,max:2,orientation:"vertical",showValue:!1}),this.noise_fader.accentColor=[255,162,1],this.noise_fader.borderColor=[20,20,20],this.noise_fader.set(1),this.lfo_intensity_knob=this.gui.Knob({label:"vib/wah",callback:e=>{this.lfoControl(e)},x:20,y:23,size:1.1,showValue:!1,min:1e-4,max:.95}),this.lfo_intensity_knob.set(.48),this.lfo_intensity_knob.borderColor=[178,192,191],this.lfo_intensity_knob.accentColor=[255,162,1],this.lfo_intensity_knob.border=5,this.lfoControl(.48),this.lfo_speed_knob=this.gui.Knob({label:"speed",callback:e=>{this.lfo.frequency.value=e},x:35,y:23,size:1.1,showValue:!1,min:.01,max:20,curve:2.5}),this.lfo_speed_knob.set(10),this.lfo.frequency.value=10,this.lfo_speed_knob.borderColor=[178,192,191],this.lfo_speed_knob.accentColor=[255,162,1],this.lfo_speed_knob.border=5,this.cutoff_frequency_knob=this.gui.Knob({label:"frequency",callback:e=>{this.cutoff.value=e},x:53,y:25,size:1.4,showValue:!1,min:50,max:2500,curve:2}),this.cutoff_frequency_knob.set(1200),this.cutoff.value=1200,this.cutoff_frequency_knob.borderColor=[178,192,191],this.cutoff_frequency_knob.accentColor=[255,162,1],this.cutoff_frequency_knob.border=5,this.resonance_knob=this.gui.Knob({label:"resonance",callback:e=>{this.vcf.Q.value=e},x:53,y:72,size:1.4,min:.99999,max:18,curve:2,showValue:!1}),this.resonance_knob.set(1),this.vcf.Q.value=1,this.resonance_knob.borderColor=[178,192,191],this.resonance_knob.accentColor=[255,162,1],this.resonance_knob.border=5,this.asdr_int_knob=this.gui.Knob({label:"VCF Env Depth",callback:e=>{this.vcfEnvDepth.factor.value=e},x:66,y:34,size:.85,curve:3,min:0,max:5e3,showValue:!1}),this.asdr_int_knob.set(.01),this.asdr_int_knob.borderColor=[178,192,191],this.asdr_int_knob.accentColor=[255,162,1],this.asdr_int_knob.border=5,this.volume_knob=this.gui.Knob({label:"volume",callback:e=>{this.output.factor.value=e},x:66,y:68,size:.85,min:1e-4,max:1.5,showValue:!1}),this.volume_knob.set(1),this.output.factor.value=1,this.volume_knob.borderColor=[178,192,191],this.volume_knob.accentColor=[255,162,1],this.volume_knob.border=5,this.velocity_filter_knob=this.gui.Knob({label:"velo filter",callback:e=>{this.vcfDynamicRange=e},x:77,y:15,size:.85,min:.01,max:.99,showValue:!1}),this.velocity_filter_knob.set(.99),this.velocity_filter_knob.borderColor=[178,192,191],this.velocity_filter_knob.accentColor=[255,162,1],this.velocity_filter_knob.border=5,this.velocity_volume_knob=this.gui.Knob({label:"velo volume",callback:e=>{this.vcaDynamicRange=e},x:77,y:83,size:.85,min:.01,max:.99,showValue:!1}),this.velocity_volume_knob.set(.99),this.velocity_volume_knob.borderColor=[178,192,191],this.velocity_volume_knob.accentColor=[255,162,1],this.velocity_volume_knob.border=5,this.attack_fader=this.gui.Slider({label:"A",callback:e=>{this.env.attack=e},x:76,y:36,size:1,curve:2,min:.01,max:10,orientation:"vertical",showValue:!1}),this.attack_fader.accentColor=[255,162,1],this.attack_fader.borderColor=[20,20,20],this.env.attack=.1,this.attack_fader.set(.1),this.decay_fader=this.gui.Slider({label:"D",callback:e=>{this.env.decay=e},x:82,y:36,size:1,curve:2,min:.01,max:10,orientation:"vertical",showValue:!1}),this.decay_fader.accentColor=[255,162,1],this.decay_fader.borderColor=[20,20,20],this.env.decay=.1,this.decay_fader.set(.1),this.sustain_fader=this.gui.Slider({label:"S",callback:e=>{this.env.sustain=e},x:88,y:36,size:1,min:1e-4,max:1,orientation:"vertical",showValue:!1}),this.sustain_fader.accentColor=[255,162,1],this.sustain_fader.borderColor=[20,20,20],this.sustain_fader.set(1),this.env.sustain=1,this.release_fader=this.gui.Slider({label:"R",callback:e=>{this.env.release=e},x:94,y:36,size:1,min:.1,max:20,curve:2,orientation:"vertical",showValue:!1}),this.release_fader.accentColor=[255,162,1],this.release_fader.borderColor=[20,20,20],this.release_fader.set(1),this.env.release=1,this.chorus_filter_knob=this.gui.Knob({label:"chorus",callback:e=>{this.chor.wet.value=e},x:91,y:15,size:.85,min:1e-4,max:1,showValue:!1}),this.chorus_filter_knob.set(1e-4),this.chorus_filter_knob.borderColor=[178,192,191],this.chorus_filter_knob.accentColor=[255,162,1],this.chorus_filter_knob.border=5,this.dist_volume_knob=this.gui.Knob({label:"Overdrive",callback:e=>{this.dist.distortion=e},x:91,y:83,size:.85,min:1e-4,max:1,showValue:!1}),this.dist_volume_knob.set(1e-4),this.dist_volume_knob.borderColor=[178,192,191],this.dist_volume_knob.accentColor=[255,162,1],this.dist_volume_knob.border=5,this.gui_elements=[this.octave_radio,this.triangle_fader,this.saw_fader,this.square_fader,this.octave_down_fader,this.two_octave_down_fader,this.noise_fader,this.lfo_intensity_knob,this.lfo_speed_knob,this.cutoff_frequency_knob,this.resonance_knob,this.asdr_int_knob,this.volume_knob,this.velocity_filter_knob,this.velocity_volume_knob,this.attack_fader,this.decay_fader,this.sustain_fader,this.release_fader,this.chorus_filter_knob,this.dist_volume_knob]}}t.ESPSynth=ESPSynth},1951:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Oscilloscope=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Oscilloscope=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Canvas",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4;this.target=document.getElementById(e),this.width=this.target.offsetWidth,this.height=this.width*t,this.wave=document.createElementNS("http://www.w3.org/2000/svg","path"),this.wave.setAttribute("class","oscilloscope__wave"),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("width",this.width),this.svg.setAttribute("height",this.height),this.svg.setAttribute("class","oscilloscope__svg"),this.svg.appendChild(this.wave),this.target.appendChild(this.svg),this.audioContext=window.audioContext,this.running=!0,this.hasAudio=!1,this.input=new s.Multiply,this.gain=new s.Signal(1),this.analyserNode=this.audioContext.createAnalyser(),this.input.connect(this.analyserNode),this.gain.connect(this.input.factor),this.analyserNode.fftSize=2048,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.yScaling=1,this.xScaling=2,this.zoom=1.25,this.enableTrigger=1,this.threshold=128,this.constructor=function(){this.start(),console.log("Oscilloscope started")},this.setFftSize=function(e){Math.log2(e)%1!=0&&(e=Math.pow(2,Math.floor(Math.log2(e))),console.log("FFT size must be a power of two.")),console.log("Setting FFT size to",e),this.analyserNode.fftSize=e,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength)}.bind(this),this.drawWave=function(){var e="M";this.analyserNode.getByteTimeDomainData(this.dataArray);var t=0;let n=this.threshold<=1?128*this.threshold+127:this.threshold;for(var s=1;s<this.bufferLength;s++)if(this.dataArray[s]>n&&this.dataArray[s-1]<=n){t=s;break}0===this.enableTrigger&&(t=0);let r=0,o=this.height/2;for(e+=`${r} ${o}, `,this.xScaling=this.zoom<.1?.2:2*this.zoom,s=0;s<this.bufferLength-t;s++){let n=(255-this.dataArray[s+t])*(1/this.yScaling);if(r=this.width/this.bufferLength*s*this.xScaling,o=this.height/2*(n/128),r>this.width-10)break;e+=`${r} ${o}, `}this.wave.setAttribute("d",e),this.wave.setAttribute("stroke","black"),this.wave.setAttribute("stroke-width","2"),this.wave.setAttribute("fill","none"),this.running&&window.requestAnimationFrame(this.drawWave)}.bind(this),this.start=function(){this.running=!0,window.requestAnimationFrame(this.drawWave)}.bind(this),this.stop=function(){this.running=!1}.bind(this),this.disconnect=function(){this.target.removeChild(this.svg)}.bind(this),this.connect=function(e){this.target=document.getElementById(e),this.target.appendChild(this.svg)}.bind(this),this.destroy=function(){this.stop(),setTimeout((()=>{this.target.contains(this.svg)&&this.target.removeChild(this.svg),this.analyserNode.disconnect(),this.input.disconnect(),this.gain.dispose(),this.target=null,this.wave=null,this.svg=null,this.audioContext=null,this.input=null,this.gain=null,this.analyserNode=null,this.dataArray=null,console.log("Oscilloscope destroyed.")}),100)}.bind(this),this.start()}},2049:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Snare=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Snare=class Snare{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.name="Snare",this.gui=t,this.output=new r.Multiply(1),this.vco1=new r.Oscillator(e).start(),this.vco2=new r.Oscillator(e+150).start(),this.vca1=new r.Multiply(.5),this.headsEnvelope=new r.Envelope({attack:.001,decay:.1,sustain:0,release:.1}),this.vco1.connect(this.vca1),this.vco2.connect(this.vca1),this.headsEnvelope.connect(this.vca1.factor),this.vca1.connect(this.output),this.rattle=new r.Noise("white").start(),this.ratFilter=new r.Filter({type:"bandpass",frequency:1500,Q:1}),this.vca2=new r.Multiply(.5),this.ratEnvelope=new r.Envelope({attack:.001,decay:.2,sustain:0,release:.1}),this.rattle.connect(this.ratFilter),this.ratFilter.connect(this.vca2),this.ratEnvelope.connect(this.vca2.factor),this.vca2.connect(this.output)}trigger(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(this.ratEnvelope.triggerAttackRelease(.01,e),this.headsEnvelope.triggerAttackRelease(.01,e)):(this.ratEnvelope.triggerAttackRelease(.01),this.headsEnvelope.triggerAttackRelease(.01))}}},2188:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Simpler=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(3670)),a=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class ExtendedSampler extends r.Sampler{constructor(e){super(e),this.startTime=0}ftomf(e){return 69+12*Math.log2(e/440)}triggerAttack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Array.isArray(e)||(e=[e]),e.forEach((e=>{const s=this.ftomf(new r.FrequencyClass(this.context,e).toFrequency()),o=Math.round(s),a=s-o,c=this._findClosest(o),l=o-c,h=this._buffers.get(l),u=r.intervalToFrequencyRatio(c+a),d=new r.ToneBufferSource({url:h,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);d.start(t,this.startTime,h.duration/u,n),Array.isArray(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const e=this._activeSources.get(o),t=e.indexOf(d);-1!==t&&e.splice(t,1)}}})),this}}class Simpler extends a.MonophonicTemplate{constructor(e){super(),this.presets=o.default,this.name="Simpler",this.sampler=new ExtendedSampler,this.vcf=new r.Filter,this.vca=new r.Multiply(1),this.output=new r.Multiply(1),this.cutoffSig=new r.Signal(1e4),this.cutoffSig.connect(this.vcf.frequency),this.vcf.frequency.value=1e4,this.vcf.rolloff=-12,this.vcf.Q.value=1,this.filterEnv=new r.Envelope,this.vcfEnvDepth=new r.Multiply,this.filterEnv.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcf.frequency),this.vcf.connect(this.vca),this.vca.connect(this.output),this.sample="";let t=[{name:"volume",min:-36,max:0,curve:1,callback:e=>{this.sampler.volume.value=Math.pow(10,e/20)}},{name:"attack",min:.01,max:1,curve:2,callback:e=>{this.sampler.attack=e}},{name:"release",min:.01,max:10,curve:2,callback:e=>{this.sampler.release=e}},{name:"cutoff",min:100,max:1e4,curve:2,callback:e=>this.cutoffSig.value=e},{name:"Q",min:0,max:20,curve:2,callback:e=>this.vcf.Q.value=e},{name:"filterEnvDepth",min:0,max:5e3,curve:2,callback:e=>this.vcfEnvDepth.factor.value=e}];this.param=this.generateParameters(t),this.createAccessors(this,this.param),this.sampleFiles={bell:["C4","berklee/bell_1.mp3"],bell1:["C4","berklee/bell_1a.mp3"],bell2:["C4","berklee/bell_2a.mp3"],bell3:["C4","berklee/bell_mallet_2.mp3"],horn:["C4","berklee/casiohorn2.mp3"],chotone:["C4","berklee/chotone_c4_!.mp3"],voice:["C4","berklee/femalevoice_aa_Db4.mp3"],kalimba:["C4","berklee/Kalimba_1.mp3"],dreamyPiano:["A5","salamander/A5.mp3"],softPiano:["A4","salamander/A4.mp3"],piano:[45,"salamander/A3.mp3"],casio:["C4","casio/C2.mp3"]},e&&this.loadSample(e)}load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"piano";this.loadSample(e)}loadSample(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.sampler&&(this.sampler.dispose(),this.sampler.releaseAll()),null===e)return void this.loadSampleToSampler();if("number"==typeof e){const t=Object.keys(this.sampleFiles);e=Math.floor(e)%t.length,e=t[e]}if(!(e in this.sampleFiles))return void console.error(`The sample "${e}" is not available.`);console.log(`Simpler loading ${e}`),this.sample=e,this.baseUrl="https://tonejs.github.io/audio/";const t=this.sampleFiles[this.sample][1],n=this.sampleFiles[this.sample][0];console.log(n,t),this.sampler=new ExtendedSampler({urls:{60:this.baseUrl.concat(t)}}).connect(this.vcf)}listSamples(){const e=Object.keys(this.sampleFiles);console.log(e)}triggerAttack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.sampler.release=this.release,e=r.Midi(e).toFrequency(),t/=127,n?(this.sampler.triggerAttack(e,n,t),this.filterEnv.triggerAttack(n),this.vca.factor.setValueAtTime(t,n)):(this.sampler.triggerAttack(e),this.filterEnv.triggerAttack(),this.vca.factor.value=t)}triggerRelease(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=r.Midi(e).toFrequency(),t?(this.sampler.triggerRelease(e,t),this.filterEnv.triggerRelease(t)):(this.sampler.triggerRelease(e),this.filterEnv.triggerRelease())}triggerAttackRelease(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.param.release=this.release,e=r.Midi(e).toFrequency(),t/=127,s&&(this.sampler.triggerAttackRelease(e,n,s,t),this.filterEnv.triggerAttackRelease(n,s),this.vca.factor.setValueAtTime(t,s))}setADSR(e,t,n,s){this.sampler.attack=e>.001?e:.001,this.sampler.release=s>.01?s:.01}loadSampleToSampler(){const e=document.createElement("input");e.type="file",e.accept="audio/*",e.onchange=e=>{const t=e.target.files[0];if(!t)return void console.log("No file selected");const n=new FileReader;n.onload=()=>{this.sampler=new ExtendedSampler({urls:{60:n.result}}).connect(this.vcf),console.log("Audio loaded into sampler")},n.readAsDataURL(t)},e.click()}}t.Simpler=Simpler},2271:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TimingProvider:()=>Z});var s=n(9762),extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}function __generator(e,t){var n,s,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=verb(0),a.throw=verb(1),a.return=verb(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(c){return function(l){return function step(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(o=0)),o;)try{if(n=1,s&&(r=2&c[0]?s.return:c[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,c[1])).done)return r;switch(s=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,s=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],s=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s,r,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(s=o.next()).done;)a.push(s.value)}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function __spreadArray(e,t,n){if(n||2===arguments.length)for(var s,r=0,o=t.length;r<o;r++)!s&&r in t||(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function isFunction(e){return"function"==typeof e}function createErrorClass(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var r=createErrorClass((function(e){return function UnsubscriptionErrorImpl(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function arrRemove(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var o=function(){function Subscription(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return Subscription.prototype.unsubscribe=function(){var e,t,n,s,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=__values(a),l=c.next();!l.done;l=c.next())l.value.remove(this)}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else a.remove(this);var h=this.initialTeardown;if(isFunction(h))try{h()}catch(e){o=e instanceof r?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var d=__values(u),f=d.next();!f.done;f=d.next()){var v=f.value;try{execFinalizer(v)}catch(e){o=null!=o?o:[],e instanceof r?o=__spreadArray(__spreadArray([],__read(o)),__read(e.errors)):o.push(e)}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(n)throw n.error}}}if(o)throw new r(o)}},Subscription.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)execFinalizer(e);else{if(e instanceof Subscription){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}},Subscription.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},Subscription.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},Subscription.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&arrRemove(t,e)},Subscription.prototype.remove=function(e){var t=this._finalizers;t&&arrRemove(t,e),e instanceof Subscription&&e._removeParent(this)},Subscription.EMPTY=((e=new Subscription).closed=!0,e),Subscription;var e}(),a=o.EMPTY;function isSubscription(e){return e instanceof o||e&&"closed"in e&&isFunction(e.remove)&&isFunction(e.add)&&isFunction(e.unsubscribe)}function execFinalizer(e){isFunction(e)?e():e.unsubscribe()}var c=null,l=null,h=void 0,u=!1,d=!1,f={setTimeout:function(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var r=f.delegate;return(null==r?void 0:r.setTimeout)?r.setTimeout.apply(r,__spreadArray([e,t],__read(n))):setTimeout.apply(void 0,__spreadArray([e,t],__read(n)))},clearTimeout:function(e){var t=f.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function reportUnhandledError(e){f.setTimeout((function(){if(!c)throw e;c(e)}))}function noop(){}var v=createNotification("C",void 0,void 0);function createNotification(e,t,n){return{kind:e,value:t,error:n}}var g=null;function errorContext(e){if(u){var t=!g;if(t&&(g={errorThrown:!1,error:null}),e(),t){var n=g,s=n.errorThrown,r=n.error;if(g=null,s)throw r}}else e()}var m=function(e){function Subscriber(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,isSubscription(t)&&t.add(n)):n.destination=w,n}return __extends(Subscriber,e),Subscriber.create=function(e,t,n){return new _(e,t,n)},Subscriber.prototype.next=function(e){this.isStopped?handleStoppedNotification(function nextNotification(e){return createNotification("N",e,void 0)}(e),this):this._next(e)},Subscriber.prototype.error=function(e){this.isStopped?handleStoppedNotification(function errorNotification(e){return createNotification("E",void 0,e)}(e),this):(this.isStopped=!0,this._error(e))},Subscriber.prototype.complete=function(){this.isStopped?handleStoppedNotification(v,this):(this.isStopped=!0,this._complete())},Subscriber.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},Subscriber.prototype._next=function(e){this.destination.next(e)},Subscriber.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},Subscriber.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},Subscriber}(o),y=Function.prototype.bind;function bind(e,t){return y.call(e,t)}var b=function(){function ConsumerObserver(e){this.partialObserver=e}return ConsumerObserver.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){handleUnhandledError(e)}},ConsumerObserver.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){handleUnhandledError(e)}else handleUnhandledError(e)},ConsumerObserver.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){handleUnhandledError(e)}},ConsumerObserver}(),_=function(e){function SafeSubscriber(t,n,s){var r,o,a=e.call(this)||this;return isFunction(t)||!t?r={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=s?s:void 0}:a&&d?((o=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},r={next:t.next&&bind(t.next,o),error:t.error&&bind(t.error,o),complete:t.complete&&bind(t.complete,o)}):r=t,a.destination=new b(r),a}return __extends(SafeSubscriber,e),SafeSubscriber}(m);function handleUnhandledError(e){u?function captureError(e){u&&g&&(g.errorThrown=!0,g.error=e)}(e):reportUnhandledError(e)}function handleStoppedNotification(e,t){var n=l;n&&f.setTimeout((function(){return n(e,t)}))}var w={closed:!0,next:noop,error:function defaultErrorHandler(e){throw e},complete:noop},k="function"==typeof Symbol&&Symbol.observable||"@@observable";function identity(e){return e}var x=function(){function Observable(e){e&&(this._subscribe=e)}return Observable.prototype.lift=function(e){var t=new Observable;return t.source=this,t.operator=e,t},Observable.prototype.subscribe=function(e,t,n){var s=this,r=function isSubscriber(e){return e&&e instanceof m||function isObserver(e){return e&&isFunction(e.next)&&isFunction(e.error)&&isFunction(e.complete)}(e)&&isSubscription(e)}(e)?e:new _(e,t,n);return errorContext((function(){var e=s,t=e.operator,n=e.source;r.add(t?t.call(r,n):n?s._subscribe(r):s._trySubscribe(r))})),r},Observable.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},Observable.prototype.forEach=function(e,t){var n=this;return new(t=getPromiseCtor(t))((function(t,s){var r=new _({next:function(t){try{e(t)}catch(e){s(e),r.unsubscribe()}},error:s,complete:t});n.subscribe(r)}))},Observable.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},Observable.prototype[k]=function(){return this},Observable.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function pipeFromArray(e){return 0===e.length?identity:1===e.length?e[0]:function piped(t){return e.reduce((function(e,t){return t(e)}),t)}}(e)(this)},Observable.prototype.toPromise=function(e){var t=this;return new(e=getPromiseCtor(e))((function(e,n){var s;t.subscribe((function(e){return s=e}),(function(e){return n(e)}),(function(){return e(s)}))}))},Observable.create=function(e){return new Observable(e)},Observable}();function getPromiseCtor(e){var t;return null!==(t=null!=e?e:h)&&void 0!==t?t:Promise}var S=createErrorClass((function(e){return function ObjectUnsubscribedErrorImpl(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),C=function(e){function Subject(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return __extends(Subject,e),Subject.prototype.lift=function(e){var t=new M(this,this);return t.operator=e,t},Subject.prototype._throwIfClosed=function(){if(this.closed)throw new S},Subject.prototype.next=function(e){var t=this;errorContext((function(){var n,s;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var r=__values(t.currentObservers),o=r.next();!o.done;o=r.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(n)throw n.error}}}}))},Subject.prototype.error=function(e){var t=this;errorContext((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},Subject.prototype.complete=function(){var e=this;errorContext((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},Subject.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(Subject.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),Subject.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},Subject.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},Subject.prototype._innerSubscribe=function(e){var t=this,n=this,s=n.hasError,r=n.isStopped,c=n.observers;return s||r?a:(this.currentObservers=null,c.push(e),new o((function(){t.currentObservers=null,arrRemove(c,e)})))},Subject.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,s=t.thrownError,r=t.isStopped;n?e.error(s):r&&e.complete()},Subject.prototype.asObservable=function(){var e=new x;return e.source=this,e},Subject.create=function(e,t){return new M(e,t)},Subject}(x),M=function(e){function AnonymousSubject(t,n){var s=e.call(this)||this;return s.destination=t,s.source=n,s}return __extends(AnonymousSubject,e),AnonymousSubject.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},AnonymousSubject.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},AnonymousSubject.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},AnonymousSubject.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:a},AnonymousSubject}(C);function operate(e){return function(t){if(function hasLift(e){return isFunction(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function createOperatorSubscriber(e,t,n,s,r){return new O(e,t,n,s,r)}var O=function(e){function OperatorSubscriber(t,n,s,r,o,a){var c=e.call(this,t)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,c._error=r?function(e){try{r(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=s?function(){try{s()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,c}return __extends(OperatorSubscriber,e),OperatorSubscriber.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},OperatorSubscriber}(m);function map(e,t){return operate((function(n,s){var r=0;n.subscribe(createOperatorSubscriber(s,(function(n){s.next(e.call(t,n,r++))})))}))}var isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function isPromise(e){return isFunction(null==e?void 0:e.then)}function isInteropObservable(e){return isFunction(e[k])}function isAsyncIterable(e){return Symbol.asyncIterator&&isFunction(null==e?void 0:e[Symbol.asyncIterator])}function createInvalidObservableTypeError(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var T=function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function isIterable(e){return isFunction(null==e?void 0:e[T])}function readableStreamLikeToAsyncGenerator(e){return function __asyncGenerator(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=n.apply(e,t||[]),o=[];return s=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),verb("next"),verb("throw"),verb("return",(function awaitReturn(e){return function(t){return Promise.resolve(t).then(e,reject)}})),s[Symbol.asyncIterator]=function(){return this},s;function verb(e,t){r[e]&&(s[e]=function(t){return new Promise((function(n,s){o.push([e,t,n,s])>1||resume(e,t)}))},t&&(s[e]=t(s[e])))}function resume(e,t){try{!function step(e){e.value instanceof __await?Promise.resolve(e.value.v).then(fulfill,reject):settle(o[0][2],e)}(r[e](t))}catch(e){settle(o[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),o.shift(),o.length&&resume(o[0][0],o[0][1])}}(this,arguments,(function readableStreamLikeToAsyncGenerator_1(){var t,n,s;return __generator(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,__await(t.read())];case 3:return n=r.sent(),s=n.value,n.done?[4,__await(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,__await(s)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function isReadableStreamLike(e){return isFunction(null==e?void 0:e.getReader)}function innerFrom(e){if(e instanceof x)return e;if(null!=e){if(isInteropObservable(e))return function fromInteropObservable(e){return new x((function(t){var n=e[k]();if(isFunction(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}))}(e);if(isArrayLike(e))return function fromArrayLike(e){return new x((function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()}))}(e);if(isPromise(e))return function fromPromise(e){return new x((function(t){e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,reportUnhandledError)}))}(e);if(isAsyncIterable(e))return fromAsyncIterable(e);if(isIterable(e))return function fromIterable(e){return new x((function(t){var n,s;try{for(var r=__values(e),o=r.next();!o.done;o=r.next()){var a=o.value;if(t.next(a),t.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(n)throw n.error}}t.complete()}))}(e);if(isReadableStreamLike(e))return function fromReadableStreamLike(e){return fromAsyncIterable(readableStreamLikeToAsyncGenerator(e))}(e)}throw createInvalidObservableTypeError(e)}function fromAsyncIterable(e){return new x((function(t){(function process(e,t){var n,s,r,o;return function __awaiter(e,t,n,s){return new(n||(n=Promise))((function(r,o){function fulfilled(e){try{step(s.next(e))}catch(e){o(e)}}function rejected(e){try{step(s.throw(e))}catch(e){o(e)}}function step(e){e.done?r(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var a,c;return __generator(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=__values(e),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(n){t[n]=e[n]&&function(t){return new Promise((function(s,r){!function settle(e,t,n,s){Promise.resolve(s).then((function(t){e({value:t,done:n})}),t)}(s,r,(t=e[n](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,n.next()];case 2:if((s=l.sent()).done)return[3,4];if(a=s.value,t.next(a),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=l.sent(),r={error:c},[3,11];case 6:return l.trys.push([6,,9,10]),s&&!s.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function executeSchedule(e,t,n,s,r){void 0===s&&(s=0),void 0===r&&(r=!1);var o=t.schedule((function(){n(),r?e.add(this.schedule(null,s)):this.unsubscribe()}),s);if(e.add(o),!r)return o}function mergeMap(e,t,n){return void 0===n&&(n=Infinity),isFunction(t)?mergeMap((function(n,s){return map((function(e,r){return t(n,e,s,r)}))(innerFrom(e(n,s)))}),n):("number"==typeof t&&(n=t),operate((function(t,s){return function mergeInternals(e,t,n,s,r,o,a,c){var l=[],h=0,u=0,d=!1,checkComplete=function(){!d||l.length||h||t.complete()},outerNext=function(e){return h<s?doInnerSub(e):l.push(e)},doInnerSub=function(e){o&&t.next(e),h++;var c=!1;innerFrom(n(e,u++)).subscribe(createOperatorSubscriber(t,(function(e){null==r||r(e),o?outerNext(e):t.next(e)}),(function(){c=!0}),void 0,(function(){if(c)try{h--;for(var _loop_1=function(){var e=l.shift();a?executeSchedule(t,a,(function(){return doInnerSub(e)})):doInnerSub(e)};l.length&&h<s;)_loop_1();checkComplete()}catch(e){t.error(e)}})))};return e.subscribe(createOperatorSubscriber(t,outerNext,(function(){d=!0,checkComplete()}))),function(){null==c||c()}}(t,s,e,n)})))}function mergeAll(e){return void 0===e&&(e=Infinity),mergeMap(identity,e)}var q=new x((function(e){return e.complete()}));function isScheduler(e){return e&&isFunction(e.schedule)}function last(e){return e[e.length-1]}function popResultSelector(e){return isFunction(last(e))?e.pop():void 0}function popScheduler(e){return isScheduler(last(e))?e.pop():void 0}function observeOn(e,t){return void 0===t&&(t=0),operate((function(n,s){n.subscribe(createOperatorSubscriber(s,(function(n){return executeSchedule(s,e,(function(){return s.next(n)}),t)}),(function(){return executeSchedule(s,e,(function(){return s.complete()}),t)}),(function(n){return executeSchedule(s,e,(function(){return s.error(n)}),t)})))}))}function subscribeOn(e,t){return void 0===t&&(t=0),operate((function(n,s){s.add(e.schedule((function(){return n.subscribe(s)}),t))}))}function scheduleAsyncIterable(e,t){if(!e)throw new Error("Iterable cannot be null");return new x((function(n){executeSchedule(n,t,(function(){var s=e[Symbol.asyncIterator]();executeSchedule(n,t,(function(){s.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function from(e,t){return t?function scheduled(e,t){if(null!=e){if(isInteropObservable(e))return function scheduleObservable(e,t){return innerFrom(e).pipe(subscribeOn(t),observeOn(t))}(e,t);if(isArrayLike(e))return function scheduleArray(e,t){return new x((function(n){var s=0;return t.schedule((function(){s===e.length?n.complete():(n.next(e[s++]),n.closed||this.schedule())}))}))}(e,t);if(isPromise(e))return function schedulePromise(e,t){return innerFrom(e).pipe(subscribeOn(t),observeOn(t))}(e,t);if(isAsyncIterable(e))return scheduleAsyncIterable(e,t);if(isIterable(e))return function scheduleIterable(e,t){return new x((function(n){var s;return executeSchedule(n,t,(function(){s=e[T](),executeSchedule(n,t,(function(){var e,t,r;try{t=(e=s.next()).value,r=e.done}catch(e){return void n.error(e)}r?n.complete():n.next(t)}),0,!0)})),function(){return isFunction(null==s?void 0:s.return)&&s.return()}}))}(e,t);if(isReadableStreamLike(e))return function scheduleReadableStreamLike(e,t){return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(e),t)}(e,t)}throw createInvalidObservableTypeError(e)}(e,t):innerFrom(e)}function merge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=popScheduler(e),s=function popNumber(e,t){return"number"==typeof last(e)?e.pop():t}(e,Infinity),r=e;return r.length?1===r.length?innerFrom(r[0]):mergeAll(s)(from(r,n)):q}function throwError(e,t){var n=isFunction(e)?e:function(){return e},init=function(e){return e.error(n())};return new x(t?function(e){return t.schedule(init,0,e)}:init)}function finalize(e){return operate((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}const R=Symbol.observable||"@@observable",to_observer_noop=()=>{},rethrow=e=>{throw e},emitNotSupportedError=e=>(e.error(new Error("The required browser API seems to be not supported.")),()=>{}),A="undefined"==typeof window?null:window,P=((e,t)=>{const emptyFunction=()=>{};return e=>{const subscribe=(...n)=>{const s=e((e=>"function"==typeof e[0])(n)?t({next:n[0]}):t(...n));return void 0!==s?s:emptyFunction};return subscribe[Symbol.observable]=()=>({subscribe:(...e)=>({unsubscribe:subscribe(...e)})}),function patch(e){return Symbol.observable||("function"==typeof e&&e.prototype&&e.prototype[Symbol.observable]?(e.prototype[R]=e.prototype[Symbol.observable],delete e.prototype[Symbol.observable]):(e[R]=e[Symbol.observable],delete e[Symbol.observable])),e}(subscribe)}})(0,(function toObserver(e){return e?e.next&&e.error&&e.complete?e:{complete:(e.complete??to_observer_noop).bind(e),error:(e.error??rethrow).bind(e),next:(e.next??to_observer_noop).bind(e)}:{complete:to_observer_noop,error:rethrow,next:to_observer_noop}})),E=(((e,t,n)=>{})(emitNotSupportedError,A,P),(e=>{})(P),(e=>{})(P),(e=>(t,n,s)=>e((e=>{const listener=t=>e.next(t);return t.addEventListener(n,listener,s),()=>t.removeEventListener(n,listener,s)})))(P)),D=((e,t,n)=>()=>n((n=>{if(null===t||void 0===t.navigator||void 0===t.navigator.onLine)return e(n);const emitFalse=()=>n.next(!1),emitTrue=()=>n.next(!0);return t.addEventListener("offline",emitFalse),t.addEventListener("online",emitTrue),n.next(t.navigator.onLine),()=>{t.removeEventListener("offline",emitFalse),t.removeEventListener("online",emitTrue)}})))(emitNotSupportedError,A,P);function concat(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function concatAll(){return mergeAll(1)}()(from(e,popScheduler(e)))}var j=createErrorClass((function(e){return function EmptyErrorImpl(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function filter(e,t){return operate((function(n,s){var r=0;n.subscribe(createOperatorSubscriber(s,(function(n){return e.call(t,n,r++)&&s.next(n)})))}))}function take(e){return e<=0?function(){return q}:operate((function(t,n){var s=0;t.subscribe(createOperatorSubscriber(n,(function(t){++s<=e&&(n.next(t),e<=s&&n.complete())})))}))}function defaultErrorFactory(){return new j}function ignoreElements(){return operate((function(e,t){e.subscribe(createOperatorSubscriber(t,noop))}))}function defer(e){return new x((function(t){innerFrom(e()).subscribe(t)}))}function concatMap(e,t){return isFunction(t)?mergeMap(e,t,1):mergeMap(e,1)}function of(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return from(e,popScheduler(e))}var I=function(e){function Action(t,n){return e.call(this)||this}return __extends(Action,e),Action.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},Action}(o),F={setInterval:function(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var r=F.delegate;return(null==r?void 0:r.setInterval)?r.setInterval.apply(r,__spreadArray([e,t],__read(n))):setInterval.apply(void 0,__spreadArray([e,t],__read(n)))},clearInterval:function(e){var t=F.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},V=function(e){function AsyncAction(t,n){var s=e.call(this,t,n)||this;return s.scheduler=t,s.work=n,s.pending=!1,s}return __extends(AsyncAction,e),AsyncAction.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var s=this.id,r=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(r,s,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,t),this},AsyncAction.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),F.setInterval(e.flush.bind(e,this),n)},AsyncAction.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&F.clearInterval(t)},AsyncAction.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},AsyncAction.prototype._execute=function(e,t){var n,s=!1;try{this.work(e)}catch(e){s=!0,n=e||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),n},AsyncAction.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,s=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,arrRemove(s,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},AsyncAction}(I),W={now:function(){return(W.delegate||Date).now()},delegate:void 0},z=function(){function Scheduler(e,t){void 0===t&&(t=Scheduler.now),this.schedulerActionCtor=e,this.now=t}return Scheduler.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},Scheduler.now=W.now,Scheduler}(),N=new(function(e){function AsyncScheduler(t,n){void 0===n&&(n=z.now);var s=e.call(this,t,n)||this;return s.actions=[],s._active=!1,s}return __extends(AsyncScheduler,e),AsyncScheduler.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},AsyncScheduler}(z))(V),B=N;function timer(e,t,n){void 0===e&&(e=0),void 0===n&&(n=B);var s=-1;return null!=t&&(isScheduler(t)?n=t:s=t),new x((function(t){var r=function isValidDate(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;r<0&&(r=0);var o=0;return n.schedule((function(){t.closed||(t.next(o++),0<=s?this.schedule(void 0,s):t.complete())}),r)}))}function catchError(e){return operate((function(t,n){var s,r=null,o=!1;r=t.subscribe(createOperatorSubscriber(n,void 0,void 0,(function(a){s=innerFrom(e(a,catchError(e)(t))),r?(r.unsubscribe(),r=null,s.subscribe(n)):o=!0}))),o&&(r.unsubscribe(),r=null,s.subscribe(n))}))}function tap(e,t,n){var s=isFunction(e)||t||n?{next:e,error:t,complete:n}:e;return s?operate((function(e,t){var n;null===(n=s.subscribe)||void 0===n||n.call(s);var r=!0;e.subscribe(createOperatorSubscriber(t,(function(e){var n;null===(n=s.next)||void 0===n||n.call(s,e),t.next(e)}),(function(){var e;r=!1,null===(e=s.complete)||void 0===e||e.call(s),t.complete()}),(function(e){var n;r=!1,null===(n=s.error)||void 0===n||n.call(s,e),t.error(e)}),(function(){var e,t;r&&(null===(e=s.unsubscribe)||void 0===e||e.call(s)),null===(t=s.finalize)||void 0===t||t.call(s)})))})):identity}function scanInternals(e,t,n,s,r){return function(o,a){var c=n,l=t,h=0;o.subscribe(createOperatorSubscriber(a,(function(t){var n=h++;l=c?e(l,t,n):(c=!0,t),s&&a.next(l)}),r&&function(){c&&a.next(l),a.complete()}))}}function scan(e,t){return operate(scanInternals(e,t,arguments.length>=2,!0))}var L={connector:function(){return new C}};function connect(e,t){void 0===t&&(t=L);var n=t.connector;return operate((function(t,s){var r=n();innerFrom(e(function fromSubscribable(e){return new x((function(t){return e.subscribe(t)}))}(r))).subscribe(s),s.add(t.subscribe(r))}))}var K=function(e){function ReplaySubject(t,n,s){void 0===t&&(t=Infinity),void 0===n&&(n=Infinity),void 0===s&&(s=W);var r=e.call(this)||this;return r._bufferSize=t,r._windowTime=n,r._timestampProvider=s,r._buffer=[],r._infiniteTimeWindow=!0,r._infiniteTimeWindow=Infinity===n,r._bufferSize=Math.max(1,t),r._windowTime=Math.max(1,n),r}return __extends(ReplaySubject,e),ReplaySubject.prototype.next=function(t){var n=this,s=n.isStopped,r=n._buffer,o=n._infiniteTimeWindow,a=n._timestampProvider,c=n._windowTime;s||(r.push(t),!o&&r.push(a.now()+c)),this._trimBuffer(),e.prototype.next.call(this,t)},ReplaySubject.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,s=this._buffer.slice(),r=0;r<s.length&&!e.closed;r+=n?1:2)e.next(s[r]);return this._checkFinalizedStatuses(e),t},ReplaySubject.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,s=e._buffer,r=e._infiniteTimeWindow,o=(r?1:2)*t;if(t<Infinity&&o<s.length&&s.splice(0,s.length-o),!r){for(var a=n.now(),c=0,l=1;l<s.length&&s[l]<=a;l+=2)c=l;c&&s.splice(0,c+1)}},ReplaySubject}(C);function groupBy(e,t,n,s){return operate((function(r,o){var a;t&&"function"!=typeof t?(n=t.duration,a=t.element,s=t.connector):a=t;var c=new Map,notify=function(e){c.forEach(e),e(o)},handleError=function(e){return notify((function(t){return t.error(e)}))},l=0,h=!1,u=new O(o,(function(t){try{var r=e(t),d=c.get(r);if(!d){c.set(r,d=s?s():new C);var f=function createGroupedObservable(e,t){var n=new x((function(e){l++;var n=t.subscribe(e);return function(){n.unsubscribe(),0==--l&&h&&u.unsubscribe()}}));return n.key=e,n}(r,d);if(o.next(f),n){var v=createOperatorSubscriber(d,(function(){d.complete(),null==v||v.unsubscribe()}),void 0,void 0,(function(){return c.delete(r)}));u.add(innerFrom(n(f)).subscribe(v))}}d.next(a?a(t):t)}catch(e){handleError(e)}}),(function(){return notify((function(e){return e.complete()}))}),handleError,(function(){return c.clear()}),(function(){return h=!0,0===l}));r.subscribe(u)}))}var G=function(e){function BehaviorSubject(t){var n=e.call(this)||this;return n._value=t,n}return __extends(BehaviorSubject,e),Object.defineProperty(BehaviorSubject.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),BehaviorSubject.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},BehaviorSubject.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,s=e._value;if(t)throw n;return this._throwIfClosed(),s},BehaviorSubject.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},BehaviorSubject}(C);function distinctUntilChanged(e,t){return void 0===t&&(t=identity),e=null!=e?e:defaultCompare,operate((function(n,s){var r,o=!0;n.subscribe(createOperatorSubscriber(s,(function(n){var a=t(n);!o&&e(r,a)||(o=!1,r=a,s.next(n))})))}))}function defaultCompare(e,t){return e===t}function endWith(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return concat(t,of.apply(void 0,__spreadArray([],__read(e))))}}const findSendPeerToPeerMessageFunction=(e,t)=>{const n=t.find((([t])=>t===e));if(void 0===n)throw new Error("There is no tuple with the given key.");return n[1]},isBooleanTuple=e=>"boolean"==typeof e[1],isNotBooleanTuple=e=>"boolean"!=typeof e[1],isPeerToPeerMessageTuple=e=>null!==e[1]&&"object"==typeof e[1],isSendPeerToPeerMessageTuple=e=>"function"==typeof e[1],isTrueTuple=e=>!0===e[1],H=Symbol();function skip(e){return filter((function(t,n){return e<=n}))}function withLatestFrom(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=popResultSelector(e);return operate((function(t,s){for(var r=e.length,o=new Array(r),a=e.map((function(){return!1})),c=!1,_loop_1=function(t){innerFrom(e[t]).subscribe(createOperatorSubscriber(s,(function(e){o[t]=e,c||a[t]||(a[t]=!0,(c=a.every(identity))&&(a=null))}),noop))},l=0;l<r;l++)_loop_1(l);t.subscribe(createOperatorSubscriber(s,(function(e){if(c){var t=__spreadArray([e],__read(o));s.next(n?n.apply(void 0,__spreadArray([],__read(t))):t)}})))}))}const $=function isNonNulled(e){return null!=e};var U,Q=Array.isArray;function zip(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=popResultSelector(e),s=function argsOrArgArray(e){return 1===e.length&&Q(e[0])?e[0]:e}(e);return s.length?new x((function(e){var t=s.map((function(){return[]})),r=s.map((function(){return!1}));e.add((function(){t=r=null}));for(var _loop_1=function(o){innerFrom(s[o]).subscribe(createOperatorSubscriber(e,(function(s){if(t[o].push(s),t.every((function(e){return e.length}))){var a=t.map((function(e){return e.shift()}));e.next(n?n.apply(void 0,__spreadArray([],__read(a))):a),t.some((function(e,t){return!e.length&&r[t]}))&&e.complete()}}),(function(){r[o]=!0,!t[o].length&&e.complete()})))},o=0;!e.closed&&o<s.length;o++)_loop_1(o);return function(){t=r=null}})):q}function switchMap(e,t){return operate((function(n,s){var r=null,o=0,a=!1,checkComplete=function(){return a&&!r&&s.complete()};n.subscribe(createOperatorSubscriber(s,(function(n){null==r||r.unsubscribe();var a=0,c=o++;innerFrom(e(n,c)).subscribe(r=createOperatorSubscriber(s,(function(e){return s.next(t?t(n,e,c,a++):e)}),(function(){r=null,checkComplete()})))}),(function(){a=!0,checkComplete()})))}))}function iif(e,t,n){return defer((function(){return e()?t:n}))}function count(e){return function reduce(e,t){return operate(scanInternals(e,t,arguments.length>=2,!1,!0))}((function(t,n,s){return!e||e(n,s)?t+1:t}),0)}function interval(e,t){return void 0===e&&(e=0),void 0===t&&(t=N),e<0&&(e=0),timer(e,e,t)}function takeUntil(e){return operate((function(t,n){innerFrom(e).subscribe(createOperatorSubscriber(n,(function(){return n.complete()}),noop)),!n.closed&&t.subscribe(n)}))}function retry(e){var t;void 0===e&&(e=Infinity);var n=(t=e&&"object"==typeof e?e:{count:e}).count,s=void 0===n?Infinity:n,r=t.delay,o=t.resetOnSuccess,a=void 0!==o&&o;return s<=0?identity:operate((function(e,t){var n,o=0,subscribeForRetry=function(){var c=!1;n=e.subscribe(createOperatorSubscriber(t,(function(e){a&&(o=0),t.next(e)}),void 0,(function(e){if(o++<s){var resub_1=function(){n?(n.unsubscribe(),n=null,subscribeForRetry()):c=!0};if(null!=r){var a="number"==typeof r?timer(r):innerFrom(r(e,o)),l=createOperatorSubscriber(t,(function(){l.unsubscribe(),resub_1()}),(function(){t.complete()}));a.subscribe(l)}else resub_1()}else t.error(e)}))),c&&(n.unsubscribe(),n=null,subscribeForRetry())};subscribeForRetry()}))}!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(U||(U={}));var Y=function(){function Notification(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return Notification.prototype.observe=function(e){return observeNotification(this,e)},Notification.prototype.do=function(e,t,n){var s=this,r=s.kind,o=s.value,a=s.error;return"N"===r?null==e?void 0:e(o):"E"===r?null==t?void 0:t(a):null==n?void 0:n()},Notification.prototype.accept=function(e,t,n){var s;return isFunction(null===(s=e)||void 0===s?void 0:s.next)?this.observe(e):this.do(e,t,n)},Notification.prototype.toObservable=function(){var e=this,t=e.kind,n=e.value,s=e.error,r="N"===t?of(n):"E"===t?throwError((function(){return s})):"C"===t?q:0;if(!r)throw new TypeError("Unexpected notification kind "+t);return r},Notification.createNext=function(e){return new Notification("N",e)},Notification.createError=function(e){return new Notification("E",void 0,e)},Notification.createComplete=function(){return Notification.completeNotification},Notification.completeNotification=new Notification("C"),Notification}();function observeNotification(e,t){var n,s,r,o=e,a=o.kind,c=o.value,l=o.error;if("string"!=typeof a)throw new TypeError('Invalid notification, missing "kind"');"N"===a?null===(n=t.next)||void 0===n||n.call(t,c):"E"===a?null===(s=t.error)||void 0===s||s.call(t,l):null===(r=t.complete)||void 0===r||r.call(t)}class InexorablyOperator{constructor(e){this.callback=e}call(e,t){return t.subscribe(new InexorablySubscriber(e,this.callback))}}class InexorablySubscriber extends m{constructor(e,t){super(e),this.add(new o((()=>t(this.notification))))}complete(){this.notification=new Y("C"),super.complete()}error(e){this.notification=new Y("E",void 0,e),super.error(e)}}function startWith(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=popScheduler(e);return operate((function(t,s){(n?concat(e,t,n):concat(e,t)).subscribe(s)}))}const ignoreLateResult=e=>new x((t=>{let n=!0;return e.then((e=>{n&&(t.next(e),t.complete())}),(e=>{n&&t.error(e)})),()=>n=!1})),negotiateDataChannels=(e,t)=>n=>n.pipe(mergeMap((([n,s,r])=>new x((o=>{const a=[],c=new C,l=[],h=new C,createAndSendOffer=()=>(v=!1,ignoreLateResult(b.setLocalDescription()).pipe(tap((()=>{const{localDescription:e}=b;if(null===e)throw new Error("The local description is not set.");t({...jsonifyDescription(e),client:{id:n},version:T})})))),subscribeToCandidates=()=>E(b,"icecandidate")((({candidate:e})=>{null===e?t({client:{id:n},numberOfGatheredCandidates:y,type:"summary",version:T}):9!==e.port&&"tcp"!==e.protocol&&(t({...e.toJSON(),client:{id:n},type:"candidate",version:T}),y+=1)})),subscribeToDataChannels=()=>{const e=[zip([E(_,"open"),E(x,"open")]).pipe(take(1)).subscribe((()=>{w=e=>{const t="update"===e.type?_:x;try{t.send(JSON.stringify(e))}catch(e){return c.next(e),!1}return!0},o.next([n,w])})),merge(...[_,x].map((e=>["close","closing","error"].map((t=>E(e,t))))).flat()).subscribe((({type:e})=>c.next(new Error(`RTCDataChannel fired unexpected event of type "${e}".`))))],t=[()=>e.forEach((e=>e.unsubscribe())),E(_,"message")((({data:e})=>{const t=JSON.parse(e);o.next([n,t])})),E(x,"message")((({data:e,timeStamp:t})=>{const s={...JSON.parse(e),timestamp:null!=t?t:performance.now()};o.next([n,s])}))];return()=>t.forEach((e=>e()))},[u,d]=(f=1,[()=>f**2,()=>{f+=1}]);var f;const subscribeToPeerConnection=()=>{const e=merge(E(b,"icecandidate"),E(b,"icegatheringstatechange")).pipe(switchMap((()=>iif((()=>"gathering"===b.iceGatheringState),defer((()=>timer(1e4*u()))),q)))).subscribe((()=>{d(),c.next(new Error('RTCPeerConnection seems to be stuck at iceGatheringState "gathering".'))})),t=[()=>e.unsubscribe(),E(b,"connectionstatechange")((()=>{const e=b.connectionState;["closed","disconnected","failed"].includes(e)&&c.next(new Error(`RTCPeerConnection transitioned to unexpected connectionState "${e}".`))})),E(b,"icecandidateerror")((()=>c.next(new Error('RTCPeerConnection fired unexpected event of type "icecandidateerror".')))),E(b,"iceconnectionstatechange")((()=>{const e=b.iceConnectionState;["closed","disconnected","failed"].includes(e)&&c.next(new Error(`RTCPeerConnection transitioned to unexpected iceConnectionState "${e}".`))})),E(b,"signalingstatechange")((()=>{"closed"===b.signalingState&&c.next(new Error('RTCPeerConnection transitioned to unexpected signalingState "closed".'))}))];return()=>t.forEach((e=>e()))},resetState=t=>{h.next(null),S(),M(),O(),_.close(),x.close(),b.close(),null!==w&&o.next([n,!0]),v=!0,g=0,m=T===t?m:Infinity,y=0,b=e(),l.length=T===t?l.length:0,_=b.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),w=null,x=b.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),S=subscribeToCandidates(),M=subscribeToDataChannels(),O=subscribeToPeerConnection(),T=t};let v=!0,g=0,m=Infinity,y=0,b=e(),_=b.createDataChannel("",{id:0,negotiated:!0,ordered:!0}),w=null,k=null,x=b.createDataChannel("",{id:1,maxRetransmits:0,negotiated:!0,ordered:!1}),S=subscribeToCandidates(),M=subscribeToDataChannels(),O=subscribeToPeerConnection(),T=0;const addFinalCandidate=async e=>{g+=e,g===m&&await b.addIceCandidate()},jsonifyDescription=e=>e instanceof RTCSessionDescription?e.toJSON():e;return o.next([n,!0]),merge(defer((()=>from(a))),c.pipe(mergeMap((e=>throwError((()=>e))))),r.pipe(((e,t,n)=>s=>s.pipe(function materialize(){return operate((function(e,t){e.subscribe(createOperatorSubscriber(t,(function(e){t.next(Y.createNext(e))}),(function(){t.next(Y.createComplete()),t.complete()}),(function(e){t.next(Y.createError(e)),t.complete()})))}))}(),startWith(null),switchMap((s=>concat(of(s),null===s||"N"===s.kind?n.pipe(function takeWhile(e,t){return void 0===t&&(t=!1),operate((function(n,s){var r=0;n.subscribe(createOperatorSubscriber(s,(function(n){var o=e(n,r++);(o||t)&&s.next(n),!o&&s.complete()})))}))}(t),tap(e),ignoreElements()):q))),filter($),function dematerialize(){return operate((function(e,t){e.subscribe(createOperatorSubscriber(t,(function(e){return observeNotification(e,t)})))}))}()))((()=>t({client:{id:n},type:"check"})),(()=>"open"!==_.readyState||"open"!==x.readyState),interval(5e3)),function inexorably(e){return t=>t.lift(new InexorablyOperator(e))}((e=>{void 0!==e&&c.complete()})))).pipe(mergeMap((e=>(e=>{const{type:r}=e;if("answer"===r&&s){if(T>e.version)return q;if(T===e.version&&!v)return ignoreLateResult(b.setRemoteDescription(e)).pipe(mergeMap((()=>from(l))),mergeMap((e=>ignoreLateResult(b.addIceCandidate(e)))),count(),mergeMap((e=>ignoreLateResult(addFinalCandidate(e)))))}if("candidate"===r){if(T>e.version)return q;if(T<e.version&&!s&&resetState(e.version),T===e.version)return null===b.remoteDescription?(l.push(e),q):ignoreLateResult(b.addIceCandidate(e)).pipe(mergeMap((()=>ignoreLateResult(addFinalCandidate(1)))))}if("error"===r&&s)return T>e.version?q:(resetState(e.version+1),createAndSendOffer());if("notice"===r&&!s)return q;if("offer"===r&&!s)return T>e.version?q:(T<e.version&&resetState(e.version),v=!1,ignoreLateResult(b.setRemoteDescription(e)).pipe(mergeMap((()=>merge(ignoreLateResult(b.setLocalDescription()).pipe(tap((()=>{const{localDescription:e}=b;if(null===e)throw new Error("The local description is not set.");t({...jsonifyDescription(e),client:{id:n},version:T})}))),from(l).pipe(mergeMap((e=>ignoreLateResult(b.addIceCandidate(e)))),count(),mergeMap((e=>ignoreLateResult(addFinalCandidate(e))))))))));if("request"===r&&s)return 0===T&&v?createAndSendOffer():q;if("summary"===r){if(T>e.version)return q;if(T<e.version&&!s&&resetState(e.version),T===e.version)return m=e.numberOfGatheredCandidates,ignoreLateResult(addFinalCandidate(0))}return k=new Error(`The current event of type "${r}" can't be processed.`),throwError((()=>k))})(e).pipe(takeUntil(h)))),retry({delay:e=>{if(e===k)return throwError((()=>e));if(a.length=0,v)resetState(T);else{const e={client:{id:n},type:"error",version:T};s?a.push(e):(resetState(T+1),t(e))}return of(null)}}),takeUntil(concat(r.pipe(ignoreElements()),of(null))),finalize((()=>{S(),M(),O(),_.close(),x.close(),b.close()}))).subscribe({complete:()=>{o.next([n,!1]),o.complete()},error:e=>o.error(e)})})))));function not(e,t){return function(n,s){return!e.call(t,n,s)}}const X=/^[\dA-Za-z]{20}$/,J="undefined"==typeof window?null:window,Z=((e,t,n,s,r,o,a)=>class TimingProvider extends n{constructor(e){super();const t=s.now()/1e3;this._clientId="",this._endPosition=Number.POSITIVE_INFINITY,this._error=null,this._hops=[],this._onadjust=null,this._onchange=null,this._onreadystatechange=null,this._origin=Number.MAX_SAFE_INTEGER,this._providerIdOrUrl=e,this._readyState="connecting",this._skew=0,this._startPosition=Number.NEGATIVE_INFINITY,this._subscription=null,this._updateRequestsSubject=new C,this._vector={acceleration:0,position:0,timestamp:t,velocity:0},this._version=0,this._createClient()}get endPosition(){return this._endPosition}get error(){return this._error}get onadjust(){return null===this._onadjust?this._onadjust:this._onadjust[0]}set onadjust(e){if(null!==this._onadjust&&this.removeEventListener("adjust",this._onadjust[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("adjust",t),this._onadjust=[e,t]}else this._onadjust=null}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get skew(){return this._skew}get startPosition(){return this._startPosition}get vector(){return this._vector}destroy(){if(null===this._subscription)throw new Error("The timingProvider is already destroyed.");this._readyState="closed",this._subscription.unsubscribe(),this._subscription=null,this._updateRequestsSubject.complete(),r((()=>this.dispatchEvent(new Event("readystatechange"))))}update(e){if(null===this._subscription)return Promise.reject(new Error("The timingProvider is destroyed and can't be updated."));const t=a(this._vector,e);return null!==t&&this._updateRequestsSubject.next([{...t,hops:[],version:this._version+1},null]),Promise.resolve()}_createClient(){const n=X.test(this._providerIdOrUrl)?`wss://matchmaker.suenc.io?providerId=${this._providerIdOrUrl}`:this._providerIdOrUrl;this._subscription=merge(concat(from(D()).pipe(function equals(e){return t=>t.pipe(filter((t=>e===t)))}(!0),function first(e,t){var n=arguments.length>=2;return function(s){return s.pipe(e?filter((function(t,n){return e(t,n,s)})):identity,take(1),n?function defaultIfEmpty(e){return operate((function(t,n){var s=!1;t.subscribe(createOperatorSubscriber(n,(function(e){s=!0,n.next(e)}),(function(){s||n.next(e),n.complete()})))}))}(t):function throwIfEmpty(e){return void 0===e&&(e=defaultErrorFactory),operate((function(t,n){var s=!1;t.subscribe(createOperatorSubscriber(n,(function(e){s=!0,n.next(e)}),(function(){return s?n.complete():n.error(e())})))}))}((function(){return new j})))}}(),ignoreElements()),defer((()=>{const[s,r]=t(n);return s.pipe((o=e=>"closure"===e.type,a=()=>{const e=new Error("Your plan has exceeded its quota.");this._error=e,this._readyState="closed",this.dispatchEvent(new Event("readystatechange"))},connect((e=>{const[t,n]=function partition(e,t,n){return[filter(t,n)(innerFrom(e)),filter(not(t,n))(innerFrom(e))]}(e,o);return n.pipe(takeUntil(t.pipe(tap(a))))}))),(c=e=>"init"===e.type,e=>e.pipe(scan((([e,t],n)=>{if(c(n)){if(null===t)throw new Error("Another value has been identified as the first value already.");return[[n,...t],null]}return null===t?[[n],t]:[e,[...t,n]]}),[[],[]]),concatMap((([e])=>from(e))))),concatMap((e=>{if("array"===e.type)return from(e.events);if("init"===e.type){const{client:{id:t},events:n,origin:s}=e;return this._clientId=t,this._origin=s,0===n.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange"))),from(n)}return of(e)})),((e,t)=>n=>new x((s=>{const r=new Map,isActive=t=>e()<t;return n.pipe((o=()=>{r.forEach((([e,t])=>{null===e?t.unsubscribe():e.complete()}))},e=>new x((t=>{const n=e.subscribe({complete:()=>{o(),t.complete()},error:e=>{o(),t.error(e)},next:e=>t.next(e)});return()=>{o(),n.unsubscribe()}})))).subscribe({complete(){s.complete()},error(e){s.error(e)},next(e){var n;const o=e.client.id,[a,c]=null!==(n=r.get(o))&&void 0!==n?n:[null,null];if("termination"===e.type)null!==c&&c.unsubscribe(),null!==a&&a.complete(),r.set(o,[null,t.pipe(skip(isActive(o)?1:0),take(1)).subscribe((()=>r.delete(o)))]);else if(null===a&&null===c){const t=new C;r.set(o,[t,null]),s.next([o,isActive(o),t.asObservable()]),t.next(e)}else null===c&&a.next(e)}});var o})))((()=>this._clientId),timer(1e4)),negotiateDataChannels(e,r));var o,a,c}))).pipe((e=>defer((()=>{let t=0;return e.pipe(retry({delay:e=>(t+=1,iif((()=>t<4),timer(1e3*t**2),throwError((()=>e))))}),tap((()=>t=0)))}))),catchError((e=>(this._error=e,this._readyState="closed",this.dispatchEvent(new Event("readystatechange")),q))),tap((e=>{isSendPeerToPeerMessageTuple(e)&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),scan((([,e],t)=>{const n=e.findIndex((([e])=>e===t[0]));return-1===n?(isTrueTuple(t)||isSendPeerToPeerMessageTuple(t))&&e.push(t):!1===t[1]?e.splice(n,1):(isTrueTuple(t)||isSendPeerToPeerMessageTuple(t))&&(e[n]=t),[t,e]}),[,[]]),tap((([,e])=>{0===e.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),filter((([e])=>!(isSendPeerToPeerMessageTuple(e)&&!e[1]({message:this._createExtendedVector([...this._hops,this._origin]),type:"update"})))),connect((e=>{const t=new K(1);return e.pipe(tap((([,e])=>t.next(e))),map((([e,t])=>{if(isPeerToPeerMessageTuple(e)){const[n,s]=e;if("ping"===s.type)return[n,{...s,reply:findSendPeerToPeerMessageFunction(n,t.filter(isSendPeerToPeerMessageTuple))}]}return e})),filter(isNotBooleanTuple),groupBy((([e])=>e),{duration:t=>e.pipe(map((([e])=>e)),filter(isBooleanTuple),filter((([e])=>e===t.key)))}),mergeMap((e=>{const t=new G([0,[]]);return e.pipe(connect((n=>merge(n.pipe(filter(isSendPeerToPeerMessageTuple),((e,t)=>n=>n.pipe(map((([,n])=>interval(1e3).pipe(startWith(0),map(((e,s)=>(n({index:s,type:"ping"}),t()))),withLatestFrom(e),tap((([t,[n,s]])=>e.next([n,[...s,t]]))),ignoreElements()))),endWith(q),function switchAll(){return switchMap(identity)}()))(t,(()=>s.now()))),n.pipe(filter(isPeerToPeerMessageTuple),map((([,e])=>e)),groupBy((e=>e.type)),mergeMap((e=>"ping"===e.key?e.pipe(tap((({index:e,timestamp:t,reply:n})=>n({index:e,remoteReceivedTime:t,remoteSentTime:s.now(),type:"pong"}))),ignoreElements()):"pong"===e.key?e.pipe((e=>t=>t.pipe(withLatestFrom(e),map((([{index:t,remoteReceivedTime:n,remoteSentTime:s,timestamp:r},[o,a]])=>{if(t<o)return null;const c=t-o,[l,...h]=a.slice(c);return e.next([o+c+1,h]),[l,n,s,r]})),filter($)))(t),map((([e,t,n,s])=>[(t+n-e-s)/2,s-e+t-n])),(e=>e.pipe(scan(((e,t)=>[...e.slice(-59),t]),[]),map((e=>e.slice(1).reduce(((e,t)=>e[1]<t[1]?e:t),e[0]))))),map((e=>[1,e]))):e.pipe(map((({message:e})=>e)),map((e=>this._version>e.version||this._version===e.version&&((0===this._hops.length?this._origin:this._hops[0])<e.hops[0]||e.hops.includes(this._origin))?null:e)),map((e=>[0,e]))))),(e=>e.pipe(scan(((e,[t,n])=>0===t?[n,e[1]]:[e[0],n]),[H,H]),filter((e=>e.every((e=>e!==H)))))),distinctUntilChanged((([e,[t,n]],[s,[r,o]])=>e===s&&t===r&&n===o)),map((([t,[n,s]])=>[e.key,null===t?null:{...t,timestamp:t.timestamp-n/1e3},s])),endWith([e.key,null,null]))))))})),scan((([,e],t)=>{const n=e.findIndex((([e])=>t[0]===e));return null===t[2]?n>-1&&e.splice(n,1):n>-1?e[n]=t:(e.push(t),e.sort((([e],[t])=>e<t?-1:e>t?1:0))),[t,e]}),[,[]]),mergeMap((e=>t.pipe(take(1),map((t=>[e,t]))))),map((([[e],t])=>[...e,t])))}))),this._updateRequestsSubject.pipe(map((([e])=>[null,e,0,null])))).pipe(scan((([e,t]=[[[null,this._createExtendedVector(this._hops),0]],[]],[n,s,r,a])=>{const c=null!=a?a:t,l=e.findIndex((e=>e[0]===n));if(null!==s){if(this._version<s.version)return e.length=0,e.push([n,s,r]),[e,c];if(this._version===s.version){const t=0===this._hops.length?this._origin:this._hops[0];if(t>s.hops[0]&&!s.hops.includes(this._origin))return e.length=0,e.push([n,s,r]),[e,c];if(t===s.hops[0]&&!s.hops.includes(this._origin)&&this._hops.length>0)return l>-1?e[l]=[n,s,r]:e.push([n,s,r]),o(e),[e,c]}}return l>-1&&(1===e.length?e[0]=[null,{...e[0][1],hops:[e[0][1].hops[0],...e[0][1].hops.map((()=>this._origin))]},0]:e.splice(l,1)),[e,c]}),void 0),distinctUntilChanged(((e,t)=>e===t),(([[[,e]]])=>e))).subscribe((([[[e,t]],n])=>{const s={...t,hops:[...t.hops,this._origin]};for(const[t,r]of n.filter(isSendPeerToPeerMessageTuple))if(!r({message:s,type:"update"})&&e===t)return;this._setInternalVector(t)}))}_createExtendedVector(e){return{...this._vector,hops:e,version:this._version}}_setInternalVector({hops:e,version:t,...n}){this._hops=e,this._vector=n,this._version=t,this.dispatchEvent(new CustomEvent("change",{detail:n}))}})((e=>()=>{if(null===e)throw new Error("A native EventTarget could not be created.");return new e.RTCPeerConnection({iceCandidatePoolSize:1,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}]})})(J),(ne=e=>new WebSocket(e),e=>{const t=new C,n=ne(e);return[merge(E(n,"message"),merge(merge(...["close","error"].map((e=>E(n,e)))).pipe(map((({type:e})=>new Error(`WebSocket fired unexpected event of type "${e}".`)))),t).pipe(mergeMap((e=>throwError((()=>e)))))).pipe(finalize((()=>n.close())),map((e=>JSON.parse(e.data)))),e=>{try{n.send(JSON.stringify(e))}catch(e){t.next(e)}}]}),(ie=(e=>()=>{if(null===e)throw new Error("A native EventTarget could not be created.");return e.document.createElement("p")})(J),class EventTarget{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=ie()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(s=this,r=t,o=e=>{const t={value:s};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof r?r.call(s,e):r.handleEvent.call(s,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var s,r}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const s=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===s?null:s,n)}}),performance,setTimeout,(ee=([,{hops:e}])=>e,te=([,,e])=>e,e=>{e.sort(((e,t)=>{const n=(([e,...t],[n,...s])=>{if(void 0===e||void 0===n)throw new Error("Every vector should have an origin.");if(e===n){const e=t.filter((e=>e===t[0])).length,n=s.filter((e=>e===s[0])).length;if(e===n){if(0===e)throw new Error("At least one vector should have a hop if they have the same origin.");if(1===e||t[0]===s[0]){if(t.length===s.length){if(t.every(((e,t)=>e===s[t])))throw new Error("Every vector should be unique.");return 0}return t.length-s.length}return t[0]-s[0]}return e-n}return e-n})(ee(e),ee(t));return 0===n?te(e)-te(t):n}))}),((e,t,n)=>(s,r)=>{const o=e(r),a=n(s,t.now()/1e3-s.timestamp);for(const[e,t]of Object.entries(o))if(t!==a[e])return{...a,...o};return null})(s.filterTimingStateVectorUpdate,performance,s.translateTimingStateVector));var ee,te,ie,ne},2589:e=>{"use strict";e.exports=JSON.parse('{"vco":{"color":[150,0,0],"boundingBox":{"x":5,"y":20,"width":30,"height":50},"offsets":{"x":10,"y":20},"groupA":["type"],"controlTypeA":"radioButton","controlTypeB":"knob","sizeA":0.8,"sizeB":0.75,"theme":"dark"},"vcf":{"color":[100,0,150],"boundingBox":{"x":45,"y":20,"width":40,"height":100},"offsets":{"x":10,"y":30},"groupA":["cutoff"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6},"vca":{"color":[100,50,100],"boundingBox":{"x":90,"y":20,"width":20,"height":100},"offsets":{"x":12,"y":30},"groupA":["level"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.5,"sizeB":0.5},"env":{"color":[50,100,100],"boundingBox":{"x":5,"y":60,"width":100,"height":50},"offsets":{"x":8,"y":30},"groupA":["decay","pDecay","nDecay","nEnv"],"controlTypeA":"knob","controlTypeB":"fader","sizeA":0.5,"sizeB":1},"lfo":{"color":[20,0,100],"boundingBox":{"x":50,"y":70,"width":50,"height":50},"offsets":{"x":12,"y":30},"groupA":["rate"],"controlTypeA":"knob","controlTypeB":"knob","sizeA":0.8,"sizeB":0.6}}')},2613:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var s=n(1601),r=n.n(s),o=n(6314),a=n.n(o)()(r());a.push([e.id,"/* Style for the container to control vertical or horizontal layout */\n.vertical-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center; /* Center the items if desired */\n}\n\n.horizontal-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center; /* Center the items vertically */\n}\n\n.sliderStyle {\n  width: 80%;\n  height: 8px;\n  background: #ddd;\n  outline: none;\n  opacity: 0.8;\n  transition: opacity 0.2s;\n}\n\n.sliderStyle::-webkit-slider-thumb {\n  appearance: none;\n  width: 20px;\n  height: 20px;\n  background: #4CAF50;\n  cursor: pointer;\n  border-radius: 50%;\n}\n\n.sliderStyle::-moz-range-thumb {\n  width: 20px;\n  height: 20px;\n  background: #4CAF50;\n  cursor: pointer;\n  border-radius: 50%;\n}\n\n/* Style for the label */\nlabel {\n  font-size: 14px;\n  margin-bottom: 5px;\n}",""]);const c=a},2805:e=>{"use strict";e.exports=JSON.parse('{"default":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":0.6399999999999997,"detune":-0.0050000000000004485,"gain":0.49,"octave1":0.3763000000000001,"detune1":0.004100000000000548,"gain1":0.2471151519016499,"octave12":-0.48769999999999936,"detune12":-0.006785841498486267,"gain12":0.4489000000000002,"cutoff":145.9711999999991,"keyTracking":1,"vcf env":1800.0000000000005,"Q":2.5919999999999983,"a":0.003,"d":1.4579999999999995,"s":0,"r":4.049999999999999,"vcf a":0.007199999999999998,"vcf d":1.25,"vcf s":0.02249999999999999,"vcf r":3.8719999999999994,"lfo":0.5,"pwm":0.0225,"distortion":1.6478738086663287e-32,"mix":1},"mono":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":-0.2600000000000011,"detune":-4.440892098500626e-16,"gain":0.99,"octave1":-1.0253000000000012,"detune1":-0.03759999999999947,"gain1":0,"octave12":-0.5299999999999998,"detune12":-0.006785841498486267,"gain12":0,"cutoff":257.94879999999887,"keyTracking":0,"vcf env":220.49999999999946,"Q":9.800000000000006,"a":0.003,"d":5,"s":0.3249000000000002,"r":0.12799999999999884,"vcf a":0.0012500000000000002,"vcf d":0.6124999999999979,"vcf s":0,"vcf r":0.3919999999999978,"distortion":0,"mix":1,"lfo":0.5,"pwm":0.0225},"ringingSub":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":0.4599999999999995,"detune":-4.440892098500626e-16,"gain":0.99,"octave1":-0.8468000000000013,"detune1":-0.03759999999999947,"gain1":0.6399999999999997,"octave12":-0.5299999999999998,"detune12":-0.006785841498486267,"gain12":0,"cutoff":10.998199999999782,"keyTracking":1,"vcf env":199.99999999999923,"Q":2.737999999999998,"a":0.003,"d":1.9844999999999988,"s":1,"r":1.7999999999999972,"vcf a":0.005,"vcf d":1.1044999999999978,"vcf s":0.3480999999999996,"vcf r":1.0579999999999958,"lfo":0.5,"pwm":0.0225,"distortion":0,"mix":1},"fat":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":0.15999999999999925,"detune":-4.440892098500626e-16,"gain":1,"octave1":-0.5717000000000012,"detune1":0.09289999999999965,"gain1":0.8463999999999998,"octave12":-0.7324999999999999,"detune12":-0.08746089048940536,"gain12":0.8463999999999998,"cutoff":226.95499999999856,"keyTracking":0.17639999999999956,"vcf env":647.9999999999991,"Q":0.2419999999999986,"a":0.003,"d":1.9844999999999988,"s":1,"r":1.5679999999999972,"vcf a":0.005,"vcf d":0.9140958877053913,"vcf s":0.3480999999999996,"vcf r":0.031999999999999244,"lfo":0.5,"pwm":0.0225,"distortion":0.14440000000000014,"mix":0.3969000000000003},"blip":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":1,"detune":-4.440892098500626e-16,"gain":0.7499999999999998,"octave1":0.3231999999999995,"detune1":0.032899999999999596,"gain1":1,"octave12":0.27070000000000105,"detune12":-0.006785841498486267,"gain12":0.8463999999999998,"cutoff":170.96619999999902,"keyTracking":0.6399999999999997,"vcf env":647.9999999999991,"Q":0.7219999999999969,"a":0.003,"d":1.1519999999999984,"s":0.1295999999999996,"r":0.24199999999999997,"vcf a":0.005,"vcf d":0.24199999999999763,"vcf s":0.06249999999999967,"vcf r":0.049999999999999066,"lfo":0.5,"pwm":0.1225,"distortion":0.10890000000000019,"mix":0.4356000000000005},"sub":{"vco1":0.5,"vco2":0.5,"vco3":0.5,"octave":-0.20000000000000107,"detune":-4.440892098500626e-16,"gain":0.99,"octave1":1,"detune1":0.001264000000000598,"gain1":0.3480999999999996,"octave12":-0.5299999999999998,"detune12":-0.006785841498486267,"gain12":0,"cutoff":37.992799999999605,"keyTracking":0.9409000000000014,"vcf env":40.49999999999962,"Q":0,"a":0.003,"d":1.9844999999999988,"s":1,"r":0.5119999999999978,"vcf a":0.005,"vcf d":1.1044999999999978,"vcf s":0.3480999999999996,"vcf r":0.5119999999999968,"lfo":0.5,"pwm":0.225,"distortion":0,"mix":1}}')},2946:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlotTransferFunction=void 0,t.PlotTransferFunction=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Canvas1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4;const s=document.getElementById(t),r=s.querySelector("svg.transfer-function-svg");if(r&&s.removeChild(r),"stop"===e)return;const o=s.offsetWidth,a=s.offsetWidth*n,c=a-10,l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("width",o),l.setAttribute("height",a),l.setAttribute("class","transfer-function-svg");const h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x","1"),h.setAttribute("y","1"),h.setAttribute("width",c-1),h.setAttribute("height",c-1),h.setAttribute("stroke","black"),h.setAttribute("fill","none"),l.appendChild(h);const u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("class","transfer-function-path"),l.appendChild(u),s.appendChild(l);var d="M";let f=2/c,v=-1;for(let t=0;t<c;t++)d+=`${t} ${c/2-e(v)*c/2} `,v+=f;function addLabel(e,t,n){const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",t),s.setAttribute("y",n),s.textContent=e,s.setAttribute("font-family","sans-serif"),s.setAttribute("font-size","10px"),s.setAttribute("fill","black"),l.appendChild(s)}function addLabel(e,t,n,s,r,o){const a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttribute("x",t),a.setAttribute("y",n),a.textContent=e,a.setAttribute("font-family","sans-serif"),a.setAttribute("font-size","10px"),a.setAttribute("fill","black"),s&&a.setAttribute("transform",`rotate(${s} ${t}, ${n})`),r&&a.setAttribute("text-anchor",r),o&&a.setAttribute("alignment-baseline",o),l.appendChild(a)}u.setAttribute("d",d),u.setAttribute("stroke","black"),u.setAttribute("stroke-width","2"),u.setAttribute("fill","none"),addLabel("-1",5,a-2,0,"start","baseline"),addLabel("input",c/2,a-11,0,"middle","hanging"),addLabel("1",c-5,a-2,0,"end","baseline"),addLabel("-1",c+3,c-5,90,"middle","baseline"),addLabel("1",c+13,10,90,"middle","hanging"),addLabel("output",c+3,c/2,90,"middle","baseline")}},3019:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.timingStrategyManager=void 0;var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(7721),a=s(n(8972)),c=n(7833),l=s(n(8805));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.timingStrategyManager=new class TimingStrategyManager{constructor(){this.STRATEGIES={TONE_JS:"tone_js",TIMING_OBJECT:"timing_object",MIDI_CLOCK:"midi_clock",ABLETON_LINK:"ableton_link"},this.debug=!1,this.activeStrategy=this.STRATEGIES.TONE_JS,this.patchToneLoop(),this.patchToneTransport()}async initializeStrategy(e){switch(e){case this.STRATEGIES.TIMING_OBJECT:return o.timingObjectManager.initialize();case this.STRATEGIES.MIDI_CLOCK:return a.default.enable(),Promise.resolve();case this.STRATEGIES.ABLETON_LINK:return c.abletonLinkManager.initialize();case this.STRATEGIES.TONE_JS:return Promise.resolve();default:throw new Error(`Unknown timing strategy: ${e}`)}}async setStrategy(e){if(!Object.values(this.STRATEGIES).includes(e))throw new Error(`Invalid timing strategy: ${e}. Valid options are: ${Object.values(this.STRATEGIES).join(", ")}`);return this.activeStrategy===e||(await this.initializeStrategy(e),this.deactivateCurrentStrategy(),this.activeStrategy=e,this.activateStrategy(),this.debug&&console.log(`Timing strategy changed to: ${e}`)),Promise.resolve()}deactivateCurrentStrategy(){switch(this.activeStrategy){case this.STRATEGIES.TIMING_OBJECT:o.timingObjectManager.shouldBeUsed=!1,o.timingObjectManager.stopTimer();break;case this.STRATEGIES.MIDI_CLOCK:a.default.disable();break;case this.STRATEGIES.ABLETON_LINK:c.abletonLinkManager.disable();case this.STRATEGIES.TONE_JS:}}activateStrategy(){switch(this.activeStrategy){case this.STRATEGIES.TIMING_OBJECT:o.timingObjectManager.setShouldUse();break;case this.STRATEGIES.MIDI_CLOCK:r.getTransport().stop();break;case this.STRATEGIES.ABLETON_LINK:c.abletonLinkManager.enable();case this.STRATEGIES.TONE_JS:}}getActiveStrategy(){return this.activeStrategy}getAvailableStrategies(){return{...this.STRATEGIES}}start(){switch(this.activeStrategy){case this.STRATEGIES.TIMING_OBJECT:o.timingObjectManager.startTimer();break;case this.STRATEGIES.MIDI_CLOCK:a.default.enable();break;case this.STRATEGIES.ABLETON_LINK:c.abletonLinkManager.startTimer();break;case this.STRATEGIES.TONE_JS:r.getTransport().start()}}stop(){switch(this.activeStrategy){case this.STRATEGIES.TIMING_OBJECT:o.timingObjectManager.stopTimer();break;case this.STRATEGIES.MIDI_CLOCK:a.default.disable(),this.debug&&console.log("Transport is controlled by MIDI clock");break;case this.STRATEGIES.ABLETON_LINK:c.abletonLinkManager.stopTimer();break;case this.STRATEGIES.TONE_JS:r.getTransport().stop()}}setBpm(e){switch(this.activeStrategy){case this.STRATEGIES.TIMING_OBJECT:o.timingObjectManager.updateVelocity(e);break;case this.STRATEGIES.MIDI_CLOCK:this.debug&&console.log("BPM is controlled by MIDI clock");break;case this.STRATEGIES.TONE_JS:r.getTransport().bpm.value=e}}registerLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return l.default.registerLoop(e,t)}unregisterLoop(e){if("string"==typeof e)l.default.unregisterLoop(e);else for(const[t,n]of l.default.registeredLoops.entries())if(n.loop===e){l.default.unregisterLoop(t);break}}patchToneLoop(){const e=r.Loop.prototype.start,t=r.Loop.prototype.dispose,n=this;r.Loop.prototype.start=function(t){return n.registerLoop(this),e.call(this,t)},r.Loop.prototype.dispose=function(){return n.unregisterLoop(this),t.call(this)}}patchToneTransport(){const e=r.getTransport().start,t=this;r.getTransport().start=function(n,s){return t.activeStrategy===t.STRATEGIES.MIDI_CLOCK?(console.warn("Cannot start Tone.Transport directly when MIDI clock strategy is active"),this):e.call(this,n,s)}}}},3172:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asciiCallbackInstance=void 0,t.asciiCallbackInstance=new class AsciiCallback{constructor(){this.asciiOn=!1,this.allowRepeat=!1,this.handler=(e,t)=>{console.log("Ascii",e,t,"\nadd a new handler like: \nsetAsciiHandler((num,state)=>{\nconsole.log(num, state)})")},this.activeKeys={},this.keyDown=this.keyDown.bind(this),this.keyUp=this.keyUp.bind(this)}keyDown(e){if(!this.asciiOn)return;const t=e.keyCode;let n=t;n=32==t?"Space":e.key,this.activeKeys[n]&&!this.allowRepeat||(this.activeKeys[n]=!0,this.handler(n,"down"))}keyUp(e){if(!this.asciiOn)return;const t=e.keyCode;let n=t;n=32==t?"Space":e.key,this.activeKeys[n]&&(this.activeKeys[n]=!1,this.handler(n,"up"))}enable(){this.asciiOn||(this.asciiOn=!0,document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp))}disable(){this.asciiOn&&(this.asciiOn=!1,document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp))}setHandler(e){this.handler=e}}},3414:e=>{"use strict";e.exports={}},3447:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Parameter=void 0;var r=s(n(1297)),o=n(3941);t.Parameter=class Parameter{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.default;this.parent=e,this.name=t.name||"param",this.min=t.min||0,this.max=t.max||1,this.curve=t.curve||1,this.rawValue=this.unScaleValue(t.value||.5,0,1,this.min,this.max,this.curve),this.normalizedValue=0,this.group=t.group||"default",this._value=Array.isArray(t.value)||void 0!==t.value?t.value:this.scaleValue(.5,0,1,this.min,this.max,this.curve),this.callback=t.callback||function(){},this.control=null,this.gui=n,this.layout=s||r.default,this.type=t.type||"vcf",this.radioOptions=t.radioOptions||null,this.guiElements=[],this.labels=t.labels||null,this.seq=null,this.set(this._value)}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Array.isArray(this._value)&&null!==e?this._value[e]:this._value}set=(()=>{var e=this;return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Array.isArray(e._value)?Array.isArray(t)?(e._value=[...t],t.forEach(((t,n)=>e.callback(t,r)))):null!==n?(e._value[n]=t,e.callback(t,r)):(e._value.fill(t),e._value.forEach(((t,n)=>e.callback(t,r)))):(e._value=t,e.callback(t,r)),0==s&&(Array.isArray(e._value)?e.guiElements.forEach(((t,n)=>t.forceSet(e._value[n]))):e.guiElements.length>0&&e.guiElements[0].forceSet(e._value))}})();sequence(e,t){this.seq&&this.seq.dispose(),this.seq=new o.Seq(this,e,t,"infinite",0,((e,t)=>this.parent.param[this.name].set(Number(e[0]),null,!1,t)))}stop(){this.seq&&(this.seq.dispose(),this.seq=null)}attachControl(e){this.control=e,e.onChange=e=>{this.value=e}}createGui(){const{x:e,y:t,width:n,height:s}=this.layout,r=this.getGroupColor(this.group);this.control=this.gui.Knob({label:this.name,min:this.min,max:this.max,size:n,x:e,y:t,accentColor:r,callback:e=>this.set(e)}),this.control.setValue(this.get())}getGroupColor(e){const t={vco:[200,0,0],vcf:[0,200,0],env:[0,0,200],default:[100,100,100]};return t[e]||t.default}setRealValue(e){this.value=e,this.rawValue=this.unScaleValue(e,this.min,this.max,0,1,this.curve)}getRealValue(){return this.value}setNormalizedValue(e){this.rawValue=e,this.value=this.scaleValue(e,0,1,this.min,this.max,this.curve)}getNormalizedValue(){return this.rawValue}scaleValue(e,t,n,s,r,o){return s+Math.pow(e,o)*(r-s)}unScaleValue(e,t,n,s,r,o){return Math.pow((e-t)/(n-t),1/o)}}},3670:e=>{"use strict";e.exports=JSON.parse('{"default":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":1,"Hihat1":1,"Toms1":1,"Output1":3.4800000000000013,"Dry Kick1":0.09999999999999971,"Kick Rate1":1,"Snare Rate1":1,"Hihat Rate1":1,"Tom1 Rate1":1,"Tom2 Rate1":1,"Tom3 Rate1":1,"Threshold1":-13.249999999999986,"Ratio1":2.709999999999994,"Distort1":0,"Hat Decay1":0.2970999999999998,"kit1":"LINN"},"electro":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":1,"Hihat1":0.8999999999999999,"Toms1":0.23000000000000007,"Output1":0.9599999999999991,"Dry Kick1":0.1399999999999997,"Kick Rate1":0.8999999999999999,"Snare Rate1":0.8799999999999999,"Hihat Rate1":1.1,"Tom1 Rate1":1.4000000000000004,"Tom2 Rate1":1.3000000000000003,"Tom3 Rate1":1.12,"Threshold1":-28.649999999999995,"Ratio1":7.459999999999997,"Distort1":0.17,"Hat Decay1":0.11889999999999983,"kit1":"CR78"},"breakbeat":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":1,"Hihat1":0.7199999999999998,"Toms1":0.7900000000000005,"Output1":2.3999999999999995,"Dry Kick1":0,"Kick Rate1":1.06,"Snare Rate1":1.12,"Hihat Rate1":0.8399999999999999,"Tom1 Rate1":1.1600000000000001,"Tom2 Rate1":1.1400000000000001,"Tom3 Rate1":1.1,"Threshold1":-28.649999999999995,"Ratio1":12.210000000000006,"Distort1":0.04,"Hat Decay1":0.19809999999999958,"kit1":"breakbeat8"},"techno":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":0.7299999999999998,"Hihat1":0.5399999999999996,"Toms1":0.6200000000000003,"Output1":3.3199999999999994,"Dry Kick1":0,"Kick Rate1":0.8399999999999999,"Snare Rate1":1.12,"Hihat Rate1":1.1400000000000001,"Tom1 Rate1":1.1600000000000001,"Tom2 Rate1":1.1400000000000001,"Tom3 Rate1":1.1,"Threshold1":-28.649999999999995,"Ratio1":12.020000000000005,"Distort1":0.03,"Hat Decay1":0.2376999999999996,"kit1":"Techno"},"snappy":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":0.7299999999999998,"Hihat1":0.5399999999999996,"Toms1":0.4499999999999995,"Output1":3.3199999999999994,"Dry Kick1":0,"Kick Rate1":1.1400000000000001,"Snare Rate1":1.3800000000000003,"Hihat Rate1":1.1400000000000001,"Tom1 Rate1":1.6800000000000006,"Tom2 Rate1":0.52,"Tom3 Rate1":0.21999999999999936,"Threshold1":-28.649999999999995,"Ratio1":1,"Distort1":0.09999999999999999,"Hat Decay1":0.08919999999999953,"kit1":"KPR77"}}')},3705:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Diffuseur=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Diffuseur=class Diffuseur{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=e,this.input=new r.Multiply(1),this.eq=new r.EQ3,this.convolver=new r.Convolver,this.output=new r.Multiply(1),this.buffer=null,this.input.connect(this.eq),this.eq.connect(this.convolver),this.convolver.connect(this.output),this.sampleFiles={plate:"./audio/plate_reverb.mp3",spring:"./audio/spring_reverb.mp3",hall:"./audio/hall_reverb.mp3",ampeg:"./audio/ampeg_amp.mp3",marshall:"./audio/marshall_amp.mp3",vox:"./audio/voxAC30_amp.mp3",dreadnought:"./audio/dreadnought_guitar.mp3",taylor:"./audio/taylor_guitar.mp3",guitar:"./audio/custom_guitar.mp3",bell3:"berklee/bell_mallet_2.mp3",horn:"berklee/casiohorn2.mp3",chotone:"berklee/chotone_c4_!.mp3",voice:"berklee/femalevoice_aa_Db4.mp3",kalimba:"berklee/Kalimba_1.mp3",dreamyPiano:"salamander/A5.mp3",softPiano:"salamander/A4.mp3",piano:"salamander/A3.mp3",casio:"casio/C2.mp3"}}load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e){const e=document.createElement("input");e.type="file",e.accept="audio/*",e.onchange=e=>{const t=e.target.files[0];if(!t)return void console.log("No file selected");const n=new FileReader;n.onload=()=>{this.buffer=new r.Buffer(n.result),this.convolver.buffer=this.buffer,console.log("Audio loaded into diffuseur")},n.readAsDataURL(t)},e.click()}if("number"==typeof e){const t=Object.keys(this.sampleFiles);e=Math.floor(e)%t.length,e=t[e]}if(e in this.sampleFiles)return console.log(`Diffuseur loading ${e}`),this.sample=e,new Promise(((t,n)=>{new r.Buffer(this.sampleFiles[e],(e=>{this.buffer=e,this.convolver.buffer=e,t()}),n)}));console.error(`The sample "${e}" is not available.`)}async filterIR(e){if(!this.buffer)return void console.error("Buffer not loaded.");const t=r.getContext().rawContext,n=this.buffer.duration,s=new OfflineAudioContext(2,n*t.sampleRate,t.sampleRate),o=this.buffer.get(),a=s.createBufferSource();a.buffer=o;const c=s.createBiquadFilter();return c.type="lowpass",c.frequency.value=e,a.connect(c),c.connect(s.destination),a.start(0),new Promise(((e,t)=>{s.startRendering().then((t=>{const n=new r.Buffer(t);this.buffer=n,this.convolver.buffer=n,e()})).catch(t)}))}async stretchIR(e){if(!this.buffer)return void console.error("Buffer not loaded.");const t=r.getContext().rawContext,n=this.buffer.duration,s=new OfflineAudioContext(2,n*e*t.sampleRate,t.sampleRate),o=this.buffer.get(),a=s.createBufferSource();return a.buffer=o,a.playbackRate.value=1/e,a.connect(s.destination),a.start(0),new Promise(((e,t)=>{s.startRendering().then((t=>{const n=new r.Buffer(t);this.buffer=n,this.convolver.buffer=n,e()})).catch(t)}))}async highpassIR(e){if(!this.buffer)return void console.error("Buffer not loaded.");const t=r.getContext().rawContext,n=this.buffer.duration,s=new OfflineAudioContext(2,n*t.sampleRate,t.sampleRate),o=this.buffer.get(),a=s.createBufferSource();a.buffer=o;const c=s.createBiquadFilter();return c.type="highpass",c.frequency.value=e,a.connect(c),c.connect(s.destination),a.start(0),new Promise(((e,t)=>{s.startRendering().then((t=>{const n=new r.Buffer(t);this.buffer=n,this.convolver.buffer=n,e()})).catch(t)}))}setEQ(e,t,n){this.eq.high.value=n,this.eq.mid.value=t,this.eq.low.value=e}setEQBand(e,t){e<10||t<10?console.log("EQ bands are in Hz"):(this.eq.highFrequency.value=t,this.eq.lowFrequency.value=e)}listSamples(){const e=Object.keys(this.sampleFiles);console.log(e)}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}disconnect(e){e.input?this.output.disconnect(e.input):this.output.disconnect(e)}}},3820:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.DelayOp=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.DelayOp=class DelayOp{constructor(){this.input=new r.Multiply(1),this.hpf=new r.OnePoleFilter({type:"highpass",frequency:100}),this.delay=new r.FeedbackDelay,this.drive=new r.Multiply(.8),this.waveShaper=new r.WaveShaper((e=>.9*Math.tanh(16*e))),this.lpf=new r.Filter({frequency:2e3}),this.panner=new r.Panner(0),this.output=new r.Multiply(1),this.delayTime=new r.Signal(.1),this.input.connect(this.hpf),this.hpf.connect(this.delay),this.delay.connect(this.drive),this.drive.connect(this.waveShaper),this.waveShaper.connect(this.lpf),this.lpf.connect(this.panner),this.panner.connect(this.output),this.delayTime.connect(this.delay.delayTime)}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}}},3826:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paramDefinitions=void 0,t.paramDefinitions=e=>[{name:"time",min:.01,max:1,curve:2,type:"vco",callback:function(t){e.delay.delayTime.value=t,e.delayR.delayTime.value=t*e._delayRatio}},{name:"feedback",min:0,max:1.2,curve:.7,type:"vco",callback:function(t){e.feedbackMult.factor.value=t,e.feedbackMultR.factor.value=t}},{name:"damping",min:100,max:1e4,curve:2,callback:function(t){e.vcf.frequency.value=t,e.vcf.frequency.value=.9*t}},{name:"hpf",min:10,max:2e3,curve:2,callback:function(t){e.highpass.frequency.value=t}},{name:"dry",value:0,min:0,max:1.2,curve:2,type:"vca",callback:function(t){e.drySig.factor.value=t}},{name:"wet",min:0,max:1.2,curve:2,type:"vca",callback:function(t){e.wetSig.factor.value=t}},{name:"gain",min:0,max:1,curve:.2,type:"vca",callback:function(t){e.ws_input.factor.value=t}},{name:"amp",min:0,max:1.2,curve:2,type:"vca",callback:function(t){e.output.factor.value=t}},{name:"delayRatio",value:0,min:.5,max:1,curve:1,type:"vco",callback:function(t){e._delayRatio=t,e.time=e.delay.delayTime.value}}]},3926:(e,t)=>{"use strict";function createTimingInitModal(e,t){const n=document.createElement("div");n.className="timing-modal-container",n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.backgroundColor="rgba(0, 0, 0, 0.5)",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.zIndex="1000";const s=document.createElement("div");s.className="timing-modal-content",s.style.backgroundColor="white",s.style.padding="20px",s.style.borderRadius="5px",s.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.2)",s.style.width="400px",s.style.textAlign="center",s.style.color="#000000";const r=document.createElement("h3");r.textContent=e,r.style.marginTop="0",r.style.color="#000000";const o=document.createElement("p");o.textContent=t,o.style.color="#000000";const a=document.createElement("div");if(a.className="timing-spinner",a.style.border="4px solid #f3f3f3",a.style.borderTop="4px solid #3498db",a.style.borderRadius="50%",a.style.width="30px",a.style.height="30px",a.style.animation="timing-spin 2s linear infinite",a.style.margin="20px auto",!document.getElementById("timing-spinner-style")){const e=document.createElement("style");e.id="timing-spinner-style",e.textContent="@keyframes timing-spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }",document.head.appendChild(e)}return s.appendChild(r),s.appendChild(o),s.appendChild(a),n.appendChild(s),document.body.appendChild(n),{close:function close(){document.body.contains(n)&&document.body.removeChild(n)},modalContainer:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.createTimingInitModal=createTimingInitModal,t.handleTimingInitialization=async function handleTimingInitialization(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Timing Object";const r=createTimingInitModal(`Initializing ${s}`,`Please wait while the ${s} is being initialized. This may take a few seconds...`);try{const n=await e();return r.close(),t&&t(n),n}catch(e){return r.close(),console.error(`Error initializing ${s}:`,e),alert(`Failed to initialize ${s}: ${e.message}`),n&&n(e),null}}},3941:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Seq=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),r=n(1077),o=n(6192);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Seq=class Seq{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"8n",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.synth=e,this.vals=Array.isArray(t)?t:(0,r.parsePitchStringSequence)(t),this._subdivision=n,this._octave=0,this._sustain=.1,this._roll=.02,this._velocity=100,this._orn=0,this._lag=0,this._transform=e=>e,this.phraseLength=s,this.enable=1,this.min=24,this.max=127,this.loopInstance=null,this.num=o,this.callback=a,this.parent=null,this.index=0,this.ornaments=[[1,1,1],[2,2,2],[1,2,3],[2,1,2],[1,1,8],[1,2,4],[2,1,4],[4,1,4]],this.createLoop()}get subdivision(){return this._subdivision}set subdivision(e){this._subdivision=e,this.setSubdivision(e)}get octave(){return this._octave}set octave(e){this._octave=e}get sustain(){return this._sustain}set sustain(e){this._sustain=e}get roll(){return this._roll}set roll(e){this._roll=e}get velocity(){return this._velocity}set velocity(e){this._velocity=e}get orn(){return this._orn}set orn(e){this._orn=e}get lag(){return this._lag}set lag(e){this._lag=e}get transform(){return this._transform}set transform(e){if("function"!=typeof e)throw new TypeError("Transform must be a function");this._transform=e}sequence(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"infinite";this.vals=Array.isArray(e)?e:(0,r.parsePitchStringSequence)(e),this.phraseLength=n,this.subdivision=t,this.loopInstance&&this.loopInstance.dispose(),this.createLoop(),this.start()}drumSequence(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"infinite";this.vals=Array.isArray(e)?e:(0,r.parseStringSequence)(e),this.phraseLength=n,this.subdivision=t,this.loopInstance&&this.loopInstance.dispose(),this.createLoop()}createLoop(){this.loopInstance=new s.Loop((e=>{if(this.index=Math.floor(r.Theory.ticks/s.Time(this.subdivision).toTicks()),0===this.enable)return;let t=this.vals[this.index%this.vals.length];null==t&&(t="."),t=this.perform_transform(t),t=this.checkForRandomElement(t);let n=(0,r.parsePitchStringBeat)(t,e);n=this.applyOrnamentation(n);const o=n.map((e=>e[1]));let a=this.getNoteParam(this.roll,this.index);a*=s.Time(this.subdivision);for(let e=1;e<n.length;e++)o[e]===o[e-1]&&(n[e][1]=n[e-1][1]+a);for(const t of n)this.callback(t,e,this.index,this.num);"infinite"!==this.phraseLength&&(this.phraseLength-=1,this.phraseLength<1&&this.stop())}),this.subdivision).start(0),this.setSubdivision(this.subdivision),s.Transport.start()}applyOrnamentation(e){let t;t=Array.isArray(this._orn)?this._orn[this.index%this._orn.length]:this._orn%this.ornaments.length;let[n,s,r]=this.ornaments[t],a=[],c=e.length,l=1/r;for(let[t,h]of e)"."===t?a.push([".",h]):(0,o.orn)(t,n,s,r).forEach(((e,t)=>{"."!==e&&a.push([e,h+t*l*(1/c)])}));return a}checkForRandomElement(e){if("number"==typeof e)return e;if("string"==typeof e&&e.includes("?")){let t=[];this.vals.forEach((e=>{if("string"==typeof e){const n=/[#b]?[A-Ga-g]/g,s=/[oOxX\*\^]/g,r=/(-?\d+)/g,o=/([oOxX\*\^])\s*(1|2|3)/g;let a=e.match(n);a&&t.push(...a);let c=e.match(s);if(c){t.push(...c);let n=e.match(o);n&&n.forEach((e=>{const[n,s]=e.split(/\s*/);t.push(s)}))}let l=e.match(r);l&&t.push(...l)}})),e=e.replace(/\?/g,(()=>t[Math.floor(Math.random()*t.length)]))}return e}getNoteParam(e,t){return Array.isArray(e)?e[t%e.length]:e}setNoteParam(e,t){for(let n=0;n<t.length;n++)t[n]=e;return t}start(){this.enable=1,this.phraseLength="infinite"}stop(){this.enable=0}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.vals.length;this.phraseLength=e,this.enable=1}expr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"16n";const s=Array.from({length:t},((t,n)=>e(n)));this.vals=s.map((e=>"string"==typeof e?e:Array.isArray(e)?JSON.stringify(e):e)),this.phraseLength="infinite",this.sequence(this.vals,n)}setSubdivision(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"8n";this._subdivision=e,this.loopInstance&&(this.loopInstance.interval=s.Time(this.subdivision))}perform_transform(e){if("string"==typeof e&&/^[A-Ga-g][#b]?\d/.test(e))return e;if(isNaN(Number(e))){if("["===e[0]){for(let t=0;t<e.length;t++)if(!isNaN(Number(e[t]))&&""!==e[t].trim()){let n=e[t],s=t;for(;s<e.length-1&&!isNaN(Number(e[s+1]))&&""!==e[s+1].trim();)n+=e[s+1],s+=1;let r=String(this.transform(Number(n)));e=e.slice(0,t)+r+e.slice(s+1),s+=r.length-n.length,t=s}return e}return"[]"===e?(this.transform("."),"."):(this.transform("."),e)}return String(this.transform(Number(e)))}setTransform(e){this.transform=e}dispose(){this.stop(),this.loopInstance&&this.loopInstance.dispose(),this.parent=null,this.sequence=null,this.callback=null}}},4154:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.QuadPanner=void 0;var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(1174),a=(n(3447),s(n(1297)),s(n(7173)));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class QuadPanner extends o.MonophonicTemplate{constructor(){super(),this.context=window.audioContext,this.name="panner",this.channelMerger=this.context.createChannelMerger(4);let e=window.audioContext.destination.maxChannelCount;window.audioContext.destination.channelCount=e,window.audioContext.destination.channelCountMode="explicit",window.audioContext.destination.channelInterpretation="discrete",this.channelMerger.channelCountMode="explicit",this.channelMerger.channelInterpretation="discrete",this.channelMerger.connect(window.audioContext.destination),this.input=new r.Multiply(1),this.channel=[];for(let e=0;e<4;e++)this.channel.push(new r.Multiply(.5)),this.input.connect(this.channel[e]),this.channel[e].connect(this.channelMerger,0,e);this._x=0,this._y=0,this.output=this.channelMerger,this.paramDefinitions=(0,a.default)(this),this.param=this.generateParameters(this.paramDefinitions),this.createAccessors(this,this.param),this.autocompleteList=this.paramDefinitions.map((e=>e.name))}x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this._x=e,this.pan(this._x,this._y)}y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this._y=e,this.pan(this._x,this._y)}pan(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e=Math.max(-1,Math.min(1,e)),t=Math.max(-1,Math.min(1,t));let s=.7;const r=Math.pow((1-e)*(1-t),s),o=Math.pow((1+e)*(1-t),s),a=Math.pow((1-e)*(1+t),s),c=Math.pow((1+e)*(1+t),s),l=.01;null==n?(this.channel[0].factor.rampTo(r,l),this.channel[1].factor.rampTo(o,l),this.channel[2].factor.rampTo(c,l),this.channel[3].factor.rampTo(a,l)):(this.channel[0].factor.setValueAtTime(r,n),this.channel[1].factor.setValueAtTime(o,n),this.channel[2].factor.setValueAtTime(c,n),this.channel[3].factor.setValueAtTime(a,n))}setAngle(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=e*Math.PI/180,r=Math.cos(s)*t,o=Math.sin(s)*t;this._x=r,this._y=o,this.pan(this._x,this._y,n)}dispose(){this.lrPanner.dispose(),this.fbPanner.dispose(),this.splitter.disconnect(),this.channelMerger.disconnect(),console.log("SimpleQuadPanner disposed.")}}t.QuadPanner=QuadPanner},4287:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.MidiOut=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(1174),a=n(5961),c=n(1077);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class MidiOut extends o.MonophonicTemplate{constructor(){super(),this.isGlide=!1,this.name="MidiOut",console.log(this.name," loaded"),this.midiOutput=a.midiHandlerInstance,this.channel=1}triggerAttackRelease(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(console.log("AR",e,t,s),s?(r.now(),r.Time(s).toSeconds()):r.now(),r.Time(n).toSeconds(),this.midiOutput){this.channel;const o=e;r.Draw.schedule((()=>{this.midiOutput.sendNoteOn(o,t)}),s),r.Draw.schedule((()=>{this.midiOutput.sendNoteOff(o,0)}),s+n)}}parseNoteString(e,t,n,s){if("."===e[0])return;let o="";o=/^[a-ac-zA-Z]$/.test(e[0][0])?(0,c.pitchNameToMidi)(e[0]):(0,c.intervalToMidi)(e[0],this.min,this.max);const a=e[1];if(o<0)return;let l=this.getNoteParam(this.octave[n],s),h=this.getNoteParam(this.velocity[n],s),u=this.getNoteParam(this.sustain[n],s);try{this.triggerAttackRelease(o+12*l,h,u,t+a*r.Time(this.subdivision[n]))}catch(e){console.log("invalid note",o+12*l,h,u)}}}t.MidiOut=MidiOut},4426:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Caverns=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(3820);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Caverns=class Caverns{constructor(){this.input=new r.Multiply(1),this.delay=[];for(let e=0;e<8;e++)this.delay.push(new o.DelayOp);this.cross=[];for(let e=0;e<8;e++)this.cross.push(new r.Multiply);this.output=new r.Multiply(.125);for(let e=0;e<8;e++){this.input.connect(this.delay[e].input),this.delay[e].connect(this.output);for(let t=e+1;t<8;t++)this.delay[e].connect(this.cross[t]);this.cross[e].connect(this.delay[e].input)}}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}setDelayTime=function(e){for(let t=0;t<8;t++)this.delay[t].delayTime.value=e*1.25**t};setFeedback=function(e){for(let t=0;t<8;t++)this.delay[t].delay.feedback.value=e};setCross=function(e){for(let t=0;t<8;t++)this.cross[t].factor.value=e};setLowpass=function(e){for(let t=0;t<8;t++)this.delay[t].lpf.frequency.value=e};setHighpass=function(e){for(let t=0;t<8;t++)this.delay[t].hpf.frequency=e};setDrive=function(e){for(let t=0;t<8;t++)this.delay[t].drive.factor.value=e};setPanning=function(e){for(let t=0;t<8;t++)this.delay[t].panner.pan.rampTo(Math.sin(t*e),.1)}}},4658:e=>{"use strict";e.exports=window.io},4994:e=>{e.exports=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},5056:(e,t,n)=>{"use strict";e.exports=function setAttributesWithoutAttributes(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{"use strict";var t=[];function getIndexByIdentifier(e){for(var n=-1,s=0;s<t.length;s++)if(t[s].identifier===e){n=s;break}return n}function modulesToDom(e,n){for(var s={},r=[],o=0;o<e.length;o++){var a=e[o],c=n.base?a[0]+n.base:a[0],l=s[c]||0,h="".concat(c," ").concat(l);s[c]=l+1;var u=getIndexByIdentifier(h),d={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==u)t[u].references++,t[u].updater(d);else{var f=addElementStyle(d,n);n.byIndex=o,t.splice(o,0,{identifier:h,updater:f,references:1})}r.push(h)}return r}function addElementStyle(e,t){var n=t.domAPI(t);return n.update(e),function updater(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,n){var s=modulesToDom(e=e||[],n=n||{});return function update(e){e=e||[];for(var r=0;r<s.length;r++){var o=getIndexByIdentifier(s[r]);t[o].references--}for(var a=modulesToDom(e,n),c=0;c<s.length;c++){var l=getIndexByIdentifier(s[c]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}s=a}}},5164:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Drummer=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),r=n(9672),o=(n(1077),n(6737));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}n(3447);class Drummer extends r.DrumTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kick",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"acoustic";super(),this.name="Drummer",this.voice=e,this.kit=t,this.drumkitList=["LINN","Techno","TheCheebacabra1","TheCheebacabra2","acoustic-kit","breakbeat13","breakbeat8","breakbeat9","4OP-FM","Bongos","CR78","KPR77","Kit3","Kit8"],this.output=new s.Multiply(1),this.env=new s.Envelope(.001,1,1,10),this.vca=new s.Multiply,this.gain=new s.Multiply(1),this.drum=new s.Player,this.vcf=new s.Filter({type:"lowpass",rolloff:"-12",Q:0,frequency:1e4}),this.vcfEnvDepth=new s.Multiply,this.cutoffFreq=new s.Signal,this.accentEnv=new s.Envelope({attack:.003,decay:.1,sustain:0,release:.1}),this.accentDepth=new s.Multiply,this.drum.connect(this.vcf),this.vcf.connect(this.vca),this.vca.connect(this.output),this.cutoffFreq.connect(this.vcf.frequency),this.env.connect(this.vcfEnvDepth),this.accentEnv.connect(this.vcfEnvDepth),this.vcfEnvDepth.connect(this.vcf.frequency),this.env.connect(this.gain),this.gain.connect(this.vca.factor),this.accentEnv.connect(this.accentDepth),this.accentDepth.connect(this.vca.factor),this.velocity=new o.SimpleSeq(1),this.strike=new o.SimpleSeq(0),this.curStrike=0,this.damp=new o.SimpleSeq(0),this.chokeRatio=.5,this.choke=new o.SimpleSeq(0),this.decay=new o.SimpleSeq(1),this.tone=new o.SimpleSeq(1),this.accent=new o.SimpleSeq(0),this.accentLevel=.2,this.tuning=new o.SimpleSeq(1),this.subdivision=new o.SimpleSeq("16n"),this.sampleLength=1,this.loadSamples(this.kit),this.prevTime=0}loadKit(e){this.loadSamples(e)}listKits(){console.log(this.drumkitList)}loadSamples(e){this.kit=e,this.drumFolders={"4OP-FM":"4OP-FM",FM:"4OP-FM",Bongos:"Bongos",Bongo:"Bongos",CR78:"CR78",KPR77:"KPR77",Kit3:"Kit3",kit3:"Kit3",Kit8:"Kit8",kit8:"Kit8",LINN:"LINN",linn:"LINN",R8:"R8",Stark:"Stark",stark:"Stark",Techno:"Techno",techno:"Techno",TheCheebacabra1:"TheCheebacabra1",Cheese1:"TheCheebacabra1",TheCheebacabra2:"TheCheebacabra2",Cheese2:"TheCheebacabra2","acoustic-kit":"acoustic-kit",acoustic:"acoustic-kit",Acoustic:"acoustic-kit",breakbeat13:"breakbeat13",breakbeat8:"breakbeat8",breakbeat9:"breakbeat9"},this.kit in this.drumFolders?(console.log(`Drumsampler loading ${this.kit}`),this.baseUrl="https://tonejs.github.io/audio/drum-samples/".concat(this.drumFolders[this.kit]),this.urls={C3:"/kick.mp3",D3:"/snare.mp3","F#3":"/hihat.mp3",F3:"/tom1.mp3",G3:"/tom2.mp3",A3:"/tom3.mp3"},this.drum=new s.Player({url:this.baseUrl.concat("/"+this.voice+".mp3"),onload:()=>{this.sampleLength=this.drum.buffer.duration,console.log("Sample length:",this.sampleLength," seconds"),this.drum.connect(this.vcf)}})):console.error(`The kit "${this.kit}" is not available.`)}trigger(e,t){console.log("trig",e);try{this.drum.volume.setValueAtTime(s.gainToDb(e),t),this.drum.start(t,this.curStrike),this.env.triggerAttackRelease(.001,t)}catch(e){console.log("time error")}}parseNoteString(e,t,n,r){if("."===e[0])return;let o=e[0],a=e[1];this.loopFunc(r,n,o,t+a*s.Time(this.subdivision[n]))}getNoteParam(e,t){return Array.isArray(e)?e[t%e.length]:e}setNoteParam(e,t){for(let n=0;n<t.length;n++)t[n]=e;return t}toneScalar(e,t){e=Math.pow(e,2),this.vcfEnvDepth.factor.setValueAtTime(4e3*e,t),this.cutoffFreq.setValueAtTime(1e4*(1-e),t)}loopFunc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:127,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.now(),o=n*this.velocity.get(t,e),a=this.decay.get(t,e);this.env.release=this.sampleLength*a,1!=this.choke.get(t,e)&&(a*=this.chokeRatio),this.toneScalar(this.damp.get(t,e),r),this.accent.get(t,e)&&this.accentEnv.triggerAttackRelease(.05),this.curStrike=this.strike.get(t,e),this.trigger(o,r)}}t.Drummer=Drummer},5213:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Feedback=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(3447);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Feedback=class Feedback{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.input=new r.Multiply(e),this.delay=new r.Delay(t),this._feedback=new r.Multiply(n),this._output=new r.Multiply(1),this.input.connect(this.delay),this.delay.connect(this._feedback),this._feedback.connect(this.delay),this.delay.connect(this._output);let s=[{name:"inputGain",min:0,max:1,curve:2,callback:e=>this.input.factor.value=e},{name:"time",min:.01,max:1,curve:2,callback:e=>this.delay.delayTime.value=e},{name:"feedback",min:0,max:1,curve:1,callback:e=>this._feedback.factor.value=e},{name:"outputGain",min:0,max:1,curve:2,callback:e=>this._output.factor.value=e}];this.param=this.generateParameters(s),this.createAccessors(this,this.param)}generateParameters(e){const t={};return e.forEach((e=>{const n=new o.Parameter(e);t[e.name]=n})),t}createAccessors(e,t){Object.keys(t).forEach((n=>{Object.defineProperty(e,n,{get:()=>t[n].value,set:e=>{t[n].value=e}})}))}get(){let e="Parameters:\n";for(let t in this.param){const n=this.param[t];e+=`${n.name}: ${n.value}\n`}}connect(e){e.input?this._output.connect(e.input):this._output.connect(e)}disconnect(e){e.input?this._output.disconnect(e.input):this._output.disconnect(e)}}},5220:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.DrumSampler=void 0;var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(9672),a=s(n(8642)),c=n(1077),l=n(3447),h=n(3941);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class DrumSampler extends o.DrumTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.gui=t,this.presets=a.default,this.name="DrumSampler",this.kit=e,this.drumkitList=["LINN","Techno","TheCheebacabra1","TheCheebacabra2","acoustic-kit","breakbeat13","breakbeat8","breakbeat9","4OP-FM","Bongos","CR78","KPR77","Kit3","Kit8"],this.closedEnv=new r.Envelope({attack:0,decay:.5,sustain:0,release:.4}),this.openEnv=new r.Envelope({attack:0,decay:1,sustain:0,release:.4}),this.hatVca=new r.Multiply,this.openHatChoke=new r.Multiply,this.comp=new r.Compressor(-20,4),this.distortion=new r.Distortion(.5),this.output=new r.Multiply(.8),this.dry_kick=new r.Multiply(0),this.kickEnv=new r.Envelope(0,1,1,10),this.kick_vca=new r.Multiply,this.kick_gain=new r.Multiply(1),this.kick=(new r.Player).connect(this.kick_vca),this.snareEnv=new r.Envelope(0,1,1,10),this.snare_vca=new r.Multiply,this.snare_gain=new r.Multiply(1),this.snare=(new r.Player).connect(this.snare_vca),this.hihat_vca=new r.Multiply(.9),this.hihat=(new r.Player).connect(this.hihat_vca),this.tom=[],this.tomEnv=[],this.tom_vca=[],this.tom_gain=[];for(let e=0;e<3;e++)this.tomEnv.push(new r.Envelope(0,1,1,10)),this.tom_vca.push(new r.Multiply),this.tom_gain.push(new r.Multiply(.8)),this.tom.push(new r.Player);for(let e=0;e<3;e++)this.tom[e].connect(this.tom_vca[e]),this.tomEnv[e].connect(this.tom_gain[e]),this.tom_gain[e].connect(this.tom_vca[e].factor),this.tom_vca[e].connect(this.comp);this.kickEnv.connect(this.kick_gain),this.kick_gain.connect(this.kick_vca.factor),this.kick_vca.connect(this.comp),this.snareEnv.connect(this.snare_gain),this.snare_gain.connect(this.snare_vca.factor),this.snare_vca.connect(this.comp),this.hihat_vca.connect(this.hatVca),this.kick_vca.connect(this.dry_kick),this.comp.connect(this.distortion),this.distortion.connect(this.output),this.closedEnv.connect(this.hatVca.factor),this.openEnv.connect(this.openHatChoke),this.openHatChoke.connect(this.hatVca.factor),this.hatVca.connect(this.comp),this.dry_kick.connect(this.output),this.newKick=new DrumVoice,this.newKick.output.connect(this.comp),this.newHat=new DrumVoice,this.newHat.output.connect(this.comp),this.p1=new DrumVoice,this.p1.output.connect(this.comp),setTimeout((()=>this.loadSamples(this.kit)),100),this.hatDecay=.05,this.prevTime=0,this.kickGhostVelocity=new Array(10).fill(.25),this.snareGhostVelocity=new Array(10).fill(1/4),this.kickVelocity=new Array(10).fill(1),this.snareVelocity=new Array(10).fill(1),this.closedVelocity=new Array(10).fill(.75),this.openVelocity=new Array(10).fill(1),this.p1Velocity=new Array(10).fill(1),this.p2Velocity=new Array(10).fill(1),this.p3Velocity=new Array(10).fill(1),null!==this.gui&&(this.initGui(),this.hideGui(),setTimeout(this.loadPreset("default"),1e3));for(let e=0;e<10;e++)this.subdivision[e]="16n"}get kickDecay(){return this.kickEnv.release}set kickDecay(e){this.kickEnv.release=e}get snareDecay(){return this.snareEnv.release}set snareDecay(e){this.snareEnv.release=e}get closedDecay(){return this.closedEnv.release}set closedDecay(e){this.closedEnv.release=e}get openDecay(){return this.openEnv.decay}set openDecay(e){this.openEnv.decay=e}get p1Decay(){return this.tomEnv[0].release}set p1Decay(e){this.tomEnv[0].release=e}get p2Decay(){return this.tomEnv[1].release}set p2Decay(e){this.tomEnv[1].release=e}get p3Decay(){return this.tomEnv[2].release}set p3Decay(e){this.tomEnv[2].release=e}get kickRate(){return this.kick.playbackRate}set kickRate(e){this.kick.playbackRate=e}get snareRate(){return this.snare.playbackRate}set snareRate(e){this.snare.playbackRate=e}get closedRate(){return this.hihat.playbackRate}set closedRate(e){this.hihat.playbackRate=e}get p1Rate(){return this.tom[0].playbackRate}set p1Rate(e){this.tom[0].playbackRate=e}get p2Rate(){return this.tom[1].playbackRate.playbackRate}set p2Rate(e){this.tom[1].playbackRate=e}get p3Rate(){return this.tomEnv[2].playbackRate}set p3Rate(e){this.tom[2].playbackRate=e}get threshold(){return this.comp.threshold.value}set threshold(e){this.comp.threshold.value=e}get ratio(){return this.comp.ratio.value}set ratio(e){this.comp.ratio.value=e}get dist(){return this.distortion.distortion}set dist(e){this.distortion.distortion=e}get volume(){return this.output.factor.value}set volume(e){this.output.factor.value=e}set dryKick(e){this.dry_kick.factor.value=e}get dryKick(){return this.dry_kick.factor.value}setVelocity(e,t,n){if(n>1&&(n/=127),t>=0&&t<10)switch(e){case"kick":case"O":this.kickVelocity[t]=n;break;case"snare":case"X":this.snareVelocity[t]=n;break;case"closed":case"*":this.closedVelocity[t]=n;break;case"open":case"^":this.openVelocity[t]=n;break;case"p1":case"1":case"p2":case"2":case"p3":case"3":this.p1Velocity[t]=n;break;case"o":this.kickGhostVelocity[t]=n;break;case"x":this.snareGhostVelocity[t]=n}else for(let s=0;s<10;s++)switch(e){case"kick":case"O":this.kickVelocity[s]=n;break;case"snare":case"X":this.snareVelocity[s]=n;break;case"closed":case"*":this.closedVelocity[s]=n;break;case"open":case"^":this.openVelocity[s]=n;break;case"p1":case"1":case"p2":case"2":case"p3":case"3":this.p1Velocity[t]=s;break;case"o":this.kickGhostVelocity[t]=n;break;case"x":this.snareGhostVelocity[t]=n}}loadKit(e){this.loadSamples(e)}listKits(){console.log(this.drumkitList)}loadSamples(e){if(this.kit=e,this.drumFolders={"4OP-FM":"4OP-FM",FM:"4OP-FM",Bongos:"Bongos",Bongo:"Bongos",CR78:"CR78",KPR77:"KPR77",Kit3:"Kit3",kit3:"Kit3",Kit8:"Kit8",kit8:"Kit8",LINN:"LINN",linn:"LINN",R8:"R8",Stark:"Stark",stark:"Stark",Techno:"Techno",techno:"Techno",TheCheebacabra1:"TheCheebacabra1",Cheese1:"TheCheebacabra1",TheCheebacabra2:"TheCheebacabra2",Cheese2:"TheCheebacabra2","acoustic-kit":"acoustic-kit",acoustic:"acoustic-kit",Acoustic:"acoustic-kit",breakbeat13:"breakbeat13",breakbeat8:"breakbeat8",breakbeat9:"breakbeat9"},this.kit in this.drumFolders)console.log(`Drumsampler loading ${this.kit}`),this.baseUrl="https://tonejs.github.io/audio/drum-samples/".concat(this.drumFolders[this.kit]);else{if("default"!==this.kit)return void console.error(`The kit "${this.kit}" is not available.`);this.baseUrl="./audio/drumDefault"}this.urls={C3:"/kick.mp3",D3:"/snare.mp3","F#3":"/hihat.mp3",F3:"/tom1.mp3",G3:"/tom2.mp3",A3:"/tom3.mp3"};try{this.kick.load(this.baseUrl.concat("/kick.mp3")),this.snare.load(this.baseUrl.concat("/snare.mp3")),this.hihat.load(this.baseUrl.concat("/hihat.mp3")),this.newHat.voice.load(this.baseUrl.concat("/hihat.mp3")),this.tom[0].load(this.baseUrl.concat("/tom1.mp3")),this.tom[1].load(this.baseUrl.concat("/tom2.mp3")),this.tom[2].load(this.baseUrl.concat("/tom3.mp3")),this.newKick.voice.load(this.baseUrl.concat("/kick.mp3"))}catch(e){console.log("unable to load samples - try calling loadPreset(`default`)")}}trigger(e,t,n){if(e.loaded)switch(e){case"kick":this.triggerVoice(this.kick,t,n);break;case"snare":this.triggerVoice(this.snare,t,n);break;case"hihat":this.triggerVoice(this.hihat,t,n);break;case"tom1":this.triggerVoice(this.tom[0],t,n);break;case"tom2":this.triggerVoice(this.tom[1],t,n);break;case"tom3":this.triggerVoice(this.tom[2],t,n);break;default:console.error(`Unknown voice: ${e}`)}else console.error("Sampler is not loaded yet.")}sequence(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"infinite";console.log(e,n),this.seq[n]?this.seq[n].drumSequence(e,t,s):(this.seq[n]=new h.Seq(this,"0",t,s,n,this.triggerDrum.bind(this)),this.seq[n].parent=this,this.seq[n].vals=(0,c.parseStringSequence)(e),this.seq[n].loopInstance.stop(),this.seq[n].createLoop=this.newCreateLoop,this.seq[n].createLoop())}setSeq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"8n",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.seq[n]=(0,c.parseStringSequence)(e),t&&this.setSubdivision(t,n)}createLoop(e,t){null===this.loopInstance[t]&&(this.loopInstance[t]=new r.Loop((e=>{if(this.index=Math.floor(r.Transport.ticks/r.Time(this.subdivision[t]).toTicks()),0===this.enable[t])return;0==t&&this.callback(this.index);let n=this.seq[t][this.index%this.seq[t].length];n=this.checkForRandomElement(t,n);const s=(0,c.parseStringBeat)(n,e);for(const n of s)this.triggerDrum(n[0],t,e+n[1]*r.Time(this.subdivision[t]));"infinite"!==this.phraseLength[t]&&(this.phraseLength[t]-=1,this.phraseLength[t]<1&&this.stop(t))}),e).start(0),r.Transport.start(),console.log("loop started")),e&&setTimeout(this.setSubdivision(e,t),100),this.start(t)}newCreateLoop(){console.log("loop made"),this.loopInstance=new r.Loop((e=>{if(0===this.enable)return;this.index=Math.floor(r.Transport.ticks/r.Time(this.subdivision).toTicks());let t=this.vals[this.index%this.vals.length];t=this.perform_transform(t),t=this.checkForRandomElement(t);const n=(0,c.parseStringBeat)(t,e);for(const t of n)this.parent.triggerDrum(t[0],e+t[1]*r.Time(this.subdivision),this.index,this.num)}),this.subdivision).start(0),this.setSubdivision(this.subdivision),r.Transport.start(),console.log("loop started"),this.loopInstance.start(),r.Transport.start()}triggerDrum=(()=>{var e=this;return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.immediate(),s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t=t[0],e.getSeqParam(e.seq[o].octave,s),e.getSeqParam(e.seq[o].velocity,s),e.getSeqParam(e.seq[o].sustain,s);let a=e.getSeqParam(e.seq[o].subdivision,s);switch(n+=e.getSeqParam(e.seq[o].lag,s)*r.Time(a).toSeconds(),t){case".":break;case"0":case"O":e.newKick.trigger(1,1,n);break;case"o":e.newKick.trigger(.5,1.5,n);break;case"X":e.triggerVoice(e.snare,1,n);break;case"x":e.triggerVoice(e.snare,.5,n);break;case"*":e.newHat.triggerChoke(.75,.1,n);break;case"^":e.newHat.trigger(.75,1,n);break;case"1":e.triggerVoice(e.tom[0],1,n);break;case"2":e.triggerVoice(e.tom[1],1,n);break;case"3":e.triggerVoice(e.tom[2],1,n);break;default:console.log("triggerDrum(), no matching drum voice ",t,"\n")}}})();triggerNew(e,t,n){console.log("new"),this.newKick.voice.volume.setValueAtTime(r.gainToDb(t),n),this.newKick.voice.start(n),this.newKick.env1.triggerAttackRelease(.001,n)}triggerVoice(e,t,n){let s=null;e===this.kick?s=this.kickEnv:e===this.snare?s=this.snareEnv:e===this.tom[0]?s=this.tomEnv[0]:e===this.tom[1]?s=this.tomEnv[1]:e===this.tom[2]?s=this.tomEnv[2]:e===this.hihat?(this.closedEnv.triggerAttackRelease(.001,n),this.openHatChoke.factor.setValueAtTime(0,n)):"openHat"===e&&(e=this.hihat,this.openHatChoke.factor.setValueAtTime(1,n),this.openEnv.triggerAttackRelease(10,n));try{e.volume.setValueAtTime(r.gainToDb(t),n),e.start(n),null!==s&&s.triggerAttackRelease(.001,n)}catch(e){}}drawBeat(e){const t=["^","*","1","2","3","x","X","o","O"],n=document.getElementById(e),s=this.seq.original;n.innerHTML="";for(let e=0;e<s.length;e++){const r=s[e],o=t.indexOf(r);if(-1!==o){const t=20*o,s=40*e,a=document.createElement("div");a.className="beat",a.style.transform=`translate(${s}px, ${t}px)`,a.textContent=r,n.appendChild(a)}}}loadPreset(e){setTimeout((()=>{this.curPreset=e;const t=this.presets[this.curPreset];if(t){console.log("Loading preset ",this.curPreset,t);for(let e in t)try{for(let n of Object.values(this.gui_elements))n.id===e&&"momentary"!==n.type&&n.set(t[e])}catch(e){console.log(e)}}else console.log("No preset of name ",e)}),1e3)}initGui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;e&&(this.gui=e),this.x=t,this.y=n,this.enables_array=[],this.values_array=[];const s=this.createKnob("Kick",0,40,0,1,.5,[200,50,0],(e=>this.newKick.output.factor.value=e)),r=this.createKnob("Snare",0,20,0,1,.5,[200,50,0],(e=>this.snare_gain.factor.value=e)),o=this.createKnob("Hihat",0,0,0,1,.5,[200,50,0],(e=>this.newHat.output.factor.value=e)),a=this.createKnob("Toms",0,60,0,1,.5,[200,50,0],(e=>{this.tom_gain[0].factor.value=e,this.tom_gain[1].factor.value=e,this.tom_gain[2].factor.value=e})),c=this.createKnob("decay",10,40,0,1,.5,[200,50,0],(e=>this.newKick.decay=10*e+.01)),l=this.createKnob("decay",10,20,0,1,.5,[200,50,0],(e=>this.snareEnv.release=10*e+.01)),h=this.createKnob("decay",10,60,0,1,.5,[200,50,0],(e=>{this.tomEnv[0].release=10*e+.01,this.tomEnv[1].release=10*e+.01,this.tomEnv[2].release=10*e+.01})),u=this.createKnob("Output",80,60,0,4,1,[200,50,0],(e=>this.output.factor.value=e)),d=this.createKnob("Dry Kick",40,40,0,1,.4,[200,50,0],(e=>this.dry_kick.factor.value=e)),f=this.createKnob("rate",20,40,0,2,.4,[200,50,0],(e=>this.newKick.rate=e)),v=this.createKnob("rate",20,20,0,2,.4,[200,50,0],(e=>this.snare.playbackRate=e)),g=this.createKnob("rate",20,0,0,2,.4,[200,50,0],(e=>this.newHat.rate=e)),m=this.createKnob("1 Rate",20,60,0,2,.4,[200,50,0],(e=>this.tom[0].playbackRate=e)),y=this.createKnob("2 Rate",30,60,0,2,.4,[200,50,0],(e=>this.tom[1].playbackRate=e)),b=this.createKnob("3 Rate",40,60,0,2,.4,[200,50,0],(e=>this.tom[2].playbackRate=e)),_=this.createKnob("Threshold",60,20,-60,-5,.5,[200,50,0],(e=>this.comp.threshold.value=e)),w=this.createKnob("Ratio",60,40,1,20,.5,[200,50,0],(e=>this.comp.ratio.value=e)),k=this.createKnob("Distort",60,60,0,1,.5,[200,50,0],(e=>this.distortion.distortion=e)),x=this.createKnob("Closed Decay",40,0,.01,1,.75,[200,50,0],(e=>this.newHat.choke=e)),S=this.createKnob("Open Decay",50,0,.01,2,.75,[200,50,0],(e=>this.newHat.decay=e)),C=this.gui.Dropdown({label:"kit",dropdownOptions:this.drumkitList,x:80,y:10,size:15,callback:e=>{this.loadSamples(e)}});this.gui_elements=[s,r,o,a,c,l,h,u,d,f,v,g,m,y,b,_,w,k,x,S,C]}createKnob(e,t,n,s,r,o,a,c){return this.gui.Knob({label:e,min:s,max:r,size:o,accentColor:a,x:t+this.x,y:n+this.y,callback:c,curve:1,border:4,showLabel:1,showValue:1})}}t.DrumSampler=DrumSampler;class DrumVoice{constructor(){this.chokeRatio=.1,this.decayTime=1,this.startPoint=0,this.env=new r.Envelope(0,1,1,10),this.vca=new r.Multiply,this.output=new r.Multiply(1),this.dryOut=new r.Multiply(0),this.voice=(new r.Player).connect(this.vca),this.vca.connect(this.output),this.voice.connect(this.dryOut),this.env.connect(this.vca.factor);let e=[{name:"choke",min:0,max:1,curve:2,callback:e=>{this.chokeRatio=e}},{name:"decay",min:0,max:5,curve:3,callback:e=>{this.decayTime=e}},{name:"amp",min:0,max:1,curve:2,callback:e=>this.output.factor.value=e},{name:"dry",min:0,max:1,curve:2,callback:e=>this.dryOut.factor.value=e},{name:"rate",value:1,min:-10,max:10,curve:1,callback:e=>{this.voice.playbackRate=Math.abs(e),e<0&&(this.voice.reverse=!0)}}];this.param=this.generateParameters(e),this.createAccessors(this,this.param)}setDecayTime(e,t){this.decayTime=e,this.chokeRatio=t,this.env.release=e*t}triggerSample(e,t,n){try{this.voice.volume.setValueAtTime(r.gainToDb(e),n),this.voice.start(n,this.startPoint),this.env.triggerAttackRelease(.001,n)}catch(e){console.log("time error",e)}}trigger(e,t,n){this.env.release=this.decayTime,this.env.decay=this.decayTime,this.triggerSample(e,t,n)}triggerChoke(e,t,n){this.env.release=this.decayTime*this.chokeRatio,this.env.decay=this.decayTime*this.chokeRatio,this.triggerSample(e,t,n)}generateParameters(e){const t={};return e.forEach((e=>{const n=new l.Parameter(e);t[e.name]=n})),t}createAccessors(e,t){console.log(t),Object.keys(t).forEach((n=>{const s=t[n];if("function"!=typeof s.set)throw new Error(`Parameter '${n}' does not have a set method`);const r={get:(e,t)=>"string"!=typeof t||isNaN(t)?e.get():e.get(parseInt(t)),set:(e,t,n)=>(console.log(e,t,n),"string"!=typeof t||isNaN(t)?(e.set(n),!0):(e.set(n,parseInt(t)),!0))};Object.defineProperty(e,n,{get:()=>new Proxy(s,r),set:e=>s.set(e)})}))}setParameter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=this.param[e];if(!s)throw new Error(`Parameter '${e}' does not exist.`);n?s.callback(t,n):s.callback(t),s.guiElement&&s.guiElement.setValue(t)}get(){let e="Parameters:\n";for(let t in this.param){const n=this.param[t];e+=`${n.name}: ${n._value}\n`}console.log(e)}}},5294:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseVoice=void 0,s(n(5897)),n(5324);var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(3414)),a=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}n(3447),s(n(1297)),s(n(8609));class NoiseVoice extends a.MonophonicTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.gui=e,this.presets=o.default,this.isGlide=!1,this.name="NoiseVoice",this.source=(new r.Noise).start(),this.gain=new r.Multiply(.5),this.waveshaper=new r.WaveShaper((e=>Math.tanh(8*e))),this.hpf=new r.Filter({frequency:200,type:"highpass",Q:0}),this.lpf=new r.Filter({frequency:1e3,type:"lowpass",Q:0}),this.vca=new r.Multiply(0),this.output=new r.Multiply(1),this.env=new r.Envelope({attack:.01,decay:.1,sustain:0,release:.1}),this.velocitySig=new r.Signal(1),this.velocity_depth=new r.Multiply(1),this.env_depth=new r.Multiply(1),this.direct=new r.Signal(1),this.baseCutoff=new r.Signal(0),this.cutoffSignal=new r.Signal(1e3),this.hpf_band=new r.Multiply,this.lpf_band=new r.Multiply,this.hpf_env_depth=new r.Multiply,this.lpf_env_depth=new r.Multiply,this.source.connect(this.gain),this.gain.connect(this.waveshaper),this.waveshaper.connect(this.hpf),this.hpf.connect(this.lpf),this.lpf.connect(this.vca),this.vca.connect(this.output),this.env.connect(this.velocity_depth),this.velocitySig.connect(this.velocity_depth.factor),this.velocity_depth.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.direct.connect(this.vca.factor),this.baseCutoff.connect(this.hpf.frequency),this.baseCutoff.connect(this.lpf.frequency),this.cutoffSignal.connect(this.hpf.frequency),this.cutoffSignal.connect(this.lpf.frequency),this.cutoffSignal.connect(this.hpf_band),this.cutoffSignal.connect(this.lpf_band),this.hpf_band.connect(this.hpf.frequency),this.lpf_band.connect(this.lpf.frequency),this.env.connect(this.hpf_env_depth),this.env.connect(this.lpf_env_depth),this.hpf_env_depth.connect(this.hpf.frequency),this.lpf_env_depth.connect(this.lpf.frequency)}setCutoff(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.cutoffSignal.setValueAtTime(e,t):this.cutoffSignal.value=e}setResonance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n?("both"!==t&&"lpf"!==t||this.lpf.Q.setValueAtTime(e,n),"both"!==t&&"hpf"!==t||this.hpf.Q.setValueAtTime(e,n)):("both"!==t&&"lpf"!==t||(this.lpf.Q.value=e),"both"!==t&&"hpf"!==t||(this.hpf.Q.value=e))}setBandwidth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n?("both"!==t&&"hpf"!==t||this.hpf_band.factor.setValueAtTime(1-Math.pow(2,1/e),n),"both"!==t&&"lpf"!==t||this.lpf_band.factor.setValueAtTime(1-Math.pow(2,e),n)):("both"!==t&&"hpf"!==t||(this.hpf_band.factor.value=1-Math.pow(2,1/e)),"both"!==t&&"lpf"!==t||(this.lpf_band.factor.value=1-Math.pow(2,e)))}triggerAttack(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t?(this.env.triggerAttack(t),this.setCutoff(r.Midi(e).toFrequency(),t)):(this.env.triggerAttack(),this.setCutoff(r.Midi(e).toFrequency()),console.log("att",e))}triggerRelease(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?this.env.triggerRelease(e):this.env.triggerRelease()}triggerAttackRelease(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;n?(this.env.triggerAttackRelease(t,n),this.setCutoff(r.Midi(e).toFrequency(),n)):(this.env.triggerAttackRelease(t),this.setCutoff(r.Midi(e).toFrequency()))}}t.NoiseVoice=NoiseVoice},5309:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=e=>[{name:"type",type:"vco",value:"square",radioOptions:["square","saw","tri","sine"],callback:function(t){switch(t){case"square":e.vco.type="pulse";break;case"saw":e.vco.type="sawtooth";break;case"tri":e.vco.type="triangle";break;case"sine":e.vco.type="sine"}}},{name:"cutoff",type:"vcf",min:20,max:1e4,curve:2,isSignal:"true",connectTo:e=>e.cutoffSig,callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?e.cutoffSig.setValueAtTime(t,n):e.cutoffSig.value=t}},{name:"Q",type:"vcf",min:0,max:30,curve:2,callback:function(t){e.vcf.Q.value=t}},{name:"keyTrack",type:"hidden",min:0,max:2,curve:1,callback:function(t){e.keyTracker.factor.value=t}},{name:"envDepth",type:"vcf",min:-1e3,max:5e3,curve:2,callback:function(t){e.vcf_env_depth.factor.value=t}},{name:"level",type:"vca",min:0,max:1,curve:2,value:0,callback:function(t){e.vca_lvl.value=t}},{name:"attack",type:"env",min:0,max:1,curve:2,value:.01,callback:function(t){e.env.attack=t}},{name:"decay",type:"env",min:0,max:1,curve:2,value:.1,callback:function(t){e.env.decay=t}},{name:"sustain",type:"env",min:0,max:1,curve:2,value:.5,callback:function(t){e.env.sustain=t}},{name:"release",type:"env",min:0,max:1,curve:2,value:.5,callback:function(t){e.env.release=t}}]},5322:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Drone=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(8272)),a=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class Drone extends a.MonophonicTemplate{constructor(){super(),this.presets=o.default,this.name="Drone",this.frequency=new r.Signal(100),this.frequencyCV=new r.Signal,this.frequency_scalar=new r.Multiply(1),this.detune_scalar=new r.Multiply(1),this.vco_1=(new r.PulseOscillator).start(),this.vco_2=(new r.PulseOscillator).start(),this.frequency.connect(this.frequency_scalar),this.frequencyCV.connect(this.frequency_scalar.factor),this.frequency_scalar.connect(this.vco_1.frequency),this.frequency_scalar.connect(this.detune_scalar),this.detune_scalar.connect(this.vco_2.frequency),this.crossfade=new r.CrossFade,this.crossfade_lfo_depth=new r.Multiply,this.vco_1.connect(this.crossfade.a),this.vco_2.connect(this.crossfade.b),this.vcf=new r.Filter({type:"lowpass",rolloff:-24,Q:0,cutoff:3e3}),this.crossfade.connect(this.vcf),this.crossfade_constant=new r.Signal(0),this.crossfade_lfo_depth.connect(this.crossfade.fade),this.crossfade_constant.connect(this.crossfade.fade),this.vca=new r.Multiply,this.lfo_vca=new r.Multiply(1),this.lfo_vca_constant=new r.Signal(1),this.panner=new r.Panner(0),this.output=new r.Multiply(.25),this.vcf.connect(this.lfo_vca),this.lfo_vca.connect(this.vca),this.lfo_vca_constant.connect(this.lfo_vca.factor),this.vca.connect(this.panner),this.panner.connect(this.output),this.env=new r.Envelope,this.velocity=new r.Signal(1),this.velocity_depth=new r.Multiply(1),this.env.connect(this.velocity_depth),this.velocity_depth.connect(this.vca.factor),this.velocity.connect(this.velocity_depth.factor),this.cutoffSig=new r.Signal(1e3),this.cutoffSig.connect(this.vcf.frequency),this.cutoffCV=new r.Signal,this.cutoffCV.connect(this.vcf.frequency),this.keyTracking=new r.Multiply(.1),this.frequency.connect(this.keyTracking),this.keyTracking.connect(this.vcf.frequency),this.vcf_env=new r.Envelope,this.vcf_env_depth=new r.Multiply,this.vcf_env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.lfo=new r.Oscillator(.5).start(),this.vca_constant=new r.Signal(1),this.amp_lfo_depth=new r.Multiply(0),this.lfo.connect(this.amp_lfo_depth),this.amp_lfo_depth.connect(this.lfo_vca.factor),this.pitch_lfo_depth=new r.Multiply(0),this.lfo.connect(this.pitch_lfo_depth),this.lfo.connect(this.crossfade_lfo_depth),this.frequency_constant=new r.Signal(1),this.pitch_lfo_depth.connect(this.frequency_scalar.factor),this.frequency_constant.connect(this.frequency_scalar.factor),this.pwm_lfo_depth=new r.Multiply,this.lfo.connect(this.pwm_lfo_depth)}triggerAttack=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=r.Midi(e).toFrequency();t/=127,n?(this.frequency.setValueAtTime(s,n),this.env.triggerAttack(n),this.vcf_env.triggerAttack(n),this.velocity.setValueAtTime(Math.pow(t,2),n)):(this.frequency.value=s,this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.velocity.value=Math.pow(t,2))};triggerRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?(this.env.triggerRelease(t),this.vcf_env.triggerRelease(t)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())};triggerAttackRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=r.Midi(e).toFrequency(),t/=127,s?(this.frequency.setValueAtTime(e,s),this.env.triggerAttackRelease(n,s),this.vcf_env.triggerAttackRelease(n,s),this.velocity.setValueAtTime(Math.pow(t,2),s)):(this.frequency.value=e,this.env.triggerAttackRelease(n),this.vcf_env.triggerAttackRelease(n),this.velocity.value=Math.pow(t,2))};shapeVco(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=[];for(let e=0;e<64;e++)o.push(1/Math.pow(e+1,s)*16*(e%2<2-r)*Math.abs(1-Math.sin(e*Math.PI*t+Math.PI/2)*n));0===e?this.vco_1.partials=o:this.vco_2.partials=o}setHighpass(e){null!==this.super&&(this.super.hpf.frequency.value=e)}initGui(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.gui=e,this.x=t,this.y=n,this.vco_mix=this.createKnob("vco_mix",5,5,0,1,.75,[200,50,0],(e=>this.crossfade_constant.value=e)),this.detune=this.createKnob("detune",15,5,1,2,.75,[200,50,0],(e=>this.detune_scalar.factor.value=e)),this.cutoff=this.createKnob("cutoff",25,5,0,1e4,.75,[200,50,0],(e=>this.cutoffSig.value=e)),this.vcf_env_knob=this.createKnob("vcf env",35,5,0,5e3,.75,[200,50,0],(e=>this.vcf_env_depth.factor.value=e)),this.vcf_Q_knob=this.createKnob("Q",45,5,0,20,.75,[200,50,0],(e=>this.vcf.Q.value=e)),this.keyTracking_knob=this.createKnob("key vcf",55,5,0,1,.75,[200,50,0],(e=>this.keyTracking.factor.value=e)),this.highpass_knob=this.createKnob("hpf",65,5,10,3e3,.75,[200,50,0],(e=>this.setHighpass(e))),this.attack_knob=this.createKnob("a",5,45,.005,.5,.5,[200,50,0],(e=>this.env.attack=e)),this.decay_knob=this.createKnob("d",15,45,.01,10,.5,[200,50,0],(e=>this.env.decay=e)),this.sustain_knob=this.createKnob("s",25,45,0,1,.5,[200,50,0],(e=>this.env.sustain=e)),this.release_knob=this.createKnob("r",35,45,0,20,.5,[200,50,0],(e=>this.env.release=e)),this.vcf_attack_knob=this.createKnob("a",5,70,.005,.5,.5,[200,50,0],(e=>this.vcf_env.attack=e)),this.vcf_decay_knob=this.createKnob("d",15,70,.01,10,.5,[200,50,0],(e=>this.vcf_env.decay=e)),this.vcf_sustain_knob=this.createKnob("s",25,70,0,1,.5,[200,50,0],(e=>this.vcf_env.sustain=e)),this.vcf_release_knob=this.createKnob("r",35,70,0,20,.5,[200,50,0],(e=>this.vcf_env.release=e)),this.lfo_freq_knob=this.createKnob("lfo",45,65,0,20,.5,[200,50,0],(e=>this.lfo.frequency.value=e)),this.lfo_vibrato=this.createKnob("vibrato",55,65,0,.1,.5,[200,50,0],(e=>this.pitch_lfo_depth.factor.value=e)),this.lfo_tremolo=this.createKnob("tremolo",65,65,0,1,.5,[200,50,0],(e=>this.amp_lfo_depth.factor.value=e)),this.lfo_blend_knob=this.createKnob("blend",75,65,0,1,.5,[200,50,0],(e=>this.crossfade_lfo_depth.factor.value=e)),this.vco1_shape_knob=this.createKnob("shape1",75,25,0,1,.6,[200,50,0],(e=>this.shapeVco(0,2*e+1))),this.vco2_shape_knob=this.createKnob("shape2",85,25,0,1,.6,[200,50,0],(e=>this.shapeVco(1,2*e+1))),this.pan_knob=this.createKnob("pan",85,65,0,1,.5,[200,50,0],(e=>{this.super.pan(e)})),this.gui_elements=[this.vco_mix,this.detune,this.cutoff,this.vcf_env_knob,this.vcf_Q_knob,this.keyTracking_knob,this.highpass_knob,this.attack_knob,this.decay_knob,this.sustain_knob,this.release_knob,this.vcf_attack_knob,this.vcf_decay_knob,this.vcf_sustain_knob,this.vcf_release_knob,this.lfo_freq_knob,this.lfo_vibrato,this.lfo_tremolo,this.lfo_blend_knob,this.pan_knob,this.vco1_shape_knob,this.vco2_shape_knob]}}t.Drone=Drone},5324:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sketch=void 0;var _p5Elements=__webpack_require__(582);const sketch=p=>{let grey=p.color(220,229,234),div;p.setColor=_p5Elements.setColor,p.setFont=_p5Elements.setFont,p.debug=_p5Elements.debug,p.setTheme=_p5Elements.setp5Theme,p.listThemes=_p5Elements.listThemes,p.setThemeParameters=_p5Elements.setThemeParameters,p.exportTheme=_p5Elements.exportTheme,p.p5Code="",p.Debug=function(){p.debug()},p.setup=function(){p.canvas.parentElement.id;let e=document.getElementById(p.canvas.parentElement.id),t=p.initialize(e,grey);p.width=t[0],p.height=t[1],p.frame=0,p.x=0,p.y=0,p.capture=null},p.draw=function(){p.drawBackground();try{eval(p.p5Code)}catch(e){console.log("Error in p5Code: ",e)}p.frame+=1,p.drawElements()},p.mousePressed=function(){for(const e of Object.values(p.elements))if("string"!=typeof e)try{e.isPressed()}catch(e){}},p.mouseReleased=function(){for(const e of Object.values(p.elements))if("string"!=typeof e)try{e.isReleased()}catch(e){}},p.mouseClicked=function(){for(const e of Object.values(p.elements))if("string"!=typeof e)try{e.isClicked()}catch(e){}},p.mouseDragged=function(){for(const e of Object.values(p.elements))if("string"!=typeof e)try{e.isDragged()}catch(e){}},p.windowResized=function(){},p.openWebcam=function(e,t){p.capture=p.createCapture(p.VIDEO),p.capture.size(e,t),p.capture.hide(),console.log("Webcam opened with resolution:",e,"x",t)}};exports.sketch=sketch},5493:(e,t,n)=>{"use strict";var s=n(4994);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Percussion=void 0,s(n(5897)),function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}s.default=e,n&&n.set(e,s)}(n(5726)),t.Percussion=class Percussion{constructor(e){console.log(e)}trigger=function(e){e?(this.env.triggerAttackRelease(.01,e),this.pitch_env.triggerAttackRelease(.01,e)):(this.env.triggerAttackRelease(.01),this.pitch_env.triggerAttackRelease(.01))};connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}disconnect(e){e.input?this.output.disconnect(e.input):this.output.disconnect(e)}}},5726:e=>{"use strict";e.exports=window.Tone},5897:e=>{"use strict";e.exports=window.p5},5923:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.AnalogDelay=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));n(3820),n(3447),n(5944);var o=n(3826),a=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}s(n(1297));class AnalogDelay extends a.MonophonicTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(),this.name="analogDelay",this.input=new r.Multiply(1),this.highpass=new r.Filter({type:"highpass",frequency:20,Q:0}),this.ws_input=new r.Multiply(.125),this.waveShaper=new r.WaveShaper((e=>Math.tanh(e))),this.vcf=new r.Filter({type:"lowpass",frequency:5e3,Q:0,slope:"-12"}),this.vcfR=new r.Filter({type:"lowpass",frequency:5e3,Q:0,slope:"-12"}),this.delay=new r.Delay(e,e),this.delayR=new r.Delay(e,e),this._delayRatio=.75,this.feedbackMult=new r.Multiply(t),this.feedbackMultR=new r.Multiply(t),this.merge=new r.Merge(2),this.wetSig=new r.Multiply(1),this.drySig=new r.Multiply(0),this.output=new r.Multiply(1),this.input.connect(this.drySig),this.input.connect(this.highpass),this.highpass.connect(this.ws_input),this.ws_input.connect(this.waveShaper),this.waveShaper.connect(this.vcf),this.waveShaper.connect(this.vcfR),this.vcf.connect(this.delay),this.vcfR.connect(this.delayR),this.delay.connect(this.feedbackMult),this.delayR.connect(this.feedbackMultR),this.feedbackMult.connect(this.vcf),this.feedbackMultR.connect(this.vcfR),this.delay.connect(this.merge,0,0),this.delayR.connect(this.merge,0,1),this.merge.connect(this.wetSig),this.wetSig.connect(this.output),this.drySig.connect(this.output),this.lfo=new r.Oscillator(2).start(),this.lfoDepth=new r.Multiply,this.lfo.connect(this.lfoDepth),this.lfoDepth.connect(this.delay.delayTime),this.lfoDepth.connect(this.delayR.delayTime),this.paramDefinitions=(0,o.paramDefinitions)(this),this.param=this.generateParameters(this.paramDefinitions),this.createAccessors(this,this.param)}}t.AnalogDelay=AnalogDelay},5944:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var s=n(5072),r=n.n(s),o=n(7825),a=n.n(o),c=n(7659),l=n.n(c),h=n(5056),u=n.n(h),d=n(540),f=n.n(d),v=n(1113),g=n.n(v),m=n(2613),y={};y.styleTagTransform=g(),y.setAttributes=u(),y.insert=l().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=f(),r()(m.A,y);const b=m.A&&m.A.locals?m.A.locals:void 0},5953:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hardClip=function hardClip(e){return Math.max(Math.min(4*e,1),-1)},t.hardSync=function hardSync(e){return(e*=8)>0?e%1:e<0?Math.abs(e)%1*-1:0},t.pseudorandom=function pseudorandom(e){return(9187543225*(7*(Math.abs(e)-0))+12345)%4294967296/4294967296*2-1},t.pwm=function pwm(e){return e>.05?1:-1},t.sawToTri=function sawToTri(e){return e*=2.3,Math.abs(e)<=1?e:e>1?2-e:e<-1?-2-e:void 0},t.sineFolder=function sineFolder(e){return Math.sin(e*Math.PI*8)},t.softClip=function softClip(e){return Math.tanh(4*e)},t.triangleFolder=function triangleFolder(e){return e=Math.abs(8*e+.5),0==Math.floor(e%2)?e%1*2-1:2*(1-e%1)-1}},5961:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ccCallbacks=void 0,exports.getMidiIO=getMidiIO,exports.handleMidiInput=handleMidiInput,exports.muted=exports.midi_output_names=exports.midi_output_ids=exports.midi_input_names=exports.midi_input_ids=exports.midiMsgs=exports.midiHandlerInstance=exports.midi=void 0,exports.onMIDIFailure=onMIDIFailure,exports.onMIDISuccess=onMIDISuccess,exports.outputMidiID=void 0,exports.setMidiInput=setMidiInput,exports.setMidiOutput=setMidiOutput;var midi=exports.midi=null,muted=exports.muted=!1,outputMidiID=exports.outputMidiID=null,midiMsgs=exports.midiMsgs={},ccCallbacks=exports.ccCallbacks={};function onMIDISuccess(midiAccess){console.log("MIDI ready!"),exports.midi=midi=midiAccess,console.log(getMidiIO()),eval("globalThis.setMidiInput1 = setMidiInput;")}function onMIDIFailure(e){console.error(`Failed to get MIDI access - ${e}`)}function setMidiInput(e){for(var t of(Array.isArray(e)||(e=[e]),midi.inputs.forEach((function(e,t){e.onmidimessage=null})),e))t in midi_input_ids&null!=midi.inputs.get(midi_input_ids[t])?(midi.inputs.get(midi_input_ids[t]).onmidimessage=handleMidiInput,console.log("MIDI input set to: "+midi_input_names[t])):console.warn("Invalid input ID")}function setMidiOutput(e){Array.isArray(e)&&console.warn("Can only handle one MIDI output. Please enter one ID."),e in midi_output_ids&null!=midi.outputs.get(midi_output_ids[e])?(exports.outputMidiID=outputMidiID=midi_output_ids[e],console.log("MIDI output set to: "+midi_output_names[e]),midiHandlerInstance.setOutput(midi.outputs.get(outputMidiID))):console.warn("Invalid output ID")}navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(onMIDISuccess).catch(onMIDIFailure):console.log("Web MIDI API is not supported in this browser.");class MidiHandler{constructor(){this.noteOnHandler=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127;console.log("Default Note On Handler:",e,t),console.log("Define your own note on handler like this:\nsetNoteOnHandler(( note, vel, (optional:channel) ) => { <your code here> }) ")},this.noteOffHandler=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;console.log("Default Note Off Handler:",e,t),console.log("Define your own note off handler like this:\nsetNoteOffHandler(( note, vel, (optional:channel) ) => { <your code here> }) ")},this.CCHandler=function(e,t){console.log("Default CC Handler:",e,t),console.log("Define your own CC handler like this:\nsetCCHandler(( cc, value, (optionaL:channel) ) => { <your code here> }) ")},this.midiClockHandler=e=>{console.log("MIDI Clock message received",e.data[0])},this.midiOutput=null}setOutput(e){this.midiOutput=e}sendNoteOn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:127,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(console.log(e,t,n),this.midiOutput){const s=144|n-1;this.midiOutput.send([s,e,t])}else console.warn("No MIDI output is set.")}sendNoteOff(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(console.log(e,t,n),this.midiOutput){const s=128|n-1;this.midiOutput.send([s,e,t])}else console.warn("No MIDI output is set.")}sendCC(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.midiOutput){const s=176|n-1;this.midiOutput.send([s,e,t])}else console.warn("No MIDI output is set.")}handleNoteOn(e,t,n){this.noteOnHandler(e,t,n)}handleNoteOff(e,t,n){this.noteOffHandler(e,t,n)}handleCC(e,t,n){this.CCHandler(e,t,n)}handleMidiClock(e){this.midiClockHandler(e)}setNoteOnHandler(e){this.noteOnHandler=e}setNoteOffHandler(e){this.noteOffHandler=e}setCCHandler(e){this.CCHandler=e}setMidiClockHandler(e){this.midiClockHandler=e}}const midiHandlerInstance=exports.midiHandlerInstance=new MidiHandler;var midi_input_ids=exports.midi_input_ids={},midi_output_ids=exports.midi_output_ids={},midi_input_names=exports.midi_input_names={},midi_output_names=exports.midi_output_names={};function getMidiIO(){var e="MIDI Inputs:\n",t="MIDI Outputs:\n",n=null,s=null,r=1;for(var o of midi.outputs)t+=r+": "+o[1].name+"\n",s=o[1].id,midi_output_ids[r]=s,midi_output_names[r]=o[1].name,r+=1;for(var a of(r=1,midi.inputs))e+=r+": "+a[1].name+"\n",n=a[1].id,midi_input_ids[r]=n,midi_input_names[r]=a[1].name,r+=1;return e+t}function handleMidiInput(e){if(e.data[0]>=248)return void midiHandlerInstance.handleMidiClock(e);let t=1+(15&e.data[0]);if(null!=e.data[1]){let n=e.data[0];if(n>=128&&n<=159){let s=e.data[1],r=e.data[2];n>=128&&n<=143||r<1?midiHandlerInstance.handleNoteOff(s,r,t):midiHandlerInstance.handleNoteOn(s,r,t)}else if(n>=176&&n<=191){let n=e.data[1],s=e.data[2];midiHandlerInstance.handleCC(n,s,t)}}}},6192:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.orn=function orn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if("string"==typeof e&&/^[A-Ga-g][#b]?\d/.test(e))return[e];e=Number(e);const r=[[0,1,2,3],[0,2,1,3],[0,1,-1,0],[1,0,-1,0],[1,".",".",0],[1,0,".","."],[".",0,0,0],[".",0,".",0]];let o=[];t%=r.length;for(let a=0;a<s;a++)o.push(e+r[t][a%r[t].length]*n);return o}},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function toString(){return this.map((function(t){var n="",s=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),s&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),s&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function i(e,n,s,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(s)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(a[l]=!0)}for(var h=0;h<e.length;h++){var u=[].concat(e[h]);s&&a[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},6373:(e,t,n)=>{"use strict";function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.TuringMachine=void 0,function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}s.default=e,n&&n.set(e,s)}(n(5726)),n(1077),t.TuringMachine=class TuringMachine{constructor(){this.seq=new Array(32).fill(0),this.bigKnob=0,this.index=0,this.len=16,this.init(),this.val=0,this.pitchScalar=1,this.pitchVal=0,this.scale=[0,2,4,5,7,9,11,12]}init(){for(let e=0;e<32;e++)this.seq[e]=Math.random()>.5}get(){return Math.random()>Math.abs(this.bigKnob)&&(this.seq[this.index%this.len]=Math.random()>.5),this.val=this.seq[this.index%this.len],this.index++,this.val}set knob(e){this.len=this.bigKnob>0?16:8,this.bigKnob=e>1?1:e<-1?-1:e,this.len=this.bigKnob>0?32:16}pitch(){this.pitchVal=0;for(let e=0;e<8;e++)this.pitchVal+=this.seq[(this.index+e)%8]*e;return this.pitchVal=this.pitchVal*this.pitchScalar/32,console.log(this.pitchVal),this.scale[Math.floor(this.pitchVal)]}getStep(e){return Array.isArray(e)&&(e=e.reduce(((e,t)=>e+t))),this.seq[(this.index+e)%this.len]}}},6379:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Stripe=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Stripe=class Stripe{constructor(){this.input=new r.Multiply(1),this.eq=new r.EQ3,this.gain=new r.Multiply(1),this.send=new r.Multiply(0),this.output=new r.Multiply(1),this.input.connect(this.eq),this.eq.connect(this.gain),this.gain.connect(this.send),this.gain.connect(this.output)}setEQ(e,t,n){this.eq.high.value=n,this.eq.mid.value=t,this.eq.low.value=e}setEQBands(e,t){e<10||t<10?console.log("EQ bands are in Hz"):(this.eq.highFrequency.value=t,this.eq.lowFrequency.value=e)}setSendLevel(e){this.send.factor.value=e}setGain(e){this.gain.factor.value=e}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}}},6603:()=>{"use strict";const e={};["Aurora","Bells","Contrabass","Drum","DunDun","Flute","Guitar","HandPan","Harp","Horn","Kalimba","LightGuitar","Lyre","MantaOcarina","Ocarina","Old-Zither","Panflute","Piano","Pipa","SFX_TR-909","ToyUkulele","Trumpet","Vintage-Lyre","WinterPiano","Xylophone","Zither"].forEach(((t,n)=>{const s="https://specy.github.io/genshinMusic/assets/audio/"+t+"/0.mp3";e[t]={url:s,basePitch:60}})),console.log(e)},6737:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSeq=void 0,t.SimpleSeq=class SimpleSeq{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;this.numSeqs=t,this.seq=new Array(this.numSeqs).fill(e)}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e%=this.numSeqs,Array.isArray(this.seq[e])?this.seq[e][t%this.seq[e].length]:this.seq[e]}set(e,t){this.seq[e]=t}setAll(e){this.seq=new Array(this.numSeqs).fill(e)}set val(e){this.setAll(e)}get val(){return this.seq[0]}set value(e){this.setAll(e)}}},6788:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Cymbal=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=n(9672);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class Cymbal extends o.DrumTemplate{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.gui=e,this.name="Cymbal",this.oscillators=[],this.defaultFrequencies=[893,2079,1546],this.oscWaveforms=["sine","square","triangle","sawtooth"];for(let e=0;e<3;e++){const e=new r.Oscillator({type:"square"}).start();this.oscillators.push(e)}this.noises=[],this.noiseTypes=["white","pink","brown"];for(let e=0;e<3;e++){const e=new r.Noise("white").start();this.noises.push(e)}this.oscMixer=new r.Gain(1),this.oscillators.forEach((e=>e.connect(this.oscMixer))),this.noises.forEach((e=>e.connect(this.oscMixer))),this.lowerBandFilter=new r.Filter({type:"bandpass"}),this.lowerBandEnv=new r.AmplitudeEnvelope({attack:.01,decay:.4,sustain:0,release:.1}),this.lowerBandVCA=new r.Gain(1),this.oscMixer.chain(this.lowerBandFilter,this.lowerBandEnv,this.lowerBandVCA),this.upperBandFilter=new r.Filter({type:"bandpass"}),this.upperBandFilter1=new r.Filter({type:"bandpass"}),this.upperBandFilter2=new r.Filter({type:"bandpass"}),this.upperBandEnv1=new r.AmplitudeEnvelope({attack:.01,decay:.2,sustain:0,release:.1}),this.upperBandEnv2=new r.AmplitudeEnvelope({attack:.01,decay:.3,sustain:0,release:.1}),this.upperBandVCA1=new r.Gain(1),this.upperBandVCA2=new r.Gain(1),this.oscMixer.connect(this.upperBandFilter),this.upperBandFilter.chain(this.upperBandFilter1,this.upperBandEnv1,this.upperBandVCA1),this.upperBandFilter.chain(this.upperBandFilter2,this.upperBandEnv2,this.upperBandVCA2),this.output=new r.Gain(1),this.lowerBandVCA.connect(this.output),this.upperBandVCA1.connect(this.output),this.upperBandVCA2.connect(this.output),this.output.toDestination(),null!==this.gui&&this.initGui()}initGui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;if(null!==e){for(let t=0;t<3;t++){const n=this.oscillators[t];e.Knob({label:"freq "+t,mapto:n.frequency,x:40+8*t,y:12,size:.5,min:20,max:2500,curve:2,value:this.defaultFrequencies[t]}),e.Radio({label:"waveform "+t,radioOptions:this.oscWaveforms,callback:e=>{n.type=e},size:1,x:7,y:12+20*t,horizontal:!0,value:"square"})}for(let t=0;t<3;t++){const n=this.noises[t];e.Radio({label:"noise "+t,radioOptions:this.noiseTypes,callback:e=>{n.type=e},size:1,x:90,y:12+16*t,horizontal:!0,value:"white"})}e.Knob({label:"low band freq",mapto:this.lowerBandFilter.frequency,x:20,y:50,size:.5,min:100,max:5e3,curve:2,value:579}),e.Knob({label:"low band Q",mapto:this.lowerBandFilter.Q,x:30,y:50,size:.5,min:.5,max:5,curve:2,value:1.45}),e.Knob({label:"low decay",mapto:this.lowerBandEnv.decay,x:20,y:70,size:.5,min:.01,max:1,curve:2,value:.4}),e.Knob({label:"low release",mapto:this.lowerBandEnv.release,x:30,y:70,size:.5,min:.01,max:1,curve:2,value:.1}),e.Knob({label:"up band freq",mapto:this.upperBandFilter.frequency,x:57,y:50,size:.5,min:1e3,max:1e4,curve:2,value:5976}),e.Knob({label:"up band Q",mapto:this.upperBandFilter.Q,x:67,y:50,size:.5,min:.5,max:5,curve:2,value:1.4}),e.Knob({label:"up1 band freq",mapto:this.upperBandFilter1.frequency,x:45,y:60,size:.5,min:1e3,max:1e4,curve:2,value:6795}),e.Knob({label:"up2 band freq",mapto:this.upperBandFilter2.frequency,x:70,y:60,size:.5,min:1e3,max:1e4,curve:2,value:8735}),e.Knob({label:"up1 band Q",mapto:this.upperBandFilter1.Q,x:55,y:60,size:.5,min:.5,max:5,curve:2,value:1.39}),e.Knob({label:"up2 band Q",mapto:this.upperBandFilter2.Q,x:80,y:60,size:.5,min:.5,max:5,curve:2,value:.67}),e.Knob({label:"up1 decay",mapto:this.upperBandEnv1.decay,x:45,y:70,size:.5,min:.01,max:1,curve:2,value:.2}),e.Knob({label:"up1 release",mapto:this.upperBandEnv1.release,x:55,y:70,size:.5,min:.01,max:1,curve:2,value:.1}),e.Knob({label:"up2 decay",mapto:this.upperBandEnv2.decay,x:70,y:70,size:.5,min:.01,max:1,curve:2,value:.3}),e.Knob({label:"up2 release",mapto:this.upperBandEnv2.release,x:80,y:70,size:.5,min:.01,max:1,curve:2,value:.1}),e.Button({label:"trig",callback:()=>this.trigger(),size:2,border:20,borderColor:[255,0,0],x:48,y:36})}else console.error("Provide a GUI instance to create GUI elements")}trigger(){this.lowerBandEnv.triggerAttackRelease(.01),this.upperBandEnv1.triggerAttackRelease(.01),this.upperBandEnv2.triggerAttackRelease(.01)}}t.Cymbal=Cymbal},7173:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=e=>[{name:"angle",type:"vco",value:0,min:0,max:359,curve:1,isSignal:"false",connectTo:null,callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.setAngle(t,1,n)}},{name:"gain",type:"vca",min:0,max:1,curve:2,isSignal:"true",connectTo:e=>e.input.factor,callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?e.input.setValueAtTime(t,n):e.input.rampTo(t,.1)}}]},7220:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Kick=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Kick=class Kick{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2;this.vco=(new r.Oscillator).start(),this.shaper_gain=new r.Multiply(n),this.waveShaper=new r.WaveShaper((e=>.9*Math.tanh(16*e))),this.vca=new r.Multiply,this.output=new r.Multiply(.5),this.pitch_env=new r.Envelope,this.pitch_env_depth=new r.Multiply,this.frequency=new r.Signal(e),this.env=new r.Envelope,this.vco.connect(this.vca),this.vca.connect(this.shaper_gain),this.shaper_gain.connect(this.waveShaper),this.waveShaper.connect(this.output),this.pitch_env.connect(this.pitch_env_depth),this.pitch_env_depth.connect(this.vco.frequency),this.frequency.connect(this.vco.frequency),this.env.connect(this.vca.factor),this.env.decay=t,this.env.release=t,this.env.sustain=0,this.env.attack=.03,this.pitch_env.attack=0,this.pitch_env.decay=1,this.pitch_env.sustain=0,this.pitch_env.release=.1}trigger=function(e){e?(this.env.triggerAttackRelease(.01,e),this.pitch_env.triggerAttackRelease(.01,e)):(this.env.triggerAttackRelease(.01),this.pitch_env.triggerAttackRelease(.01))};connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}disconnect(e){e.input?this.output.disconnect(e.input):this.output.disconnect(e)}}},7316:e=>{"use strict";e.exports=JSON.parse('{"default":{"detune":0.49999999999999956,"drive2":0.1567999999999999,"fm":0,"am":0,"harm":2.006999999999993,"cutoff":3170.3199999999993,"Q":0,"noiseG":0.375,"toneG":0.39015,"vol":0.5,"drop":199.9999999999999,"decay":0.5779999999999995,"pDecay":0.07784100000000005,"nDecay":0.0605,"nFreq":1764.1899999999994,"nEnv":1191.6400000000012,"vcfEnv":1945.0850000000016},"kick":{"detune":0.49999999999999956,"drive2":0.2738,"fm":0,"am":0,"harm":2.006999999999993,"cutoff":886.7949999999983,"Q":3.108841807610066,"noiseG":0.375,"toneG":0.39015,"vol":0.5,"drop":17.999999999999968,"decay":0.28799999999999937,"pDecay":0.07784100000000005,"nDecay":0.07200000000000001,"nFreq":670.239999999999,"nEnv":1191.6400000000012,"vcfEnv":1945.0850000000016},"snare":{"detune":1,"drive2":0.2738,"fm":1.0240000000000005,"am":0,"harm":2.006999999999999,"cutoff":4384.22,"Q":6.021722656131611,"noiseG":0.40560000000000007,"toneG":0.39015,"vol":0.5,"drop":0,"decay":0.16199999999999942,"pDecay":0.07784100000000005,"nDecay":0.26450000000000023,"nFreq":932.589999999999,"nEnv":1191.6400000000012,"vcfEnv":214.37500000000026},"hat":{"detune":1,"drive2":0.2738,"fm":1.0240000000000005,"am":0,"harm":2.006999999999999,"cutoff":10000,"Q":0,"noiseG":0.40560000000000007,"toneG":0,"vol":0.5,"drop":0,"decay":0.16199999999999942,"pDecay":0.07784100000000005,"nDecay":0.12800000000000006,"nFreq":6278.590000000001,"nEnv":109.7600000000001,"vcfEnv":214.37500000000026},"ride":{"detune":11,"drive2":0.1457999999999999,"fm":14,"am":0,"harm":23.43,"cutoff":10000,"Q":0,"noiseG":1.5,"toneG":0.42135000000000006,"vol":0.5,"drop":0,"decay":2.3433629976826644,"pDecay":1,"nDecay":5,"nFreq":6278.590000000001,"nEnv":3767.8550000000046,"vcfEnv":214.37500000000026},"splash":{"detune":11,"drive2":0.1457999999999999,"fm":14,"am":0,"harm":23.43,"cutoff":10000,"Q":3.706805103404472,"noiseG":1.5,"toneG":0.15359999999999985,"vol":0.5,"drop":0,"decay":1,"pDecay":1,"nDecay":3,"nFreq":10000,"nEnv":0,"vcfEnv":5000},"crash":{"detune":11,"drive2":0.1457999999999999,"fm":14,"am":0,"harm":23.43,"cutoff":10000,"Q":5.545158745241173,"noiseG":1.5,"toneG":0.15359999999999985,"vol":0.5,"drop":0,"decay":1,"pDecay":1,"nDecay":10,"nFreq":10000,"nEnv":744.3850000000006,"vcfEnv":0}}')},7331:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Rumble=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(2805)),a=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}n(3447);class Rumble extends a.MonophonicTemplate{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),e=this,this.gui=t,this.presets=o.default,this.isGlide=!1,this.name="Rumble",console.log(this.name," loaded, available preset: ",o.default),this.frequency=new r.Signal,this.vco_freq_1=new r.Multiply(1),this.vco_freq_2=new r.Multiply(1),this.vco_freq_3=new r.Multiply(1),this.vco_octave_1=new r.Multiply(1),this.vco_octave_2=new r.Multiply(1),this.vco_octave_3=new r.Multiply(1),this.frequency.connect(this.vco_freq_1),this.frequency.connect(this.vco_freq_2),this.frequency.connect(this.vco_freq_3),this.vco_1=new r.OmniOscillator({type:"pulse"}).start(),this.vco_2=new r.OmniOscillator({type:"pulse"}).start(),this.vco_3=new r.OmniOscillator({type:"pulse"}).start(),this.vco_freq_1.connect(this.vco_octave_1),this.vco_freq_2.connect(this.vco_octave_2),this.vco_freq_3.connect(this.vco_octave_3),this.vco_octave_1.connect(this.vco_1.frequency),this.vco_octave_2.connect(this.vco_2.frequency),this.vco_octave_3.connect(this.vco_3.frequency),this.vco_gain_1=new r.Multiply(.25),this.vco_gain_2=new r.Multiply(.25),this.vco_gain_3=new r.Multiply(.25),this.vco_1.connect(this.vco_gain_1),this.vco_2.connect(this.vco_gain_2),this.vco_3.connect(this.vco_gain_3),this.vcf=new r.Filter({type:"lowpass",rolloff:-24}),this.vco_gain_1.connect(this.vcf),this.vco_gain_2.connect(this.vcf),this.vco_gain_3.connect(this.vcf),this.clip=new r.Multiply(.125),this.direct_level=new r.Multiply(.5),this.waveShaper=new r.WaveShaper((e=>Math.sin(e*Math.PI*2))),this.waveShaper.oversample="4x",this.vcf.connect(this.clip),this.vcf.connect(this.direct_level),this.clip.connect(this.waveShaper),this.vca=new r.Multiply,this.direct_level.connect(this.vca),this.output=new r.Multiply(.5),this.waveShaper.connect(this.vca),this.vca.connect(this.output),this.vca_lvl=new r.Signal,this.vca_lvl.connect(this.vca.factor),this.env=new r.Envelope,this.env_depth=new r.Multiply,this.env.connect(this.env_depth),this.env_depth.connect(this.vca.factor),this.velocitySig=new r.Signal(1),this.velocitySig.connect(this.env_depth.factor),this.vcf_env=new r.Envelope,this.cutoffSig=new r.Signal(1e3),this.cutoff_cv=new r.Signal(0),this.vcf_env_depth=new r.Multiply(500),this.keyTracking=new r.Multiply(.1),this.vcf_env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.cutoffSig.connect(this.vcf.frequency),this.cutoff_cv.connect(this.vcf.frequency),this.frequency.connect(this.keyTracking),this.keyTracking.connect(this.vcf.frequency),this.lfo=new r.Oscillator(1).start(),this.lfo_pwm_1=new r.Multiply,this.lfo_pwm_2=new r.Multiply,this.lfo_pwm_3=new r.Multiply,this.lfo.connect(this.lfo_pwm_1),this.lfo_pwm_1.connect(this.vco_1.width),this.lfo.connect(this.lfo_pwm_2),this.lfo_pwm_2.connect(this.vco_2.width),this.lfo.connect(this.lfo_pwm_3),this.lfo_pwm_3.connect(this.vco_3.width);let n=[{name:"detune",min:0,max:1,curve:2,value:[1,1,1],callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==n?e.vco_freq_1.factor.value=t:1==n?e.vco_freq_2.factor.value=t:2==n&&(e.vco_freq_3.factor.value=t)}},{name:"octave",min:-3,max:4,curve:1,value:[1,1,1],callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==n?e.vco_octave_1.factor.value=Math.pow(2,t):1==n?e.vco_octave_2.factor.value=Math.pow(2,t):2==n&&(e.vco_octave_3.factor.value=Math.pow(2,t))}},{name:"gain",min:0,max:1,curve:2,value:[.75,.75,.75],callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==n?e.vco_gain_1.factor.value=t:1==n?e.vco_gain_2.factor.value=t:2==n&&(e.vco_gain_3.factor.value=t)}},{name:"cutoff",min:20,max:2e4,curve:2,callback:e=>this.cutoffSig.value=e},{name:"Q",min:0,max:30,curve:2,callback:e=>this.vcf.Q.value=e},{name:"keyTrack",min:0,max:2,curve:1,callback:e=>this.keyTracking.factor.value=e},{name:"vcfEnvDepth",min:0,max:1e3,curve:2,callback:e=>this.vcf_env_depth.factor.value=e},{name:"adsr",min:0,max:100,curve:1,value:[.01,.1,.5,.5],callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==n?e.env.attack=t:1==n?e.env.decay=t:2==n?e.env.sustain=t:3==n&&(e.env.release=t)}},{name:"filterAdsr",min:0,max:100,curve:1,value:[.01,.1,.5,.5],callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==n?e.vcf_env.attack=t:1==n?e.vcf_env.decay=t:2==n?e.vcf_env.sustain=t:3==n&&(e.vcf_env.release=t)}},{name:"pwm",min:0,max:1,curve:1,value:[0,0,0],callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0==n?e.lfo_pwm_1.factor.value=t:1==n?e.lfo_pwm_2.factor.value=t:2==n&&(e.lfo_pwm_3.factor.value=t)}},{name:"lfoRate",min:0,max:1e3,curve:1,value:1,callback:function(t){return e.lfo.frequency.value=t}},{name:"distortion",min:0,max:1,curve:.35,value:1,callback:e=>{this.clip.factor.value=e}},{name:"mix",min:0,max:1,curve:1,value:.35,callback:e=>{this.direct_level.factor.value=e}}];this.param=this.generateParameters(n),this.createAccessors(this,this.param),this.autocompleteList=n.map((e=>e.name))}triggerAttack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e=r.Midi(e).toFrequency(),t/=127,n?(this.env.triggerAttack(n),this.vcf_env.triggerAttack(n),this.frequency.setValueAtTime(e,n),this.velocitySig.setValueAtTime(t,n)):(this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.frequency.value=e,this.velocitySig.rampTo(t,.03))}triggerRelease(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(this.env.triggerRelease(e),this.vcf_env.triggerRelease(e)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())}triggerAttackRelease(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=r.Midi(e).toFrequency(),t/=127,s?(this.env.triggerAttackRelease(n,s),this.vcf_env.triggerAttackRelease(n,s),this.frequency.setValueAtTime(e,s),this.velocitySig.setValueAtTime(t,s)):(this.env.triggerAttackRelease(n),this.vcf_env.triggerAttackRelease(n),this.frequency.value=e,this.velocitySig.rampTo(t,.03))}setDetune(e,t,n){this.vco_freq_1.factor.value=e,this.vco_freq_2.factor.value=t,this.vco_freq_3.factor.value=n}setPwmDepth(e,t,n){this.lfo_pwm_1.factor.value=e,this.lfo_pwm_2.factor.value=t,this.lfo_pwm_3.factor.value=n}setGain(e,t,n){this.vco_gain_1.factor.value=e,this.vco_gain_2.factor.value=t,this.vco_gain_3.factor.value=n}initGui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.gui;this.gui=e,this.x=0,this.y=0;const t=[5,15,25];this.vco1_label=this.createLabel("vco1",t[0],5),this.vco2_label=this.createLabel("vco2",t[1],5),this.vco3_label=this.createLabel("vco3",t[2],5),this.vco1_oct_knob=this.gui.Knob({label:"octave",x:t[0],y:20,min:-2,max:1,size:.75,accentColor:[200,50,0],border:2,callback:e=>{this.vco_freq_1.value=calcFreq(e,this.vco1_detune_knob.value)}}),this.vco1_detune_knob=this.gui.Knob({label:"detune",x:t[0],y:50,min:-.5,max:.5,size:.75,accentColor:[200,50,0],border:2,callback:e=>this.vco_freq_1.value=calcFreq(this.vco1_oct_knob.value,e)}),this.vco1_gain_knob=this.gui.Knob({label:"gain",x:t[0],y:80,min:0,max:1,size:.75,accentColor:[200,50,0],border:2,mapto:this.vco_gain_1.factor});const calcFreq=function(e,t){return Math.pow(2,Math.floor(e))+Math.pow(t,2)*Math.sign(t)};this.vco2_oct_knob=this.createKnob("octave",t[1],20,-2,1,.75,[200,50,0],(e=>{this.vco_freq_2.value=calcFreq(e,this.vco2_detune_knob.value)})),this.vco2_detune_knob=this.createKnob("detune",t[1],50,-.5,.5,.75,[50,150,100],(e=>this.vco_freq_2.value=calcFreq(this.vco2_oct_knob.value,e))),this.vco2_gain_knob=this.createKnob("gain",t[1],80,0,1,.75,[200,50,0],(e=>this.vco_gain_2.factor.value=e)),this.vco3_oct_knob=this.createKnob("octave",t[2],20,-2,1,.75,[200,50,0],(e=>this.vco_freq_3.value=calcFreq(e,this.vco3_detune_knob.value))),this.vco3_detune_knob=this.createKnob("detune",t[2],50,-.5,.5,.75,[50,150,100],(e=>this.vco_freq_3.value=calcFreq(this.vco3_oct_knob.value,e))),this.vco3_gain_knob=this.createKnob("gain",t[2],80,0,1,.75,[200,50,0],(e=>this.vco_gain_3.factor.value=e)),this.vcf_cutoff_knob=this.createKnob("cutoff",45,28,2,1e4,1.75,[200,0,200],(e=>this.cutoffSig.value=e)),this.keytracking_knob=this.createKnob("keyTracking",45,75,0,1,.75,[200,0,200],(e=>this.keyTracking.factor.value=e)),this.vcf_env_depth_knob=this.createKnob("vcf env",55,75,0,5e3,.75,[200,0,200],(e=>this.vcf_env_depth.factor.value=e)),this.vcf_res_knob=this.createKnob("Q",35,75,0,20,.75,[200,0,200],(e=>this.vcf.Q.value=e)),this.attack_knob=this.createKnob("a",68,55,1e-6,.5,.35,[0,0,200],(e=>this.env.attack=e)),this.decay_knob=this.createKnob("d",76,55,0,10,.35,[0,0,200],(e=>this.env.decay=e)),this.sustain_knob=this.createKnob("s",84,55,0,1,.35,[0,0,200],(e=>this.env.sustain=e)),this.release_knob=this.createKnob("r",92,55,0,20,.35,[0,0,200],(e=>this.env.release=e)),this.vcf_attack_knob=this.createKnob("vcf a",68,80,.001,.5,.35,[0,0,200],(e=>this.vcf_env.attack=e)),this.vcf_decay_knob=this.createKnob("vcf d",76,80,0,10,.35,[0,0,200],(e=>this.vcf_env.decay=e)),this.vcf_sustain_knob=this.createKnob("vcf s",84,80,0,1,.35,[0,0,200],(e=>this.vcf_env.sustain=e)),this.vcf_release_knob=this.createKnob("vcf r",92,80,0,20,.35,[0,0,200],(e=>this.vcf_env.release=e)),this.lfo_knob=this.createKnob("lfo",60,25,0,20,.35,[0,0,200],(e=>this.lfo.frequency.value=e)),this.pwm_knob=this.createKnob("pwm",68,25,0,.9,.35,[0,0,200],(e=>{this.setPwmDepth(e,.8*e,.6*e)})),this.clip_knob=this.createKnob("distortion",82,25,0,1,.35,[0,0,200],(e=>{this.clip.factor.value=e})),this.clip_mix=this.createKnob("mix",90,25,0,1,.35,[0,0,200],(e=>{this.direct_level.factor.value=e})),this.gui_elements=[this.vco1_label,this.vco2_label,this.vco3_label,this.vco1_oct_knob,this.vco1_detune_knob,this.vco1_gain_knob,this.vco2_oct_knob,this.vco2_detune_knob,this.vco2_gain_knob,this.vco3_oct_knob,this.vco3_detune_knob,this.vco3_gain_knob,this.vcf_cutoff_knob,this.vcf_res_knob,this.keytracking_knob,this.vcf_env_depth_knob,this.attack_knob,this.decay_knob,this.sustain_knob,this.release_knob,this.vcf_attack_knob,this.vcf_decay_knob,this.vcf_sustain_knob,this.vcf_release_knob,this.lfo_knob,this.pwm_knob,this.clip_knob,this.clip_mix]}createLabel(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.01;return this.gui.Text({label:e,x:t+this.x,y:n+this.y,size:s,border:r,borderRadius:o})}createKnob(e,t,n,s,r,o,a,c){return this.gui.Knob({label:e,min:s,max:r,size:o,accentColor:a,x:t+this.x,y:n+this.y,callback:c,showLabel:1,showValue:0,curve:2,border:2})}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}}t.Rumble=Rumble},7659:e=>{"use strict";var t={};e.exports=function insertBySelector(e,n){var s=function getTarget(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},7683:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollabSlobClient=void 0;var s=n(4658);t.CollabSlobClient=class CollabSlobClient{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.debug=e,this.logger=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{debug:function(t){if(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];console.log(`[DEBUG] ${t}`,...s)}},info:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];console.log(`[INFO] ${e}`,...n)},warn:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];console.warn(`[WARN] ${e}`,...n)},error:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];console.error(`[ERROR] ${e}`,...n)}}}(this.debug),this.socket=(0,s.io)("https://collab-slob-server.onrender.com/slob"),this.controls={},this.handlers={},this.username="",this.roomJoined=void 0,this.clientId=this._generateClientId(),this.controlsCallback=e=>{},this.eventsCallback=e=>{},this.chatCallback=e=>{},this.initializeSocketEvents()}_generateClientId(){return"client_"+Math.random().toString(36).substring(2,15)}initializeSocketEvents(){this.socket.on("serverMessage",(e=>{})),this.socket.on("chat",(e=>{e.chat==="Connected with id: "+this.socket.id&&(this.username=e.id),e.header&&e.header.clientId!==this.clientId&&this.chatCallback(e)})),this.socket.on("otherUsers",(e=>{let t="",n=e.users.length;for(let s of e.users)t+=--n?`${s}, `:s})),this.socket.on("control",(e=>{if(this.logger.debug(`Control received: ${JSON.stringify(e)}`),this.logger.debug(`Current room joined: ${this.roomJoined}`),this.logger.debug(`My client ID: ${this.clientId}`),this.logger.debug("Incoming header:",e.header),this.roomJoined)if(this.logger.debug("Room is joined, processing control"),this.logger.debug("INCOMING IN COLLABHUB.JS",e),e.header&&e.header.clientId!==this.clientId){this.logger.debug("Control is from another client, continuing");let t=e.header,n=e.values;this.logger.debug("Setting control in local store:",t.name,n),this.controls[t.name]=n,t.name in this.handlers?(this.logger.debug("Handler found for control:",t.name),this.handlers[t.name](e)):this.logger.debug("No handler found for control:",t.name),this.logger.debug("Calling controlsCallback"),this.controlsCallback(e)}else this.logger.debug("Control is from this client or has no header, ignoring");else this.logger.debug("No room joined, ignoring control")})),this.socket.on("availableControls",(e=>{for(let t of e.controls)delete t.observers,delete t.mode})),this.socket.on("observedControls",(e=>{for(let t of e.controls)delete t.observers,delete t.mode})),this.socket.on("myControls",(e=>{for(let t of e.controls)delete t.observers,delete t.mode})),this.socket.on("event",(e=>{if(this.roomJoined&&e.header&&e.header.clientId!==this.clientId){let t=e.header;t.name in this.handlers&&this.handlers[t.name](e),this.eventsCallback(e)}})),this.socket.on("availableEvents",(e=>{for(let t of e.events)delete t.observers,delete t.mode})),this.socket.on("observedEvents",(e=>{for(let t of e.events)delete t.observers,delete t.mode})),this.socket.on("myEvents",(e=>{for(let t of e.events)delete t.observers,delete t.mode})),this.socket.on("availableRoomsList",(e=>{let t="",n=e.rooms.length;for(let s of e.rooms)t+=--n?`${s}, `:s}))}setControlsCallback(e){this.controlsCallback=e}setEventsCallback(e){this.eventsCallback=e}setChatCallback(e){this.chatCallback=e}control(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this.logger.debug("control() called with args:",t),this.roomJoined){this.logger.debug("Room is joined:",this.roomJoined);let e="publish"===t[0]||"pub"===t[0]?"publish":"push",n="publish"===e?t[1]:t[0],s="publish"===e?t[2]:t[1],r="publish"===e?t[3]?t[3]:this.roomJoined:t[2]?t[2]:this.roomJoined;this.logger.debug("Parsed arguments - mode:",e,"headerName:",n,"values:",s,"target:",r);const o={name:n,clientId:this.clientId};this.logger.debug("Created header:",o);const a={mode:e,header:o,values:s,target:r};this.logger.debug("Emitting control message:",JSON.stringify(a)),this.socket.emit("control",a),this.logger.debug("Control message emitted")}else this.logger.debug("No room joined, cannot send control"),console.info("Join a room to send controls.")}event(){if(this.roomJoined){let e="publish"===(arguments.length<=0?void 0:arguments[0])||"pub"===(arguments.length<=0?void 0:arguments[0])?"publish":"push",t="publish"===e?arguments.length<=1?void 0:arguments[1]:arguments.length<=0?void 0:arguments[0],n="publish"===e?(arguments.length<=2?void 0:arguments[2])?arguments.length<=2?void 0:arguments[2]:this.roomJoined:(arguments.length<=1?void 0:arguments[1])?arguments.length<=1?void 0:arguments[1]:this.roomJoined;const s={mode:e,header:{name:t,clientId:this.clientId},target:n};this.socket.emit("event",s)}else console.info("Join a room to send events.")}chat(e,t){if(this.roomJoined){const n={chat:e,header:{clientId:this.clientId}};n.target=t||this.roomJoined,this.socket.emit("chat",n)}else console.info("Join a room to chat.")}setUsername(e){this.socket.emit("addUsername",{username:e}),this.username=e}getControl(e){return e in this.controls?this.controls[e]:0}on(e,t){this.handlers[e]=t}getUsers(){this.socket.emit("otherUsers")}joinRoom(e){this.logger.debug(`joinRoom() called with roomName: ${e}`),this.roomJoined&&(this.logger.debug(`Already in room: ${this.roomJoined}, leaving it first`),this.leaveRoom(this.roomJoined)),this.logger.debug(`Preparing to join room: ${e}`),this.logger.debug(`Emitting joinRoom event with roomName: ${e}`),this.socket.emit("joinRoom",e),this.roomJoined=e,this.logger.debug(`Room joined flag set to: ${this.roomJoined}`),this.logger.debug(`Client ID: ${this.clientId}`)}leaveRoom(e){this.logger.debug(`leaveRoom() called with roomName: ${e}`),this.socket.emit("leaveRoom",e),this.logger.debug(`Emitted leaveRoom event with roomName: ${e}`)}getRooms(){this.socket.emit("getAvailableRooms")}observeControl(e){let t={header:e};this.socket.emit("observeControl",t)}unobserveControl(e){let t={header:e};this.socket.emit("unobserveControl",t)}observeAllControls(e){let t={observe:e};this.socket.emit("observeAllControl",t),this.socket.emit("getMyControls")}clearControl(e){let t={header:e};this.socket.emit("clearControl",t),this.socket.emit("getMyControls")}observeEvent(e){let t={header:e};this.socket.emit("observeEvent",t)}unobserveEvent(e){let t={header:e};this.socket.emit("unobserveEvent",t)}observeAllEvents(e){let t={observe:e};this.socket.emit("observeAllEvents",t),this.socket.emit("getMyEvents")}clearEvent(e){let t={header:e};this.socket.emit("clearEvent",t),this.socket.emit("getMyEvents")}}},7721:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timingObjectManager=t.default=void 0;var s=n(9762),r=n(2271),o=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class TimingObjectManager{constructor(){this.timingObject=null,this.intervalId=null,this.shouldBeUsed=!1}async initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AspCEtTZLHqHgw3KfHav";return this.timingObject?Promise.resolve(this):new Promise((t=>{this.timingObject=new s.TimingObject(new r.TimingProvider(e));const resolveWhenOpen=()=>{this.timingObject.removeEventListener("readystatechange",resolveWhenOpen),"open"===this.timingObject.readyState&&t(this)};this.timingObject.addEventListener("readystatechange",resolveWhenOpen)}))}setShouldUse(){this.shouldBeUsed=!0,this.timingObject&&"open"===this.timingObject.readyState&&this.setupEventListeners()}setupEventListeners(){this.timingObject.addEventListener("change",(()=>{if(!this.shouldBeUsed)return;const{velocity:e}=this.timingObject.query();0===e?this.stopTimer():null===this.intervalId?this.startTimer():this.restartTimer()}))}translateVector(e){let{acceleration:t,position:n,timestamp:s,velocity:r}=e;if(0!==t)throw new Error("Acceleration other than zero is not supported.");return{position:n+r*(performance.now()/1e3-s),velocity:r}}convertBpmToVelocity(e){return e/60}updateTransport(){if(!this.shouldBeUsed)return;const{position:e,velocity:t}=this.translateVector(this.timingObject.query());0!==t&&(o.getTransport().seconds=e/t,o.getTransport().bpm.value=60*t)}startTimer(){this.shouldBeUsed&&("stopped"===o.getTransport().state&&o.getTransport().start(),this.updateTransport(),this.intervalId=setInterval((()=>this.updateTransport()),2e3))}stopTimer(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.shouldBeUsed&&(null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),e&&o.getTransport().stop())}restartTimer(){this.shouldBeUsed&&(this.stopTimer(),this.startTimer())}updateVelocity(e){return this.shouldBeUsed?this.timingObject.update({velocity:this.convertBpmToVelocity(e)}):Promise.resolve()}isMoving(){const{velocity:e}=this.timingObject.query();return 0!==e}}t.timingObjectManager=new TimingObjectManager,t.default=TimingObjectManager},7825:e=>{"use strict";e.exports=function domAPI(e){if("undefined"==typeof document)return{update:function update(){},remove:function remove(){}};var t=e.insertStyleElement(e);return{update:function update(n){!function apply(e,t,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,r&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,n)},remove:function remove(){!function removeStyleElement(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7833:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.abletonLinkManager=void 0;var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(9340));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class AbletonLinkManager{constructor(){this.linkClient=null,this.intervalId=null,this.shouldBeUsed=!1,this.updateInterval=100,this.isInitialized=!1,this.debug=!1,this.serverUrl="https://link-slob-server.onrender.com/"}async initialize(){return this.isInitialized?Promise.resolve(this):new Promise((e=>{try{this.createLinkClient(e)}catch(t){console.error("Failed to initialize Ableton Link:",t),this.isInitialized=!1,e(this)}}))}createLinkClient(e){this.linkClient=new o.default({serverUrl:this.serverUrl,onUpdate:e=>{this.shouldBeUsed&&this.debug&&console.log("Received update from LinkSlob:",e)},onStatusChange:e=>{this.debug&&console.log("LinkSlob status changed:",e)},onTransportChange:e=>{this.debug&&console.log("LinkSlob transport state changed:",e)}}),this.linkClient.setDebug(this.debug),this.isInitialized=!0;const t=r.getTransport().bpm.value;this.linkClient.setBpm(t),this.debug&&console.log(`Ableton Link initialized with BPM: ${t}`),e(this)}enable(){this.shouldBeUsed=!0,this.linkClient&&this.isInitialized?this.linkClient.connect().then((()=>{this.debug&&console.log("Ableton Link enabled and connected to LinkSlob server")})).catch((e=>{console.error("Failed to connect to LinkSlob server:",e)})):this.debug&&console.log("Ableton Link not initialized yet")}disable(){this.shouldBeUsed=!1,this.stopTimer(),this.linkClient&&this.isInitialized&&(this.linkClient.disconnect(),this.debug&&console.log("Ableton Link disabled and disconnected from LinkSlob server"))}startTimer(){this.shouldBeUsed&&this.isInitialized&&("stopped"===r.getTransport().state&&r.getTransport().start(),this.linkClient&&this.linkClient.isConnectedToServer()?(this.linkClient.start(),this.updateTransport(),this.intervalId=setInterval((()=>this.updateTransport()),this.updateInterval),this.debug&&console.log("Ableton Link timer started")):this.enable())}stopTimer(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isInitialized&&(null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.linkClient&&this.linkClient.isConnectedToServer()&&this.linkClient.stop(),e&&r.getTransport().stop(),this.debug&&console.log("Ableton Link timer stopped"))}restartTimer(){this.shouldBeUsed&&(this.stopTimer(!1),this.startTimer())}updateTransport(){if(!this.shouldBeUsed||!this.isInitialized||!this.linkClient)return;const e=this.linkClient.getBeat(),t=this.linkClient.getPhase(),n=this.linkClient.getBpm();if(Math.abs(r.getTransport().bpm.value-n)>.1&&(r.getTransport().bpm.value=n),"started"===r.getTransport().state){const t=r.getTransport().seconds*n/60,s=e-t;if(Math.abs(s)>.0625)if(Math.abs(s)>1){const o=e/(n/60);r.getTransport().seconds=o,this.debug&&console.log(`Hard sync: beat=${e.toFixed(2)}, toneBeat=${t.toFixed(2)}, diff=${s.toFixed(2)}`)}else{const o=s>0?1.01:.99,a=n*o;r.getTransport().bpm.rampTo(a,.2),setTimeout((()=>{r.getTransport().bpm.rampTo(n,.2)}),300),this.debug&&console.log(`Soft sync: beat=${e.toFixed(2)}, toneBeat=${t.toFixed(2)}, diff=${s.toFixed(2)}, adjustment=${o}`)}}if(this.debug){const s=r.getTransport().seconds*n/60;console.log(`Transport check: linkBeat=${e.toFixed(2)}, toneBeat=${s.toFixed(2)}, phase=${t.toFixed(2)}, bpm=${n.toFixed(2)}`)}}updateBpm(e){this.shouldBeUsed&&this.isInitialized&&this.linkClient&&this.linkClient.isConnectedToServer()&&(this.linkClient.setBpm(e),this.debug&&console.log(`Updated Link BPM to ${e}`))}hasConnections(){return!(!this.isInitialized||!this.linkClient)&&this.linkClient.getNumPeers()>0}getNumPeers(){return this.isInitialized&&this.linkClient?this.linkClient.getNumPeers():0}getBeat(){return this.isInitialized&&this.linkClient?this.linkClient.getBeat():0}getPhase(){return this.isInitialized&&this.linkClient?this.linkClient.getPhase():0}setServerUrl(e){this.serverUrl=e,this.isInitialized&&this.linkClient&&(this.linkClient.disconnect(),this.isInitialized=!1,this.initialize())}isMoving(){return!(!this.isInitialized||!this.linkClient)&&this.linkClient.getBpm()>0}}t.abletonLinkManager=new AbletonLinkManager,t.default=AbletonLinkManager},7846:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.Daisy=t.Daisies=void 0,n(5324),s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(8816)),a=n(1174),c=(n(3447),n(807));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class Daisy extends a.MonophonicTemplate{constructor(){super(),this.presets=o.default,this.name="Daisy",this.frequency=new r.Signal(100),this.frequencyCV=new r.Signal,this.frequency_scalar=new r.Multiply(1),this.detune_scalar=new r.Multiply(1),this.vco_1=new r.Oscillator({type:"square"}).start(),this.vco_2=new r.Oscillator({type:"square"}).start(),this.frequency.connect(this.frequency_scalar),this.frequencyCV.connect(this.frequency_scalar.factor),this.frequency_scalar.connect(this.vco_1.frequency),this.frequency_scalar.connect(this.detune_scalar),this.detune_scalar.connect(this.vco_2.frequency),this.crossfade=new r.CrossFade,this.crossfade_lfo_depth=new r.Multiply,this.vco_1.connect(this.crossfade.a),this.vco_2.connect(this.crossfade.b),this.vcf=new r.Filter({type:"lowpass",rolloff:-24,Q:0,cutoff:3e3}),this.crossfade.connect(this.vcf),this.crossfade_constant=new r.Signal(0),this.crossfade_lfo_depth.connect(this.crossfade.fade),this.crossfade_constant.connect(this.crossfade.fade),this.vca=new r.Multiply,this.lfo_vca=new r.Multiply(1),this.lfo_vca_constant=new r.Signal(1),this.panner=new r.Panner(0),this.output=new r.Multiply(.25),this.vcf.connect(this.lfo_vca),this.lfo_vca.connect(this.vca),this.lfo_vca_constant.connect(this.lfo_vca.factor),this.vca.connect(this.panner),this.panner.connect(this.output),this.env=new r.Envelope,this.velocitySig=new r.Signal(1),this.velocity_depth=new r.Multiply(1),this.env.connect(this.velocity_depth),this.velocity_depth.connect(this.vca.factor),this.velocitySig.connect(this.velocity_depth.factor),this.cutoffSig=new r.Signal(1e3),this.cutoffSig.connect(this.vcf.frequency),this.cutoffCV=new r.Signal,this.cutoffCV.connect(this.vcf.frequency),this.keyTracking=new r.Multiply(.1),this.frequency.connect(this.keyTracking),this.keyTracking.connect(this.vcf.frequency),this.vcf_env=new r.Envelope,this.vcf_env_depth=new r.Multiply,this.vcf_env.connect(this.vcf_env_depth),this.vcf_env_depth.connect(this.vcf.frequency),this.lfo=new r.Oscillator(.5).start(),this.vca_constant=new r.Signal(1),this.amp_lfo_depth=new r.Multiply(0),this.lfo.connect(this.amp_lfo_depth),this.amp_lfo_depth.connect(this.lfo_vca.factor),this.pitch_lfo_depth=new r.Multiply(0),this.lfo.connect(this.pitch_lfo_depth),this.lfo.connect(this.crossfade_lfo_depth),this.frequency_constant=new r.Signal(1),this.pitch_lfo_depth.connect(this.frequency_scalar.factor),this.frequency_constant.connect(this.frequency_scalar.factor),this.pwm_lfo_depth=new r.Multiply,this.lfo.connect(this.pwm_lfo_depth),this.autocompleteList=["test","triggerAttack"],this.paramDefinitions=(0,c.paramDefinitions)(this),this.param=this.generateParameters(this.paramDefinitions),this.createAccessors(this,this.param)}triggerAttack=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=r.Midi(e).toFrequency();t/=127,n?(this.frequency.setValueAtTime(s,n),this.env.triggerAttack(n),this.vcf_env.triggerAttack(n),this.velocitySig.setValueAtTime(Math.pow(t,2),n)):(this.frequency.value=s,this.env.triggerAttack(),this.vcf_env.triggerAttack(),this.velocitySig.value=Math.pow(t,2))};triggerRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?(this.env.triggerRelease(t),this.vcf_env.triggerRelease(t)):(this.env.triggerRelease(),this.vcf_env.triggerRelease())};triggerAttackRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=r.Midi(e).toFrequency(),t/=127,s?(this.frequency.setValueAtTime(e,s),this.env.triggerAttackRelease(n,s),this.vcf_env.triggerAttackRelease(n,s),this.velocitySig.setValueAtTime(Math.pow(t,2),s)):(this.frequency.value=e,this.env.triggerAttackRelease(n),this.vcf_env.triggerAttackRelease(n),this.velocitySig.value=Math.pow(t,2))};shapeVco(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=[];for(let e=0;e<64;e++)o.push(1/Math.pow(e+1,s)*16*(e%2<2-r)*Math.abs(1-Math.sin(e*Math.PI*t+Math.PI/2)*n));0===e?this.vco_1.partials=o:this.vco_2.partials=o}setHighpass(e){null!==this.super&&(this.super.hpf.frequency.value=e)}}t.Daisy=Daisy;class Daisies extends a.MonophonicTemplate{constructor(){console.log("Daisies is obsolete: use Polyphony(Daisy) instead")}}t.Daisies=Daisies},8011:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Spectroscope=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Spectroscope=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4;this.target=document.getElementById(e),this.width=this.target.offsetWidth,this.height=this.target.offsetWidth*t,this.wave=document.createElementNS("http://www.w3.org/2000/svg","path"),this.wave.setAttribute("class","oscilloscope__wave"),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("width",this.width),this.svg.setAttribute("height",this.height),this.svg.setAttribute("class","oscilloscope__svg"),this.svg.appendChild(this.wave),this.target.appendChild(this.svg),this.audioContext=window.audioContext,this.running=!1,this.hasAudio=!1,this.input=new s.Multiply,this.gain=new s.Signal(.1),this.analyserNode=this.audioContext.createAnalyser(),this.input.connect(this.analyserNode),this.gain.connect(this.input.factor),this.analyserNode.fftSize=4096,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.yScaling=1,this.maxFrequency=24e3,this.minFrequency=0,this.xScaling=2,this.binWidth=24e3/this.analyserNode.frequencyBinCount,this.setFftSize=function(e){Math.log2(e)%1!=0&&(e=Math.pow(2,Math.floor(Math.log2(e))),console.log("FFT size must be a power of two.")),console.log("Setting FFT size to ",e),this.analyserNode.fftSize=e,this.bufferLength=this.analyserNode.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.binWidth=24e3/this.bufferLength}.bind(this),this.drawWave=function(){var e="M";this.analyserNode.getByteFrequencyData(this.dataArray);let t=this.width,n=this.height/2;Math.max(...this.dataArray),Math.min(...this.dataArray),t=0,n=this.height,e+=`${t} ${n}, `;for(var s=0;s<this.bufferLength;s++){let r=24e3/(this.maxFrequency-this.minFrequency),o=this.minFrequency/this.binWidth,a=(255-this.dataArray[s+o])*(1/this.yScaling);if(t=(this.width+this.width/this.bufferLength)/this.bufferLength*s,t*=r,n=this.height/2*(a/128),t>this.width)break;e+=`${t} ${n}, `}t+=1,n=this.height,e+=`${t} ${n}, `,this.wave.setAttribute("d",e),this.wave.setAttribute("stroke","black"),this.running&&window.requestAnimationFrame(this.drawWave)}.bind(this),this.start=function(){this.running=!0,window.requestAnimationFrame(this.drawWave)}.bind(this),this.stop=function(){this.running=!1}.bind(this),this.disconnect=function(){this.target.removeChild(this.svg)}.bind(this),this.connect=function(e){this.target=document.getElementById(e),this.target.appendChild(this.svg)},this.start(),this.destroy=function(){this.stop(),setTimeout((()=>{this.target.contains(this.svg)&&this.target.removeChild(this.svg),this.analyserNode.disconnect(),this.input.disconnect(),this.gain.dispose(),this.target=null,this.wave=null,this.svg=null,this.audioContext=null,this.input=null,this.gain=null,this.analyserNode=null,this.dataArray=null,console.log("Spectroscope destroyed.")}),100)}.bind(this)}},8128:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.ModDelay=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.ModDelay=class ModDelay{constructor(){this.input=new r.Multiply(1),this.lfoRate=new r.Signal(.5),this.delay=new r.Delay({delayTime:0}),this.delayTime=new r.Signal(.1),this.delayTimeAdd=new r.Add,this.feedback=new r.Multiply(0),this.lfo=(new r.Oscillator).start(),this.lfoDepthScalar=new r.Multiply(.01),this.lfoDepth=new r.Multiply(.1),this.panner=new r.Panner(0),this.output=new r.Multiply(1),this.input.connect(this.delay),this.delay.connect(this.feedback),this.feedback.connect(this.delay),this.delay.connect(this.panner),this.panner.connect(this.output),this.delayTime.connect(this.delayTimeAdd),this.delayTimeAdd.connect(this.delay.delayTime),this.lfoRate.connect(this.lfo.frequency),this.lfo.connect(this.lfoDepthScalar),this.lfoDepthScalar.connect(this.lfoDepth),this.lfoDepth.connect(this.delayTimeAdd.addend),this.setDelayTime(.01)}setDelayTime(e){this.delayTime.value=e,this.lfoDepthScalar.factor.value=e}}},8272:e=>{"use strict";e.exports=JSON.parse('{"default":{"vco_mix":0.4096000000000002,"detune":1.9940090000000001,"cutoff":120.9999999999993,"vcf env":1057.9999999999998,"Q":2.047999999999998,"key vcf":1,"a":0.005,"d":0.1716759999999987,"s":0.6723999999999998,"r":1.6809999999999994,"a1":0.005,"d1":1.159696,"s1":0.6888999999999997,"r1":0.840999999999999,"lfo":4.801999999999989,"vibrato":0,"tremolo":0},"ether":{"vco_mix":0.6724000000000004,"detune":1.9940090000000001,"cutoff":168.99999999999915,"vcf env":1250,"Q":4.231999999999999,"key vcf":1,"a":0.005,"d":0.1716759999999987,"s":0.4224999999999996,"r":3.8440000000000003,"a1":0.005,"d1":1.159696,"s1":0.2915999999999996,"r1":2.809,"lfo":4.801999999999989,"vibrato":0.007290000000000004,"tremolo":0},"tremPad":{"vco_mix":0.4355999999999999,"detune":1.009409,"cutoff":1023.999999999999,"vcf env":1200.5,"Q":4.802,"key vcf":1,"a":0.5,"d":9.900699,"s":1,"r":20,"a1":0.5,"d1":10,"s1":1,"r1":20,"lfo":1.7999999999999925,"vibrato":0,"tremolo":0.5329000000000006}}')},8331:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Quadrophonic=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.Quadrophonic=class Quadrophonic{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this.context=window.audioContext,this.numChannels=e,this.channelMerger=this.context.createChannelMerger(this.numChannels);let t=window.audioContext.destination.maxChannelCount;window.audioContext.destination.channelCount=t,window.audioContext.destination.channelCountMode="explicit",window.audioContext.destination.channelInterpretation="discrete",this.channelMerger=window.audioContext.createChannelMerger(t),this.channelMerger.channelCount=1,this.channelMerger.channelCountMode="explicit",this.channelMerger.channelInterpretation="discrete",this.channelMerger.connect(window.audioContext.destination),this.input=[];for(let e=0;e<this.numChannels;e++)this.input.push(new s.Multiply(1)),this.input[e].connect(this.channelMerger,0,0)}connectSource(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e.connect(this.channelMerger,t,n)}disconnectSource(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.disconnect(this.channelMerger,0,t)}getNode(){return this.channelMerger}dispose(){this.channelMerger.disconnect(),console.log("ChannelMerger disposed.")}}},8375:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(3172);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var r=n(7683);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var o=n(5961);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var a=n(582);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))}));var c=n(5324);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var l=n(1077);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===l[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}));var h=n(3019);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===h[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}}))}));var u=n(3926);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===u[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}));var d=n(375);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===d[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}}))}));var f=n(6192);Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===f[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}}))}));var v=n(3941);Object.keys(v).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===v[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}}))}));var g=n(6373);Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===g[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}}))}));var m=n(9710);Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===m[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}}))}));var y=n(5923);Object.keys(y).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===y[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return y[e]}}))}));var b=n(4426);Object.keys(b).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===b[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return b[e]}}))}));var _=n(8128);Object.keys(_).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===_[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return _[e]}}))}));var w=n(6788);Object.keys(w).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===w[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return w[e]}}))}));var k=n(7846);Object.keys(k).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===k[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return k[e]}}))}));var x=n(182);Object.keys(x).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===x[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return x[e]}}))}));var S=n(3820);Object.keys(S).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===S[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return S[e]}}))}));var C=n(3705);Object.keys(C).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===C[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return C[e]}}))}));var M=n(5322);Object.keys(M).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===M[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return M[e]}}))}));var O=n(5220);Object.keys(O).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===O[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return O[e]}}))}));var T=n(9672);Object.keys(T).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===T[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return T[e]}}))}));var q=n(394);Object.keys(q).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===q[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return q[e]}}))}));var R=n(5164);Object.keys(R).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===R[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return R[e]}}))}));var A=n(1768);Object.keys(A).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===A[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return A[e]}}))}));var P=n(5213);Object.keys(P).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===P[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return P[e]}}))}));var E=n(9313);Object.keys(E).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===E[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return E[e]}}))}));var D=n(7220);Object.keys(D).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===D[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return D[e]}}))}));var j=n(4287);Object.keys(j).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===j[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return j[e]}}))}));var I=n(1174);Object.keys(I).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===I[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return I[e]}}))}));var F=n(5294);Object.keys(F).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===F[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return F[e]}}))}));var V=n(4154);Object.keys(V).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===V[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return V[e]}}))}));var W=n(3447);Object.keys(W).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===W[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return W[e]}}))}));var z=n(5493);Object.keys(z).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===z[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return z[e]}}))}));var N=n(727);Object.keys(N).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===N[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return N[e]}}))}));var B=n(506);Object.keys(B).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===B[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return B[e]}}))}));var L=n(8331);Object.keys(L).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===L[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return L[e]}}))}));var K=n(1439);Object.keys(K).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===K[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return K[e]}}))}));var G=n(7331);Object.keys(G).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===G[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return G[e]}}))}));var H=n(6603);Object.keys(H).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===H[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return H[e]}}))}));var $=n(6737);Object.keys($).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===$[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return $[e]}}))}));var U=n(2188);Object.keys(U).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===U[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return U[e]}}))}));var Q=n(2049);Object.keys(Q).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===Q[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return Q[e]}}))}));var Y=n(6379);Object.keys(Y).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===Y[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return Y[e]}}))}));var X=n(8577);Object.keys(X).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===X[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return X[e]}}))}));var J=n(9667);Object.keys(J).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===J[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return J[e]}}))}));var Z=n(1160);Object.keys(Z).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===Z[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return Z[e]}}))}));var ee=n(5953);Object.keys(ee).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===ee[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return ee[e]}}))}));var te=n(1951);Object.keys(te).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===te[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return te[e]}}))}));var ie=n(8011);Object.keys(ie).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===ie[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return ie[e]}}))}));var ne=n(1729);Object.keys(ne).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===ne[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return ne[e]}}))}));var se=n(2946);Object.keys(se).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===se[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return se[e]}}))}));var re=n(1313);Object.keys(re).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===re[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return re[e]}}))}))},8577:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SympathyString=t.Sympathy=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class SympathyString{constructor(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.input=new s.Multiply(1),this.delay=new s.LowpassCombFilter({resonance:.95,dampening:1e4}),this.vca=new s.Multiply(e),this.output=new s.Multiply(1),this.delayTime=new s.Signal(.1),this.delayTimeScalar=new s.Multiply(1),this.input.connect(this.delay),this.delay.connect(this.vca),this.vca.connect(this.output),this.delayTime.connect(this.delayTimeScalar),this.delayTimeScalar.connect(this.delay.delayTime)}setFrequency=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.delayTime.linearRampToValueAtTime(1/e,t+.001):this.delayTime.value=1/e};setFeedback=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=e<0?0:e>.9999?.9999:e,t?this.delay.resonance.setValueAtTime(e,t):this.delay.resonance.value=e};connect(e){this.output.connect(e)}}t.SympathyString=SympathyString,t.Sympathy=class Sympathy{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[100,200,300,400,500,600];for(this.numStrings=e,this.frequencies=t,this.input=new s.Multiply(1),this.hpf=new s.Filter({frequency:20,type:"highpass",Q:0}),this.eq=new s.EQ3,this.vca=new s.Multiply(1),this.output=new s.Multiply(1),this.hpf_cutoff=new s.Signal(20),this.hpf.connect(this.eq),this.eq.connect(this.vca),this.vca.connect(this.output),this.strings=[],this.detune=0;this.frequencies.length<this.numStrings;)this.frequencies.push(this.frequencies[0]);for(let e=0;e<this.numStrings;e++)this.strings.push(new SympathyString(t[e],1-t[e]/5e3)),this.input.connect(this.strings[e].input),this.strings[e].output.connect(this.hpf)}setFrequencies=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.length<this.numStrings){let t=Math.floor(this.numStrings/e.length),n=e;for(let s=0;s<t;s++)e=e.concat(n.map((e=>e*(2+s))))}if(t)for(let n=0;n<this.numStrings;n++)this.frequencies[n]=e[n]*(1-(Math.random()-.5)*this.detune),this.strings[n].setFrequency(this.frequencies[n],t);else for(let t=0;t<this.numStrings;t++)this.frequencies[t]<5?this.frequencies[t]=5:this.frequencies[t]>2e4&&(this.frequencies[t]=2e4),this.frequencies[t]=e[t]*(1-(Math.random()-.5)*this.detune),this.strings[t].setFrequency(this.frequencies[t])};setDetune=function(e){this.detune=e,this.setFrequencies(this.frequencies)};setFeedback=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e=e<0?0:e>.9999?.9999:e,t)for(let n=0;n<this.numStrings;n++)this.strings[n].setFeedback(e,t);else for(let t=0;t<this.numStrings;t++)this.strings[t].setFeedback(e)};setGains=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.length==this.numStrings)if(t)for(let t=0;t<this.numStrings;t++)this.strings[t].vca.factor.exponentialRampToValueAtTime(e[t],.1);else for(let t=0;t<this.numStrings;t++)this.strings[t].vca.factor.value=e[t];else console.log("incorrect gains array size, should be ",this.numStrings)};setHighpass=function(e){this.hpf.frequency.value=e};setEQ(e,t,n){this.eq.high.value=n,this.eq.mid.value=t,this.eq.low.value=e}setEQBands(e,t){e<10||t<10?console.log("EQ bands are in Hz"):(this.eq.highFrequency.value=t,this.eq.lowFrequency.value=e)}connect(e){this.output.connect(e)}}},8609:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=e=>[{name:"type",type:"vco",value:"white",radioOptions:["white","pink"],callback:function(t){switch(t){case"white":case"tri":case"sine":e.source.type="white";break;case"saw":e.source.type="pink"}}},{name:"cutoff",type:"vcf",min:20,max:1e4,curve:2,isSignal:"true",connectTo:e=>e.cutoffSig,callback:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n?e.cutoffSig.setValueAtTime(t,n):e.cutoffSig.value=t}},{name:"Q",type:"vcf",min:0,max:30,curve:2,callback:function(t){e.vcf.Q.value=t}},{name:"keyTrack",type:"hidden",min:0,max:2,curve:1,callback:function(t){e.keyTracker.factor.value=t}},{name:"envDepth",type:"vcf",min:-1e3,max:5e3,curve:2,callback:function(t){e.vcf_env_depth.factor.value=t}},{name:"level",type:"vca",min:0,max:1,curve:2,value:0,callback:function(t){e.vca_lvl.value=t}},{name:"attack",type:"env",min:0,max:1,curve:2,value:.01,callback:function(t){e.env.attack=t}},{name:"decay",type:"env",min:0,max:1,curve:2,value:.1,callback:function(t){e.env.decay=t}},{name:"sustain",type:"env",min:0,max:1,curve:2,value:.5,callback:function(t){e.env.sustain=t}},{name:"release",type:"env",min:0,max:1,curve:2,value:.5,callback:function(t){e.env.release=t}}]},8642:e=>{"use strict";e.exports=JSON.parse('{"default":{"Kick":0.5,"Snare":0.5,"Hihat":0.4,"Toms":0.5,"decay":1,"decay1":1,"decay12":1,"Output":2,"Dry Kick":0.5,"rate":1,"rate1":1,"rate12":1,"1 Rate":1,"2 Rate":1,"3 Rate":1,"Threshold":-32.5,"Ratio":1,"Distort":0.1,"Closed Decay":0.16839999999999972,"Open Decay":1.9801,"kit":"Acoustic"},"electro":{"Kick":0.7,"Snare":0.5,"Hihat":0.3,"Toms":0.5,"Output":3,"Dry Kick":0.3,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1.4,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":4.5,"Distort":0.3,"Hat Decay":0.505,"kit":"Techno","Kick1":1,"Snare1":1,"Hihat1":0.8999999999999999,"Toms1":0.23000000000000007,"Output1":0.9599999999999991,"Dry Kick1":0.1399999999999997,"Kick Rate1":0.8999999999999999,"Snare Rate1":0.8799999999999999,"Hihat Rate1":1.1,"Tom1 Rate1":1.4000000000000004,"Tom2 Rate1":1.3000000000000003,"Tom3 Rate1":1.12,"Threshold1":-28.649999999999995,"Ratio1":7.459999999999997,"Distort1":0.17,"Hat Decay1":0.11889999999999983,"kit1":"CR78"},"breakbeat":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"Kick1":1,"Snare1":1,"Hihat1":0.7199999999999998,"Toms1":0.7900000000000005,"Output1":2.3999999999999995,"Dry Kick1":0,"Kick Rate1":1.06,"Snare Rate1":1.12,"Hihat Rate1":0.8399999999999999,"Tom1 Rate1":1.1600000000000001,"Tom2 Rate1":1.1400000000000001,"Tom3 Rate1":1.1,"Threshold1":-28.649999999999995,"Ratio1":12.210000000000006,"Distort1":0.04,"Hat Decay1":0.19809999999999958,"kit":"breakbeat8"},"techno":{"Kick":1,"Snare":1,"Hihat":0.6999999999999997,"Toms":0.6099999999999997,"decay":0.2599999999999998,"decay1":0.04999999999999981,"decay12":0.004,"Output":0.9999999999999991,"Dry Kick":0,"rate":0.8599999999999999,"rate1":0.819999999999999,"rate12":1,"1 Rate":2,"2 Rate":2,"3 Rate":2,"Threshold":-29.20000000000002,"Ratio":9.36,"Distort":0.1999999999999997,"Closed Decay":0.07859999999999995,"Open Decay":2,"kit":"Techno"},"snappy":{"Kick":0.5,"Snare":0.5,"Hihat":0.5,"Toms":0.5,"Output":2,"Dry Kick":0.5,"Kick Rate":1,"Snare Rate":1,"Hihat Rate":1,"Tom1 Rate":1,"Tom2 Rate":1,"Tom3 Rate":1,"Threshold":-32.5,"Ratio":10.5,"Distort":0.5,"Hat Decay":0.505,"kit":"LINN","Kick1":1,"Snare1":0.7299999999999998,"Hihat1":0.5399999999999996,"Toms1":0.4499999999999995,"Output1":3.3199999999999994,"Dry Kick1":0,"Kick Rate1":1.1400000000000001,"Snare Rate1":1.3800000000000003,"Hihat Rate1":1.1400000000000001,"Tom1 Rate1":1.6800000000000006,"Tom2 Rate1":0.52,"Tom3 Rate1":0.21999999999999936,"Threshold1":-28.649999999999995,"Ratio1":1,"Distort1":0.09999999999999999,"Hat Decay1":0.08919999999999953,"kit1":"KPR77"},"linn":{"Kick":1,"Snare":1,"Hihat":0.51,"Toms":1,"decay":0.2599999999999998,"decay1":0.45000000000000007,"decay12":0.5,"Output":1.2799999999999994,"Dry Kick":0,"rate":0.8799999999999999,"rate1":1.2000000000000002,"rate12":0.7999999999999998,"1 Rate":1,"2 Rate":1,"3 Rate":1,"Threshold":-29.20000000000002,"Ratio":6.129999999999996,"Distort":0.09999999999999969,"Closed Decay":0.059,"Open Decay":1.1045000000000003,"kit":"LINN"}}')},8805:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),o=s(n(8972));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}const a=new class ToneJsMidiSync{constructor(){this.registeredLoops=new Map,this.nextLoopId=1,this.debug=!1}registerLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t&&e.interval&&(t=e.interval),!t)return this.debug&&console.error("No interval provided and could not determine interval from loop instance"),null;const n="tone-loop-"+this.nextLoopId++,s=this.convertIntervalToPulses(t),a=this.getCallbackFunction(e);return a?(o.default.on(n,(()=>{if(!1!==e._active)try{a(r.getTransport().immediate())}catch(e){this.debug&&console.error("Error in MIDI clock triggered loop callback:",e)}}),{pulses:s}),this.registeredLoops.set(n,{loop:e,interval:t,pulses:s}),this.debug&&console.log(`Registered Tone.js loop with MIDI clock: ${n} (${s} pulses)`),n):(this.debug&&console.error("Could not determine callback function for loop",e),null)}registerCallback(e,t){const n={callback:e,_active:!0};return this.registerLoop(n,t)}unregisterLoop(e){this.registeredLoops.has(e)&&(o.default.off(e),this.registeredLoops.delete(e),this.debug&&console.log(`Unregistered loop: ${e}`))}getCallbackFunction(e){return"function"==typeof e.callback?e.callback:"object"==typeof e.callback&&null!==e.callback&&"function"==typeof e.callback.next?t=>e.callback.next(t):e._callback&&"function"==typeof e._callback?e._callback:e.onTrigger&&"function"==typeof e.onTrigger?e.onTrigger:null}convertIntervalToPulses(e){let t=6;if("number"==typeof e){const n=60/r.getTransport().bpm.value;t=Math.round(e/n*24)}else"string"==typeof e&&("4n"===e||"1/4"===e?t=24:"8n"===e||"1/8"===e?t=12:"16n"===e||"1/16"===e?t=6:"32n"===e||"1/32"===e?t=3:"2n"===e||"1/2"===e?t=48:"1m"===e||"1n"===e?t=96:"8t"===e?t=8:"16t"===e&&(t=4));return Math.max(1,t)}setLoopActive(e,t){const n=this.registeredLoops.get(e);n&&(n.loop._active=t,this.debug&&console.log(`Loop ${e} active state set to ${t}`))}getRegisteredLoops(){const e={};for(const[t,n]of this.registeredLoops)e[t]={interval:n.interval,pulses:n.pulses,active:!1!==n.loop._active};return e}};t.default=a},8816:e=>{"use strict";e.exports=JSON.parse('{"default":{"vco_mix":0.4096000000000002,"detune":1.9940090000000001,"cutoff":120.9999999999993,"vcf env":1057.9999999999998,"Q":2.047999999999998,"key vcf":1,"hpf":46.178999999999824,"a":0.005,"d":0.1716759999999987,"s":0.6723999999999998,"r":1.6809999999999994,"a1":0.005,"d1":1.159696,"s1":0.6888999999999997,"r1":0.840999999999999,"lfo":4.801999999999989,"vibrato":0,"tremolo":0},"ether":{"vco_mix":0.6724000000000004,"detune":1.9940090000000001,"cutoff":168.99999999999915,"vcf env":1250,"Q":4.231999999999999,"key vcf":1,"hpf":46.178999999999824,"a":0.005,"d":0.1716759999999987,"s":0.4224999999999996,"r":3.8440000000000003,"a1":0.005,"d1":1.159696,"s1":0.2915999999999996,"r1":2.809,"lfo":4.801999999999989,"vibrato":0.007290000000000004,"tremolo":0},"tremPad":{"vco_mix":0.4355999999999999,"detune":1.009409,"cutoff":1023.999999999999,"vcf env":1200.5,"Q":4.802,"key vcf":1,"hpf":46.178999999999824,"a":0.5,"d":9.900699,"s":1,"r":20,"a1":0.5,"d1":10,"s1":1,"r1":20,"lfo":1.7999999999999925,"vibrato":0,"tremolo":0.5329000000000006},"chime":{"vco_mix":0.19359999999999997,"detune":1.9940090000000001,"cutoff":624.9999999999986,"vcf env":1300.5,"Q":2.047999999999998,"key vcf":0.6723999999999998,"hpf":46.178999999999824,"a":0.005,"d":0.28933062867908127,"s":0.5208999999999997,"r":1.457068975770812,"a1":0.005,"d1":0.6305912279255007,"s1":0.04839999999999971,"r1":0.7609756133823595,"lfo":2.047999999999991,"vibrato":0.0032400000000000007,"tremolo":0.24010000000000026,"blend":0.25,"shape1":0.009999999999999943,"shape2":0.3721000000000001,"pan":0.19359999999999955}}')},8972:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726)),r=n(5961);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}const o=new class MidiClockManager{constructor(){this.enabled=!1,this.debug=!1,this.pulseCount=0,this.pulsePosition=0,this.registeredCallbacks=new Map}enable(){return this.enabled||(this.enabled=!0,this.setupMidiClockListener(),this.debug&&console.log("MIDI clock manager enabled")),this}disable(){return this.enabled=!1,this.debug&&console.log("MIDI clock manager disabled"),this}setupMidiClockListener(){r.midiHandlerInstance.setMidiClockHandler((e=>this.handleMidiInput(e))),this.debug&&console.log("MIDI clock listener registered")}handleMidiInput(e){if(this.enabled)switch(e.data[0]){case 248:this.handleClockPulse();break;case 250:this.handleStart();break;case 252:this.handleStop();break;case 251:this.handleContinue()}}handleClockPulse(){this.enabled&&(this.pulseCount++,this.pulsePosition=this.pulseCount%24,s.getTransport().position=this.ticksToTransportPosition(),this.triggerCallbacks())}handleStart(){this.enabled&&(this.pulseCount=0,this.pulsePosition=0,this.debug&&console.log("MIDI clock start received"))}handleStop(){this.enabled&&this.debug&&console.log("MIDI clock stop received")}handleContinue(){this.enabled&&this.debug&&console.log("MIDI clock continue received")}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||"function"!=typeof t)return console.error("Invalid callback registration"),this;const{pulses:s=1,offset:r=0}=n;return this.registeredCallbacks.set(e,{callback:t,pulses:s,offset:r,options:n}),this.debug&&console.log(`MIDI clock callback registered: ${e} at ${s} pulse intervals`),this}off(e){return this.registeredCallbacks.has(e)&&(this.registeredCallbacks.delete(e),this.debug&&console.log(`MIDI clock callback unregistered: ${e}`)),this}ticksToTransportPosition(){const e=this.pulseCount,t=e/6,n=Math.floor(e/24)%4;return`${Math.floor(e/96)}:${n}:${Math.floor(t%4)}`}triggerCallbacks(){0!==this.registeredCallbacks.size&&this.registeredCallbacks.forEach(((e,t)=>{const{callback:n,pulses:s,offset:r}=e;this.pulseCount%s===r&&n()}))}getState(){return{enabled:this.enabled,running:this.running,pulseCount:this.pulseCount,pulsePosition:this.pulsePosition,quartersElapsed:Math.floor(this.pulseCount/24),sixteenthsElapsed:Math.floor(this.pulseCount/6)}}};t.default=o},9212:e=>{"use strict";e.exports=JSON.parse('{"default":{"octave":"8","tri":1,"saw":1,"squ":1,"-1":1,"-2":1,"noise":1,"vib/wah":0.48,"speed":10,"frequency":1200,"resonance":1,"VCF Env Depth":0.01,"volume":1,"velo filter":0.99,"velo volume":0.99,"A":0.1,"D":0.1,"S":1,"R":1,"chorus":0.0001,"Overdrive":0.0001},"Big Sweep":{"octave":"4","tri":0.0001,"saw":1.9866673333333333,"squ":0.0001,"-1":1.7066313333333347,"-2":2,"noise":1,"vib/wah":0.48,"speed":10,"frequency":1079.0000000000005,"resonance":6.142493025000001,"VCF Env Depth":2047.5449932752538,"volume":1,"velo filter":0.49019999999999975,"velo volume":0.3824,"A":7.692400000000003,"D":9.290800000000004,"S":0.37006299999999964,"R":16.721000000000007,"chorus":0.7300270000000002,"Overdrive":0.14008599999999996},"Fat Bass":{"octave":"16","tri":1.826675333333333,"saw":1.960002,"squ":0.0001,"-1":1,"-2":0.7333966666666665,"noise":0.10676133333333335,"vib/wah":0.48,"speed":10,"frequency":685.4999999999993,"resonance":2.641784774360023,"VCF Env Depth":1454.5302125627568,"volume":1.014999,"velo filter":0.99,"velo volume":0.99,"A":0.01,"D":4.195900000000002,"S":0.5900409999999995,"R":4.183999999999998,"chorus":0.090091,"Overdrive":0.33006700000000017},"80s Bass":{"octave":"16","tri":0.0001,"saw":0.0001,"squ":1.7333466666666677,"-1":1.880006,"-2":1.6000200000000002,"noise":0.013432666666666667,"vib/wah":0.48,"speed":10,"frequency":685.4999999999993,"resonance":1.2479293620748477,"VCF Env Depth":1789.554999999998,"volume":1.1550229999999997,"velo filter":0.5293999999999995,"velo volume":0.5293999999999995,"A":0.01,"D":3.596500000000001,"S":0.0001,"R":4.183999999999998,"chorus":0.0001,"Overdrive":0.1700829999999997},"Alien Distress Call":{"octave":"8","tri":1.4666933333333332,"saw":0.0001,"squ":0.8933886666666665,"-1":0.0001,"-2":0.0001,"noise":0.44007800000000036,"vib/wah":0.6460319999999997,"speed":2.203899999999993,"frequency":930.4999999999977,"resonance":13.282497224999993,"VCF Env Depth":69.11999999999912,"volume":0.07509500000000001,"velo filter":0.039399999999999574,"velo volume":0.0884,"A":2.6074000000000006,"D":9.091000000000001,"S":1,"R":10.353,"chorus":0.0001,"Overdrive":0.6200379999999996},"Hazy Pad":{"octave":"8","tri":1.6800160000000013,"saw":0.8667233333333338,"squ":0.10676133333333333,"-1":0.013432666666666667,"-2":0.0001,"noise":0.013432666666666667,"vib/wah":0.7980159999999998,"speed":1.2043999999999933,"frequency":709.999999999997,"resonance":3.082491225000001,"VCF Env Depth":20.479999999999567,"volume":0.8850410000000003,"velo filter":0.40199999999999964,"velo volume":0.4216000000000001,"A":5.404600000000002,"D":0.5095000000000001,"S":1,"R":10.154,"chorus":0.0001,"Overdrive":0.08009200000000001},"Poly Synth":{"octave":"8","tri":0.706731333333335,"saw":1.3200339999999995,"squ":1.7866773333333341,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.47504999999999953,"speed":3.2033999999999927,"frequency":858.5000000000002,"resonance":3.4547914440000014,"VCF Env Depth":787.3199999999944,"volume":0.8850410000000003,"velo filter":0.40199999999999964,"velo volume":0.4216000000000001,"A":0.01,"D":9.100900000000005,"S":0.0001,"R":5.377999999999994,"chorus":0.21007900000000007,"Overdrive":0.2600739999999999},"Lead Synth":{"octave":"4","tri":1.7332966666666678,"saw":0.6267353333333332,"squ":0.6267353333333333,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.461002,"speed":11.399300000000002,"frequency":1030.0000000000005,"resonance":1.4912902890000006,"VCF Env Depth":238.36943484410202,"volume":1,"velo filter":0.99,"velo volume":0.5881999999999996,"A":0.01,"D":0.01,"S":0.8700129999999998,"R":3.786,"chorus":0.0001,"Overdrive":0.090091},"warm keys":{"octave":"4","tri":1.6666333333333343,"saw":0.6267353333333332,"squ":2,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.4705010000000001,"speed":6.001999999999995,"frequency":662.5000000000001,"resonance":1.8992905290000013,"VCF Env Depth":1661.1772730937196,"volume":1.164989,"velo filter":0.7547999999999998,"velo volume":0.8135999999999999,"A":0.01,"D":3.9060999999999946,"S":0.4600539999999994,"R":16.816,"chorus":0.0001,"Overdrive":0.090091},"SynthPop Lead":{"octave":"4","tri":1.1999900000000012,"saw":1.466693333333333,"squ":1.5333566666666671,"-1":0.0001,"-2":0.0001,"noise":0.0001,"vib/wah":0.461002,"speed":11.399300000000002,"frequency":1152.5000000000005,"resonance":1.8992905290000013,"VCF Env Depth":238.36943484410202,"volume":1,"velo filter":0.49999999999999944,"velo volume":0.5881999999999996,"A":0.01,"D":0.01,"S":0.8700129999999998,"R":3.786,"chorus":0.0001,"Overdrive":0.17008299999999993},"SynthPop Bass":{"octave":"16","tri":1.4666933333333332,"saw":1.5866873333333347,"squ":1.5733546666666682,"-1":1,"-2":0.6933986666666666,"noise":0.0001,"vib/wah":0.48,"speed":10,"frequency":660.999999999999,"resonance":1.386411747593559,"VCF Env Depth":1454.5302125627568,"volume":1.014999,"velo filter":0.99,"velo volume":0.01,"A":0.01,"D":4.195900000000002,"S":0.5900409999999995,"R":4.183999999999998,"chorus":0.090091,"Overdrive":0.33006700000000017},"Wobbly Pad":{"octave":"8","tri":1.6800160000000013,"saw":0.8667233333333338,"squ":0.10676133333333333,"-1":0.013432666666666667,"-2":0.0001,"noise":0.013432666666666667,"vib/wah":0.8265129999999999,"speed":11.799099999999996,"frequency":1028.4999999999973,"resonance":3.082491225000001,"VCF Env Depth":20.479999999999567,"volume":0.9150390000000003,"velo filter":0.40199999999999964,"velo volume":0.4216000000000001,"A":5.404600000000002,"D":1.7083000000000004,"S":1,"R":0.1,"chorus":0.0001,"Overdrive":0.08009200000000001}}')},9313:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.KP=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}n(5294),n(1439);class Voice{constructor(){this.impulse=(new r.Noise).start(),this.hpf=new r.Filter({frequency:200,type:"highpass",Q:0,rolloff:-24}),this.lpf=new r.Filter({frequency:1e3,type:"lowpass",Q:0,rolloff:-12}),this.dry=new r.Signal(0),this.wet=new r.Multiply(1),this.vca=new r.Multiply(1),this.delay_1=new r.LowpassCombFilter({resonance:.95,dampening:1e4}),this.delay_2=new r.LowpassCombFilter({resonance:.95,dampening:1e4}),this.env=new r.Envelope,this.env_depth=new r.Multiply(1),this.velocity=new r.Multiply(1),this.choke=new r.Signal,this.resonance=new r.Signal(.9),this.velocity_depth=new r.Multiply(1),this.lowpassCutoffSignal=new r.Signal(1e3),this.highpassCutoffSignal=new r.Signal(1e3),this.bandwidthSignal=new r.Signal(500),this.hpfBandWidthNegate=new r.Negate,this.hpf_env_depth=new r.Multiply,this.lpf_env_depth=new r.Multiply,this.delayTime=new r.Signal(.1),this.detune=new r.Multiply(1),this.output=new r.Multiply(1),this.impulse.connect(this.hpf),this.hpf.connect(this.lpf),this.lpf.connect(this.vca),this.dry.connect(this.vca.factor),this.vca.connect(this.wet),this.wet.connect(this.delay_1),this.wet.connect(this.delay_2),this.delay_1.connect(this.output),this.delay_2.connect(this.output),this.resonance.connect(this.delay_1.resonance),this.resonance.connect(this.delay_2.resonance),this.choke.connect(this.delay_1.resonance),this.choke.connect(this.delay_2.resonance),this.env.connect(this.env_depth),this.env_depth.connect(this.velocity_depth),this.velocity_depth.connect(this.vca.factor),this.velocity.connect(this.velocity_depth),this.delayTime.connect(this.delay_1.delayTime),this.delayTime.connect(this.detune),this.detune.connect(this.delay_2.delayTime),this.highpassCutoffSignal.connect(this.hpf.frequency),this.lowpassCutoffSignal.connect(this.lpf.frequency),this.env.connect(this.hpf_env_depth.factor),this.env.connect(this.hpf_env_depth.factor),this.hpf_env_depth.connect(this.hpf.frequency),this.lpf_env_depth.connect(this.lpf.frequency)}cutoff=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.lowpassCutoffSignal.setValueAtTime(e,t):this.lowpassCutoffSignal.value=e};bandwidth=function(e,t){t?this.bandwidthSignal.setValueAtTime(e,t):this.bandwidthSignal.value=e};frequency=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.delayTime.setValueAtTime(1/e,t):this.delayTime.rampTo(1/e,.01)};triggerAttack=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n?(this.env.triggerAttack(n),this.frequency(e,n),this.velocity_depth.linearRampToValueAtTime(t,.01,n)):(this.env.triggerAttack(),this.frequency(e),this.velocity_depth.rampTo(t,.002))};triggerRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t?this.env.triggerRelease(t):this.env.triggerRelease()};triggerAttackRelease=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;s?(this.env.triggerAttackRelease(n,s),this.frequency(e,s),this.velocity_depth.linearRampToValueAtTime(t,.01,s)):(this.env.triggerAttackRelease(n),this.frequency(e),this.velocity_depth.rampTo(t,.002))}}t.KP=class KP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;this.numVoices=e,this.voice=[];for(let e=0;e<this.numVoices;e++)this.voice.push(new Voice);this.clip=new r.Multiply(.125),this.waveShaper=new r.WaveShaper((e=>Math.sin(e*Math.PI*2))),this.waveShaper.oversample="4x",this.lpf=new r.Filter({type:"lowpass",rolloff:-12,Q:0,frequency:5e3}),this.output=new r.Multiply(.15),this.clip.connect(this.waveShaper);for(let e=0;e<this.numVoices;e++)this.voice[e].output.connect(this.clip);this.clip.connect(this.waveShaper),this.waveShaper.connect(this.lpf),this.lpf.connect(this.output),this.prevNote=0,this.v=0,this.voiceCounter=0,this.activeNotes=[-1,-1,-1,-1,-1,-1,-1,-1],this.noteOrder=[7,0,1,2,3,4,5,6]}triggerAttack=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.v=this.getNewVoice(e),n?this.voice[this.v].triggerAttack(e,t,n):this.voice[this.v].triggerAttack(e,t)};triggerRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.v=this.getActiveVoice(e),this.v<0||(t?this.voice[this.v].triggerRelease(t):this.voice[this.v].triggerRelease())};triggerAttackRelease=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.v=this.getNewVoice(e),s?this.voice[this.v].triggerAttackRelease(e,t,n,s):this.voice[this.v].triggerAttackRelease(e,t,n)};getNewVoice(e){this.voiceCounter>=this.numVoices&&(this.voiceCounter=0),this.prevNote=this.noteOrder.shift(),this.noteOrder.push(e);for(let t=0;t<this.numVoices;t++)this.activeNotes[t]==e&&this.triggerRelease(e);for(let t=0;t<this.numVoices;t++){const n=(t+this.voiceCounter)%this.numVoices;if(this.activeNotes[n]<0)return this.activeNotes[n]=e,this.voiceCounter=(n+1)%this.numVoices,n}return this.voiceCounter=(this.voiceCounter+1)%this.numVoices,this.voiceCounter}getActiveVoice=function(e){for(let t=0;t<this.numVoices;t++)if(this.activeNotes[t]==e)return this.activeNotes[t]=-1,t;return-1};panic=function(){for(let e=0;e<this.numVoices;e++)this.voice[e].env.triggerRelease(),this.activeNotes[e]=-1};setResonance=function(e){for(let t=0;t<this.numVoices;t++)this.voice[t].resonance.value=e};setDamping=function(e){for(let t=0;t<this.numVoices;t++)this.voice[t].delay_1.dampening=e,this.voice[t].delay_2.dampening=e};setCutoff=function(e){for(let t=0;t<this.numVoices;t++)this.voice[t].lowpassCutoffSignal.value=e;this.lpf.frequency.value=2*e};setQ=function(e){for(let t=0;t<this.numVoices;t++)this.voice[t].lpf.Q.value=e};setHighpass=function(e){for(let t=0;t<this.numVoices;t++)this.voice[t].highpassCutoffSignal.value=e};setADSR=function(e,t,n,s){for(let r=0;r<this.numVoices;r++)this.voice[r].env.attack=e,this.voice[r].env.decay=t,this.voice[r].env.sustain=n,this.voice[r].env.release=s};setDecay(e){e=e<0?.001:e;for(let t=0;t<this.numVoices;t++)this.voice[t].env.release=e,this.voice[t].env.decay=e}setClip(e){this.clip.rampTo(e,.02)}setChoke(e){for(let t=0;t<this.numVoices;t++)this.voice[t].choke.rampTo(-e/2,.2)}setDetune(e){for(let t=0;t<this.numVoices;t++)this.voice[t].detune.value=e}setDry(e){for(let t=0;t<this.numVoices;t++)this.voice[t].dry.value=e}setEnvDepth(e){for(let t=0;t<this.numVoices;t++)this.voice[t].env_depth.factor.value=e}connect(e){e.input?this.output.connect(e.input):this.output.connect(e)}}},9315:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=e=>[{name:"detune",type:"vco",min:0,max:2,curve:1,isSignal:"true",connectTo:e.tuning.factor,callback:function(t){return e.tuning.factor.value=t}},{name:"drive2",type:"vco",min:0,max:2,curve:2,isSignal:"true",connectTo:e.drive.gain,callback:function(t){return e.drive.gain.value=t}},{name:"fm",type:"vcf",min:0,max:10,curve:2,isSignal:"true",connectTo:e.fmDepth.factor,callback:function(t){return e.modIndex.value=t}},{name:"am",type:"vcf",min:0,max:2,curve:2,isSignal:"true",connectTo:e.amDepth.factor,callback:function(t){return e.amDepth.gain.value=t}},{name:"harm",type:"vcf",min:1,max:20,curve:1,isSignal:"true",connectTo:e.harmonicity.factor,callback:function(t){e.harmonicity.factor.value=t}},{name:"cutoff",type:"vcf",min:50,max:1e4,curve:2,isSignal:"true",connectTo:e.cutoffSig,callback:function(t){return e.cutoffSig.value=t}},{name:"Q",type:"vcf",min:0,max:20,curve:.7,isSignal:"true",connectTo:e.finalFilter.Q,callback:function(t){return e.finalFilter.Q.value=t}},{name:"noiseG",type:"vca",min:0,max:1.5,curve:2,isSignal:"true",connectTo:e.noiseGain.gain,callback:function(t){return e.noiseGain.gain.value=t}},{name:"toneG",type:"vca",min:0,max:1.5,curve:2,isSignal:"true",connectTo:e.drive.gain,callback:function(t){return e.toneGain.gain.value=t}},{name:"vol",type:"vca",min:0,max:2,curve:2,isSignal:"true",connectTo:e.output.factor,callback:function(t){return e.output.factor.value=t}},{name:"drop",type:"vco",min:0,max:5e3,curve:2,isSignal:"true",connectTo:e.pitchEnvDepth.factor,callback:function(t){return e.pitchEnvDepth.factor.value=t}},{name:"decay",type:"env",min:0,max:5,curve:2,isSignal:"false",connectTo:e.env.decay,callback:function(t){e.env.decay=t,e.env.release=t}},{name:"pDecay",type:"env",min:0,max:1,curve:2,isSignal:"false",connectTo:e.pitchEnvelope.decay,callback:function(t){e.pitchEnvelope.decay=t,e.pitchEnvelope.release=t}},{name:"nDecay",type:"env",min:0,max:5,curve:2,isSignal:"false",connectTo:e.noiseEnv.decay,callback:function(t){e.noiseEnv.decay=t,e.noiseEnv.release=t}},{name:"nFreq",type:"vcf",min:100,max:1e4,curve:2,isSignal:"true",connectTo:e.noiseCutoff,callback:function(t){e.noiseCutoff.value=t}},{name:"nEnv",type:"env",min:0,max:5e3,curve:3,isSignal:"true",connectTo:e.noiseVcfEnvDepth.factor,callback:function(t){return e.noiseVcfEnvDepth.factor.value=t}},{name:"vcfEnv",type:"vcf",min:0,max:5e3,curve:3,isSignal:"true",connectTo:e.vcfEnvDepth.factor,callback:function(t){return e.vcfEnvDepth.factor.value=t}}]},9340:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(4658);t.default=class LinkSlobClient{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.serverUrl=e.serverUrl||"http://localhost:3333",this.onUpdate=e.onUpdate||(()=>{}),this.onStatusChange=e.onStatusChange||(()=>{}),this.onTransportChange=e.onTransportChange||(()=>{}),this.socket=null,this.isConnected=!1,this.numPeers=0,this.bpm=120,this.beat=0,this.phase=0,this.serverTimestamp=0,this.lastUpdateTime=performance.now(),this.debug=!1}connect(){return new Promise(((e,t)=>{try{this._log("Connecting to LinkSlob server at",this.serverUrl),this.socket=(0,s.io)(this.serverUrl),this.socket.on("connect",(()=>{this.isConnected=!0,this._log("Connected to LinkSlob server"),this.onStatusChange({isConnected:!0}),e()})),this.socket.on("disconnect",(()=>{this.isConnected=!1,this._log("Disconnected from LinkSlob server"),this.onStatusChange({isConnected:!1})})),this.socket.on("connect_error",(e=>{this._log("error","Connection error:",e),this.onStatusChange({isConnected:!1,error:e}),t(e)})),this.socket.on("link-update",(e=>{this.beat=e.beat,this.phase=e.phase,this.bpm=e.bpm,this.numPeers=e.numPeers,this.serverTimestamp=e.timestamp||Date.now()/1e3,this.lastUpdateTime=performance.now(),this.onUpdate({...e,timestamp:this.serverTimestamp})})),this.socket.on("link-status",(e=>{this.isConnected=e.isConnected,this.numPeers=e.numPeers,this.bpm=e.bpm,this.beat=e.beat,this.phase=e.phase,this.serverTimestamp=e.timestamp||Date.now()/1e3,this.onStatusChange({...e,timestamp:this.serverTimestamp})})),this.socket.on("bpm-changed",(e=>{this.bpm=e,this._log("BPM changed to",e)})),this.socket.on("transport-state",(e=>{this._log("Transport state changed to",e),this.onTransportChange(e)}))}catch(e){this._log("error","Failed to connect to LinkSlob server:",e),t(e)}}))}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.isConnected=!1,this._log("Disconnected from LinkSlob server"))}setBpm(e){this.socket&&this.isConnected&&(this.socket.emit("set-bpm",e),this._log("Setting BPM to",e))}setBeat(e){this.socket&&this.isConnected&&(this.socket.emit("set-beat",e),this._log("Setting beat to",e))}start(){this.socket&&this.isConnected&&(this.socket.emit("transport","start"),this._log("Starting transport"))}stop(){this.socket&&this.isConnected&&(this.socket.emit("transport","stop"),this._log("Stopping transport"))}getNumPeers(){return this.numPeers}getServerTimestamp(){return this.serverTimestamp}getBpm(){return this.bpm}getBeat(){return this.beat}getPhase(){return this.phase}isConnectedToServer(){return this.isConnected}getTimeSinceLastUpdate(){return performance.now()-this.lastUpdateTime}setDebug(e){this.debug=e}_log(e){if(this.debug){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];"error"===e?console.error("[LinkSlob]",...n):console.log("[LinkSlob]",...n)}}}},9667:(e,t,n)=>{"use strict";var s=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.ToneWood=void 0,s(n(5897));var r=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,n&&n.set(e,s),s}(n(5726));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}t.ToneWood=class ToneWood{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.gui=e,this.input=new r.Multiply(1),this.gain=new r.Multiply(1),this.waveShaper=new r.WaveShaper((e=>Math.tanh(e))),this.convolver=new r.Convolver,this.output=new r.Multiply(1),this.buffer=null,this.input.connect(this.gain),this.gain.connect(this.convolver),this.waveShaper.connect(this.output),this.convolver.connect(this.waveShaper),this.convolver.normalize=!0}load(e){return new Promise(((t,n)=>{new r.Buffer(e,(e=>{this.buffer=e,this.convolver.buffer=e,t()}),n)}))}async filterIR(e){if(!this.buffer)return void console.error("Buffer not loaded.");const t=r.getContext().rawContext,n=this.buffer.duration,s=new OfflineAudioContext(2,n*t.sampleRate,t.sampleRate),o=this.buffer.get(),a=s.createBufferSource();a.buffer=o;const c=s.createBiquadFilter();return c.type="lowpass",c.frequency.value=e,a.connect(c),c.connect(s.destination),a.start(0),new Promise(((e,t)=>{s.startRendering().then((t=>{const n=new r.Buffer(t);this.buffer=n,this.convolver.buffer=n,e()})).catch(t)}))}async stretchIR(e){if(!this.buffer)return void console.error("Buffer not loaded.");const t=r.getContext().rawContext,n=this.buffer.duration,s=new OfflineAudioContext(2,n*e*t.sampleRate,t.sampleRate),o=this.buffer.get(),a=s.createBufferSource();return a.buffer=o,a.playbackRate.value=1/e,a.connect(s.destination),a.start(0),new Promise(((e,t)=>{s.startRendering().then((t=>{const n=new r.Buffer(t);this.buffer=n,this.convolver.buffer=n,e()})).catch(t)}))}async highpassIR(e){if(!this.buffer)return void console.error("Buffer not loaded.");const t=r.getContext().rawContext,n=this.buffer.duration,s=new OfflineAudioContext(2,n*t.sampleRate,t.sampleRate),o=this.buffer.get(),a=s.createBufferSource();a.buffer=o;const c=s.createBiquadFilter();return c.type="highpass",c.frequency.value=e,a.connect(c),c.connect(s.destination),a.start(0),new Promise(((e,t)=>{s.startRendering().then((t=>{const n=new r.Buffer(t);this.buffer=n,this.convolver.buffer=n,e()})).catch(t)}))}connect(e){this.output.connect(e)}}},9672:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrumTemplate=void 0,function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_getRequireWildcardCache(t);if(n&&n.has(e))return n.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}s.default=e,n&&n.set(e,s)}(n(5726));var s=n(1174);function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(e){return e?n:t})(e)}class DrumTemplate extends s.MonophonicTemplate{constructor(){super(),this.type="Drum"}trigger(){this.env.triggerAttackRelease(.001)}}t.DrumTemplate=DrumTemplate},9710:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expr=function expr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return Array.from({length:t},((t,n)=>e(n)))},t.stepper=function stepper(e,t,n,s){let r=n-t,o=(e-t)/r;const a=[],c=[];for(let e=0;e<s.length;e++)a.push(s[e][0]),c.push(s[e][1]);let l=0;for(;l<a.length;){if(o<a[l]){let e=(c[l]-c[l-1])/(a[l]-a[l-1]);return(c[l-1]+e*(o-a[l-1]))*r+t}l++}return n}},9762:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TimingObject:()=>s,filterTimingStateVectorUpdate:()=>filterTimingStateVectorUpdate,translateTimingStateVector:()=>translateTimingStateVector});const filterTimingStateVectorUpdate=e=>{if(void 0===e)return{};let t=null!==e.acceleration&&void 0!==e.acceleration?{acceleration:e.acceleration}:{};return null!==e.position&&void 0!==e.position&&(t={...t,position:e.position}),null!==e.velocity&&void 0!==e.velocity?{...t,velocity:e.velocity}:t},translateTimingStateVector=(e,t)=>{const{acceleration:n,position:s,timestamp:r,velocity:o}=e;return{acceleration:n,position:s+o*t+.5*n*t**2,timestamp:r+t,velocity:o+n*t}},s=((e,t,n,s,r,o,a,c)=>class extends s{constructor(e={},t=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY){super();const{timingProviderSource:s,vector:c}=void 0===e.update?{timingProviderSource:null,vector:e}:{timingProviderSource:e,vector:{}};if(this._endPosition=null===s?n:s.endPosition,this._onchange=null,this._onerror=null,this._onreadystatechange=null,this._readyState=null===s?"open":s.readyState,this._skew=null===s?0:s.skew,this._startPosition=null===s?t:s.startPosition,this._timingProviderSource=s,this._timeoutId=null,this._vector=null===s?{acceleration:0,position:0,velocity:0,...r(c),timestamp:o.now()/1e3}:s.vector,n<this._vector.position&&(this._vector={...this._vector,acceleration:0,position:n,velocity:0}),t>this._vector.position&&(this._vector={...this._vector,acceleration:0,position:t,velocity:0}),this._setInternalTimeout(),null===s)a((()=>this.dispatchEvent(new Event("readystatechange"))));else{const onAdjust=()=>{this._skew=s.skew},onChange=()=>this._setInternalVector(s.vector),onReadyStateChange=()=>{this._isAllowedTransition(s.readyState)?this._readyState=s.readyState:(this._readyState="closed",s.removeEventListener("adjust",onAdjust),s.removeEventListener("change",onChange),s.removeEventListener("readystatechange",onReadyStateChange)),null!==s.error&&a((()=>this.dispatchEvent(new ErrorEvent("error",{error:s.error})))),a((()=>this.dispatchEvent(new Event("readystatechange"))))};s.addEventListener("adjust",onAdjust),s.addEventListener("change",onChange),s.addEventListener("readystatechange",onReadyStateChange)}}get endPosition(){return this._endPosition}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onerror(){return null===this._onerror?this._onerror:this._onerror[0]}set onerror(e){if(null!==this._onerror&&this.removeEventListener("error",this._onerror[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("error",t),this._onerror=[e,t]}else this._onerror=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get startPosition(){return this._startPosition}get timingProviderSource(){return this._timingProviderSource}query(){if("open"!==this._readyState)throw n();const e=o.now()/1e3,t=null===this._timingProviderSource?e-this._vector.timestamp:e+this._skew-this._vector.timestamp,s=c(this._vector,t);return this._endPosition<s.position||this._startPosition>s.position?(this._setInternalVector({...s,acceleration:0,position:this._endPosition<s.position?this._endPosition:this._startPosition,velocity:0}),this.query()):s}update(e){if("open"!==this._readyState)return Promise.reject(n());if(null!==this._timingProviderSource){const t=this._timingProviderSource.update(e);return t instanceof Promise?t:Promise.reject(new TypeError("The timingProviderSource failed to return a promise."))}const t=r(e);if(0===Object.keys(t).length)return Promise.resolve();const s={...this.query(),...t},{position:o,velocity:a,acceleration:c}=s;return o<this._startPosition||o>this._endPosition||o===this._startPosition&&(a<0||0===a&&c<0)||o===this._endPosition&&(a>0||0===a&&c>0)?Promise.reject((()=>{try{return new DOMException("","IllegalValueError")}catch(e){return e.name="IllegalValueError",e}})()):(this._setInternalVector(s),Promise.resolve())}_isAllowedTransition(e){return"closing"===this._readyState&&"closed"===e||"connecting"===this._readyState||"open"===this._readyState&&("closed"===e||"closing"===e)}_setInternalTimeout(){if(null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this._endPosition===Number.POSITIVE_INFINITY&&this._startPosition===Number.NEGATIVE_INFINITY||0===this._vector.acceleration&&0===this._vector.velocity)return;const t=e(this._vector,this._startPosition,this._endPosition);null!==t&&(this._timeoutId=a((()=>this.query()),t))}_setInternalVector(e){this._vector=e,this._setInternalTimeout(),a((()=>this.dispatchEvent(new Event("change"))))}})((a=({acceleration:e,position:t,velocity:n},s)=>{const r=((e,t,n,s)=>{if(0===n&&0===t)return e!==s?[]:[0];if(0===n)return[(s-e)/t];const r=t/n,o=Math.sqrt(r**2-2/n*(e-s));return[o-r,-(o+r)].filter((e=>!isNaN(e))).sort()})(t,n,e,s);if(0===r.length)return null;if(1===r.length)return r[0]>0?r[0]:null;if(2===r.length){if(r[1]<0)return null;if(r[0]>0)return r[0];if(r[1]>0)return r[1]}return null},o=(e,t,n)=>{const s=a(e,t),r=a(e,n);return null!==s&&null!==r?s<r?s:r:null!==s?s:null!==r?r:null},(e,t,n)=>{const s=o(e,t,n);return null===s||s===Number.POSITIVE_INFINITY?null:s}),0,(()=>{try{return new DOMException("","InvalidStateError")}catch(e){return e.code=11,e.name="InvalidStateError",e}}),(r=(e=>()=>{if(null===e)throw new Error("A native EventTarget could not be created.");return e.document.createElement("p")})("undefined"==typeof window?null:window),class EventTarget{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=r()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(s=this,r=t,o=e=>{const t={value:s};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof r?r.call(s,e):r.handleEvent.call(s,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var s,r}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const s=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===s?null:s,n)}}),filterTimingStateVectorUpdate,performance,setTimeout,translateTimingStateVector);var r,o,a}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nc=void 0;var __webpack_exports__=__webpack_require__(8375),__webpack_export_target__=window;for(var __webpack_i__ in __webpack_exports__)__webpack_export_target__[__webpack_i__]=__webpack_exports__[__webpack_i__];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();

    // --- Important window initializations ---
    
    // Initialize ASCII
    window.enableAsciiInput = asciiCallbackInstance.enable.bind(asciiCallbackInstance);
    window.disableAsciiInput = asciiCallbackInstance.disable.bind(asciiCallbackInstance);
    window.setAsciiHandler = asciiCallbackInstance.setHandler.bind(asciiCallbackInstance);
    window.enableAsciiRepeat = () => asciiCallbackInstance.allowRepeat = true;
    window.disableAsciiRepeat = () => asciiCallbackInstance.allowRepeat = false;

    // Initialize MIDI
    window.midiHandlerInstance = midiHandlerInstance;
    window.setNoteOnHandler = midiHandlerInstance.setNoteOnHandler.bind(midiHandlerInstance);
    window.setNoteOffHandler = midiHandlerInstance.setNoteOffHandler.bind(midiHandlerInstance);
    window.setCCHandler = midiHandlerInstance.setCCHandler.bind(midiHandlerInstance);
    window.sendCC = midiHandlerInstance.sendCC.bind(midiHandlerInstance);
    window.sendNote = midiHandlerInstance.sendNoteOn.bind(midiHandlerInstance);
    window.sendNoteOff = midiHandlerInstance.sendNoteOff.bind(midiHandlerInstance);

    // Since this function can be called by the user, just have it defined to be called
    function initCollab(roomName = 'famleLounge') {
        // window.chClient = new CollabHubClient(); // needs to happen once (!)
        // window.chTracker = new CollabHubTracker(window.chClient);
        window.chClient = new CollabSlobClient();

        // collab-hub join a room
        window.chClient.joinRoom(roomName); // TODO change this to the patch-specific room name
    }
    

    // --- UI/Control Functions ---
    
    function acknowledgeWarning() {
        document.getElementById('volumeWarning').style.display = 'none';
        runCode();
    }
    
    
    window.timing = timingStrategyManager;
    // Functions for timing control
    function startTiming() {
        console.log('Starting timing manager');
        // Ensure window.timing is initialized before calling start
        if (window.timing && typeof window.timing.start === 'function') {
            window.timing.start();
        } else {
            console.error("Timing manager (window.timing) not initialized or start function missing.");
        }
    }
    
    function stopTiming() {
        console.log('Stopping timing manager');
        // Ensure window.timing is initialized before calling stop
        if (window.timing && typeof window.timing.stop === 'function') {
            window.timing.stop();
        } else {
            console.error("Timing manager (window.timing) not initialized or stop function missing.");
        }
    }
    
    
    // Function to handle timing strategy changes
    async function handleTimingStrategyChange(strategy) {
        console.log('Changing timing strategy to:', strategy);
        
        if (strategy === 'tone_js' || strategy === 'midi_clock' || strategy === 'ableton_link') {
            window.timing.setStrategy(strategy);
        } else if (strategy === 'timing_object') {
            // Use the handleTimingInitialization function (expected from synth-bundle)
            await handleTimingInitialization(
                () => window.timing.setStrategy(strategy),
                () => console.log('Timing Object initialized successfully'),
                (error) => console.error('Failed to initialize Timing Object:', error),
                'Timing Object'
            );
        }    
    }

    // Attach listener for timing strategy selection
    document.addEventListener('DOMContentLoaded', () => {
        const timingSelect = document.getElementById('timingStrategySelect');
        if (timingSelect) {
            timingSelect.addEventListener('change', (event) => {
                const target = event.target;
                if (target) {
                    handleTimingStrategyChange(target.value);
                }
            });
        }
    });
    
    
    // Function to display available MIDI devices and populate the selectors
    function displayMidiDevices() {
        if (!window.midi_input_ids || !window.midi_output_ids || !window.midi_input_names || !window.midi_output_names) {
            console.warn('MIDI device information not available');
            return;
        }
        
        // Get the select elements
        const inputSelect = document.getElementById('midiInputSelect');
        const outputSelect = document.getElementById('midiOutputSelect');
        
        if (inputSelect && outputSelect) {
            // Clear existing options
            inputSelect.innerHTML = '<option value="">None</option>';
            outputSelect.innerHTML = '<option value="">None</option>';
            
            // Add input options using midi_input_ids and midi_input_names
            for (const id in window.midi_input_ids) {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = window.midi_input_names[id];
                inputSelect.appendChild(option);
            }
            
            // Add output options using midi_output_ids and midi_output_names
            for (const id in window.midi_output_ids) {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = window.midi_output_names[id];
                outputSelect.appendChild(option);
            }
        }
    }

    // Function to handle MIDI input device selection
    function handleMidiInputSelection(deviceId) {
        console.log('Setting MIDI input device:', deviceId);
        if (window.setMidiInput && deviceId) {
            try {
                window.setMidiInput(deviceId);
                console.log('MIDI input device set successfully');
            } catch (error) {
                console.error('Failed to set MIDI input device:', error);
            }
        } else {
            console.warn("MIDI input function not available or no device selected");
        }
    }

    // Function to handle MIDI output device selection
    function handleMidiOutputSelection(deviceId) {
        console.log('Setting MIDI output device:', deviceId);
        if (window.setMidiOutput && deviceId) {
            try {
                window.setMidiOutput(deviceId);
                console.log('MIDI output device set successfully');
            } catch (error) {
                console.error('Failed to set MIDI output device:', error);
            }
        } else {
            console.warn("MIDI output function not available or no device selected");
        }
    }

    // Attach listeners for MIDI device selection
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize MIDI device selectors
        const refreshBtn = document.getElementById('refreshMidiBtn');
        const inputSelect = document.getElementById('midiInputSelect');
        const outputSelect = document.getElementById('midiOutputSelect');
        
        if (refreshBtn) {
            refreshBtn.addEventListener('click', () => {
                displayMidiDevices();
            });
        }
        
        if (inputSelect) {
            inputSelect.addEventListener('change', (event) => {
                const target = event.target;
                if (target) {
                    handleMidiInputSelection(target.value);
                }
            });
        }
        
        if (outputSelect) {
            outputSelect.addEventListener('change', (event) => {
                const target = event.target;
                if (target) {
                    handleMidiOutputSelection(target.value);
                }
            });
        }
        
        // Initial display of MIDI devices
        // Wait a moment to ensure MIDI is initialized
        setTimeout(displayMidiDevices, 500);
    });

    // Make MIDI functions globally available
    window.setMidiInput = setMidiInput;
    window.setMidiOutput = setMidiOutput;
    
    
    // Function to run user code
    async function runCode() {
        try {
            // Start audio context
            await Tone.start();
            window.audioContext = Tone.context.rawContext;
            
            // Clear previous state
            Tone.Transport.stop();
            Tone.Transport.cancel();
            
            // Clear all previous canvases
            Canvas.innerHTML = "";
            
            // Get the user code from the non-executable script tag
            const userCodeElement = document.getElementById('userCode');
            const userCode = userCodeElement.textContent || userCodeElement.innerText;
            
            // Run user code
            eval(userCode);

            updateBPM(Theory.tempo);
        } catch (error) {
            console.error('Error running code:', error);
            alert('Error running code: ' + error.message);
        }
    }

    // Function to stop all sound (just reloads the page, there is too much to fix otherwise)
    function stopCode() {
        location.reload();
    }

    // Attach listeners to buttons
    document.addEventListener('DOMContentLoaded', () => {
        const startBtn = document.getElementById('startButton');
        const stopBtn = document.getElementById('stopButton');
        if (startBtn) startBtn.addEventListener('click', startTiming); 
        if (stopBtn) stopBtn.addEventListener('click', stopTiming);   
    });
    
    
    function updateBPM(value) {
        document.getElementById('bpmValue').textContent = value;
        document.getElementById('bpmSlider').value = value;
        document.getElementById('bpmInput').value = value;
        window.timing.setBpm(value);
    }

    // Sync BPM UI with actual Tone.Transport BPM value
    function syncBPMFromToneTransport() {
        const currentBPM = Math.round(Tone.Transport.bpm.value);
        const displayedBPM = parseInt(document.getElementById('bpmValue').textContent);
        
        // Only update if the values differ
        if (currentBPM !== displayedBPM) {
            // Update UI without triggering the main updateBPM function
            document.getElementById('bpmValue').textContent = currentBPM;
            document.getElementById('bpmSlider').value = currentBPM;
            document.getElementById('bpmInput').value = currentBPM;
        }
    }

    // Check BPM periodically to keep UI in sync
    setInterval(syncBPMFromToneTransport, 1000); // Check every 1000ms
    
</script>
    
    
<script id="userCode" type="text/plain">
    // CONSTANTS ===================================================================
const allowedOctaves = 2;
const scale = [0, 2, 4, 5, 7, 9, 11]; // Major Scale
const baseNote = 60; // C4
const COLORS = {
    ACTIVE_SEQUENCE: [255, 85, 0],    // Orange for active sequence
    INACTIVE_SEQUENCE: [51, 153, 255], // Blue for inactive sequence
    SELECTED_ACTIVE_NOTE: [0, 255, 0],       // Green for selected active note
    SELECTED_REST_NOTE: [0, 120, 0],       // Green for selected rest note
    REST_NOTE: [100, 100, 100]        // Gray for rest notes
};
const keyboardMapping = [
    ['1', '2', '3', '4', '5', '6', '7', '8'],         // First sequence
    ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i'],         // Second sequence
    ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k'],         // Third sequence
    ['z', 'x', 'c', 'v', 'b', 'n', 'm', ',']          // Fourth sequence
];

const seqHeight = 10;
const padding = 10;

// HELPERS =====================================================================
const midiToDegree = (midi) => {
    const semitone = (midi - baseNote) % 12;
    let degree = scale.indexOf(semitone);
    if (degree === -1) degree = 0; // fallback
    const octaveShift = Math.floor((midi - baseNote) / 12);
    return (degree + octaveShift * scale.length) / (scale.length);
};

const noteObjectToString = (noteObj, transpose = 0) => {
    if (!noteObj.isOn) {
        return '.';  // Return rest if note is off
    }
    return Tone.Frequency(noteObj.value + transpose, "midi").toNote();
};

const clamp = (val, min, max) => Math.min(Math.max(val, min), max);

// KEYBOARD METHODS ============================================================
function adjustNote(key) {
    const s = selectedNote.sequence;
    const i = selectedNote.step;
    const noteObj = sequenceValues[s][i];

    // Calculate current position in the scale
    const currentMidi = noteObj.value;
    const semitone = (currentMidi - baseNote) % 12;
    let octave = Math.floor((currentMidi - baseNote) / 12);

    // Find current index in the scale
    let scaleIndex = scale.indexOf(semitone);
    if (scaleIndex === -1) {
        // If not in scale, find the closest note in the scale
        for (let j = 0; j < scale.length; j++) {
            if (scale[j] > semitone) {
                scaleIndex = j - 1;
                break;
            }
        }
        if (scaleIndex === -1) scaleIndex = scale.length - 1;
    }

    // Adjust the note based on arrow key
    switch (key) {
        case "ArrowUp":
            // Move to next note in scale
            if (scaleIndex < scale.length - 1) {
                // Move to next note in same octave
                scaleIndex++;
            } else {
                // Move to first note in next octave
                scaleIndex = 0;
                octave++;
            }
            break;

        case "ArrowDown":
            // Move to previous note in scale
            if (scaleIndex > 0) {
                // Move to previous note in same octave
                scaleIndex--;
            } else {
                // Move to last note in previous octave
                scaleIndex = scale.length - 1;
                octave--;
            }
            break;

        default:
            return; // Exit if not an arrow key we handle
    }

    // Calculate new MIDI value
    const newMidi = baseNote + (octave * 12) + scale[scaleIndex];

    // Ensure we stay within allowed octave range
    if (octave < 0 || (octave >= allowedOctaves && scaleIndex != 0)) {
        return; // Don't allow going outside the allowed range
    }

    // Update the knob value
    seqKnobs[s][i].set(midiToDegree(newMidi));
}

function handleKeyboardInput(key, state) {
    // Only process key down events
    if (state !== 'down') {
        return;
    }

    switch (key) {
        case 'Space':
        case ' ':
            toggleRest();
            break;
        case 'ArrowUp':
        case 'ArrowDown':
            adjustNote(key);
            break;
        case 'Enter':
            seqRadioGroup.set(`Seq ${selectedNote.sequence + 1}`)
            break;
        case '-':
            transposeNegButtons[selectedNote.sequence].set(1) // set to true
            transposeNegButtons[selectedNote.sequence].set(0) // set to false
            break;
        case '=':
        case '+':
            transposePosButtons[selectedNote.sequence].set(1) // set to true
            transposePosButtons[selectedNote.sequence].set(0) // set to false
    }
    
    // Convert key to lowercase for consistent mapping
    const lowerKey = typeof key === 'string' ? key.toLowerCase() : key;

    // Check if the key is in our mapping
    for (let s = 0; s < keyboardMapping.length; s++) {
        const rowIndex = keyboardMapping[s].indexOf(lowerKey);
        if (rowIndex !== -1) {
            selectedNote.sequence = s;
            selectedNote.step = rowIndex;
            updateNotesVisual();
            return;
        }
    }
}

function toggleRest() {
    const seq = selectedNote.sequence;
    const step = selectedNote.step;
    const noteObj = sequenceValues[seq][step];

    noteObj.isOn = !noteObj.isOn;
    updateNotesVisual();
    activateSequence();
}

// GENERAL SETUP ==============================================================
initCollab()
window.setp5Theme("dark")
const gui = new p5(sketch, Canvas);
const output = new Tone.Multiply(0.1).toDestination();
const synth = new Twinkle(gui);
synth.connect(output);
setAsciiHandler(handleKeyboardInput);
enableAsciiInput();
enableAsciiRepeat();

// STATE ======================================================================
const sequenceValues = [
    [
        { value: 60, isOn: true },
        { value: 62, isOn: true },
        { value: 64, isOn: true },
        { value: 65, isOn: true },
        { value: 67, isOn: true },
        { value: 69, isOn: true },
        { value: 71, isOn: true },
        { value: 72, isOn: true }
    ],
    [
        { value: 60, isOn: true },
        { value: 64, isOn: true },
        { value: 62, isOn: true },
        { value: 67, isOn: true },
        { value: 65, isOn: true },
        { value: 71, isOn: true },
        { value: 69, isOn: true },
        { value: 72, isOn: true }
    ],
    [
        { value: 60, isOn: true },
        { value: 69, isOn: true },
        { value: 71, isOn: true },
        { value: 72, isOn: true },
        { value: 62, isOn: true },
        { value: 64, isOn: true },
        { value: 65, isOn: true },
        { value: 67, isOn: true }
    ],
    [
        { value: 67, isOn: true },
        { value: 69, isOn: true },
        { value: 71, isOn: true },
        { value: 72, isOn: true },
        { value: 60, isOn: true },
        { value: 62, isOn: true },
        { value: 64, isOn: true },
        { value: 65, isOn: true }
    ]
]

let seqKnobs = [];
let seqButtons = [];
let transposes = [0, 0, 0, 0];
let transposeLabels = [];
let transposeNegButtons = [];
let transposePosButtons = [];
let activeSequence = 0;
let selectedNote = {
    sequence: 0,
    step: 0
};


// STATE METHODS ===============================================================
function activateSequence() {
    // Create all sequences
    for (let s = 0; s < 4; s++) {
        if (s == activeSequence) {
            synth.sequence(sequenceValues[s]
                .map(noteObj => noteObjectToString(noteObj, transposes[s])),
                '8n',
                s);
            continue;
        }
        synth.sequence(".", '8n', s);
    }
}

function updateControlColors() {
    for (let s = 0; s < 4; s++) {
        const color = s === activeSequence ? COLORS.ACTIVE_SEQUENCE : COLORS.INACTIVE_SEQUENCE;

        if (transposeLabels[s]) {
            transposeLabels[s].textColor = color;
        }
    }

    updateNotesVisual();
}

function setActiveSequence(num) {
    if (num >= 0 && num < 4) {
        activeSequence = num;
        updateControlColors();
        activateSequence();
        return true;
    }
    return false;
}

function updateNotesVisual() {
    // Update all knob colors based on their state
    for (let s = 0; s < 4; s++) {
        for (let i = 0; i < 8; i++) {
            if (seqKnobs[s] && seqKnobs[s][i]) {
                // Check if this is the selected note
                if (s === selectedNote.sequence && i === selectedNote.step) {
                    seqKnobs[s][i].accentColor = sequenceValues[s][i].isOn ? COLORS.SELECTED_ACTIVE_NOTE : COLORS.SELECTED_REST_NOTE;
                }
                // Check if this is a rest note (isOn = false)
                else if (!sequenceValues[s][i].isOn) {
                    seqKnobs[s][i].accentColor = COLORS.REST_NOTE;
                }
                // Otherwise, color based on active sequence
                else {
                    seqKnobs[s][i].accentColor = s === activeSequence ? COLORS.ACTIVE_SEQUENCE : COLORS.INACTIVE_SEQUENCE;
                }
            }
        }
    }
}

// GUI ELEMENT SETUP ===========================================================
for (let s = 0; s < 4; s++) {
    const yPos = 20 + (s * (seqHeight + padding));
    seqKnobs[s] = [];
    seqButtons[s] = [];
    transposePosButtons[s] = [];

    transposeLabels[s] = gui.Text({
        x: 63.5,
        y: yPos,
        size: 1.2,
        label: `${transposes[s] > 0 ? '+' : ''}${transposes[s]}`,
        textColor: s === activeSequence ? [255, 85, 0] : [51, 153, 255]
    });

    transposeNegButtons[s] = gui.Button({
        x: 4 + (8 * 7),
        y: yPos,
        size: 0.4,
        showValue: true,
        label: "Note -",
        callback: (val) => {
            if (!val) return;
            transposes[s] = clamp(transposes[s] - 1, -36, 36); // Limit 3 oct down/up
            // Update the transpose label
            if (transposeLabels[s]) {
                transposeLabels[s].label = `${transposes[s] > 0 ? '+' : ''}${transposes[s]}`;
            }
            activateSequence();
        }
    });

    transposePosButtons[s] = gui.Button({
        x: 4 + (9 * 7),
        y: yPos,
        size: 0.4,
        showValue: true,
        label: "Note +",
        callback: (val) => {
            if (!val) return;
            transposes[s] = clamp(transposes[s] + 1, -36, 36); // Limit 3 oct down/up
            // Update the transpose label
            if (transposeLabels[s]) {
                transposeLabels[s].label = `${transposes[s] > 0 ? '+' : ''}${transposes[s]}`;
            }
            activateSequence();
        }
    });

    // Create 8 knobs for each sequence
    for (let i = 0; i < 8; i++) {
        seqKnobs[s][i] = gui.Knob({
            x: 4 + (i * 7),
            y: yPos,
            size: 0.5,
            textSize: 1.5,
            min: 1e-9, // a little less than zero, min here tests for equality, need to allow values of zero
            max: allowedOctaves,
            value: midiToDegree(sequenceValues[s][i].value),
            showLabel: false,
            showValue: false,
            accentColor: s === activeSequence ? [255, 85, 0] : [51, 153, 255],
            link: `seq${s}_step${i}_knob`,
            callback: (val) => {
                val = Math.max(val, 0);
                let totalDegrees = scale.length;
                let raw = val * totalDegrees;
                let degree = Math.floor(raw) % totalDegrees;
                let octaveShift = Math.floor(raw / totalDegrees);
                let midiValNoTranspose = baseNote + octaveShift * 12 + scale[degree];
                sequenceValues[s][i].value = midiValNoTranspose;
                activateSequence();
            }
        });
    }
}

// EXTRA BUTTONS ===============================================================
const seqRadioGroup = gui.RadioButton({
    x: 85,
    y: 65,
    textColor: [255, 255, 255],
    textSize: 1.5,
    textFont: "Helvetica",
    radioOptions: ['Seq 1', 'Seq 2', 'Seq 3', 'Seq 4'],
    value: 'Seq 1',
    linkName: 'activeSequenceRadio',
    label: ' ',
    callback: (val) => {
        let seqNum = parseInt(val.split(" ")[1]) - 1;
        setActiveSequence(seqNum);
    }
});


let bright = gui.Knob({
    size: 0.75,
    textSize: 1.5,
    value: 0.5,
    x: 80,
    y: 18,
    label: 'brightness',
    callback: x => {
        synth.cutoff = x * 5000 + 100,
            synth.Q = 10 - x * 10,
            synth.envDepth = x * 3000
    }
})

let envelope = gui.Knob({
    size: 0.75,
    textSize: 1.5,
    value: 0.5,
    x: 90,
    y: 18,
    label: 'env',
    callback: x => {
        synth.attack = x < 0.75 ? .005 : (x - .745),
            synth.sustain = x < 0.5 ? 0 : (x - .495),
            synth.decay = x < 0.5 ? x / 2 : .25 + (x - .5),
            synth.release = x < 0.5 ? x / 2 : .25 + (x - .5) * 4
    }
})

// HACK ========================================================================
// I don't know why it doesn't apply unless I offset by 500 ms
// oh well
setInterval(() => {
    bright.set(bright.value);
    envelope.set(envelope.value);
}, 500);

</script>
    
</body>
</html>
    